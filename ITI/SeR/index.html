<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <meta xmlns="" charset="utf-8" />
    <title>SeR</title>
    <link xmlns="" rel="stylesheet" href="../../css/styles.css" />
    <style type="text/css">
        code{white-space: pre-wrap;}
        span.smallcaps{font-variant: small-caps;}
        span.underline{text-decoration: underline;}
        div.column{display: inline-block; vertical-align: top; width: 50%;}
    </style>
    <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>
  <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-HLBNC861DJ" async> </script> 
  </head>
  <body>

    <header>
      <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
        <button class="menu-icon" type="button" data-toggle="responsive-menu"></button>
        <div class="title-bar-title">SeR</div>
      </div>
      <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
        <button class="menu-icon" type="button" data-toggle="responsive-menu"></button>
        <div class="title-bar-title">SeR</div>
      </div>
      <div class="top-bar" id="responsive-menu">
        <div class="top-bar-left">
          <img src="../../IHE_INTERNATIONAL.png" class="IHE logo hide-for-small-only" alt="IHE logo" />
          <ul id="tf-small-menu" class="menu vertical show-for-small-only">
              <li><a class="ihe-purple" href="https://ihe.net" target="_blank">About IHE</a></li>
              <li class="menu-text">Sections
                <ul id="tf-small-menu-list" class="nested vertical menu">
                </ul>
              </li>
            </ul>
          </div>
        <div class="top-bar-right hide-for-small-only">
          <ul class="menu">
            <li class="menu-text tf-version">IHE HIE Whitepaper</li>
          </ul>
          <ul class="menu align-right">
            <li><input id="ihe-search-field" type="search" placeholder="Search"></li>
            <li><button id="ihe-search-button" type="button" class="button search">Search</button></li>
          </ul>
        </div>
      </div>
    </header>
    <div class="scroll-top-wrapper ">
      <span class="scroll-top-inner">
        <i class="size-icon-lg fi-arrow-up"></i>
      </span>
    </div>

    <div class="grid-container fluid">
      <main>
        <div class="grid-x grid-margin-x align-center">
          <div class="hide-for-small-only cell medium-2 large-2" data-sticky-container>
            <div id="section-menu" class="sticky" data-sticky data-anchor="main-top">
            </div>
          </div>
          <div id="main-top" class="cell medium-10 large-10">

            <p><strong>Integrating the Healthcare
            Enterprise</strong></p>
            <p><img src="assets/images/IHE-logo.jpeg"
            alt="IHE_LOGO_for_tf-docs" /></p>
            <p><strong><a href="https://profiles.ihe.net/ITI">IHE
            ITI</a></strong></p>
            <p><strong>Technical Framework Supplement</strong></p>
            <p><strong>Secure Retrieve (SeR)</strong></p>
            <p><strong>Revision 2.0 - Public Comment</strong></p>
            <p>Date: August 12, 2022</p>
            <p>Author: ITI Technical Committee</p>
            <p>Email: <a href="mailto:iti@ihe.net">iti@ihe.net</a></p>
            <p><strong>Please verify you have the most recent version of
            this document.</strong> See <a
            href="http://profiles.ihe.net/ITI">here</a> for Trial
            Implementation and Final Text versions and <a
            href="https://profiles.ihe.net/ITI/#1.3">here</a> for Public
            Comment versions.</p>
            <p><strong>Foreword</strong></p>
            <p>This is a supplement to the IHE IT Infrastructure
            Technical Framework. Each supplement undergoes a process of
            public comment and trial implementation before being
            incorporated into the volumes of the Technical
            Frameworks.</p>
            <p>This supplement is published on August 12, 2022 for
            public comment. Comments are invited and can be submitted
            using the <a
            href="http://www.ihe.net/ITI_Public_Comments/">ITI Public
            Comment form</a> or by creating a <a
            href="https://github.com/IHE/ITI.SeR/issues/new?assignees=&amp;labels=&amp;template=public-comment-issue-template.md&amp;title=">GitHub
            Issue</a>. In order to be considered in development of the
            trial implementation version of the supplement, comments
            must be received by September 12, 2022.</p>
            <p>This supplement describes changes to the existing
            technical framework documents.</p>
            <p>"Boxed" instructions like the sample below indicate to
            the Volume Editor how to integrate the relevant section(s)
            into the relevant Technical Framework volume.</p>
            <table>
            <thead>
            <tr class="header">
            <th><strong>Editor: Please amend Section X.X by the
            following</strong></th>
            </tr>
            </thead>
            <tbody>
            </tbody>
            </table>
            <p>Where the amendment adds text, make the added text
            <strong><ins>bold underline</ins></strong>. Where the
            amendment removes text, make the removed text
            <strong><del>bold strikethrough</del></strong>. When entire
            new sections are added, introduce with editor's instructions
            to "add new text" or similar, which for readability are not
            bolded or underlined.</p>
            <p>General information about IHE can be found at <a
            href="http://www.ihe.net">IHE.net</a>.</p>
            <p>Information about the IHE IT Infrastructure domain can be
            found at <a href="https://www.ihe.net/IHE_Domains/">IHE
            Domains</a>.</p>
            <p>Information about the organization of IHE Technical
            Frameworks and Supplements and the process used to create
            them can be found at <a
            href="https://www.ihe.net/resources/profiles/">Profiles</a>
            and <a href="https://www.ihe.net/about_ihe/ihe_process/">IHE
            Process</a>.</p>
            <p>The current version of the IHE Technical Framework can be
            found at <a href="https://profiles.ihe.net/ITI/"><a
            href="https://profiles.ihe.net/ITI">https://profiles.ihe.net/ITI</a></a>.</p>
            <p><strong>CONTENTS</strong></p>
            <!-- TOC depthFrom:1 depthTo:2 -->

            <ul>
            <li><a href="#introduction-to-this-supplement">Introduction
            to This Supplement</a></li>
            <li><a href="#open-issues-and-questions">Open Issues and
            Questions</a></li>
            <li><a href="#closed-issues">Closed Issues</a></li>
            <li><a
            href="#ihe-technical-frameworks-general-introduction">IHE
            Technical Frameworks General Introduction</a>
            <ul>
            <li><a href="#9-copyright-licenses">9 Copyright
            Licenses</a></li>
            <li><a href="#10-trademark">10 Trademark</a></li>
            </ul></li>
            <li><a
            href="#ihe-technical-frameworks-general-introduction-appendices">IHE
            Technical Frameworks General Introduction Appendices</a>
            <ul>
            <li><a
            href="#appendix-a---actor-summary-definitions">Appendix A -
            Actor Summary Definition</a></li>
            <li><a
            href="#appendix-b---transaction-summary-definitions">Appendix
            B - Transaction Summary Definitions</a></li>
            <li><a href="#appendix-d---glossary">Appendix D -
            Glossary</a></li>
            </ul></li>
            <li><a href="#volume-1---profiles">Volume 1 -
            Profiles</a></li>
            <li><a href="#39-secure-retrieve-ser-profile">39 Secure
            Retrieve (SeR) Profile</a>
            <ul>
            <li><a
            href="#391-ser-actors-transactions-and-content-modules">39.1
            SeR Actors, Transactions, and Content Modules</a></li>
            <li><a href="#392-ser-actor-options">39.2 SeR Actor
            Options</a></li>
            <li><a href="#393-ser-required-actor-groupings">39.3 SeR
            Required Actor Groupings</a></li>
            <li><a href="#394-ser-overview">39.4 SeR Overview</a></li>
            <li><a href="#395-ser-security-considerations">39.5 SeR
            Security Considerations</a></li>
            <li><a href="#396-ser-cross-profile-considerations">39.6 SeR
            Cross Profile Considerations</a></li>
            </ul></li>
            <li><a href="#volume-2---transactions">Volume 2 -
            Transactions</a>
            <ul>
            <li><a href="#379-authorization-decisions-query-iti-79">3.79
            Authorization Decisions Query [ITI-79]</a></li>
            </ul></li>
            <li><a href="#volume-2--appendices">Volume 2 -
            Appendices</a></li>
            <li><a href="#volume-3---content-modules">Volume 3 - Content
            Modules</a></li>
            <li><a href="#volume-4---national-extensions">Volume 4 -
            National Extensions</a></li>
            </ul>
            <h1 id="introduction-to-this-supplement">Introduction to
            This Supplement</h1>
            <p>This supplement defines new functionalities for a
            Community with a unique and centralized Access Control
            system. This profile is limited to those deployment models
            and their policies where a central authorization authority
            can make complete and definitive decisions, yet support
            federated identity/authentication. In these deployment
            models no actors except the central authorization authority
            need to know the fine-grain policies to enforce.</p>
            <p>The supplement describes how to create a "system of
            trust" between the actor that can perform Authorization
            Decisions (on behalf of Consent Docs, Policies and
            Creation/Access/Disclosure rules) and actors that actually
            store clinical data and documents. For example, in a typical
            XDS environment, there are many XDS Document Repositories
            that store documents. These systems are not aware of Consent
            Documents published by patients, and cannot apply
            Access/Creation/Disclosure Policies to requests for Document
            retrieval; then the replication of Access Control
            functionalities is unfeasible and/or too expensive (due to
            integration burdens and total cost of ownership).</p>
            <p>The objective of the Secure Retrieve Profile is the
            definition of a mechanism to convey Authorization Decisions
            between actors in the Community, attesting that the reliable
            Authorization Decisions Manager implementing a Policy
            Decision Point (PDP) makes the access decision.</p>
            <!-- Dmytro: No changes are required below because this fragment describes _starting_
            requirements and constraints, i.e., the history and not the current state. -->

            <p>The starting requirements/constraints upon which this
            profile is developed are described below:</p>
            <ul>
            <li>A unique Authorization Decisions Manager (or PDP)
            performs Authorization Decisions for all XDS Document
            Consumer and all XDS Document Repositories involved in a
            Community.</li>
            <li>XDS Document Repositories cannot manage the whole set of
            information needed to perform Authorization Decisions (XDS
            Document Repositories are not required to store metadata. If
            the Repository stores metadata, the metadata might be
            insufficient to perform an access decision).</li>
            <li>The XDS infrastructure is not fully federated; a clear
            separation of duties and responsibilities between PDP and
            XDS Document Repositories is needed (Repositories store
            clinical documents; PDP evaluates access rights to those
            contents).</li>
            <li>The XDS Document Repositories must enforce Authorization
            Decisions made by the Policy Decision Point.</li>
            <li>A technical pattern that reduces behavioral and
            transactional changes for the Consumer side is clearly
            preferred (lower costs for deployment and for security
            reasons).</li>
            </ul>
            <p>This supplement is a standalone profile because it
            defines a flexible pattern that could be used by any Service
            Provider that queries for Authorization Decisions granted by
            a trusted Authorization Decisions Manager (or PDP). However,
            the focus is to add Access Control functionalities to the
            XDS environment.</p>
            <p>This profile introduces two new actors (Authorization
            Decisions Manager and Authorization Decisions Verifier) and
            one new transaction (Authorization Decisions Query).</p>
            <p>This profile does not describe how Authorization
            Decisions are performed. However, this profile relies on the
            XACML-SAML framework for messages and transactions between
            the actors.</p>
            <p>This profile describes how a Service Provider (e.g.,
            Document Repository) can request Authorization Decisions for
            clinical data granted to an Requester Entity (e.g., a user
            retrieving clinical documents).</p>
            <h1 id="open-issues-and-questions">Open Issues and
            Questions</h1>
            <ol start="11" type="1">
            <li>As the profile covers not only document retrieval, shall
            it be renamed from "Secure Retrieve" (SeR) to e.g., "Health
            IT Access Decision Delegation" (HADD)?</li>
            <li>A change in Section 3.79.4.2.2 prescribes to populate
            the status code according to Section 4.10 "Element <a
            href="samlp:Response">samlp:Response</a>: XACMLAuthzDecision
            Response" of OASIS SAML 2.0 Profile of XACML v2.0 (errata)
            instead of using a fixed value
            <code>urn:oasis:names:tc:SAML:2.0:status:Success</code> --
            this is because otherwise it would be impossible cover error
            cases. Does this change break the backward
            compatibility?</li>
            <li>Shall information about human users in the Authorization
            Decisions Manager's audit record (added with the Swiss
            change proposal) be deleted again?</li>
            <li>Shall the audit record definitions of the both actors be
            reworked to be made consistent with definitions in other IHE
            profiles?</li>
            </ol>
            <h1 id="closed-issues">Closed Issues</h1>
            <ol type="1">
            <li><p>Which is the best technical approach for the
            solution?</p>
            <ul>
            <li>It is suggested an evaluation of both the technical
            approaches: SAML token vs. JWT Bearer token. A comparison
            between the two standards will be formalized in a document.
            First step: evaluation of the efficiency of the two
            solutions proposed.</li>
            <li>A JWT token is only OAuth which is REST. What we may end
            up with is an equivalent of this in MHD. Right now, we are
            doing this for XDS, so the strategy should be:
            <ul>
            <li>Focus on SAML and SOAP, and advancing XUA.</li>
            <li>Let MHD handle the RESTful equivalent after this is in
            TI.</li>
            </ul></li>
            <li>Volume 1 should be independent of the standards
            selected. Volume 2 may eventually contain an extra piece
            that shows how OAuth, REST and MHD meet the same volume 1
            need as the SAML/SOAP pieces that are developed this
            year.</li>
            <li>Therefore, the plan is to proceed with SAML and SOAP for
            now, but not mention this in volume 1, only in volume
            2.</li>
            </ul></li>
            <li><p>I've introduced a transaction to "Request Retrieval
            Token". This allows in the same environment simple Consumer
            and Consumer compliant with SeR guideline. This is, from my
            point of view, acceptable because there are certain types of
            docs (administrative docs and so on...) that probably can be
            shared without Retrieval Token. In my perspective this
            choice brings flexibility to the solution. Is this
            reasonable?</p>
            <ul>
            <li>This can be addressed silently defining Domain Policies
            that state that some documents can be retrieved without
            Retrieval Token. No reasons to profile this feature.</li>
            </ul></li>
            <li><p>Many different patterns have been analyzed. An
            evaluation spreadsheet was produced. For further details
            see: <a
            href="https://docs.google.com/spreadsheets/d/1h28WYMsr1AQI9wajBVJyPnKFIcVtqa98/edit#gid=1371981459">CRAC
            Standards Pattern Selection Criteria Matrix -
            2020140323.xls</a></p></li>
            <li><p>Which is the best drafting approach for the
            supplement? (Suggestion to postpone this
            decision/discussion, after a deep analysis of the problem.
            This is something that can be addressed after the first face
            to face meeting, once we have clear the SCOPE and the USE
            CASES that can be covered)</p>
            <ul>
            <li>The supplement is drafted as an independent supplement
            focused on an XDS environment. The pattern selected, allows
            to be applied for future applications to other use cases.
            Transaction [ITI-79] is profiled taking this in mind
            (extensible payload for the XACMLAuthorizationDecisionQuery
            Request message)</li>
            </ul></li>
            <li><p>There was a proposal: Use Artifact Resolution
            Protocol (defined in SAML 2.0 core specification) instead of
            XACMLAuthzDecisionQuery. Rationale: The transaction [ITI-79]
            defines a standard semantic to check if an authorization
            token exists, but XACMLAuthzDecision Query is used to
            request and perform Authorization Decision.</p>
            <ul>
            <li>The proposal was rejected: The use case does not require
            the sharing of SAML Artifact. The XACMLAuthzDecisionQuery
            does not require that the Authorization Decisions Manager
            performs Authorization Decisions following the XACML
            standard. XACML Authorization Query Request message just
            conveys needed parameters to locate an authorization. In
            addition to that, Artifact Resolution protocol seems to add
            some requirements that broke the basic use case "In all
            cases, the artifact MUST exhibit a single-use semantic such
            that once it has been successfully resolved, it can no
            longer be used by any party." And again: "The responder MUST
            enforce a one-time-use property on the artifact by ensuring
            that any subsequent request with the same artifact by any
            requester results in an empty response as described above."
            For the XDS use case, the Authorization Decisions Manager
            could request the same authorization many times; the
            one-shot authorization is not useful in this use case.</li>
            </ul></li>
            <li><p>It was suggested to use Attribute Name:
            urn:oasis:names:tc:SAML:2.0:profiles:attribute:XPSA:subject
            in accordance to XSPA instead of the subject-id. The
            proposal was rejected. The using of the XSPA guideline does
            not add value, and add requirements that do not match with
            SeR use case.</p></li>
            <li><p>This profile mandates the grouping between XDS Actors
            and XUA Actors (see Section 3). Readers are asked to provide
            feedback on this requirement. It is obvious that XUA
            environment (and SAML 2.0 token) is helpful for entity
            identification. Are there any other preferred approaches to
            perform this identification?</p>
            <ul>
            <li>No other approaches are suggested. XUA grouping is
            confirmed.</li>
            </ul></li>
            <li><p>Readers should focus on the XACML encoding defined
            for the XDSDocumentEntry.uniqueId and for the XUA Attribute
            Patient ID. Both this attribute are identified by the same
            @Category and same @AttributeId. This could create problems,
            because the Authorization Decisions Manager should interpret
            which is the docID and which is the patient ID. It is not
            clear to the tech committee how much the impact is.</p>
            <ul>
            <li>A new urn is defined for patient ID.</li>
            </ul></li>
            <li><p>This profile defines a mandatory grouping between
            Authorization Decisions Manager and Document Registry. It is
            an obvious grouping, but implementations could also use
            other approaches. Readers are asked to provide feedback on
            this requirement.</p>
            <ul>
            <li>The profile does not profile the transaction to request
            Authorizations. This Authorization Decision is likely
            performed during the Query Request processing and requires
            input parameters local defined by the Domain. However, the
            performing of these decisions needs a lot of information
            managed by the Registry or conveyed within the Query
            Request. In accordance to this a grouping approach is
            proposed.</li>
            </ul></li>
            <li><p>The pattern described in this profile requires the
            Pull of authorization from an Authorization Decisions
            Manager. This approach is compliant with XACML standard. For
            efficiency reasons a Push approach could be better. In a
            Push environment when an Authorization is granted for a
            resource, this authorization is sent to the XDS Document
            Repository that stores this resource. This approach is not
            described in standard specification yet.</p>
            <ul>
            <li>The Pull approach is chosen to reduce computational load
            on the central Authorization Decisions Manager</li>
            </ul></li>
            </ol>
            <h1 id="ihe-technical-frameworks-general-introduction">IHE
            Technical Frameworks General Introduction</h1>
            <p>The <a href="https://profiles.ihe.net/GeneralIntro/">IHE
            Technical Framework General Introduction</a> is shared by
            all of the IHE domain technical frameworks. Each technical
            framework volume contains links to this document where
            appropriate.</p>
            <h2 id="9-copyright-licenses">9 Copyright Licenses</h2>
            <p>IHE technical documents refer to, and make use of, a
            number of standards developed and published by several
            standards development organizations. Please refer to the IHE
            Technical Frameworks General Introduction, Chapter 9 - <a
            href="https://profiles.ihe.net/GeneralIntro/ch-9.html">Copyright
            Licenses</a> for copyright license information for
            frequently referenced base standards.</p>
            <h2 id="10-trademark">10 Trademark</h2>
            <p>IHE® and the IHE logo are trademarks of the Healthcare
            Information Management Systems Society in the United States
            and trademarks of IHE Europe in the European Community.
            Please refer to the IHE Technical Frameworks General
            Introduction, <a
            href="https://profiles.ihe.net/GeneralIntro/ch-10.html">Section
            10 - Trademark</a> for information on their use.</p>
            <h1
            id="ihe-technical-frameworks-general-introduction-appendices">IHE
            Technical Frameworks General Introduction Appendices</h1>
            <p>The <a
            href="https://profiles.ihe.net/GeneralIntro/index.html">IHE
            Technical Framework General Introduction Appendices</a> are
            components shared by all of the IHE domain technical
            frameworks. Each technical framework volume contains links
            to these documents where appropriate.</p>
            <table>
            <thead>
            <tr class="header">
            <th>**Editor: Please update the following appendices to the
            General Introduction as indicated below. Note that these are
            not appendices to this domain's Technical Framework (TF-1,
            TF-2, TF-3, or TF-4) but rather, they are appendices to the
            IHE Technical Frameworks General Introduction located <a
            href="https://profiles.ihe.net/GeneralIntro/index.html">here</a>.
            **</th>
            </tr>
            </thead>
            <tbody>
            </tbody>
            </table>
            <h2 id="appendix-a---actor-summary-definitions">Appendix A -
            Actor Summary Definitions</h2>
            <table>
            <thead>
            <tr class="header">
            <th>**Editor: Please add the following new or modified
            actors to the <a
            href="https://profiles.ihe.net/GeneralIntro/ch-A.html">IHE
            Technical Frameworks General Introduction Appendix A:</a>
            **</th>
            </tr>
            </thead>
            <tbody>
            </tbody>
            </table>
            <table>
            <thead>
            <tr class="header">
            <th>Actor</th>
            <th>Definition</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td>Authorization Decisions Manager</td>
            <td>Actor that can perform Access Decisions, evaluating
            requests for authorization. The result of this evaluation is
            an Authorization Decision that certifies the disclosing of
            clinical data.</td>
            </tr>
            <tr class="even">
            <td>Authorization Decisions Verifier</td>
            <td>This actor queries for Authorization Decisions for
            Requester Entities used to enforce Authorization
            Decisions.</td>
            </tr>
            </tbody>
            </table>
            <h2
            id="appendix-b---transaction-summary-definitions">Appendix B
            - Transaction Summary Definitions</h2>
            <table>
            <thead>
            <tr class="header">
            <th>**Editor: Please add the following new or modified
            transactions to the <a
            href="https://profiles.ihe.net/GeneralIntro/ch-B.html">IHE
            Technical Frameworks General Introduction Appendix B:</a>
            **</th>
            </tr>
            </thead>
            <tbody>
            </tbody>
            </table>
            <table>
            <thead>
            <tr class="header">
            <th>Transaction</th>
            <th>Definition</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td>Authorization Decisions Query [ITI-79]</td>
            <td>Transaction used by the Service Provider (Authorization
            Decisions Verifier) to request Authorization Decisions to
            clinical data granted for the Requester Entity.</td>
            </tr>
            </tbody>
            </table>
            <h2 id="appendix-d---glossary">Appendix D - Glossary</h2>
            <table>
            <thead>
            <tr class="header">
            <th>**Editor: Please add the following new or modified
            glossary terms to the <a
            href="https://profiles.ihe.net/GeneralIntro/ch-D.html">IHE
            Technical Frameworks General Introduction Appendix D</a>
            **</th>
            </tr>
            </thead>
            <tbody>
            </tbody>
            </table>
            <table>
            <thead>
            <tr class="header">
            <th>Glossary Term</th>
            <th>Definition</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td>Authorization Decision Manager</td>
            <td>A system that is responsible for
            access/creation/disclosure decisions performed according to
            Domain Policies, Consent Documents, etc. This actor may
            implement additional functionalities of Policy Decision
            Points (PDP), Policy Administration Points (PAP) and a
            Policy Information Points (PIP).</td>
            </tr>
            <tr class="even">
            <td>Authorization Decision</td>
            <td>An authorization token that describes whether clinical
            data can be accessed by a specific Requester Entity.</td>
            </tr>
            <tr class="odd">
            <td>Requester Entity</td>
            <td>The entity identified within the identity assertion.
            This entity queries any actor grouped with the Authorization
            Decision Verifier for clinical data (e.g., documents).
            Authorization Decisions are created and associated with the
            Requester Entity.</td>
            </tr>
            </tbody>
            </table>
            <h1 id="volume-1---profiles">Volume 1 - Profiles</h1>
            <table>
            <thead>
            <tr class="header">
            <th><strong>Editor: Please add the following Section 39 to
            Volume 1</strong></th>
            </tr>
            </thead>
            <tbody>
            </tbody>
            </table>
            <h1 id="39-secure-retrieve-ser-profile">39 Secure Retrieve
            (SeR) Profile</h1>
            <p>This profile defines a framework for a centralized Access
            Control system, which separates the duties of creation and
            enforcement of Authorization Decisions.</p>
            <p>The main objective of this profile is to create a system
            of trust between the actor that produces Authorization
            Decisions (Authorization Decisions Manager), and actors that
            are grouped with Authorization Decisions Verifier to enforce
            the Authorization Decisions (e.g., XDS Document
            Repositories).</p>
            <p>This type of approach is useful in many situations:</p>
            <ul>
            <li>XDS environments with many XDS Document Repositories
            which expose clinical documents without an access control
            system already implemented. These systems require minimal
            integration burden to support functionalities defined in
            this profile.</li>
            <li>Federation of repositories in a new XDS Affinity Domain.
            The federation of repositories requires the subscription of
            the whole set of domain policies for content
            Creation/Access/Disclosure. A centralized Authorization
            Decision Manager coupled with the central XDS Document
            Registry allows the management of accesses to local
            Repositories without requiring the development of complex
            Access Control systems.</li>
            <li>Environments where Consent Documents, Policies and Data
            Access Rules can be collected, managed and discovered only
            in a centralized way.</li>
            <li>Sharing infrastructure with strong enforcement of Access
            Control systems. In many organizational and jurisdictional
            environments, access to clinical data is managed by Servers
            that store/register clinical data and cannot be regulated by
            the Consumer itself.</li>
            </ul>
            <p>In those scenarios, this profile defines how to create a
            "logical federation" between an Authorization Decision
            Manager (responsible for enabling/denying accesses) and
            actors that enforce Authorization Decisions (e.g., XDS
            Document Repositories that store documents and expose them
            without knowledge related to the user/role/consent
            documents/policies etc.). Actors that store clinical data
            could only trust a decision made by the Authorization
            Decision Manager.</p>
            <p>Authorization Decision Manager functionalities are out of
            scope for this profile. The implementation details typically
            are domain specific and locally defined.</p>
            <p>This profile allows the creation of a system where the
            existence of a clinical data item that cannot be accessed by
            a specific user is totally obscured from the Requester
            Entity.</p>
            <p>Creation, management and enforcement of policies are out
            of scope for this profile.</p>
            <p>This profile allows addressing the following security
            risks (related to clinical data exposure):</p>
            <ul>
            <li><p>The actor storing clinical data does not know the
            Authorization Decision that should be enforced. Therefore,
            if it denies access to data, there is a failure of
            availability. If it provides the document inappropriately,
            there is a risk to confidentiality. The SeR Profile allows
            this actor to be aware of the decision made, only asking for
            the existence of Authorizations granted by the trusted
            Authorization Decision Manager and enforcing that decision.
            In accordance with the Community policies, the actor storing
            clinical data can make further access control
            decisions.</p></li>
            <li><p>A separation of duties between the clinical data
            consumer (that requests authorization and clinical data
            items) and the Authorization Decisions Manager (or PDP) is
            created. The SeR Profile delegates decisions to the
            Authorization Decisions Manager and the enforcement to the
            Authorization Decisions Verifier.</p></li>
            </ul>
            <h2
            id="391-ser-actors-transactions-and-content-modules">39.1
            SeR Actors, Transactions, and Content Modules</h2>
            <p>This section defines the actors, transactions, and/or
            content modules in this profile.</p>
            <p>Figure 39.1-1 shows the actors directly involved in the
            SeR Profile and the relevant transactions between them.</p>
            <p><img src="assets/images/SeR_Actor_Diagram-NEW.svg"
            alt="Figure 39.1-1: SeR Actor Diagram" /></p>
            <p><strong>Figure 39.1-1: SeR Actor Diagram</strong></p>
            <!-- Dmytro: The original diagram is moved to Section 39.4.2.1. -->

            <p>Table 39.1-1 lists the transactions for each actor
            directly involved in the SeR Profile. To claim compliance
            with this profile, an actor shall support all required
            transactions (labeled "R") and may support the optional
            transactions (labeled "O").</p>
            <p><strong>Table 39.1-1: SeR Profile - Actors and
            Transactions</strong></p>
            <table>
            <thead>
            <tr class="header">
            <th>Actors</th>
            <th>Transactions</th>
            <th>Optionality</th>
            <th>Reference</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td>Authorization Decisions Manager</td>
            <td>Authorization Decisions Query [ITI-79]</td>
            <td>R</td>
            <td><a href="#379-authorization-decisions-query-iti-79">ITI
            TF-2: 3.79</a></td>
            </tr>
            <tr class="even">
            <td>Authorization Decisions Verifier</td>
            <td>Authorization Decisions Query [ITI-79]</td>
            <td>R</td>
            <td><a href="#379-authorization-decisions-query-iti-79">ITI
            TF-2: 3.79</a></td>
            </tr>
            </tbody>
            </table>
            <p>The Authorization Decisions Query [ITI-79] provides
            support for different query types, depending on which actor
            is grouped with the Authorization Decisions Verifier and
            which transactions (which clinical data items) are in focus.
            This supplement profiles one standard query type: "Retrieve
            Document Set Authorization Decision" and supports extensions
            for other query types, which may be defined on vendor,
            community, regulatory domain, or national level. The
            optionality of supporting various query types is a subject
            of local regulations.</p>
            <h3
            id="3911-actor-descriptions-and-actor-profile-requirements">39.1.1
            Actor Descriptions and Actor Profile Requirements</h3>
            <p>Most requirements are documented in Transactions (Volume
            2) and Content Modules (Volume 3). This section documents
            any additional requirements on profile's actors.</p>
            <h4 id="39111-authorization-decisions-manager">39.1.1.1
            Authorization Decisions Manager</h4>
            <p>The Authorization Decisions Manager is responsible for
            the management of access control decisions in the entire
            Community. From the Access Control point of view, this actor
            is the unique Policy Decision Point (PDP) of the entire
            domain because it may decide on the outcome of an incoming
            authorization request in order to provide access to specific
            clinical data (e.g., documents). The Authorization Decisions
            Manager creates an Access Decision.</p>
            <!-- Dmytro: See the sentence inserted below; token caching should not be a required feature. -->

            <p>The Authorization Decision does not need to be exposed to
            other systems, and it certifies the decision made. The
            Authorization Decisions Manager may cache the Authorization
            Decision and reuse it when processing subsequent requests
            with the same parameters, if the local domain policies allow
            such behavior, and implement additional Access Control
            functionalities required in the specific implementation
            scenario.</p>
            <p>(Refer to the White Paper IHE ITI <a
            href="https://www.ihe.net/Technical_Framework/upload/IHE_ITI_TF_WhitePaper_AccessControl_2009-09-28.pdf">Access
            Control White Paper</a> for further information about PDP
            and Access Control Systems.)</p>
            <h4 id="39112-authorization-decisions-verifier">39.1.1.2
            Authorization Decisions Verifier</h4>
            <p>The Authorization Decisions Verifier is the actor that
            verifies if the Requester Entity is authorized to access
            clinical data by querying the Authorization Decisions
            Verifier. The Authorization Decisions Verifier actor acts as
            a Policy Enforcement Point (PEP) and enforces the
            Authorization Decision made by the trusted Policy Decision
            Point.</p>
            <p>(Refer to the White Paper IHE ITI <a
            href="https://www.ihe.net/Technical_Framework/upload/IHE_ITI_TF_WhitePaper_AccessControl_2009-09-28.pdf">Access
            Control White Paper</a> for further information about PEP
            and Access Control Systems.)</p>
            <h2 id="392-ser-actor-options">39.2 SeR Actor Options</h2>
            <p>Options that may be selected for each actor in this
            profile, if any, are listed in the Table 39.2-1.
            Dependencies between options when applicable are specified
            in notes.</p>
            <p><strong>Table 39.2-1: SeR - Actors and
            Options</strong></p>
            <table>
            <thead>
            <tr class="header">
            <th>Actor</th>
            <th>Option Name</th>
            <th>Reference</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td>Authorization Decisions Manager</td>
            <td>XUA (Note 1)</td>
            <td>Section 39.2.1</td>
            </tr>
            <tr class="even">
            <td></td>
            <td>IUA (Note 1)</td>
            <td>Section 39.2.2</td>
            </tr>
            <tr class="odd">
            <td>Authorization Decisions Verifier</td>
            <td>XUA (Note 1)</td>
            <td>Section 39.2.1</td>
            </tr>
            <tr class="even">
            <td></td>
            <td>IUA (Note 1)</td>
            <td>Section 39.2.2</td>
            </tr>
            </tbody>
            </table>
            <p><em>Note 1: The actor shall support at least one of the
            options</em></p>
            <h3 id="3921-xua-option">39.2.1 XUA Option</h3>
            <p>The actors supporting this option shall be grouped with
            XUA X-Service Provider (<a
            href="https://profiles.ihe.net/ITI/TF/Volume1/ch-13.html#13.4">ITI
            TF-1: 13.4</a>).</p>
            <h3 id="3922-iua-option">39.2.2 IUA Option</h3>
            <p>The actors supporting this option shall be grouped with
            IUA Resource Server (<a
            href="https://profiles.ihe.net/ITI/IUA/index.html#34113-resource-server">ITI
            TF-1: 34.1.1.3</a>).</p>
            <h2 id="393-ser-required-actor-groupings">39.3 SeR Required
            Actor Groupings</h2>
            <!-- Dmytro: The paragraph is moved to Section 39.4.2.1. -->

            <p>This profile requires the identification of the entity
            that queries clinical data. Authorization Decisions are
            granted to a specific entity and can be used only by that
            entity to get access to the clinical data.</p>
            <p>Grouping with XUA Actors shall be supported. Other
            approaches for entity identification may be defined by local
            domain policies.</p>
            <p>An actor from this profile (Column 1) shall implement all
            of the required transactions and/or content modules in this
            profile <strong><em>in addition</em></strong> to all of the
            transactions required for the grouped actor (Column 2).</p>
            <p><a href="#395-ser-security-considerations">Section
            39.5</a> describes some optional groupings that may be of
            interest for security considerations and <a
            href="#396-ser-cross-profile-considerations">Section
            39.6</a> describes some optional groupings in other related
            profiles.</p>
            <p><strong>Table 39.3-1: SeR - Required Actor
            Groupings</strong></p>
            <table border="1">
                <tr bgcolor="#eeeeee">
                    <th>SeR Actor</th>
                    <th>Actor to be grouped with</th>
                    <th>Reference</th>
                    <th>Content Bindings Reference</th>
                <tr>
                <tr>
                    <td >Authorization Decisions Manager</td>
                    <td>ATNA Secure Node or Secure Application</td>
                    <td><a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html#9.1">ITI TF-1: 9.1</a></td>
                    <td>--</td>
                </tr>
                <tr>
                    <td>Authorization Decisions Verifier</td>
                    <td>ATNA Secure Node or Secure Application</td>
                    <td><a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html#9.1">ITI TF-1: 9.1</a></td>
                    <td>--</td>
                </tr>
            </table>

            <h2 id="394-ser-overview">39.4 SeR Overview</h2>
            <h3 id="3941-concepts">39.4.1 Concepts</h3>
            <p>This section describes use cases for the SeR Profile.</p>
            <h3 id="3942-use-cases">39.4.2 Use Cases</h3>
            <h4
            id="39421-use-case-1-xds-repositories-with-a-centralized-authorization-decision-manager">39.4.2.1
            Use Case #1: XDS Repositories with a centralized
            Authorization Decision Manager</h4>
            <p>This use case describes how an XDS Document Repository
            uses Authorization Decisions made by the Authorization
            Decisions Manager.</p>
            <!-- Dmytro: The paragraph below is moved from Section 39.3, the word "mandatory"
            originally present there is removed. -->

            <p>In this use case, the XUA Option is used. The groupings
            between XDS Actors and SeR Actors enforce the system of
            trust between the XDS Document Registry that localizes the
            XDS DocumentEntries and the XDS Document Repositories that
            store XDS documents. This use case assumes that
            Authorization Decisions are based on the document metadata
            and groups the XDS Document Registry and the Authorization
            Decisions Manager for simplicity.</p>
            <p>In this use case the XDS Document Repositories are all in
            the same XDS Affinity Domain and delegate Authorization
            Decisions to the Authorization Decisions Manager grouped
            with the XDS Document Registry.</p>
            <p>In this use case the Authorization Decisions Manager
            manages all information needed to perform an Authorization
            Decision and therefore combines the functionality of a
            Policy Decision Point (PDP) and a Policy Information Point
            (PIP).</p>
            <p>The Authorization Decisions Manager may also implement
            functions of a Policy Administration Point (PAP),
            administering and maintaining Policies in the XDS Affinity
            Domain.</p>
            <p>In this use case a special implementation is used
            intended to increase the overall performance. Authorization
            Decisions are created when the Requester Entity queries the
            XDS metadata and stored for a specific time interval,
            expecting that the document metadata are queried from the
            XDS Registry before the documents are queried from the XDS
            Repository within the time frame set by the Authorization
            Decision lifetime.</p>
            <p><img src="assets/images/SeR_Actor_Diagram.png"
            alt="Figure 39.4.2.1-1: SeR Actor Diagram with XDS Actor Groupings" />
            <strong>Figure 39.4.2.1-1: SeR Actor Diagram with XDS Actor
            Groupings</strong></p>
            <!-- Dmytro: This diagram is moved from Section 39.1. -->

            <h5
            id="394211-xds-repositories-with-a-centralized-authorization-decision-manager-use-case-description">39.4.2.1.1
            XDS Repositories with a centralized Authorization Decision
            Manager Use Case Description</h5>
            <p>When a Requester Entity request documents from an XDS
            Repository, the XDS Document Repository uses an
            [Authorization Decisions Query [ITI-79] to query the
            Authorization Decision from the Authorization Decisions
            Manager. The Authorization Decisions Manager builds an
            Authorization Decision based on</p>
            <ul>
            <li>the information send with the Authorization Decisions
            Query [ITI-79]</li>
            <li>the document metadata stored in the XDS Registry</li>
            <li>the Patient Consent and the Access Policies.</li>
            </ul>
            <p>The XDS Document Repository grouped with an Authorization
            Decisions Verifier enforces the Authorization Decision
            returned with the Authorization Decisions Query
            [ITI-79].</p>
            <p>For example:</p>
            <p>Mr. White comes to his GP, Dr. Brown, to show him a
            Laboratory Report. This Laboratory Report is shared in an
            XDS infrastructure. Using his EHR, Dr. Brown queries for Mr.
            White's Laboratory Reports shared in the XDS infrastructure.
            The Query Response returns some DocumentEntries to the XDS
            Document Consumer. Each XDSDocumentEntry in the response is
            authorized for the retrieval. Dr. Brown uses his XDS
            Document Consumer to retrieve these documents. The XDS
            Document Repository enforces the Authorization Decision for
            each document requested by limiting the documents provided
            to Dr. Brown.</p>
            <h5
            id="394212-xds-repositories-with-a-centralized-authorization-decision-manager-process-flow">39.4.2.1.2
            XDS Repositories with a centralized Authorization Decision
            Manager Process Flow</h5>
            <p><img src="assets/images/uc1-flow.png"
            alt="Figure 39.4.2.1.2-1: Basic Process Flow in SeR Profile" />
            <strong>Figure 39.4.2.1.2-1: Process Flow of the use
            case.</strong> <em>Note: The source code for the UML diagram
            is available <a
            href="https://github.com/IHE/ITI.SeR/blob/main/assets/plantuml/uc1-flow.plantuml">here</a>.</em></p>
            <h4
            id="39422-use-case-2-query-type-extension-use-case">39.4.2.2
            Use Case #2: Query Type Extension Use Case</h4>
            <p>This use case describes how a Community uses the SeR
            Profile to enforce authorization for all actors which manage
            sensitive data and uses various query types in a national
            extensions.</p>
            <p>In this use case sensitive information has been
            identified to be:</p>
            <ul>
            <li>clinical documents which contain the details of the
            disorder and the treatment</li>
            <li>the document metadata which contain information on the
            author and clinical facility which may be used to draw
            conclusions about the disorder</li>
            <li>the patient identifiers which contain identifier of the
            assigning authorities and may be used to draw conclusions
            about the disorder</li>
            <li>the personal data of the healthcare professionals and
            their relation to institutions which may be used to draw
            conclusions about the employer-employee relationship</li>
            </ul>
            <p>To protect the sensitive information against malicious
            misuse the following actors in the Community are grouped
            with the Authorization Decisions Verifier:</p>
            <ul>
            <li>XDS Document Repository</li>
            <li>XDS Document Registry</li>
            <li>Patient Demographics Supplier</li>
            <li>Healthcare Provider Directory</li>
            </ul>
            <p>These actors use Authorization Decisions Query [ITI-79]
            messages whenever a Requester Entity queries for the
            sensitive data to retrieve an Authorization Decision from a
            single Authorization Decisions Manager in the Community and
            disclose the data only in the case the access is
            authorized.</p>
            <p>As defined in the XUA Option, actors which request
            sensitive information are grouped with the X-Service User
            Actor of the <a
            href="https://profiles.ihe.net/ITI/TF/Volume1/ch-13.html">XUA
            Profile</a>. They use the authentication data identifying
            the Requester Entity to retrieve the X-User Assertion from
            the X-Assertion Provider and provides the X-User Assertion
            in the security header of the request for sensitive
            information. The X-User Assertion conveys the identity data
            and further information required for Authorization Decisions
            (user role, user institution, etc.) from other sources
            (e.g., Healthcare Provider Directory).</p>
            <p>The information required by the Authorization Decisions
            Manager differs depending on the actor which is queried for
            sensitive information. The difference is reflected in the
            query options chosen and different query types are used,
            which are specified as extensions (e.g., national extension)
            to this profile.</p>
            <h5
            id="394221-query-type-extension-use-case-description">39.4.2.2.1
            Query Type Extension Use Case Description</h5>
            <p>A healthcare professional queries sensitive data which
            requires authorization from an actor managing the data. The
            actors involved perform all necessary actions to enforce
            Authorization Decision for the data in the background and
            returns only the data the healthcare professional is
            authorized for.</p>
            <p>The actor used by the healthcare professional to query
            the sensitive information performs the following steps:</p>
            <ul>
            <li>authenticate the healthcare professional</li>
            <li>exchange the authentication assertion to an X-User
            Assertion</li>
            <li>perform the query adding the X-User Assertion in the
            security header of the query request.</li>
            </ul>
            <p>The actor queried for the sensitive data performs the
            following steps:</p>
            <ul>
            <li>request an Authorization Decision from the Authorization
            Decisions Manager using the information provided with the
            query payload and the X-User Assertion</li>
            <li>enforce the Authorization Decision returning only the
            data the healthcare professional is authorized for.</li>
            </ul>
            <h5 id="394222-query-type-extension-process-flow">39.4.2.2.2
            Query Type Extension Process Flow</h5>
            <p><img src="assets/images/uc2-flow.png"
            alt="Figure 39.4.2.2.2-1: Query Type Extension Process Flow" />
            <strong>Figure 39.4.2.2.2-1: Process Flow of the use case
            with query type extension</strong> <em>Note: Actors profiled
            in this supplement are yellow boxed and transactions
            profiled are drawn as solid lines.The source code for the
            UML diagram is available <a
            href="https://github.com/IHE/ITI.SeR/blob/main/assets/plantuml/uc2-flow.plantuml">here</a>.</em></p>
            <h4 id="39423-use-case-3-mobile-health-use-case">39.4.2.3
            Use Case #3: Mobile Health Use Case</h4>
            <p>This use case describes how an <a
            href="https://profiles.ihe.net/ITI/MHD/index.html">MHD
            Document Responder</a> uses Authorization Decisions made by
            the Authorization Decisions Manager.</p>
            <p>To protect the sensitive information against malicious
            misuse the MHD Document Responder is grouped with the
            Authorization Decisions Verifier and performs an
            Authorization Decisions Query [ITI-79] messages whenever a
            MHD Document Consumer queries for the sensitive data to
            disclose the data based on the Access Decision.</p>
            <p>In this use case, the IUA Option is used, i.e., the <a
            href="https://profiles.ihe.net/ITI/MHD/index.html">MHD
            Document Consumer</a> actor is grouped with <a
            href="https://profiles.ihe.net/ITI/IUA/index.html">IUA
            Authorization Client</a> actor and uses the data provided by
            the <a
            href="https://profiles.ihe.net/ITI/IUA/index.html">IUA
            Authorization Server</a> which identifies the Requester
            Entity and further information required for Authorization
            Decisions (user role, user institution, etc.).</p>
            <p>In addition, the <a
            href="https://profiles.ihe.net/ITI/MHD/index.html">MHD
            Document Responder</a> is grouped with the <a
            href="https://profiles.ihe.net/ITI/IUA/index.html">IUA
            Resource Server</a> to support the <a
            href="https://profiles.ihe.net/ITI/IUA/index.html#372-incorporate-access-token-iti-72">Incorporate
            Access Token</a> [ITI-72] transaction.</p>
            <h5
            id="394231-mobile-health-use-case-description">39.4.2.3.1
            Mobile Health Use Case Description</h5>
            <p>In this use case Dr. Brown uses the new mHealth
            infrastructure provides by his hospital.</p>
            <p>Dr. Brown uses her tablet to query the laboratory reports
            of her patient Mr. White. The hospitals mHealth app has
            previously been registered and authorized by the hospital IT
            authorizing the mHealth app to perform the transactions
            defined in the MHD Profile.</p>
            <p>The mHealth infrastructure enforces Authorization
            Decisions in the background and discloses the laboratory
            reports depending on the access policies of the hospital
            (e.g., identity and role of Dr. Brown, employment state,
            etc.).</p>
            <h5
            id="394232-mobile-health-use-case-process-flow">39.4.2.3.2
            Mobile Health Use Case Process Flow</h5>
            <p><img src="assets/images/uc3-flow.png"
            alt="Figure 39.4.2.3.2-1: Mobile Health Process Flow" />
            <strong>Figure 39.4.2.3.2-1: Process Flow of the mhealth use
            case.</strong> <em>Note: Actors profiled in this supplement
            are yellow boxed and transactions profiled are drawn as
            solid lines. The source code for the UML diagram is
            available <a
            href="https://github.com/IHE/ITI.SeR/blob/main/assets/plantuml/uc3-flow.plantuml">here</a>.</em></p>
            <h2 id="395-ser-security-considerations">39.5 SeR Security
            Considerations</h2>
            <p>To prevent interaction with malicious third parties, a
            closed system of trust based on TLS digital identities is
            strongly recommended. Authorization Decisions Manager should
            accept queries only from a restricted set of Secure
            Nodes/Applications. The Authorization Decisions Verifier
            should perform queries only to the domain-identified
            Authorization Decisions Manager.</p>
            <p>Authorization Decisions my be collected by the
            Authorization Decisions Manager. These Authorization
            Decisions should not be exposed to other systems and
            encryption may be used (when stored by the Authorization
            Decisions Manager) to avoid the disclosure of sensitive
            information.</p>
            <p>The centralized Access Control system introduces a single
            point-of-failure risk in a Community. A failure of the
            Authorization Decisions Manager could result in legitimate
            access being denied.</p>
            <p>This profile introduces an XDS Error Code in order to
            codify an additional reason for document retrieve failure.
            See <a
            href="https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.4.1">ITI
            TF-3: Table 4.2.4.1-2</a>.</p>
            <p>Adding more technical details within the failure response
            may be used to refine malicious requests. For example, if
            the error created by the Authorization Decisions Verifier
            conveys the reason of the failure, such as "the
            authorization is expired" or "the authorization is released
            in a different Functional Context," it may provide
            information to a malicious Document Consumer that can then
            try to refine subsequent requests. This profile supports to
            hide the Authorization Decisions to the Requester Entity. In
            this case, the aforementioned error code shall not be
            used.</p>
            <h2 id="396-ser-cross-profile-considerations">39.6 SeR Cross
            Profile Considerations</h2>
            <p>XDS Document Consumer that participates in an XDS
            environment using SeR framework shall be grouped with an <a
            href="https://profiles.ihe.net/ITI/TF/Volume1/ch-13.html">XUA
            X-Service User</a>.</p>
            <p><a
            href="https://profiles.ihe.net/ITI/TF/Volume1/ch-13.html">XUA
            X-Service User</a> involved in a SeR framework shall be able
            to identify the specific Requester Entity conveying its
            logical identity (user ID, application ID, etc.) within the
            <code>&lt;Subject&gt;/&lt;NameID&gt;</code> element.</p>
            <h1 id="volume-2---transactions">Volume 2 -
            Transactions</h1>
            <table>
            <thead>
            <tr class="header">
            <th><strong>Editor: Please add the following Section 3.79 to
            Volume 2</strong></th>
            </tr>
            </thead>
            <tbody>
            </tbody>
            </table>
            <h2 id="379-authorization-decisions-query-iti-79">3.79
            Authorization Decisions Query [ITI-79]</h2>
            <h3 id="3791-scope">3.79.1 Scope</h3>
            <p>This transaction is used by the Authorization Decisions
            Verifier to query for Authorization Decisions, granted and
            managed by the Authorization Decisions Manager. These
            Authorization Decisions are created to disclose specific
            clinical data.</p>
            <p>The information required to perform Authorization
            Decisions shall be conveyed with the Authorization Decisions
            Query [ITI-79] request, i.e., the identifier of the
            Requester Entity and other attributes required for a given
            use case.</p>
            <p>This transaction is based on SOAP v1.2 exchange protocol
            and Synchronous Web services (see <a
            href="https://profiles.ihe.net/ITI/TF/Volume2/ch-V.html">ITI
            TF-2: Appendix V</a>).</p>
            <h3 id="3792-actor-roles">3.79.2 Actor Roles</h3>
            <table>
            <thead>
            <tr class="header">
            <th>Actor</th>
            <th>Role</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td>Authorization Decisions Manager</td>
            <td>This actor manages Authorization Decisions granted for a
            Requester Entity and for specific clinical data.</td>
            </tr>
            <tr class="even">
            <td>Authorization Decisions Verifier</td>
            <td>This actor queries for Authorization Decisions based on
            the Requester Entity and requested clinical data.</td>
            </tr>
            </tbody>
            </table>
            <h3 id="3793-referenced-standards">3.79.3 Referenced
            Standards</h3>
            <ul>
            <li>OASIS SOAP v1.2</li>
            <li>OASIS Security Assertion Markup Language (SAML)
            v2.0</li>
            <li>OASIS eXtensible Access Control Markup Language (XACML)
            v2.0</li>
            <li>OASIS Multiple resource profile of XACML v2.0</li>
            <li>OASIS SAML 2.0 profile for XACML v2.0</li>
            <li>OASIS Cross-Enterprise Security and Privacy
            Authorization (XSPA) Profile of SAML v2.0 for Healthcare
            Version 2.0 (not normative)</li>
            </ul>
            <h3 id="3794-messages">3.79.4 Messages</h3>
            <p><img src="assets/images/Interaction_Diagram.png"
            alt="Figure 3.79.4-1: Interaction Diagram" /> <strong>Figure
            3.79.4-1: Interaction Diagram</strong></p>
            <h4
            id="37941-xacmlauthorizationdecisionquery-request">3.79.4.1
            XACMLAuthorizationDecisionQuery Request</h4>
            <p>This message shall be used by the Authorization Decisions
            Verifier to query the Authorization Decisions Manager for
            Access Decisions. This message relies on the SAML v2.0
            extension for XACML and uses the element
            <code>&lt;XACMLAuthzDecisionQuery&gt;</code> to convey the
            subject identifier and other query parameters. The request
            message complies with the multiple resource profile of XACML
            v2.0 and the Authorization Decisions Verifier may query
            Authorization Decisions for many clinical data items in one
            query. Attributes of XUA or IUA assertions (depending from
            the supported option) shall be mapped into xacml-context
            attribute elements as defined in SAML 2.0 Profile of XACML
            v2.0 (Section 2).</p>
            <h5 id="379411-trigger-events">3.79.4.1.1 Trigger
            Events</h5>
            <p>Actors grouped with a Authorization Decisions Verifier
            triggers the XACMLAuthorizationDecisionQuery Request when a
            Requester Entity requests clinical data items (e.g., a
            Retrieve Document Set Request message) which require
            authorization.</p>
            <h5 id="379412-message-semantics">3.79.4.1.2 Message
            Semantics</h5>
            <p>The XACMLAuthorizationDecisionQuery Request message shall
            use SOAP v1.2 message encoding.</p>
            <p>The WS-Addressing Action header shall have this
            value:</p>
            <ul>
            <li><code>urn:ihe:iti:2014:ser:XACMLAuthorizationDecisionQueryRequest</code></li>
            </ul>
            <p>The body of the message shall use an
            <code>&lt;XACMLAuthzDecisionQuery&gt;</code> element
            (defined in the SAML 2.0 Profile for XACML v2.0) to convey
            Authorization Query parameters.</p>
            <p>This element shall contain the following attribute:</p>
            <ul>
            <li><code>@ReturnContext</code>: shall be set to "false"
            because the content of the XACMLAuthorizationDecision
            Request is not needed within the Authorization Result.</li>
            </ul>
            <p>IHE does not define constraints for other attributes (see
            OASIS SAML 2.0 Profile of XACML Version 2.0 Section 4 for
            details).</p>
            <p>The <code>&lt;XACMLAuthzDecisionQuery&gt;</code> element
            shall have only one child element
            <code>&lt;Request&gt;</code>. This element shall comply with
            OASIS Multiple resource profile of XACML v2.0. This element
            shall have the following child elements:</p>
            <ul>
            <li>Exactly one child element <code>&lt;Subject&gt;</code>
            that identifies the Requester Entity.</li>
            <li>One or more elements <code>&lt;Resource&gt;</code> that
            identify particular clinical data items or classes of
            clinical data items.</li>
            <li>Exactly one element <code>&lt;Action&gt;</code> that
            identifies the action the Authorization Decisions Manager
            has to authorize.</li>
            <li>Exactly one element <code>&lt;Environment&gt;</code>
            that identifies run-time properties of the execution
            context.</li>
            </ul>
            <p>Particular assignment of attributes on these elements
            depends on the query type, as described in the next
            sub-section.</p>
            <h6
            id="3794121-query-types-and-request-attribute-assignments">3.79.4.1.2.1
            Query Types and Request Attribute Assignments</h6>
            <p>Currently, there is only one standard query type:
            "Retrieve Document Set Authorization Decision". Additional
            query types may be defined on vendor, community, regulatory
            domain, or national level.</p>
            <h6
            id="37941211-retrieve-document-set-authorization-decision-request-attributes">3.79.4.1.2.1.1
            Retrieve Document Set Authorization Decision Request
            Attributes</h6>
            <p>The SeR query type "Retrieve Document Set Authorization
            Decision" mandates the usage of the XUA Option and requires
            the following assignment of request attributes:</p>
            <ul>
            <li><p>The <code>&lt;Subject&gt;</code> element shall have
            at least one child element <code>&lt;Attribute&gt;</code>
            characterized by
            <code>@AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id"</code>
            and
            <code>@DataType="http://www.w3.org/2001/XMLSchema#string"</code>.
            The <code>&lt;AttributeValue&gt;</code> child element shall
            convey the subject identifier. This element shall have the
            same value of the
            <code>&lt;Subject&gt;/&lt;NameID&gt;</code> element conveyed
            within the SAML assertion. See the <a
            href="https://profiles.ihe.net/ITI/TF/Volume2/ITI-40.html">Provide
            X-User Assertion</a> [ITI-40] transaction for details. Any
            other SAML attribute related to the subject shall be added
            as additional XACML attribute. Table 3.79.4.1.2-1 defines
            which XUA attributes are identified as related to the
            subject (each attribute with "XACML Category" equal to
            <code>urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</code>).</p></li>
            <li><p>There is one <code>&lt;Resource&gt;</code> element
            for each document requested by the Requester Entity. In the
            XDS environment, a <code>&lt;Resource&gt;</code> element
            identifies a document. Each document is identified by two
            required <code>&lt;Attribute&gt;</code> child elements.</p>
            <ul>
            <li>The first <code>&lt;Attribute&gt;</code> element shall
            have
            <code>@AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"</code>
            and
            <code>@DataType="http://www.w3.org/2001/XMLSchema#string"</code>.
            The <code>&lt;AttributeValue&gt;</code> child element stores
            the value of the XDSDocumentEntry.uniqueId.</li>
            <li>The second <code>&lt;Attribute&gt;</code> element shall
            have
            <code>@AttributeId="urn:ihe:iti:ser:2016:document-entry:repository-unique-id"</code>
            and
            <code>@DataType="http://www.w3.org/2001/XMLSchema#anyURI"</code>.
            The <code>&lt;AttributeValue&gt;</code> child element stores
            the value of the XDSDocumentEntry.repositoryUniqueId.</li>
            </ul></li>
            </ul>
            <p>Any other SAML attribute related to the clinical data
            requested shall be added as additional XACML attribute
            (e.g., homeCommunityId). Table 3.79.4.1.2-1 defines which
            XUA attributes are identified as related to the clinical
            data (each attribute with "XACML Category" equal to
            <code>urn:oasis:names:tc:xacml:1.0:resource</code>).</p>
            <p>Attributes that belong to the XACML environment category
            (e.g., XUA attributes with "XACML Category" equal to
            <code>urn:oasis:names:tc:xacml:1.0:environment</code> in
            Table 3.79.4.1.2-1) shall be added to an
            <code>&lt;Environment&gt;</code> element.</p>
            <p>The <code>&lt;Action&gt;</code> element shall have a
            child element <code>&lt;Attribute&gt;</code> with
            <code>@AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id"</code>
            and
            <code>@DataType="http://www.w3.org/2001/XMLSchema#anyURI"</code>.
            This attribute shall have a child element
            <code>&lt;AttributeValue&gt;</code> characterized by value:
            <code>urn:ihe:iti:2007:RetrieveDocumentSetResponse</code>.</p>
            <p>Additional attributes that belong to the XACML action
            category (e.g., XUA attributes with "XACML Category" equal
            to <code>urn:oasis:names:tc:xacml:1.0:action</code> in Table
            3.79.4.1.2-1) shall be added to an
            <code>&lt;Action&gt;</code> element.</p>
            <p>The mapping of attributes from SAML v2.0 assertion
            defined in the <a
            href="https://profiles.ihe.net/ITI/TF/Volume2/ITI-40.html">Provide
            X-User Assertion</a> [ITI-40] transaction into XACML query
            attributes is defined below. For each attribute from
            [ITI-40], the XACML Category and @AttributeId are
            identified:</p>
            <p><strong>Table 3.79.4.1.2-1: [ITI-40] Attributes mapping
            into XACML Query Attributes</strong></p>
            <table>
            <thead>
            <tr class="header">
            <th>[ITI-40] Attribute</th>
            <th>XACML Category</th>
            <th>AttributeId</th>
            <th>DataType</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td>Subject ID</td>
            <td>urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</td>
            <td>urn:oasis:names:tc:xacml:1.0:subject:subject-id</td>
            <td><a
            href="http://www.w3.org/2001/XMLSchema#string">http://www.w3.org/2001/XMLSchema#string</a></td>
            </tr>
            <tr class="even">
            <td>Subject Organization</td>
            <td>urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</td>
            <td>urn:oasis:names:tc:xspa:1.0:subject:organization</td>
            <td><a
            href="http://www.w3.org/2001/XMLSchema#string">http://www.w3.org/2001/XMLSchema#string</a></td>
            </tr>
            <tr class="odd">
            <td>Subject Organization ID</td>
            <td>urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</td>
            <td>urn:oasis:names:tc:xspa:1.0:subject:organization-id</td>
            <td><a
            href="http://www.w3.org/2001/XMLSchema#anyURI">http://www.w3.org/2001/XMLSchema#anyURI</a></td>
            </tr>
            <tr class="even">
            <td>Home Community ID (Note 1)</td>
            <td>urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</td>
            <td>urn:ihe:iti:xca:2010:homeCommunityId</td>
            <td><a
            href="http://www.w3.org/2001/XMLSchema#anyURI">http://www.w3.org/2001/XMLSchema#anyURI</a></td>
            </tr>
            <tr class="odd">
            <td>National Provider Identifier (NPI)</td>
            <td>urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</td>
            <td>urn:oasis:names:tc:xspa:1.0:subject:npi</td>
            <td><a
            href="http://www.w3.org/2001/XMLSchema#string">http://www.w3.org/2001/XMLSchema#string</a></td>
            </tr>
            <tr class="even">
            <td>Subject Role</td>
            <td>urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</td>
            <td>urn:oasis:names:tc:xacml:2.0:subject:role</td>
            <td><a
            href="http://www.w3.org/2001/XMLSchema#anyURI">http://www.w3.org/2001/XMLSchema#anyURI</a></td>
            </tr>
            <tr class="odd">
            <td>Authz-Consent</td>
            <td>urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</td>
            <td>urn:ihe:iti:bppc:2007:docid</td>
            <td><a
            href="http://www.w3.org/2001/XMLSchema#anyURI">http://www.w3.org/2001/XMLSchema#anyURI</a></td>
            </tr>
            <tr class="even">
            <td>Patient Identifier</td>
            <td>urn:oasis:names:tc:xacml:1.0:resource</td>
            <td>urn:ihe:iti:ser:2016:patient-id</td>
            <td><a
            href="http://www.w3.org/2001/XMLSchema#string">http://www.w3.org/2001/XMLSchema#string</a></td>
            </tr>
            <tr class="odd">
            <td>PurposeOfUse</td>
            <td>urn:oasis:names:tc:xacml:1.0:subject-category:access-subject</td>
            <td>urn:oasis:names:tc:xspa:1.0:subject:purposeofuse</td>
            <td><a
            href="http://www.w3.org/2001/XMLSchema#anyURI">http://www.w3.org/2001/XMLSchema#anyURI</a></td>
            </tr>
            </tbody>
            </table>
            <p><em>Note 1: To enable Authorization Decisions for this
            [ITI-79] transaction, Home Community Id identifies the
            requesting user's community identity as identified in the
            SAML header in [ITI-40]. In other words, it is not the
            homeCommunityId of the community where the requested
            document resides.</em></p>
            <p>Any SAML 2.0 Attribute codified using the HL7 CD or CE
            dataType shall be codified into a XACML Attribute using the
            percentage urn encoding and DataType <a
            href="http://www.w3.org/2001/XMLSchema#anyURI">http://www.w3.org/2001/XMLSchema#anyURI</a>
            as defined below:</p>
            <p><code>"urn:ihe:iti:2014:ser:[codeSystem]:[codeSystemName]:[code]:[displayName]"</code></p>
            <p>For example:</p>
            <div class="sourceCode" id="cb1"><pre
            class="sourceCode xml"><code class="sourceCode xml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">saml:Attribute</span><span class="ot"> NameFormat=</span><span class="st">&quot;urn:oasis:names:tc:SAML:2.0:attrname-format:uri&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ot">                Name=</span><span class="st">&quot; urn:oasis:names:tc:xacml:2.0:action:purpose&quot;</span>&gt;</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">saml:AttributeValue</span>&gt;</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">value</span><span class="ot"> xmlns=</span><span class="st">&quot;urn:hl7-org:v3&quot;</span><span class="ot"> xsi:type=</span><span class="st">&quot;CD&quot;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="ot">               code=</span><span class="st">&quot;RECORDMGT&quot;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="ot">               displayName=</span><span class="st">&quot;records management&quot;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="ot">               codeSystem=</span><span class="st">&quot;2.16.840.1.113883.1.11.20448&quot;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="ot">               codeSystemName=</span><span class="st">&quot;Purpose of Use&quot;</span>/&gt;</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">saml:AttributeValue</span>&gt;</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">saml:Attribute</span>&gt;</span></code></pre></div>
            <p>shall be codified in a urn:</p>
            <div class="sourceCode" id="cb2"><pre
            class="sourceCode xml"><code class="sourceCode xml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">Attribute</span><span class="ot"> AttributeId=</span><span class="st">&quot;urn:oasis:names:tc:xspa:1.0:subject:purposeofuse&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ot">           DataType=</span><span class="st">&quot;http://www.w3.org/2001/XMLSchema#anyURI&quot;</span>&gt;</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">AttributeValue</span>&gt;</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        urn:ihe:iti:2014:ser:2.16.840.1.113883.1.11.20448:Purpose%20Of%20Use:RECORDMGT:records%20management</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">AttributeValue</span>&gt;</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">Attribute</span>&gt;</span></code></pre></div>
            <p>Additional SAML 2.0 <code>&lt;Attribute&gt;</code>
            elements useful as authorization query parameters may be
            identified by domain policies. Any additional
            <code>&lt;Attribute&gt;</code> can be provided to the
            Authorization Decisions Verifier using a SAML v2.0
            assertion. OASIS SAML 2.0 Profile of XACML Version 2.0,
            Section 2 provides guidance in mapping SAML attributes into
            XACML attributes. Domain Policies should define to which
            XACML category (Subject, Resource, Action or Environment)
            each additional Attribute belongs.</p>
            <h6
            id="379412111-example-of-a-soap-v12-xacmlauthorizationdecisionquery-request-message">3.79.4.1.2.1.1.1
            Example of a SOAP v1.2 XACMLAuthorizationDecisionQuery
            Request message</h6>
            <div class="sourceCode" id="cb3"><pre
            class="sourceCode xml"><code class="sourceCode xml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">&lt;?xml</span><span class="ot"> version=</span><span class="st">&quot;1.0&quot;</span><span class="ot"> encoding=</span><span class="st">&quot;UTF-8&quot;</span><span class="fu">?&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">soap:Envelope</span><span class="ot"> xsi:schemaLocation=</span><span class="st">&quot;http://www.w3.org/2003/05/soap-envelope soap-envelope.xsd&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="ot">               xmlns:soap=</span><span class="st">&quot;http://www.w3.org/2003/05/soap-envelope&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="ot">               xmlns:xsi=</span><span class="st">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="ot">               xmlns:xacml-saml=</span><span class="st">&quot;urn:oasis:xacml:2.0:saml:assertion:schema:os&quot;</span>&gt;</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">soap:Header</span><span class="ot"> xsi:schemaLocation=</span><span class="st">&quot;http://www.w3.org/2005/08/addressing ws-addr.xsd&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="ot">                 xmlns:wsa=</span><span class="st">&quot;http://www.w3.org/2005/08/addressing&quot;</span>&gt;</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">wsa:Action</span>&gt;urn:ihe:iti:2014:ser:XACMLAuthorizationDecisionQueryRequest&lt;/<span class="kw">wsa:Action</span>&gt;</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">wsa:MessageID</span>&gt;urn:uuid:9376254e-da05-41f5-9af3-ac56d63d8ebd&lt;/<span class="kw">wsa:MessageID</span>&gt;</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">wsa:To</span>&gt;https://AuthorizationDecisionsManager&lt;/<span class="kw">wsa:To</span>&gt;</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">soap:Header</span>&gt;</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">soap:Body</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="ot">            xsi:schemaLocation=</span><span class="st">&quot;urn:oasis:xacml:2.0:saml:assertion:schema:os access_control-xacml-2.0-saml-assertion-schema-os.xsd&quot;</span>&gt;</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">xacml-samlp:XACMLAuthzDecisionQuery</span><span class="ot"> xmlns:xacml-samlp=</span><span class="st">&quot;urn:oasis:xacml:2.0:saml:protocol:schema:os&quot;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="ot">                                             xacml-samlp:InputContextOnly=</span><span class="st">&quot;false&quot;</span><span class="ot"> xacml-samlp:ReturnContext=</span><span class="st">&quot;false&quot;</span>&gt;</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">Request</span><span class="ot"> xmlns=</span><span class="st">&quot;urn:oasis:names:tc:xacml:2.0:context:schema:os&quot;</span>&gt; <span class="co">&lt;!-- Requester Entity identifier --&gt;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">Subject</span>&gt;</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                    &lt;<span class="kw">Attribute</span><span class="ot"> AttributeId=</span><span class="st">&quot;urn:oasis:names:tc:xacml:1.0:subject:subject-id&quot;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="ot">                               DataType=</span><span class="st">&quot;http://www.w3.org/2001/XMLSchema#string&quot;</span>&gt;</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">AttributeValue</span>&gt;admin&lt;/<span class="kw">AttributeValue</span>&gt;</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                    &lt;/<span class="kw">Attribute</span>&gt;</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">Subject</span>&gt; <span class="co">&lt;!-- DOC 1 --&gt;</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">Resource</span>&gt;</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                    &lt;<span class="kw">Attribute</span><span class="ot"> AttributeId=</span><span class="st">&quot;urn:oasis:names:tc:xacml:1.0:resource:resource-id&quot;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="ot">                               DataType=</span><span class="st">&quot;http://www.w3.org/2001/XMLSchema#string&quot;</span>&gt;</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">AttributeValue</span>&gt;documentID1&lt;/<span class="kw">AttributeValue</span>&gt;</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                    &lt;/<span class="kw">Attribute</span>&gt;</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>                    &lt;<span class="kw">Attribute</span><span class="ot"> AttributeId=</span><span class="st">&quot;urn:ihe:iti:ser:2016:document-entry:repository-unique-id&quot;</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="ot">                               DataType=</span><span class="st">&quot;http://www.w3.org/2001/XMLSchema#anyURI&quot;</span>&gt;</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">AttributeValue</span>&gt;urn:oid:1.2.3.4.5</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                        &lt;/<span class="kw">AttributeValue</span>&gt;</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>                    &lt;/<span class="kw">Attribute</span>&gt;</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">Resource</span>&gt; <span class="co">&lt;!-- DOC 2 --&gt;</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">Resource</span>&gt;</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>                    &lt;<span class="kw">Attribute</span><span class="ot"> AttributeId=</span><span class="st">&quot;urn:oasis:names:tc:xacml:1.0:resource:resource-id&quot;</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="ot">                               DataType=</span><span class="st">&quot;http://www.w3.org/2001/XMLSchema#string&quot;</span>&gt;</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">AttributeValue</span>&gt;documentID2&lt;/<span class="kw">AttributeValue</span>&gt;</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>                    &lt;/<span class="kw">Attribute</span>&gt;</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>                    &lt;<span class="kw">Attribute</span><span class="ot"> AttributeId=</span><span class="st">&quot;urn:ihe:iti:ser:2016:document-entry:repository-unique-id&quot;</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="ot">                               DataType=</span><span class="st">&quot;http://www.w3.org/2001/XMLSchema#anyURI&quot;</span>&gt;</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">AttributeValue</span>&gt;urn:oid:1.2.3.4.5&lt;/<span class="kw">AttributeValue</span>&gt;</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>                    &lt;/<span class="kw">Attribute</span>&gt;</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">Resource</span>&gt; <span class="co">&lt;!-- DOC 3 --&gt;</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">Resource</span>&gt;</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>                    &lt;<span class="kw">Attribute</span><span class="ot"> AttributeId=</span><span class="st">&quot;urn:oasis:names:tc:xacml:1.0:resource:resource-id&quot;</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="ot">                               DataType=</span><span class="st">&quot;http://www.w3.org/2001/XMLSchema#string&quot;</span>&gt;</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">AttributeValue</span>&gt;documentID3&lt;/<span class="kw">AttributeValue</span>&gt;</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>                    &lt;/<span class="kw">Attribute</span>&gt;</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>                    &lt;<span class="kw">Attribute</span><span class="ot"> AttributeId=</span><span class="st">&quot;urn:ihe:iti:ser:2016:document-entry:repository-unique-id&quot;</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="ot">                               DataType=</span><span class="st">&quot;http://www.w3.org/2001/XMLSchema#anyURI&quot;</span>&gt;</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">AttributeValue</span>&gt;urn:oid:1.2.3.4.5</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>                        &lt;/<span class="kw">AttributeValue</span>&gt;</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>                    &lt;/<span class="kw">Attribute</span>&gt;</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">Resource</span>&gt;</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">Action</span>&gt;</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>                    &lt;<span class="kw">Attribute</span><span class="ot"> AttributeId=</span><span class="st">&quot;urn:oasis:names:tc:xacml:1.0:action-id&quot;</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="ot">                               DataType=</span><span class="st">&quot;http://www.w3.org/2001/XMLSchema#anyURI&quot;</span>&gt;</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">AttributeValue</span>&gt;urn:ihe:iti:2007:RetrieveDocumentSetResponse&lt;/<span class="kw">AttributeValue</span>&gt;</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>                    &lt;/<span class="kw">Attribute</span>&gt;</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">Action</span>&gt;</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">Environment</span>/&gt;</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">Request</span>&gt;</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">xacml-samlp:XACMLAuthzDecisionQuery</span>&gt;</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">soap:Body</span>&gt;</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">soap:Envelope</span>&gt;</span></code></pre></div>
            <h5 id="379413-expected-actions">3.79.4.1.3 Expected
            Actions</h5>
            <p>When the Authorization Decisions Manager receives an
            XACMLAuthorizationDecisionQuery Request message, it
            evaluates each Authorization Request conveyed within the
            XACMLAuthorizationDecision (one for each
            <code>&lt;Resource&gt;</code> element).</p>
            <p>The Authorization Decisions Manager shall produce a
            XACMLAuthorizationDecisionQuery Response message that
            conveys the Access Decisions. One Result for each
            <code>&lt;Resource&gt;</code> shall be sent in the response
            message.</p>
            <h6
            id="3794131-retrieve-document-set-authorization-decision-expected-actions">3.79.4.1.3.1
            Retrieve Document Set Authorization Decision Expected
            Actions</h6>
            <p>If the Authorization Decisions Manager supports decision
            caching, then it shall verify the existence of Authorization
            Decisions that match the XACML Query parameters:</p>
            <ul>
            <li>The Requester Entity identified within the
            XACMLAuthorizationDecisionQuery
            (<code>&lt;Subject&gt;/&lt;Attribute&gt;</code> element with
            <code>@AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id"</code>)
            is an entity that has Authorization Decisions already
            granted;</li>
            </ul>
            <p>AND</p>
            <ul>
            <li>Among these authorizations, there is an Authorization
            Decision for each clinical data item identified within the
            XACMLAuthorizationDecisionQuery
            (<code>&lt;Resource&gt;/&lt;Attribute&gt;</code> elements
            with
            <code>@AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id"</code>
            and
            <code>"urn:ihe:iti:xds-b:2007:document-entry:repository-unique-id"</code>).</li>
            </ul>
            <p>If other parameters (such as attributes taken from an
            [ITI-40] identity assertion) are specified within the
            XACMLAuthorizationDecisionQuery Request message and if
            domain policies require the creation of authorizations
            related to these parameters, then the Authorization
            Decisions Manager shall verify the match with these
            additional parameters (e.g., an Authorization Decision is
            created for clinical data item A for entity X acting for
            PurposeOfUse Y, the same entity cannot retrieve the clinical
            data item acting for PurposeOfUse Z).</p>
            <h4
            id="37942-xacmlauthorizationdecisionquery-response">3.79.4.2
            XACMLAuthorizationDecisionQuery Response</h4>
            <p>The XACMLAuthorizationDecisionQuery Response message is
            created by the Authorization Decisions Manager in response
            to the XACMLAuthorizationDecisionQuery Request. This message
            conveys to the Authorization Decisions Verifier the results
            of the evaluation made by the Authorization Decisions
            Manager. For each clinical data item (e.g., a document)
            specified within the Request message, the Authorization
            Decisions Manager provides an Authorization Result that
            shall be used by the Authorization Decisions Verifier to
            determine which of the requested clinical data items to
            return to the client in response to the trigger transaction
            request, in accordance with local policies. This message
            relies on the XACML extension of SAML v2.0 protocol
            standard. Authorization Results are conveyed using an
            XACMLAuthzDecisionStatement.</p>
            <h5 id="379421-trigger-events">3.79.4.2.1 Trigger
            Events</h5>
            <p>This message is created by the Authorization Decisions
            Manager after the evaluation of the XACML
            AuthorizationDecisionQuery Request message. The
            Authorization Decisions Manager identifies Authorization
            Decisions applicable to the requested clinical data items
            and the Requester Entity, and produces a result of the
            evaluation done.</p>
            <h5 id="379422-message-semantics">3.79.4.2.2 Message
            Semantics</h5>
            <p>The XACMLAuthorizationDecisionQuery Response message is
            based on OASIS SAML 2.0 Profile of XACML Version 2.0. That
            profile relies on SAML v2.0 protocol standard. The
            Addressing Action header of the SOAP message shall be:
            <code>urn:ihe:iti:2014:ser:XACMLAuthorizationDecisionQueryResponse</code>.</p>
            <p>The XACMLAuthorizationStatement (defined in the OASIS
            SAML 2.0 Profile of XACML Version 2.0) is conveyed within a
            SAML v2.0 Assertion. The Assertion does not need to be
            signed. The SAML StatusCode of the Response message shall be
            set as defined in Section 4.10 "Element
            <code>&lt;samlp:Response&gt;</code>: XACMLAuthzDecision
            Response" of OASIS SAML 2.0 Profile of XACML v2.0
            (errata).</p>
            <p>The <code>&lt;Issuer&gt;</code> of the Authorization
            Assertion should identify the trusted Authorization
            Decisions Manager (e.g., SOAP endpoint of the Web Service,
            or the home community OID in URN format, depending on local
            policies).</p>
            <p>See Section 3.1 of the OASIS SAML 2.0 Profile of XACML
            Version 2.0 for further details on the message structure. As
            specified in the OASIS Multiple resource profile of XACML
            v2.0, the XACML <code>&lt;Response&gt;</code> element shall
            contain one <code>&lt;Result&gt;</code> element for each
            <code>&lt;Resource&gt;</code> element identified within the
            XACMLAuthorizationDecisionQuery Request message. Each
            <code>&lt;Result&gt;</code> element shall contain a
            <code>@ResourceId</code> attribute that identifies the
            <code>&lt;AttributeValue&gt;</code> value of the related
            resource.</p>
            <p>As defined in the XACML v2.0 standard, there are four
            possible values associated with the
            <code>&lt;Decision&gt;</code>. The Authorization Decisions
            Manager shall associate codes to the result as described
            below:</p>
            <ul>
            <li>Permit: if a valid Authorization Decision exists
            allowing the disclosure of the requested clinical data item
            to the Requester Entity.</li>
            <li>Deny: if no valid Authorization Decisions exist for the
            identified Document/Requester Entity, or if Authorization
            Decision does not allow disclosure of the Document to the
            Requester Entity.</li>
            <li>Indeterminate: if the Authorization Decisions Manager
            cannot discover if Authorization Decisions are granted
            (e.g., internal Errors, or DB unreachable for network
            problems, ...).</li>
            <li>NotApplicable: if access to the requested clinical data
            item is not managed by the Authorization Decisions Manager.
            If the Authorization Decisions Manager cannot determine if
            the Requester Entity can access the clinical data item
            requested.</li>
            </ul>
            <h6
            id="3794221-example-of-a-soap-v12-xacmlauthorizationdecisionquery-response-message">3.79.4.2.2.1
            Example of a SOAP v1.2 XACMLAuthorizationDecisionQuery
            Response message</h6>
            <div class="sourceCode" id="cb4"><pre
            class="sourceCode xml"><code class="sourceCode xml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">&lt;?xml</span><span class="ot"> version=</span><span class="st">&quot;1.0&quot;</span><span class="ot"> encoding=</span><span class="st">&quot;UTF-8&quot;</span><span class="fu">?&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">soap:Envelope</span><span class="ot"> xsi:schemaLocation=</span><span class="st">&quot;http://www.w3.org/2003/05/soap-envelope soap-envelope.xsd&quot;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ot">               xmlns:soap=</span><span class="st">&quot;http://www.w3.org/2003/05/soap-envelope&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="ot">               xmlns:xsi=</span><span class="st">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="ot">               xmlns:xacml-saml=</span><span class="st">&quot;urn:oasis:xacml:2.0:saml:assertion:schema:os&quot;</span>&gt;</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">soap:Header</span><span class="ot"> xsi:schemaLocation=</span><span class="st">&quot;http://www.w3.org/2005/08/addressing ws-addr.xsd&quot;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="ot">                 xmlns:wsa=</span><span class="st">&quot;http://www.w3.org/2005/08/addressing&quot;</span>&gt;</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">wsa:Action</span>&gt;urn:ihe:iti:2014:XACMLAuthorizationDecisionQueryResponse&lt;/<span class="kw">wsa:Action</span>&gt;</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">wsa:RelatesTo</span>&gt;urn:uuid:9376254e-da05-41f5-9af3-ac56d63d8ebd&lt;/<span class="kw">wsa:RelatesTo</span>&gt;</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">wsa:MessageID</span>&gt;urn:uuid:7534324t-mm56-45t5-6tg4-gt56d63g6hym&lt;/<span class="kw">wsa:MessageID</span>&gt;</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">soap:Header</span>&gt;</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">soap:Body</span><span class="ot"> xmlns:samlp=</span><span class="st">&quot;urn:oasis:names:tc:SAML:2.0:protocol&quot;</span><span class="ot"> xmlns:xsi=</span><span class="st">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="ot">               xsi:schemaLocation=</span><span class="st">&quot;urn:oasis:names:tc:SAML:2.0:protocol saml-schema-protocol-2.0.xsd&quot;</span>&gt;</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">samlp:Response</span><span class="ot"> ID=</span><span class="st">&quot;a123456&quot;</span><span class="ot"> Version=</span><span class="st">&quot;2.0&quot;</span><span class="ot"> IssueInstant=</span><span class="st">&quot;2014-04-16T14:53:55Z&quot;</span>&gt;</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">samlp:Status</span>&gt;</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">samlp:StatusCode</span><span class="ot"> Value=</span><span class="st">&quot;urn:oasis:names:tc:SAML:2.0:status:Success&quot;</span>/&gt;</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">samlp:StatusMessage</span>&gt;OK&lt;/<span class="kw">samlp:StatusMessage</span>&gt;</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">samlp:Status</span>&gt;</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">saml:Assertion</span><span class="ot"> xmlns:saml=</span><span class="st">&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot;</span><span class="ot"> Version=</span><span class="st">&quot;2.0&quot;</span><span class="ot"> ID=</span><span class="st">&quot;a9812368&quot;</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="ot">                            IssueInstant=</span><span class="st">&quot;2006-05-31T13:20:00.000&quot;</span>&gt;</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">saml:Issuer</span>&gt;https://XACMLPDP.example.com&lt;/<span class="kw">saml:Issuer</span>&gt;</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">saml:Statement</span><span class="ot"> xsi:type=</span><span class="st">&quot;xacml-saml:XACMLAuthzDecisionStatementType&quot;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="ot">                                xsi:schemaLocation=</span><span class="st">&quot;urn:oasis:xacml:2.0:saml:assertion:schema:os access_control-xacml-2.0-saml-assertion-schema-os.xsd&quot;</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="ot">                                xmlns:xacml-saml=</span><span class="st">&quot;urn:oasis:xacml:2.0:saml:assertion:schema:os&quot;</span>&gt;</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>                    &lt;<span class="kw">Response</span><span class="ot"> xmlns=</span><span class="st">&quot;urn:oasis:names:tc:xacml:2.0:context:schema:os&quot;</span>&gt;</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">Result</span><span class="ot"> ResourceId=</span><span class="st">&quot;DocumentID1&quot;</span>&gt;</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>                            &lt;<span class="kw">Decision</span>&gt;Deny&lt;/<span class="kw">Decision</span>&gt;</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>                        &lt;/<span class="kw">Result</span>&gt;</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">Result</span><span class="ot"> ResourceId=</span><span class="st">&quot;DocumentID2&quot;</span>&gt;</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>                            &lt;<span class="kw">Decision</span>&gt;Permit&lt;/<span class="kw">Decision</span>&gt;</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>                        &lt;/<span class="kw">Result</span>&gt;</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>                        &lt;<span class="kw">Result</span><span class="ot"> ResourceId=</span><span class="st">&quot;DocumentID3&quot;</span>&gt;</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>                            &lt;<span class="kw">Decision</span>&gt;Permit&lt;/<span class="kw">Decision</span>&gt;</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>                        &lt;/<span class="kw">Result</span>&gt;</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>                    &lt;/<span class="kw">Response</span>&gt;</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>                &lt;/<span class="kw">saml:Statement</span>&gt;</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">saml:Assertion</span>&gt;</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">samlp:Response</span>&gt;</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    &lt;/<span class="kw">soap:Body</span>&gt;</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">soap:Envelope</span>&gt;</span></code></pre></div>
            <h5 id="379423-expected-actions">3.79.4.2.3 Expected
            Actions</h5>
            <p>Expected actions are part of each query type definition,
            because a generalized guidance on the enforcement of
            decisions is impossible due to different semantics of
            transactions which can be combined with [ITI-79],
            possibility of partial success vs. requirement of strong
            atomicity, potential dependencies between clinical data
            items ("if the decision is Permit for item X and Deny for
            item Y, then..."), potential presence of local policies and
            other "environmental" factors, etc.</p>
            <p>This section describes expected actions of the standard
            SeR query types.</p>
            <h6
            id="3794231-retrieve-document-set-authorization-decision-expected-actions">3.79.4.2.3.1
            Retrieve Document Set Authorization Decision Expected
            Actions</h6>
            <p>When the Authorization Decisions Verifier receives a
            XACMLAuthorizationDecisionQuery Response, the XDS Document
            Repository shall enforce the decision results according to
            local policy.</p>
            <p>If a Deny decision is returned, the XDS Document
            Repository shall not disclose the document, unless local
            policies allow it.</p>
            <p>If a Permit decision is returned, the XDS Document
            Repository shall disclose the document, unless additional
            local decisions are applied.</p>
            <p>If NotApplicable or Indeterminate decisions are returned,
            local policies determine what action is appropriate for the
            XDS Document Repository to perform.</p>
            <p>If one or more of the requested documents are not
            authorized, then the Document Repository shall send a status
            <code>urn:ihe:iti:2007:ResponseStatusType:PartialSuccess</code>
            in the Retrieve Document Set Response message (see <a
            href="https://profiles.ihe.net/ITI/TF/Volume2/ITI-43.html#3.43.5">ITI
            TF-2: 3.43.5</a>).</p>
            <p>If all the requested documents are not authorized, then
            the Document Repository shall send a status
            <code>urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Failure</code>
            in the Retrieve Document Set Response message (see <a
            href="https://profiles.ihe.net/ITI/TF/Volume2/ITI-43.html#3.43.5">ITI
            TF-2: 3.43.5</a>).</p>
            <p>The XDS Document Repository shall generate an Error of
            type:</p>
            <ul>
            <li>DocumentAccessNotAuthorized</li>
            </ul>
            <h3 id="3795-security-considerations">3.79.5 Security
            Considerations</h3>
            <p>The Authorization Decisions Query transaction requires
            TLS communication between actors involved.</p>
            <p>This transaction mandates the creation of Authorization
            Decisions associated at least with the Requester Entity and
            with the clinical data item requested. If additional
            parameters need to be associated to the Access Decision,
            these parameters shall be provided within the Authorization
            Decisions Query transaction.</p>
            <h4 id="37951-security-audit-considerations">3.79.5.1
            Security Audit Considerations</h4>
            <p>Actors involved in the Authorization Decisions Query
            transaction are recommended to record the "Query" event
            creating audit messages in accordance to the following
            structure.</p>
            <p>The audit message shall identify:</p>
            <ul>
            <li>The entity that requires authorization</li>
            <li>The clinical data items that have been requested</li>
            <li>The overall result of the Authorization processing</li>
            <li>Human users, if known</li>
            </ul>
            <h5
            id="379511-authorization-decisions-verifier-audit-message">3.79.5.1.1
            Authorization Decisions Verifier audit message</h5>
            <table border="1">
                <tr>
                    <th>Real World Entities</th>
                    <th>Field Name</th>
                    <th>Opt.</th>
                    <th>Value Constraints</th>
                </tr>
                <tr>
                    <td rowspan="5"><center><b>Event</b></center></td>
                    <td>EventId</td>
                    <td>M</td>
                    <td>EV (110112, DCM, "Query")</td>
                </tr>
                <tr>
                    <td>EventActionCode</td>
                    <td>M</td>
                    <td>E = Execute</td>
                </tr>
                <tr>
                    <td><i>EventDateTime</i></td>
                    <td><i>M</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>EventOutcomeIndicator</i></td>
                    <td><i>M</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>EventTypeCode</td>
                    <td>M</td>
                    <td>EV("ITI-79", "IHE Transactions", "Authorization Decisions Query")</td>
                </tr>
                <tr><td colspan="4">Source (Authorization Decisions Verifier) (1)</td></tr>
                <tr><td colspan="4">Human Requestor (0..n)</td></tr>
                <tr><td colspan="4">Destination (Authorization Decisions Verifier) (1)</td></tr>
                <tr><td colspan="4">Query Parameters (1)</td></tr>
                <tr><td colspan="4">Requester Entity (1)</td></tr>
                <tr><td colspan="4">Authorization Result (1)</td></tr>
            </table>

            <table border="1">
                <tr>
                    <td rowspan="7"><center><b>Source:</b><br>AuditMessage/ ActiveParticipant (1)</center></td>
                    <td><i>UserId</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>AlternativeUserID</td>
                    <td>M</td>
                    <td>the process ID as used within the local operating system in the local system of logs</td>
                </tr>
                <tr>
                    <td><i>UserName</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>UserIsRequestor</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>RoleIDCode</td>
                    <td>M</td>
                    <td>EV (110153, DCM, "Source")</td>
                </tr>
                <tr>
                    <td>NetworkAccessPointTypeCode</td>
                    <td>U</td>
                    <td>"1" for machine (DNS) name "2" for IP address</td>
                </tr>
                <tr>
                    <td>NetworkAccessPointID</td>
                    <td>U</td>
                    <td>The machine name or IP address, as specified in DICOM PS 3.15 A.5.3.</td>
                </tr>
            </table>

            <table border="1">
                <tr>
                    <td rowspan="7"><center><b>Human Requestor:</b><br>AuditMessage/ ActiveParticipant (0..n)</center></td>
                    <td>UserId</td>
                    <td>M</td>
                    <td>identity of the human that initiated the transaction</td>
                </tr>
                <tr>
                    <td><i>AlternativeUserID</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>UserName</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>UserIsRequestor</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>RoleIDCode</td>
                    <td>U</td>
                    <td>Access Control role(s) the user holds that allows this transaction</td>
                </tr>
                <tr>
                    <td>NetworkAccessPointTypeCode</td>
                    <td>NA</td>
                    <td></td>
                </tr>
                <tr>
                    <td>NetworkAccessPointID</td>
                    <td>NA</td>
                    <td></td>
                </tr>
            </table>

            <table border="1">
                <tr>
                    <td rowspan="7"><center><b>Destination:</b><br>AuditMessage/ ActiveParticipant (1)</center></td>
                    <td><i>UserId</i></td>
                    <td><i>M</i></td>
                    <td><i>Authorization Decisions Manager SOAP URI</i></td>
                </tr>
                <tr>
                    <td>AlternativeUserID</td>
                    <td>U</td>
                    <td>the process ID as used within the local operating system in the local system of logs</td>
                </tr>
                <tr>
                    <td><i>UserName</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>UserIsRequestor</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>RoleIDCode</td>
                    <td>M</td>
                    <td>EV (110152, DCM, "Destination")</td>
                </tr>
                <tr>
                    <td>NetworkAccessPointTypeCode</td>
                    <td>U</td>
                    <td>"1" for machine (DNS) name "2" for IP address</td>
                </tr>
                <tr>
                    <td>NetworkAccessPointID</td>
                    <td>U</td>
                    <td>The machine name or IP address, as specified in DICOM PS 3.15 A.5.3.</td>
                </tr>
            </table>

            <table border="1">
                <tr>
                    <td rowspan="9"><center><b>Requester Entity:</b><br>AuditMessage/ ParticipantObjectIdentification (1)</center></td>
                    <td>ParticipantObjectTypeCode</td>
                    <td>M</td>
                    <td>"1" (person)</td>
                </tr>
                <tr>
                    <td>ParticipantObjectTypeCodeRole</td>
                    <td>M</td>
                    <td>"11" (security user entity)</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectDataLifeCycle</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>ParticipantObjectIDTypeCode</td>
                    <td>M</td>
                    <td>EV("ITI-79", "IHE Transaction", "Authorization Decisions Query")</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectSensitivity</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>ParticipantObjectID</td>
                    <td>M</td>
                    <td>The Requester Entity who wants to retrieve clinical data (identified in the Attribute with AttributeId urn:oasis:names:tc:xacml:1.0:subject:subject-id)</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectName</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectQuery</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectDetail</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
            </table>

            <table border="1">
                <tr>
                    <td rowspan="9"><center><b>Query Parameters:</b><br>AuditMessage/ ParticipantObjectIdentification (1)</center></td>
                    <td>ParticipantObjectTypeCode</td>
                    <td>M</td>
                    <td>"2" (SYSTEM)</td>
                </tr>
                <tr>
                    <td>ParticipantObjectTypeCodeRole</td>
                    <td>M</td>
                    <td>"24" (query)</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectDataLifeCycle</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>ParticipantObjectIDTypeCode</td>
                    <td>M</td>
                    <td>EV("ITI-79", "IHE Transaction", "Authorization Decisions Query")</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectSensitivity</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectID</i></td>
                    <td><i>M</i></td>
                    <td>Not specialized</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectName</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>ParticipantObjectQuery</td>
                    <td>U</td>
                    <td>The &lt;Request&gt;, base 64 encoded</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectDetail</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
            </table>

            <table border="1">
                <tr>
                    <td rowspan="9"><center><b>Authorization Result:</b><br>AuditMessage/ ParticipantObjectIdentification (1)</center></td>
                    <td>ParticipantObjectTypeCode</td>
                    <td>M</td>
                    <td>"2" (SYSTEM)</td>
                </tr>
                <tr>
                    <td>ParticipantObjectTypeCodeRole</td>
                    <td>M</td>
                    <td>"13" (security resource)</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectDataLifeCycle</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>ParticipantObjectIDTypeCode</td>
                    <td>M</td>
                    <td>EV("ITI-79", "IHE Transaction", "Authorization Decisions Query")</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectSensitivity</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>ParticipantObjectID</td>
                    <td>M</td>
                    <td>Content of StatusCode element (overall result of the authorization)</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectName</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectQuery</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectDetail</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
            </table>

            <h5
            id="379512-authorization-decisions-manager-audit-message">3.79.5.1.2
            Authorization Decisions Manager audit message</h5>
            <table border="1">
                <tr>
                    <th>Real World Entities</th>
                    <th>Field Name</th>
                    <th>Opt.</th>
                    <th>Value Constraints</th>
                </tr>
                <tr>
                    <td rowspan="5"><center><b>Event</b></center></td>
                    <td>EventId</td>
                    <td>M</td>
                    <td>EV (110112, DCM, "Query")</td>
                </tr>
                <tr>
                    <td>EventActionCode</td>
                    <td>M</td>
                    <td>E = Execute</td>
                </tr>
                <tr>
                    <td><i>EventDateTime</i></td>
                    <td><i>M</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>EventOutcomeIndicator</i></td>
                    <td><i>M</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>EventTypeCode</td>
                    <td>M</td>
                    <td>EV("ITI-79", "IHE Transactions", "Authorization Decisions Query")</td>
                </tr>
                <tr><td colspan="4">Source (Authorization Decisions Verifier) (1)</td></tr>
                <tr><td colspan="4">Human Requestor (0..n)</td></tr>
                <tr><td colspan="4">Destination (Authorization Decisions Verifier) (1)</td></tr>
                <tr><td colspan="4">Query Parameters (1)</td></tr>
                <tr><td colspan="4">Requester Entity (1)</td></tr>
                <tr><td colspan="4">Authorization Result (1)</td></tr>
            </table>

            <table border="1">
                <tr>
                    <td rowspan="7"><center><b>Source:</b><br>AuditMessage/ ActiveParticipant</center></td>
                    <td><i>UserId</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>AlternativeUserID</td>
                    <td>M</td>
                    <td>the process ID as used within the local operating system in the local system of logs</td>
                </tr>
                <tr>
                    <td><i>UserName</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>UserIsRequestor</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>RoleIDCode</td>
                    <td>M</td>
                    <td>EV (110153, DCM, "Source")</td>
                </tr>
                <tr>
                    <td>NetworkAccessPointTypeCode</td>
                    <td>U</td>
                    <td>"1" for machine (DNS) name "2" for IP address</td>
                </tr>
                <tr>
                    <td>NetworkAccessPointID</td>
                    <td>U</td>
                    <td>The machine name or IP address, as specified in DICOM PS 3.15 A.5.3.</td>
                </tr>
            </table>

            <table border="1">
                <tr>
                    <td rowspan="7"><center><b>Human Requestor:</b><br>AuditMessage/ ActiveParticipant (0..n)</center></td>
                    <td>UserId</td>
                    <td>M</td>
                    <td>identity of the human that initiated the transaction</td>
                </tr>
                <tr>
                    <td><i>AlternativeUserID</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>UserName</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>UserIsRequestor</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>RoleIDCode</td>
                    <td>U</td>
                    <td>Access Control role(s) the user holds that allows this transaction</td>
                </tr>
                <tr>
                    <td>NetworkAccessPointTypeCode</td>
                    <td>NA</td>
                    <td></td>
                </tr>
                <tr>
                    <td>NetworkAccessPointID</td>
                    <td>NA</td>
                    <td></td>
                </tr>
            </table>

            <table border="1">
                <tr>
                    <td rowspan="7"><center><b>Destination:</b><br>AuditMessage/ ActiveParticipant (1)</center></td>
                    <td><i>UserId</i></td>
                    <td><i>M</i></td>
                    <td><i>Authorization Decisions Manager SOAP URI</i></td>
                </tr>
                <tr>
                    <td>AlternativeUserID</td>
                    <td>U</td>
                    <td>the process ID as used within the local operating system in the local system of logs</td>
                </tr>
                <tr>
                    <td><i>UserName</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>UserIsRequestor</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>RoleIDCode</td>
                    <td>M</td>
                    <td>EV (110152, DCM, "Destination")</td>
                </tr>
                <tr>
                    <td>NetworkAccessPointTypeCode</td>
                    <td>U</td>
                    <td>"1" for machine (DNS) name "2" for IP address</td>
                </tr>
                <tr>
                    <td>NetworkAccessPointID</td>
                    <td>U</td>
                    <td>The machine name or IP address, as specified in DICOM PS 3.15 A.5.3.</td>
                </tr>
            </table>

            <table border="1">
                <tr>
                    <td rowspan="9"><center><b>Requester Entity:</b><br>AuditMessage/ ParticipantObjectIdentification (1)</center></td>
                    <td>ParticipantObjectTypeCode</td>
                    <td>M</td>
                    <td>"1" (person)</td>
                </tr>
                <tr>
                    <td>ParticipantObjectTypeCodeRole</td>
                    <td>M</td>
                    <td>"11" (security user entity)</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectDataLifeCycle</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>ParticipantObjectIDTypeCode</td>
                    <td>M</td>
                    <td>EV("ITI-79", "IHE Transaction", "Authorization Decisions Query")</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectSensitivity</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>ParticipantObjectID</td>
                    <td>M</td>
                    <td>The person who wants to create retrieve clinical data (identified in the Attribute with AttributeId urn:oasis:names:tc:xacml:1.0:subject:subject-id)</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectName</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectQuery</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectDetail</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
            </table>

            <table border="1">
                <tr>
                    <td rowspan="9"><center><b>Query Parameters:</b><br>AuditMessage/ ParticipantObjectIdentification (1)</center></td>
                    <td>ParticipantObjectTypeCode</td>
                    <td>M</td>
                    <td>"2" (SYSTEM)</td>
                </tr>
                <tr>
                    <td>ParticipantObjectTypeCodeRole</td>
                    <td>M</td>
                    <td>"24" (query)</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectDataLifeCycle</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>ParticipantObjectIDTypeCode</td>
                    <td>M</td>
                    <td>EV("ITI-79", "IHE Transaction", "Authorization Decisions Query")</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectSensitivity</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectID</i></td>
                    <td><i>M</i></td>
                    <td>Not specialized</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectName</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>ParticipantObjectQuery</td>
                    <td>U</td>
                    <td>The &lt;Request&gt;, base 64 encoded</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectDetail</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
            </table>

            <table border="1">
                <tr>
                    <td rowspan="9"><center><b>Authorization Result:</b><br>AuditMessage/ ParticipantObjectIdentification (1)</center></td>
                    <td>ParticipantObjectTypeCode</td>
                    <td>M</td>
                    <td>"2" (SYSTEM)</td>
                </tr>
                <tr>
                    <td>ParticipantObjectTypeCodeRole</td>
                    <td>M</td>
                    <td>"13" (security resource)</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectDataLifeCycle</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>ParticipantObjectIDTypeCode</td>
                    <td>M</td>
                    <td>EV("ITI-79", "IHE Transaction", "Authorization Decisions Query")</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectSensitivity</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td>ParticipantObjectID</td>
                    <td>M</td>
                    <td>Content of StatusCode element (overall result of the authorization)</td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectName</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectQuery</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
                <tr>
                    <td><i>ParticipantObjectDetail</i></td>
                    <td><i>U</i></td>
                    <td><i>Not specialized</i></td>
                </tr>
            </table>

            <h4
            id="37952-authorization-decisions-manager-specific-security-considerations">3.79.5.2
            Authorization Decisions Manager Specific Security
            Considerations</h4>
            <p>None</p>
            <h4
            id="37953-authorization-decisions-verifier-specific-security-considerations">3.79.5.3
            Authorization Decisions Verifier Specific Security
            Considerations</h4>
            <p>None</p>
            <h1 id="volume-2-appendices">Volume 2 Appendices</h1>
            <p>None</p>
            <h1 id="volume-3---content-modules">Volume 3 - Content
            Modules</h1>
            <table>
            <thead>
            <tr class="header">
            <th><strong>Editor: Please add the following ErrorCode in <a
            href="https://profiles.ihe.net/ITI/TF/Volume3/ch-4.2.html#4.2.4.1">ITI
            TF-3: Table 4.2.4.1-2: Error Codes</a></strong></th>
            </tr>
            </thead>
            <tbody>
            </tbody>
            </table>
            <table>
            <thead>
            <tr class="header">
            <th>Error Code<sup>1</sup></th>
            <th>Discussion</th>
            <th>Transaction (See Note 1)</th>
            </tr>
            </thead>
            <tbody>
            <tr class="odd">
            <td>DocumentAccessNotAuthorized</td>
            <td>The document requested is not authorized to be disclosed
            to the Requester Entity</td>
            <td>RS</td>
            </tr>
            </tbody>
            </table>
            <h1 id="volume-4---national-extensions">Volume 4 - National
            Extensions</h1>
            <p>Not applicable</p>

          </div>
        </div>
      </main>
    </div>

    <footer class="ihe-footer">
    <div class="grid-container fluid">
      <div class="grid-x grid-margin-x align-middle">
        <div class="cell medium-9 small-order-2 medium-order-1 text-center medium-text-left">
          © 2000 &mdash; <span id="current-year"></span> IHE International | TEL 1-630-481-1004 | 820&nbsp;Jorie&nbsp;Boulevard,
          Oak&nbsp;Brook, IL&nbsp;60523
        </div>
        <div class="cell medium-3 small-order-1 medium-order-2 text-center medium-text-right ihe-footer-icons">
          <a href="mailto:secretary@ihe.net"><i class="fi fi-mail"></i></a>
          <a href="https://www.linkedin.com/company/iheintl"><i class="fi fi-social-linkedin"></i></a>
          <a href="https://twitter.com/IHEIntl"><i class="fi fi-social-twitter" aria-hidden="true"></i></a>
          <a href="https://www.youtube.com/user/IHEIntl"><i class="fi fi-social-youtube" aria-hidden="true"></i></a>
        </div>
      </div>
    </div>
  </footer>

    <script src="../../js/vendor/jquery.min.js"></script>
    <script src="../../js/vendor/motion-ui.min.js"></script>
    <script src="../../js/vendor/what-input.js"></script>
    <script src="../../js/vendor/foundation.min.js"></script>
    <script src="../../js/app.js"></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HLBNC861DJ');
</script>
  </body>
</html>
