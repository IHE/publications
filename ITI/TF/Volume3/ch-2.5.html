<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta charset="utf-8" />
    <title>IHE_ITI_TF_Rev16-0_Vol3_FT</title>
    <link rel="stylesheet" href="../css/styles.css" />
  </head>
  <body>
    <p>
      <img src="media/image1.jpeg" class="IHE logo" alt="IHE_LOGO_for_tf-docs" />
    </p>
    <p>IHE IT Infrastructure (ITI)</p>
    <p>Technical Framework</p>
    <p>Revision 16.0 – Final Text</p>
    <p>
      <hr />
    </p>
    <h2 xmlns="" id="5.5">5.5 Document Digital Signature (DSG) Document Content</h2>
    <p xmlns="">Document Digital Signature content shall conform to XAdES schema for signatures, with extensions and restrictions defined in the following. IHE is not changing any optionality, prohibiting use of options, or mandating options. Issues such as long-term archival management of certificates are out of scope of this profile.</p>
    <h3 xmlns="" id="5.5.1">5.5.1 References</h3>
    <h4 xmlns="" id="5.5.1.1">5.5.1.1 Normative References</h4>
    <p xmlns="">
      <span style="font-weight:bold">[XAdES]</span>
      <span>: XML Advanced Electronic Signatures XAdES   -- aka. ETSI TS 101 903</span>
      <a href="http://www.w3.org/TR/XAdES/" style="text-decoration:none">
        <span style="text-decoration:underline">http://www.w3.org/TR/XAdES/</span>
      </a>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">[W3C XMLDSIG]</span>
      <span>XML-Signature Syntax and Processing. W3C Recommendation. Donald Eastlake.</span>
      <span style="text-decoration:underline">June 2008.</span>
      <a href="https://www.w3.org/TR/xmldsig-core/" style="text-decoration:none">
        <span style="text-decoration:underline">https://www.w3.org/TR/xmldsig-core/</span>
      </a>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">[ASTM-E1762-05]</span>
      <span>ASTM E1762-95(2013) – Standard Guide for the Authentication of Health Care Information</span>
      <a href="http://www.astm.org/cgi-bin/SoftCart.exe/STORE/filtrexx40.cgi?U+mystore+odvl4256+-L+ASTM:E1762+/usr6/htdocs/astm.org/DATABASE.CART/REDLINE_PAGES/E1762.htm" style="text-decoration:none">
        <span style="text-decoration:underline">http://www.astm.org/cgi-bin/SoftCart.exe/STORE/filtrexx40.cgi?U+mystore+odvl4256+-L+ASTM:E1762+/usr6/htdocs/astm.org/DATABASE.CART/REDLINE_PAGES/E1762.htm</span>
      </a>
    </p>
    <h4 xmlns="" id="5.5.1.2">5.5.1.2 Informative References</h4>
    <p xmlns="">
      <span style="font-weight:bold"> [ASTM-E1985]</span>
      <span>E1985-98 -- Standard guide for user authentication and authorization</span>
      <a href="http://www.astm.org/cgi-bin/SoftCart.exe/DATABASE.CART/REDLINE_PAGES/E1985.htm?E+mystore" style="text-decoration:none">
        <span style="text-decoration:underline">http://www.astm.org/cgi-bin/SoftCart.exe/DATABASE.CART/REDLINE_PAGES/E1985.htm?E+mystore</span>
      </a>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">[ASTM-E2212]</span>
      <span>ASTM E2212 – Standard Practice for Healthcare Certificate Policy</span>
      <a href="http://www.astm.org/cgi-bin/SoftCart.exe/STORE/filtrexx40.cgi?U+mystore+odvl4256+-L+ASTM:E2212+/usr6/htdocs/astm.org/DATABASE.CART/REDLINE_PAGES/E2212.htm" style="text-decoration:none">
        <span style="text-decoration:underline">http://www.astm.org/cgi-bin/SoftCart.exe/STORE/filtrexx40.cgi?U+mystore+odvl4256+-L+ASTM:E2212+/usr6/htdocs/astm.org/DATABASE.CART/REDLINE_PAGES/E2212.htm</span>
      </a>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">[ASTM-E2084]</span>
      <span>ASTM E2084 – Standard Specification for the Authentication of Healthcare Information using Digital Signatures</span>
      <a href="http://www.astm.org/cgi-bin/SoftCart.exe/STORE/filtrexx40.cgi?U+mystore+odvl4256+-L+ASTM:E2084+/usr6/htdocs/astm.org/DATABASE.CART/REDLINE_PAGES/E2084.htm" style="text-decoration:none">
        <span style="text-decoration:underline">http://www.astm.org/cgi-bin/SoftCart.exe/STORE/filtrexx40.cgi?U+mystore+odvl4256+-L+ASTM:E2084+/usr6/htdocs/astm.org/DATABASE.CART/REDLINE_PAGES/E2084.htm</span>
      </a>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">[ISO17090]</span>
      <span>ISO/TS 17090-4 – Health Informatics – Public Key Infrastructure – Part 4: Digital Signatures for Healthcare Documents</span>
      <a href="http://www.iso.org/iso/en/CatalogueDetailPage.CatalogueDetail?CSNUMBER=35489&amp;ICS1=35&amp;ICS2=240&amp;ICS3=80" style="text-decoration:none">
        <span style="text-decoration:underline">http://www.iso.org/iso/en/CatalogueDetailPage.CatalogueDetail?CSNUMBER=35489&amp;ICS1=35&amp;ICS2=240&amp;ICS3=80</span>
      </a>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">[ISO 21091]</span>
      <span>ISO/TS 21091- Health Informatics – Directory Services for Security, Communications, and Identification of Professionals and Patients</span>
      <a href="http://www.iso.org/iso/en/CatalogueDetailPage.CatalogueDetail?CSNUMBER=35647&amp;scopelist=PROGRAMME" style="text-decoration:none">
        <span style="text-decoration:underline">http://www.iso.org/iso/en/CatalogueDetailPage.CatalogueDetail?CSNUMBER=35647&amp;scopelist=PROGRAMME</span>
      </a>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">[IETF RFC5280]</span>
      <span>IETF/RFC5280 – Internet X.509 Public Key Infrastructure and Certificate Revocation List (CRL) Profile</span>
      <a href="https://datatracker.ietf.org/doc/rfc5280/" style="text-decoration:none">
        <span style="text-decoration:underline">https://datatracker.ietf.org/doc/rfc5280/</span>
      </a>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">[ISO14533-2]</span>
      <span>ISO 14533-2:2012 – Process, data elements and documents in commerce, industry and administration – Long term signature profiles – Part 2: Long term signature profiles for XML Advanced Electronic Signatures (XAdES)</span>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">[ETSI TS 119 172-1]</span>
      <span>ETSI Technical Specifications 119 172-1 v1.1.1, Electronic Signatures and Infrastructures (ESI); Signature Policies; Part 1: Building blocks and table of contents for human readable signature policy documents; Annex B: Commitment types.</span>
      <a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11917201/01.01.01_60/ts_11917201v010101p.pdf" style="text-decoration:none">
        <span style="text-decoration:underline">https://www.etsi.org/deliver/etsi_ts/119100_119199/11917201/01.01.01_60/ts_11917201v010101p.pdf</span>
      </a>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">[ETSI TS 101 903]</span>
      <span>ETSI Technical Specifications 101 903, XML Advanced Electronic Signatures, Section 7.2.6, The CommitmentTypeIdentificationElement.</span>
      <a href="http://uri.etsi.org/01903/v1.1.1/ts_101903v010101p.pdf" style="text-decoration:none">
        <span style="text-decoration:underline">http://uri.etsi.org/01903/v1.1.1/ts_101903v010101p.pdf</span>
      </a>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">[ETSI TS 101 733]</span>
      <span>ETSI Technical Specifications, commitment-type-indication Attribute 101 733, Electronic Signature and Infrastructures (ESI); CMS Advanced Electronic Signature (CAdES).</span>
      <a href="https://www.etsi.org/deliver/etsi_ts/101700_101799/101733/02.02.01_60/ts_101733v020201p.pdf" style="text-decoration:none">
        <span style="text-decoration:underline">https://www.etsi.org/deliver/etsi_ts/101700_101799/101733/02.02.01_60/ts_101733v020201p.pdf</span>
      </a>
    </p>
    <h3 xmlns="" id="5.5.2">5.5.2 Signature Specification</h3>
    <p xmlns="">The following constraints define the Digital Signature block. This block is common to the detached signature and Enveloping signature.</p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Shall conform to XAdES-X-L – for support of Long Term signatures. The XAdES-X-L specification adds the timestamp of the signing and inclusion of the certificate and statement of revocation.</span>
      </li>
    </ul>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Shall use the hash algorithm sha256.</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Shall use the canonicalization algorithm “Canonical XML 1.1 with Comments” ().</span>
        <a href="http://www.w3.org/2006/12/xml-c14n11#WithComments" style="text-decoration:none">
          <span style="text-decoration:underline">http://www.w3.org/2006/12/xml-c14n11#WithComments</span>
        </a>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>The policy may be identified as</span>
        <span style="font-weight:bold">urn:ihe:iti:dsg:detached:2014</span>
        <span>when the signature document is a Detached Signature and</span>
        <span style="font-weight:bold">urn:ihe:iti:dsg:enveloping:2014</span>
        <span>when the signature document is an Enveloping Signature to indicate that the signature document complies with the DSG Profile.</span>
      </li>
    </ul>
    <p xmlns="">
      <span>Shall include a “CommitmentTypeIndication” element for the Purpose(s) of Signature (aka purposeOfSignature). The Purpose can be the action being attested to, or the role associated with the signature. The value  should come from ASTM E1762-95(2013) if applicable, and reproduced in Table 5.5.2-1. The coding scheme for ASTM is “1.2.840.10065.1.12”.</span>
      <a name="_Toc237310005">
        <span>Note that Content Creators and Content Consumers should be capable of being configured to other conformance policies to support local policy. For example</span>
        <span>,</span>
        <span>some environments may choose a different</span>
        <span>XAdES</span>
        <span>profile, hashing algorithm, policy identifier, or signature purpose vocabulary. Content Creators would thus create Digital Signature blocks that are not conformant to this profile. Content Consumers can validate these Digital Signature blocks, and be capable of configured behavior according to the local policy.</span>
      </a>
    </p>
    <p xmlns="">Some regions also require conformance to ISO 17090, which includes additional Certificate issuing, content, and validation rules.</p>
    <p xmlns="" class="tableTitle">Table 5.5.2-1: Digital Signature Purposes from ASTM E1762-95(2013)</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <thead>
        <tr style="height:8.1pt">
          <td style="width:24.62%" class="tableHeader">Code</td>
          <td style="width:17.86%" class="tableHeader">Term</td>
          <td style="width:57.52%" class="tableHeader">Definition</td>
        </tr>
      </thead>
      <tbody>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.1</td>
          <td style="width:17.86%">Author’s Signature</td>
          <td style="width:57.52%">The signature of the primary or sole author of a health information document. There can be only one primary author of a health information document.</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.2</td>
          <td style="width:17.86%">Co-Author’s Signature</td>
          <td style="width:57.52%">The signature of a health information document co-author. There can be multiple co-authors of a health information document.</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.3</td>
          <td style="width:17.86%">Co-participant’s Signature</td>
          <td style="width:57.52%">The signature of an individual who is a participant in the health information document but is not an author or co-author. (e.g., a surgeon who is required by institutional, regulatory, or legal rules to sign an operative report, but who was not involved in the authorship of that report.)</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.4</td>
          <td style="width:17.86%">Transcriptionist/Recorder Signature</td>
          <td style="width:57.52%">The signature of an individual who has transcribed a dictated document or recorded written text into a digital machine -readable format.</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.5</td>
          <td style="width:17.86%">Verification Signature</td>
          <td style="width:57.52%">A signature verifying the information contained in a document. (e.g., a physician is required to countersign a verbal order that has previously been recorded in the medical record by a registered nurse who has carried out the verbal order.)</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.6</td>
          <td style="width:17.86%">Validation Signature</td>
          <td style="width:57.52%">A signature validating a health information document for inclusion in the patient record. (e.g., a medical student or resident is credentialed to perform history or physical examinations and to write progress notes. The attending physician signs the history and physical examination to validate the entry for inclusion in the patient’s medical record.)</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.7</td>
          <td style="width:17.86%">Consent Signature</td>
          <td style="width:57.52%">The signature of an individual consenting to what is described in a health information document.</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.8</td>
          <td style="width:17.86%">Signature Witness Signature</td>
          <td style="width:57.52%">The signature of a witness to any other signature.</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.9</td>
          <td style="width:17.86%">Event Witness Signature</td>
          <td style="width:57.52%">The signature of a witness to an event. (Example the witness has observed a procedure and is attesting to this fact.)</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.10</td>
          <td style="width:17.86%">Identity Witness Signature</td>
          <td style="width:57.52%">The signature of an individual who has witnessed another individual who is known to them signing a document. (e.g., the identity witness is a notary public.)</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.11</td>
          <td style="width:17.86%">Consent Witness Signature</td>
          <td style="width:57.52%">The signature of an individual who has witnessed the health care provider counselling a patient.</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.12</td>
          <td style="width:17.86%">Interpreter Signature</td>
          <td style="width:57.52%">The signature of an individual who has translated health care information during an event or the obtaining of consent to a treatment.</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.13</td>
          <td style="width:17.86%">Review Signature</td>
          <td style="width:57.52%">The signature of a person, device, or algorithm that has reviewed or filtered data for inclusion into the patient record. (e.g., (1) a medical records clerk who scans a document for inclusion in the medical record, enters header information, or catalogues and classifies the data, or a combination thereof; (2) a gateway that receives data from another computer system and interprets that data or changes its format, or both, before entering it into the patient record.)</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.14</td>
          <td style="width:17.86%">Source Signature</td>
          <td style="width:57.52%">The signature of an automated data source. (e.g., (1) the signature for an image that is generated by a device for inclusion in the patient record; (2) the signature for an ECG derived by an ECG system for inclusion in the patient record; (3) the data from a biomedical monitoring device or system that is for inclusion in the patient record.)</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.15</td>
          <td style="width:17.86%">Addendum Signature</td>
          <td style="width:57.52%">The signature on a new amended document of an individual who has corrected, edited, or amended an original health information document. An addendum signature can either be a signature type or a signature sub-type (see ASTM E1762-Section 8.1). Any document with an addendum signature shall have a companion document that is the original document with its original, unaltered content, and original signatures. The original document shall be referenced via an attribute in the new document, which contains, for example, the digest of the old document. Whether the original, unaltered, document is always displayed with the addended document is a local matter, but the original, unaltered, document must remain as part of the patient record and be retrievable on demand.</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.16</td>
          <td style="width:17.86%">Modification Signature</td>
          <td style="width:57.52%">The signature on an original document of an individual who has generated a new amended document. This (original) document shall reference the new document via an additional signature purpose. This is the inverse of an addendum signature and provides a pointer from the original to the amended document.</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.17</td>
          <td style="width:17.86%">Administrative (Error/Edit) Signature</td>
          <td style="width:57.52%">The signature of an individual who is certifying that the document is invalidated by an error(s), or is placed in the wrong chart. An administrative (error/edit) signature must include an addendum to the document and therefore shall have an addendum signature sub-type (see ASTM E1762-Section 8.1). This signature is reserved for the highest health information system administrative classification, since it is a statement that the entire document is invalidated by the error and that the document should no longer be used for patient care, although for legal reasons the document must remain part of the permanent patient record.</td>
        </tr>
        <tr style="height:15.5pt">
          <td style="width:24.62%">1.2.840.10065.1.12.1.18</td>
          <td style="width:17.86%">Timestamp Signature</td>
          <td style="width:57.52%">The signature by an entity or device trusted to provide accurate timestamps. This timestamp might be provided, for example, in the signature time attribute.</td>
        </tr>
      </tbody>
    </table>
    <h3 xmlns="" id="5.5.3">5.5.3 Detached Signature</h3>
    <p xmlns="">The Detached Signature utilizes the XML Signature - Reference element (ds:reference) to identify and provide a hash for each document that is signed. This set of Reference elements is considered the manifest. The URI attribute shall be used and hold the document uniqueID. For documents that do not use a URI as the uniqueId, the Affinity Domain should determine an appropriate way to encode the DocumentEntry.uniqueId.</p>
    <h4 xmlns="" id="5.5.3.1">5.5.3.1 SubmissionSet Signature</h4>
    <p xmlns="">The SubmissionSet Signature is a variant of the Detached Signature used to digitally sign a complete SubmissionSet. The signature can later be validated to assure that the SubmissionSet is complete and the same as when it was created.</p>
    <p xmlns="">The SubmissionSet Signature shall be a Detached Signature that has Reference elements for:</p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:14.12pt;padding-left:7.48pt">
        <span>the SubmissionSet uniqueID with a hash value of “0”</span>
      </li>
      <li style="margin-top:6pt;margin-left:14.12pt;padding-left:7.48pt">
        <span>the document uniqueID for each of the documents contained in the SubmissionSet not including the SubmissionSet Signature document</span>
      </li>
    </ul>
    <p xmlns="">The SubmissionSet Signature creation is informatively described here with the Content Creator grouped with an XDS Document Source and is equally applicable with grouping the Content Creator with the other Document Sharing infrastructure (e.g., XDR, and XDM). The document publication transaction is not specific to the SubmissionSet Signature process or content, and is included here only to show overall workflow.</p>
    <p xmlns="">Informative process for creating a SubmissionSet Signature:</p>
    <ol xmlns="" type="1" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:32pt;padding-left:4pt">
        <span>A set (n) of Documents of interest are gathered, or generated to be published</span>
      </li>
      <li style="margin-top:6pt;margin-left:32pt;padding-left:4pt">
        <span>A SubmissionSet is created for the Documents, for example in preparation for using the Provide and Register Document Set-b [ITI-41] transaction or equivalent</span>
      </li>
      <li style="margin-top:6pt;margin-left:32pt;padding-left:4pt">
        <span>A Digital Signature document is created which includes Reference elements of:</span>
      </li>
    </ol>
    <ol xmlns="" type="a" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:49.33pt;padding-left:4.67pt">
        <span>The SubmissionSet.uniqueId is included in the manifest, with a zero hash value (the value “0”).</span>
      </li>
      <li style="margin-top:6pt;margin-left:50pt;padding-left:4pt">
        <span>All of the (n) documents to be included in the SubmissionSet, other than the signature document, are listed in the manifest with their hash.</span>
      </li>
      <li style="margin-top:6pt;margin-left:49.33pt;padding-left:4.67pt">
        <span>The signature document is processed according to Section 5.5.2, and thus signed.</span>
      </li>
    </ol>
    <ol xmlns="" start="4" type="1" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:32pt;padding-left:4pt">
        <span>The signature document would be added to the SubmissionSet according to Section 5.5.6. The SubmissionSet may, but is not required, include all the “SIGNS” association defined in Section 5.5.6.4 with associations to all the other documents in the SubmissionSet. The “SIGNS” association is redundant in this case as the SubmissionSet already groups these documents.</span>
      </li>
      <li style="margin-top:6pt;margin-left:32pt;padding-left:4pt">
        <span>The SubmissionSet with the (n) documents and the Digital Signature document is submitted using the Provide and Register Document Set-b [ITI-41] transaction, or equivalent from the other Document Sharing infrastructures.</span>
      </li>
    </ol>
    <h3 xmlns="" id="5.5.4">5.5.4 Enveloping Signature</h3>
    <p xmlns="">The Enveloping Signature utilizes the XML Signature – “Include” capability where the full content of the signed document is encoded inside the signature document in the Object element (ds:object).</p>
    <p xmlns="">The signed document shall be base64 encoded, unless some other policy overrides.</p>
    <p xmlns="">The object element Encoding shall be specified (http://www.w3.org/2000/09/xmldsig#base64).</p>
    <h3 xmlns="" id="5.5.5">5.5.5 Signature Verification</h3>
    <p xmlns="">There are three levels of signature verification:</p>
    <ol xmlns="" type="1" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:32pt;padding-left:4pt">
        <span>verifying that the Digital Signature block itself has integrity through verifying the signature across the XML-Signature,</span>
      </li>
      <li style="margin-top:6pt;margin-left:32pt;padding-left:4pt">
        <span>confirming that the signer was authentic, not revoked, and appropriate to the signature purpose,</span>
      </li>
      <li style="margin-top:6pt;margin-left:32pt;padding-left:4pt">
        <span>confirming that the signed Documents of interest are unmodified using the hash algorithm.</span>
      </li>
    </ol>
    <p xmlns="">The Content Consumer shall verify the Digital Signature block has integrity.</p>
    <p xmlns="">The Content Consumer shall be able to be configured with local policy on PKI trust models, and management that supports the confirmation that the signer was authentic, not revoked, and appropriate to the signature purpose. The Content Consumer shall use this configuration when confirming the validity of the signature.</p>
    <p xmlns="">The Content Consumer shall be able to confirm the validity of the documents that are signed.</p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Workflow or local policy may direct that all or a subset of the signed documents be validated. There are use cases where only one document within a signed set of documents is all that is called for by the workflow.</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Workflow or local policy may direct that all or a subset of the signatures found within a Digital Signature Document be validated. The Digital Signature Document may contain signatures for purposes that are not relevant to the Content Consumer purpose that may not be possible to fully validate. A Content Consumer should silently ignore signatures that are not necessary to the purpose of the Content Consumer. For example, a signature may be from a different organization.</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>The document may not be accessible to the user, for example authorization denied, so confirmation of valid signed content may be impossible.</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>If there is a SubmissionSet unique ID included in the manifest, then the Content Consumer shall be able to verify that the submission set reference in the manifest is the one containing the documents which are listed in the manifest and the documents listed in the manifest are the complete list of documents in the submission set on the XDS Registry.</span>
      </li>
    </ul>
    <p xmlns="">The decision on what degree of verification is needed is determined by the application and use case.</p>
    <p xmlns="">The Content Consumer shall be able to validate content that uses SHA256 as well as SHA1.</p>
    <h3 xmlns="" id="5.5.6">5.5.6 Document Sharing Metadata</h3>
    <p xmlns="">This section applies when the Content Creator or Content Consumer is utilizing a Document Sharing Profile for transport. This section defines the source for all required Document Sharing attributes and as many optional attributes as makes sense for implementers’ applications.</p>
    <h4 xmlns="" id="5.5.6.1">5.5.6.1 Document Sharing – DocumentEntry Metadata</h4>
    <p xmlns="">The Signature Document shall have a compliant DocumentEntry with the following constraints:</p>
    <h5 xmlns="" id="5.5.6.1.1">5.5.6.1.1 XDSDocumentEntry.formatCode</h5>
    <p xmlns="">
      <span>The XDSDocumentEntry.formatCode shall be</span>
      <span style="font-weight:bold">urn:ihe:iti:dsg:detached:2014</span>
      <span>when the signature document is a Detached Signature and</span>
      <span style="font-weight:bold">urn:ihe:iti:dsg:enveloping:2014</span>
      <span>when the signature document is an Enveloping Signature. The formatCode codeSystem shall be</span>
      <span style="font-weight:bold">1.3.6.1.4.1.19376.1.2.3</span>
      <span>.</span>
    </p>
    <h5 xmlns="" id="5.5.6.1.2">5.5.6.1.2 XDSDocumentEntry.classCode</h5>
    <p xmlns="">The classCode value will be a value representing the high-level classification of Digital Signature type documents within the XDS Affinity Domain or Community.</p>
    <h5 xmlns="" id="5.5.6.1.3">5.5.6.1.3 XDSDocumentEntry.typeCode</h5>
    <p xmlns="">Where policy does not define a workflow specific typeCode, the following code should be used:</p>
    <p xmlns="">Coding schema = “ASTM”</p>
    <p xmlns="">Code value = “E1762”</p>
    <p xmlns="">Code value display name = “Full Document”</p>
    <h5 xmlns="" id="5.5.6.1.4">5.5.6.1.4 XDSDocumentEntry.author</h5>
    <p xmlns="">The author should represent the signer.</p>
    <h5 xmlns="" id="5.5.6.1.5">5.5.6.1.5 XDSDocumentEntry.eventCodeList</h5>
    <p xmlns="">The eventCodeList shall contain the signature Purpose(s) from the Digital Signature block “CommitmentTypeIndication” element, using Table 5.5.2-1.</p>
    <h5 xmlns="" id="5.5.6.1.6">5.5.6.1.6 XDSDocumentEntry.mimeType</h5>
    <p xmlns="">Shall be “text/xml”</p>
    <h5 xmlns="" id="5.5.6.1.7">5.5.6.1.7 XDSDocumentEntry.title</h5>
    <p xmlns="">Should be the same as the display name for the signature purpose</p>
    <h5 xmlns="" id="5.5.6.1.8">5.5.6.1.8 XDSDocumentEntry.language</h5>
    <p xmlns="">The language of the signature content shall be ‘art’ as in “artificial”.</p>
    <h4 xmlns="" id="5.5.6.2">5.5.6.2 Document Sharing – SubmissionSet Metadata</h4>
    <p xmlns="">This document content profile makes no changes to the structure of Submission Sets.</p>
    <h4 xmlns="" id="5.5.6.3">5.5.6.3 Document Sharing - Folder Metadata</h4>
    <p xmlns="">This document content profile makes no changes to the structure of Folders.</p>
    <h4 xmlns="" id="5.5.6.4">5.5.6.4 Document Associations</h4>
    <p xmlns="">When Detached Signature Option is used, the Content Creator shall use the “SIGNS” associationType Document Relationship to associate the signature (sourceObject) to the documents that it signs (targetObjects). See Section 4.2.2.</p>
    <p xmlns="">When SubmissionSet Signature Option is used, the Content Creator may use the “SIGNS” associationType Document Relationship to associate the signature (sourceObject) to the documents that it signs (targetObjects). See Section 4.2.2.</p>
    <h3 xmlns="" id="5.5.7">5.5.7 Security Considerations</h3>
    <p xmlns="">See XAdES specification for risk assessment and mitigation plan on Digital Signatures.</p>
    <h4 xmlns="" id="5.5.7.1">5.5.7.1 Content Creator</h4>
    <p xmlns="">When a Content Creator is grouped with an ATNA Secure Node or Secure Application, it shall create an Audit Message indicating the Signature Creation event.</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <tr>
        <td style="width:62.1pt">
          <div />
        </td>
        <td style="width:119.7pt" class="tableHeader">Field Name</td>
        <td style="width:25.2pt" class="tableHeader">Opt</td>
        <td style="width:233.1pt" class="tableHeader">Value Constraints</td>
      </tr>
      <tr>
        <td rowspan="5" style="width:62.1pt">
          <p>Event</p>
          <p>
            <span style="font-weight:bold">AuditMessage/EventIdentification</span>
            <br />
          </p>
        </td>
        <td style="width:119.7pt">EventID</td>
        <td style="width:25.2pt">M</td>
        <td style="width:233.1pt">EV(113031, DCM, “Signed Manifest”)</td>
      </tr>
      <tr>
        <td style="width:119.7pt">EventActionCode</td>
        <td style="width:25.2pt">M</td>
        <td style="width:233.1pt">“C” (Create)</td>
      </tr>
      <tr>
        <td style="width:119.7pt">EventDateTime</td>
        <td style="width:25.2pt">M</td>
        <td style="width:233.1pt">not specialized</td>
      </tr>
      <tr>
        <td style="width:119.7pt">EventOutcomeIndicator</td>
        <td style="width:25.2pt">M</td>
        <td style="width:233.1pt">not specialized</td>
      </tr>
      <tr>
        <td style="width:119.7pt">EventTypeCode</td>
        <td style="width:25.2pt">M</td>
        <td style="width:233.1pt">EV(“urn:ihe:iti:dsg”, “IHE Transactions”, “Document Digital Signature”)</td>
      </tr>
      <tr>
        <td colspan="4" style="width:472.5pt">Audit Source (Content Consumer) (1)</td>
      </tr>
      <tr>
        <td colspan="4" style="width:472.5pt">ActiveParticipant (User/System that requested Signature Creation) (0..n)</td>
      </tr>
      <tr>
        <td colspan="4" style="width:472.5pt">ActiveParticipant (Patient indicated in the Signature Document) (0..n)</td>
      </tr>
      <tr>
        <td colspan="4" style="width:472.5pt">ParticipantObjectIdentification (Digital Signature Document) (1)</td>
      </tr>
    </table>
    <h4 xmlns="" id="5.5.7.2">5.5.7.2 Content Consumer</h4>
    <p xmlns="">When a Content Consumer is grouped with an ATNA Secure Node or Secure Application, it shall create an Audit Message indicating the Signature Verification event.</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <tr>
        <td style="width:62.1pt">
          <div />
        </td>
        <td style="width:119.7pt" class="tableHeader">Field Name</td>
        <td style="width:25.2pt" class="tableHeader">Opt</td>
        <td style="width:233.1pt" class="tableHeader">Value Constraints</td>
      </tr>
      <tr>
        <td rowspan="5" style="width:62.1pt">
          <p>Event</p>
          <p>
            <span style="font-weight:bold">AuditMessage/EventIdentification</span>
            <br />
          </p>
        </td>
        <td style="width:119.7pt">EventID</td>
        <td style="width:25.2pt">M</td>
        <td style="width:233.1pt">EV(110007, DCM, “Report Verification”)</td>
      </tr>
      <tr>
        <td style="width:119.7pt">EventActionCode</td>
        <td style="width:25.2pt">M</td>
        <td style="width:233.1pt">“R” (Read)</td>
      </tr>
      <tr>
        <td style="width:119.7pt">EventDateTime</td>
        <td style="width:25.2pt">M</td>
        <td style="width:233.1pt">not specialized</td>
      </tr>
      <tr>
        <td style="width:119.7pt">EventOutcomeIndicator</td>
        <td style="width:25.2pt">M</td>
        <td style="width:233.1pt">not specialized</td>
      </tr>
      <tr>
        <td style="width:119.7pt">EventTypeCode</td>
        <td style="width:25.2pt">M</td>
        <td style="width:233.1pt">EV(“urn:ihe:iti:dsg”, “IHE Transactions”, “Document Digital Signature”)</td>
      </tr>
      <tr>
        <td colspan="4" style="width:472.5pt">Audit Source (Content Consumer) (1)</td>
      </tr>
      <tr>
        <td colspan="4" style="width:472.5pt">ActiveParticipant (User/System that requested Signature Validation) (0..n)</td>
      </tr>
      <tr>
        <td colspan="4" style="width:472.5pt">ActiveParticipant (Patient indicated in the Signature Document) (0..n)</td>
      </tr>
      <tr>
        <td colspan="4" style="width:472.5pt">ParticipantObjectIdentification (Digital Signature Document) (1)</td>
      </tr>
    </table>
  </body>
</html>
