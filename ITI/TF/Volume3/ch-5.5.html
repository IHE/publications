<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta xmlns="" charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title xmlns="">IHE ITI TF Vol3</title>
    <link xmlns="" rel="stylesheet" href="../../../css/styles.css" />
    <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-HLBNC861DJ" async> </script> 
</head>
  <body xmlns="">
    <header>
        <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
          <button class="menu-icon" type="button" data-toggle="responsive-menu"></button>
          <div class="title-bar-title">IHE ITI Technical Framework</div>
        </div>
        <div class="top-bar" id="responsive-menu">
          <div class="top-bar-left">
            <img src="../../../IHE_INTERNATIONAL.png" class="IHE logo hide-for-small-only" alt="IHE logo" />
            <ul id="tf-small-menu" class="menu vertical show-for-small-only">
              <li><a class="ihe-purple" href="https://ihe.net" target="_blank">About IHE</a></li>
              <li class="menu-text">Sections
                <ul id="tf-small-menu-list" class="nested vertical menu">
                </ul>
              </li>
            </ul>
          </div>
          <div class="top-bar-right hide-for-small-only">
            <ul class="menu">
              <li class="menu-text tf-version">IHE IT Infrastructure (ITI) Technical Framework, Volume <span id="volumeNo"></span><br />Revision 20.0, August 4, 2023 – Final Text</li>
            </ul>
              <ul class="menu align-right">
                    <li><input id="ihe-search-field" type="search" placeholder="Search"></li>
                    <li><button id="ihe-search-button" type="button" class="button search">Search</button></li>
                </ul>
            </div>
        </div>
         </header>
    <div class="navigation">
      <nav aria-label="You are here:" role="navigation">
        <ul class="breadcrumbs">
        </ul>
      </nav>
    </div>
    <div class="scroll-top-wrapper">
      <span class="scroll-top-inner">
        <i class="size-icon-lg fi-arrow-up"></i>
      </span>
    </div>
    <div class="grid-container fluid">
      <div class="grid-x grid-margin-x align-center">
        <div class="cell medium-11">
          <div class="callout disclaimer warning text-center">              
          The Final Text ITI Technical Framework is published here in HTML format and is no longer published as PDF. Trial Implementation supplements are available from the <a href=https://profiles.ihe.net/ITI/TF/Volume1/index.html>Volume 1 Table of Contents</a>.
          </div>
        </div>
      </div>
      <main>
        <div class="grid-x grid-margin-x align-center">
          <div class="hide-for-small-only cell medium-2 large-2" data-sticky-container>
            <div id="section-menu" class="sticky" data-sticky data-anchor="main-top">
            </div>
          </div>
          <div id="main-top" class="cell medium-10 large-10">
      <h2 id="5.5">5.5Document Digital Signature (DSG) XML Signature</h2>
      <p>Document Digital Signature content shall conform to XAdES schema for signatures, with extensions and restrictions defined in the following. IHE is not changing any optionality, prohibiting use of options, or mandating options. Issues such as long-term archival management of certificates are out of scope of this profile.</p>
      <h3 id="5.5.1">5.5.1 References</h3>
      <h4 id="5.5.1.1">5.5.1.1 Normative References</h4>
      <p>
        <span style="font-weight:bold">[XAdES]</span>
        <span>: XML Advanced Electronic Signatures XAdES</span>
        <a href="http://www.w3.org/TR/XAdES/">http://www.w3.org/TR/XAdES/</a>
        <span>  -- aka. ETSI TS 101 903</span>
      </p>
      <p>
        <span style="font-weight:bold">[W3C XMLDSIG]</span>
        <span>XML-Signature Syntax and Processing. W3C Recommendation. Donald Eastlake.</span>
        <span style="text-decoration:underline">June 2008.</span>
        <a href="https://www.w3.org/TR/xmldsig-core/">https://www.w3.org/TR/xmldsig-core/</a>
      </p>
      <h4 id="5.5.1.2">5.5.1.2 Informative References</h4>
      <p>
        <span style="font-weight:bold">[ISO14533-2]</span>
        <span>ISO 14533-2:2012 – Process, data elements and documents in commerce, industry and administration – Long term signature profiles – Part 2: Long term signature profiles for XML Advanced Electronic Signatures (XAdES)</span>
      </p>
      <p>
        <span style="font-weight:bold">[ETSI TS 119 172-1]</span>
        <span>ETSI Technical Specifications 119 172-1 v1.1.1, Electronic Signatures and Infrastructures (ESI); Signature Policies; Part 1: Building blocks and table of contents for human readable signature policy documents; Annex B: Commitment types.</span>
        <a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11917201/01.01.01_60/ts_11917201v010101p.pdf">https://www.etsi.org/deliver/etsi_ts/119100_119199/11917201/01.01.01_60/ts_11917201v010101p.pdf</a>
        <span />
      </p>
      <p>
        <span style="font-weight:bold">[ETSI TS 101 903]</span>
        <span>ETSI Technical Specifications 101 903, XML Advanced Electronic Signatures, Section 7.2.6, The CommitmentTypeIdentificationElement.</span>
        <a href="http://uri.etsi.org/01903/v1.1.1/ts_101903v010101p.pdf">http://uri.etsi.org/01903/v1.1.1/ts_101903v010101p.pdf</a>
        <span />
      </p>
      <p>
        <span style="font-weight:bold">[ETSI TS 101 733]</span>
        <span>ETSI Technical Specifications, commitment-type-indication Attribute 101 733, Electronic Signature and Infrastructures (ESI); CMS Advanced Electronic Signature (CAdES).</span>
        <a href="https://www.etsi.org/deliver/etsi_ts/101700_101799/101733/02.02.01_60/ts_101733v020201p.pdf">https://www.etsi.org/deliver/etsi_ts/101700_101799/101733/02.02.01_60/ts_101733v020201p.pdf</a>
        <span />
      </p>
      <p>
        <span style="font-weight:bold">[ASTM-E1762-05]</span>
        <span>ASTM E1762-95(2013) – Standard Guide for the Authentication of Health Care Information</span>
      </p>
      <h3 id="5.5.2">5.5.2 Signature Specification</h3>
      <p>The following constraints define the Digital Signature block. This block is common to the detached signature and Enveloping signature.</p>
      <ul>
        <li class="bullet-list1">Shall conform to XAdES-X-L – for support of Long Term signatures. The XAdES-X-L specification adds the timestamp of the signing and inclusion of the certificate and statement of revocation.</li>
      </ul>
      <ul>
        <li class="bullet-list1">Shall implement the hash algorithm sha256and RSA signature algorithm for the purpose of interoperability testing. 
		However, implementors SHOULD take into account additional considerations such as jurisdictional policies, quantum safe computing, 
		and evolving guidance from XAdES.
		<a href="https://www.w3.org/2001/04/xmlenc#sha256">https://www.w3.org/2001/04/xmlenc#sha256</a>
		<a href="https://www.w3.org/2001/04/xmldsig-more#rsa-sha256">https://www.w3.org/2001/04/xmldsig-more#rsa-sha256</a>
	</li>
        <li class="bullet-list1">
          <span>Shall use the canonicalization algorithm “Canonical XML 1.1 with Comments” (</span>
          <a href="http://www.w3.org/2006/12/xml-c14n11#WithComments">http://www.w3.org/2006/12/xml-c14n11#WithComments</a>
          <span>) across the XML-Signature.</span>
        </li>
        <li class="bullet-list1">
          <span>The policy may be identified as</span>
          <span style="font-weight:bold">urn:ihe:iti:dsg:detached:2014</span>
          <span>when the signature document is a Detached Signature and</span>
          <span style="font-weight:bold">urn:ihe:iti:dsg:enveloping:2014</span>
          <span>when the signature document is an Enveloping Signature to indicate that the signature document complies with the DSG Profile.</span>
        </li>
      </ul>
      <p>
        <span>Shall include a “CommitmentTypeIndication” element for the Purpose(s) of Signature (aka purposeOfSignature). The Purpose can be the action being 
		attested to, or the role associated with the signature. The value  should come from ASTM E1762-95(2013) if applicable.
		The coding scheme for ASTM is “1.2.840.10065.1.12”. The Signature Purposes is available in a FHIR ValueSet and CodeSystem - 
		<a href="http://hl7.org/fhir/ValueSet/signature-type">http://hl7.org/fhir/ValueSet/signature-type</a></span>
        <a name="_Toc237310005">
          <span>Note that Content Creators and Content Consumers might be capable of being configured to other conformance policies to support local policy. For example</span>
          <span>,</span>
          <span>some environments may choose a different XAdES profile, hashing algorithm, policy identifier, or signature purpose vocabulary. 
		  Content Creators would thus create Digital Signature blocks that are not conformant to this profile. Content Consumers might 
		  validate these Digital Signature blocks, and be capable of configured behavior according to the local policy.</span>
        </a>
      </p>
      <p>Some regions also require conformance to ISO 17090, which includes additional Certificate issuing, content, and validation rules.</p>
      <h3 id="5.5.3">5.5.3 Detached Signature</h3>
      <p>The Detached Signature utilizes the XML Signature - Reference element (ds:reference) to identify and provide a hash for each document that is signed. This set of Reference elements is considered the manifest. The URI attribute shall be used and hold the document uniqueID. For documents that do not use a URI as the uniqueId, the Affinity Domain should determine an appropriate way to encode the DocumentEntry.uniqueId.</p>
      <h4 id="5.5.3.1">5.5.3.1 SubmissionSet Signature</h4>
      <p>The SubmissionSet Signature is a variant of the Detached Signature used to digitally sign a complete SubmissionSet. The signature can later be validated to assure that the SubmissionSet is complete and the same as when it was created.</p>
      <p>The SubmissionSet Signature shall be a Detached Signature that has Reference elements for:</p>
      <ul>
        <li class="bullet-list1">the SubmissionSet uniqueID with a hash value of “0”</li>
        <li class="bullet-list1">the document uniqueID for each of the documents contained in the SubmissionSet not including the SubmissionSet Signature document</li>
      </ul>
      <p>The SubmissionSet Signature creation is informatively described here with the Content Creator grouped with an XDS Document Source and is equally applicable with grouping the Content Creator with the other Document Sharing infrastructure (e.g., XDR, and XDM). The document publication transaction is not specific to the SubmissionSet Signature process or content, and is included here only to show overall workflow.</p>
      <p>Informative process for creating a SubmissionSet Signature:</p>
      <ol>
        <li class="numbered-list1">A set (n) of Documents of interest are gathered, or generated to be published</li>
        <li class="numbered-list1">A SubmissionSet is created for the Documents, for example in preparation for using the Provide and Register Document Set-b [ITI-41] transaction or equivalent</li>
        <li class="numbered-list1">A Digital Signature document is created which includes Reference elements of:</li>
      </ol>
      <ol>
        <li class="numbered-list2">The SubmissionSet.uniqueId is included in the manifest, with a zero hash value (the value “0”).</li>
        <li class="numbered-list2">All of the (n) documents to be included in the SubmissionSet, other than the signature document, are listed in the manifest with their hash.</li>
        <li class="numbered-list2">The signature document is processed according to Section 5.5.2, and thus signed.</li>
      </ol>
      <ol start="4">
        <li class="numbered-list1">The signature document would be added to the SubmissionSet according to Section 5.5.6. The SubmissionSet may, but is not required, include all the “SIGNS” association defined in Section 5.5.6.4 with associations to all the other documents in the SubmissionSet. The “SIGNS” association is redundant in this case as the SubmissionSet already groups these documents.</li>
        <li class="numbered-list1">The SubmissionSet with the (n) documents and the Digital Signature document is submitted using the Provide and Register Document Set-b [ITI-41] transaction, or equivalent from the other Document Sharing infrastructures.</li>
      </ol>
      <h3 id="5.5.4">5.5.4 Enveloping Signature</h3>
      <p>The Enveloping Signature utilizes the XML Signature – “Include” capability where the full content of the signed document is encoded inside the signature document in the Object element (ds:object).</p>
      <p>The signed document shall be base64 encoded, unless some other policy overrides.</p>
      <p>The object element Encoding shall be specified (http://www.w3.org/2000/09/xmldsig#base64).</p>
      <h3 id="5.5.5">5.5.5 Signature Verification</h3>
      <p>There are three levels of signature verification:</p>
      <ol>
        <li class="numbered-list1">verifying that the Digital Signature block itself has integrity through verifying the signature across the XML-Signature,</li>
        <li class="numbered-list1">confirming that the signer was authentic, not revoked, and appropriate to the signature purpose,</li>
        <li class="numbered-list1">confirming that the signed Documents of interest are unmodified using the hash algorithm.</li>
      </ol>
      <p>The Content Consumer shall verify the Digital Signature block has integrity.</p>
      <p>The Content Consumer shall be able to be configured with local policy on PKI trust models, and management that supports the confirmation that the signer was authentic, not revoked, and appropriate to the signature purpose. The Content Consumer shall use this configuration when confirming the validity of the signature.</p>
      <p>The Content Consumer shall be able to confirm the validity of the documents that are signed.</p>
      <ul>
        <li class="bullet-list1">Workflow or local policy may direct that all or a subset of the signed documents be validated. There are use cases where only one document within a signed set of documents is all that is called for by the workflow.</li>
        <li class="bullet-list1">Workflow or local policy may direct that all or a subset of the signatures found within a Digital Signature Document be validated. The Digital Signature Document may contain signatures for purposes that are not relevant to the Content Consumer purpose that may not be possible to fully validate. A Content Consumer should silently ignore signatures that are not necessary to the purpose of the Content Consumer. For example, a signature may be from a different organization.</li>
        <li class="bullet-list1">The document may not be accessible to the user, for example authorization denied, so confirmation of valid signed content may be impossible.</li>
        <li class="bullet-list1">If there is a SubmissionSet unique ID included in the manifest, then the Content Consumer shall be able to verify that the submission set reference in the manifest is the one containing the documents which are listed in the manifest and the documents listed in the manifest are the complete list of documents in the submission set on the XDS Registry.</li>
      </ul>
      <p>The decision on what degree of verification is needed is determined by the application and use case.</p>
      <p>The Content Consumer shall be able to validate content that uses SHA256 as well as SHA1.</p>
      <h3 id="5.5.6">5.5.6 Document Sharing Metadata</h3>
      <p>This section applies when the Content Creator or Content Consumer is utilizing a Document Sharing Profile for transport. This section defines the source for all required Document Sharing attributes and as many optional attributes as makes sense for implementers’ applications.</p>
      <h4 id="5.5.6.1">5.5.6.1 Document Sharing – DocumentEntry Metadata</h4>
      <p>The Signature Document shall have a compliant DocumentEntry with the following constraints:</p>
      <h5 id="5.5.6.1.1">5.5.6.1.1 XDSDocumentEntry.formatCode</h5>
      <p>
        <span>The XDSDocumentEntry.formatCode shall be</span>
        <span style="font-weight:bold">urn:ihe:iti:dsg:detached:2014</span>
        <span>when the signature document is a Detached Signature and</span>
        <span style="font-weight:bold">urn:ihe:iti:dsg:enveloping:2014</span>
        <span>when the signature document is an Enveloping Signature. The formatCode codeSystem shall be</span>
        <span style="font-weight:bold">1.3.6.1.4.1.19376.1.2.3</span>
        <span>.</span>
      </p>
      <h5 id="5.5.6.1.2">5.5.6.1.2 XDSDocumentEntry.classCode</h5>
      <p>The classCode value will be a value representing the high-level classification of Digital Signature type documents within the XDS Affinity Domain or Community.</p>
      <h5 id="5.5.6.1.3">5.5.6.1.3 XDSDocumentEntry.typeCode</h5>
      <p>Where policy does not define a workflow specific typeCode, the following code should be used:</p>
      <p>Coding schema = “ASTM”</p>
      <p>Code value = “E1762”</p>
      <p>Code value display name = “Full Document”</p>
      <h5 id="5.5.6.1.4">5.5.6.1.4 XDSDocumentEntry.author</h5>
      <p>The author should represent the signer.</p>
      <h5 id="5.5.6.1.5">5.5.6.1.5 XDSDocumentEntry.eventCodeList</h5>
      <p>The eventCodeList shall contain the signature Purpose(s) from the Digital Signature block “CommitmentTypeIndication” element, using Table 5.5.2-1.</p>
      <h5 id="5.5.6.1.6">5.5.6.1.6 XDSDocumentEntry.mimeType</h5>
      <p>Shall be “text/xml”</p>
      <h5 id="5.5.6.1.7">5.5.6.1.7 XDSDocumentEntry.title</h5>
      <p>Should be the same as the display name for the signature purpose</p>
      <h5 id="5.5.6.1.8">5.5.6.1.8 XDSDocumentEntry.language</h5>
      <p>The language of the signature content shall be ‘art’ as in “artificial”.</p>
      <h4 id="5.5.6.2">5.5.6.2 Document Sharing – SubmissionSet Metadata</h4>
      <p>This document content profile makes no changes to the structure of Submission Sets.</p>
      <h4 id="5.5.6.3">5.5.6.3 Document Sharing - Folder Metadata</h4>
      <p>This document content profile makes no changes to the structure of Folders.</p>
      <h4 id="5.5.6.4">5.5.6.4 Document Associations</h4>
      <p>When Detached Signature Option is used, the Content Creator shall use the “SIGNS” associationType Document Relationship to associate the signature (sourceObject) to the documents that it signs (targetObjects). See Section 4.2.2.</p>
      <p>When SubmissionSet Signature Option is used, the Content Creator may use the “SIGNS” associationType Document Relationship to associate the signature (sourceObject) to the documents that it signs (targetObjects). See Section 4.2.2.</p>
      <h3 id="5.5.7">5.5.7 Security Considerations</h3>
      <p>See XAdES specification for risk assessment and mitigation plan on Digital Signatures.</p>
      <h4 id="5.5.7.1">5.5.7.1 Content Creator</h4>
      <p>When a Content Creator is grouped with an ATNA Secure Node or Secure Application, it shall create an Audit Message indicating the Signature Creation event.</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <div />
          </td>
          <td class="tableHeader">Field Name</td>
          <td class="tableHeader">Opt</td>
          <td class="tableHeader">Value Constraints</td>
        </tr>
        <tr>
          <td rowspan="5">
            <p>Event</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">EventIdentification</span>
            </p>
          </td>
          <td>EventID</td>
          <td>M</td>
          <td>EV(113031, DCM, “Signed Manifest”)</td>
        </tr>
        <tr>
          <td>EventActionCode</td>
          <td>M</td>
          <td>“C” (Create)</td>
        </tr>
        <tr>
          <td>EventDateTime</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>EventOutcomeIndicator</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>EventTypeCode</td>
          <td>M</td>
          <td>EV(“urn:ihe:iti:dsg”, “IHE Transactions”, “Document Digital Signature”)</td>
        </tr>
        <tr>
          <td colspan="4">Audit Source (Content Consumer) (1)</td>
        </tr>
        <tr>
          <td colspan="4">ActiveParticipant (User/System that requested Signature Creation) (0..n)</td>
        </tr>
        <tr>
          <td colspan="4">ActiveParticipant (Patient indicated in the Signature Document) (0..n)</td>
        </tr>
        <tr>
          <td colspan="4">ParticipantObjectIdentification (Digital Signature Document) (1)</td>
        </tr>
      </table>
      <h4 id="5.5.7.2">5.5.7.2 Content Consumer</h4>
      <p>When a Content Consumer is grouped with an ATNA Secure Node or Secure Application, it shall create an Audit Message indicating the Signature Verification event.</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <div />
          </td>
          <td class="tableHeader">Field Name</td>
          <td class="tableHeader">Opt</td>
          <td class="tableHeader">Value Constraints</td>
        </tr>
        <tr>
          <td rowspan="5">
            <p>Event</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">EventIdentification</span>
            </p>
          </td>
          <td>EventID</td>
          <td>M</td>
          <td>EV(110007, DCM, “Report Verification”)</td>
        </tr>
        <tr>
          <td>EventActionCode</td>
          <td>M</td>
          <td>“R” (Read)</td>
        </tr>
        <tr>
          <td>EventDateTime</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>EventOutcomeIndicator</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>EventTypeCode</td>
          <td>M</td>
          <td>EV(“urn:ihe:iti:dsg”, “IHE Transactions”, “Document Digital Signature”)</td>
        </tr>
        <tr>
          <td colspan="4">Audit Source (Content Consumer) (1)</td>
        </tr>
        <tr>
          <td colspan="4">ActiveParticipant (User/System that requested Signature Validation) (0..n)</td>
        </tr>
        <tr>
          <td colspan="4">ActiveParticipant (Patient indicated in the Signature Document) (0..n)</td>
        </tr>
        <tr>
          <td colspan="4">ParticipantObjectIdentification (Digital Signature Document) (1)</td>
        </tr>
      </table>
          </div>
        </div>
      </main>
    </div>
   <footer class="ihe-footer">
    <div class="grid-container fluid">
      <div class="grid-x grid-margin-x align-middle">
        <div class="cell medium-9 small-order-2 medium-order-1 text-center medium-text-left">
          © 2000 &mdash; <span id="current-year"></span> IHE International | TEL 1-630-481-1004 | 820&nbsp;Jorie&nbsp;Boulevard,
          Oak&nbsp;Brook, IL&nbsp;60523
        </div>
        <div class="cell medium-3 small-order-1 medium-order-2 text-center medium-text-right ihe-footer-icons">
          <a href="mailto:secretary@ihe.net"><i class="fi fi-mail"></i></a>
          <a href="https://www.linkedin.com/company/iheintl"><i class="fi fi-social-linkedin"></i></a>
          <a href="https://twitter.com/IHEIntl"><i class="fi fi-social-twitter" aria-hidden="true"></i></a>
          <a href="https://www.youtube.com/user/IHEIntl"><i class="fi fi-social-youtube" aria-hidden="true"></i></a>
        </div>
      </div>
    </div>
  </footer>
    <script src="../../../js/vendor/jquery.min.js"></script>
    <script src="../../../js/vendor/motion-ui.min.js"></script>
    <script src="../../../js/vendor/what-input.js"></script>
    <script src="../../../js/vendor/foundation.min.js"></script>
    <script src="../../../js/app.js"></script>
  	<script>
	 window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-HLBNC861DJ');
	</script>
</body>
</html>
