<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta charset="utf-8" />
    <title>IHE_ITI_TF_Rev16-0_Vol2x_FT</title>
    <link rel="stylesheet" href="../css/styles.css" />
  </head>
  <body>
    <p>
      <img src="media/image1.jpeg" class="IHE logo" alt="IHE_LOGO_for_tf-docs" />
    </p>
    <p>IHE IT Infrastructure (ITI)</p>
    <p>Technical Framework - Volume2x</p>
    <p>Revision 16.0 – Final Text</p>
    <p>
      <hr />
    </p>
    <h1 id="Appendix C">Appendix C: HL7 Profiling Conventions</h1>
    <p>The HL7 tables included in this document have been modified from the HL7 2.5 standard document. Such a modification is called a profile. Refer to the HL7 2.5 standard for the meanings of specific columns in the table.</p>
    <p>The profiling tables in this document leverage the ongoing HL7 profile definition. To maintain this specification at a generic level, the following differences have been introduced:</p>
    <ul>
      <li>
        <p>Message specifications do not indicate the cardinality of segments within a message.</p>
      </li>
      <li>
        <p>For fields composed of multiple components, there is no indication of the size of each component.</p>
      </li>
      <li>
        <p>Where a table containing enumerated values is referenced from within a segment profile table, the enumerated values table is not always present.</p>
      </li>
      <li>
        <p>The number of times a repeating field can repeat is not indicated.</p>
      </li>
      <li>
        <p>The conditions that would require inclusion of conditional fields are not defined when they depend on functional characteristics of the system implementing the transaction and they do not affect data consistency.</p>
      </li>
    </ul>
    <p>The following terms refer to the OPT column, which has been profiled:</p>
    <p>R Required</p>
    <p>R2 This is an IHE extension. If the sending application has data for the field, it is required to populate the field. If the value is not known, the field may not be sent.</p>
    <p>R+ This is an IHE extension. This is a field that IHE requires that was listed as optional within the HL7 standard.</p>
    <p>O Optional</p>
    <p>C Conditional</p>
    <p>IHE requires that Z-segments be present in HL7 transactions only when explicitly provided for within the associated IHE message profile specification. According to the HL7 standard, if the value of a field is not present, the receiver shall not change corresponding data in its database. However, if sender includes explicit NULL value (i.e., two double-quotes “”), it shall cause removal of any values for that field in the receiver’s database.</p>
    <p>Table C-1 provides a sample profile for an imaginary HL7 segment. Tables for real segments are copied from the HL7 2.5 standard with modifications made only to the OPT column.</p>
    <p>Table C-1: Sample HL7 Profile</p>
    <table>
      <tbody>
        <tr class="odd">
          <td>SEQ</td>
          <td>LEN</td>
          <td>DT</td>
          <td>OPT</td>
          <td>TBL#</td>
          <td>ITEM #</td>
          <td>ELEMENT NAME</td>
        </tr>
        <tr class="even">
          <td>1</td>
          <td>1</td>
          <td>ST</td>
          <td>R</td>
          <td />
          <td>xx001</td>
          <td>Element 1</td>
        </tr>
        <tr class="odd">
          <td>2</td>
          <td>4</td>
          <td>ST</td>
          <td>O</td>
          <td />
          <td>xx002</td>
          <td>Element 2</td>
        </tr>
        <tr class="even">
          <td>3</td>
          <td>180</td>
          <td>HD</td>
          <td>R2</td>
          <td />
          <td>xx003</td>
          <td>Element 3</td>
        </tr>
        <tr class="odd">
          <td>4</td>
          <td>180</td>
          <td>HD</td>
          <td>C</td>
          <td />
          <td>xx004</td>
          <td>Element 4</td>
        </tr>
        <tr class="even">
          <td>5</td>
          <td>180</td>
          <td>HD</td>
          <td>O</td>
          <td />
          <td>xx005</td>
          <td>Element 5</td>
        </tr>
        <tr class="odd">
          <td>6</td>
          <td>180</td>
          <td>HD</td>
          <td>R+</td>
          <td />
          <td>xx006</td>
          <td>Element 6</td>
        </tr>
      </tbody>
    </table>
    <p />
    <h2 id="Appendix C.1">C.1 HL7 Message Profiling Convention</h2>
    <p>The messages used by each transaction are described in this document using static definitions as described for HL7 constrainable message profiles; refer to HL7 Version 2.5, Chapter 2, Section 2.12.6. The static definition of each message is represented within tables. The message level table represents the IHE-constrained message structure with its list of usable segments. The segment level table represents the IHE-constrained content of one segment with its usable fields.</p>
    <h3 id="Appendix C.1.1">C.1.1 Static definition - Message level</h3>
    <p>The message table representing the static definition contains 5 columns:</p>
    <ul>
      <li>
        <p>Segment: gives the segment name, and places the segment within the hierarchy of the message structure designed by HL7, but hiding the traditional square brackets and braces that designate optionality and repeatability in HL7 standard message tables. The beginning and end lines of a segment group (see HL7 Version 2.5, Chapter 2, Section 2.5.2 for definition) are designated in this column by --- (3 dashes).</p>
      </li>
      <li>
        <p>Meaning: Meaning of the segment as defined by HL7. The beginning of a segment group is designated by one line in this column giving the segment group name in all caps, prefixed by --- (3 dashes), and followed by the keyword “begin”. The end of a segment group is designated by one line in this column giving the segment group name in all caps, prefixed by --- (3 dashes), and followed by the keyword “end”.</p>
      </li>
      <li>
        <p>Usage: Coded usage of the segment, in the context of this IHE Integration Profile. The coded values used in this column are:</p>
      </li>
    </ul>
    <p>R Required: A compliant sending application shall populate all "R" elements with a non-empty value. A compliant receiving application may ignore the information conveyed by required elements. A compliant receiving application shall not raise an error due to the presence of a required element, but may raise an error due to the absence of a required element.</p>
    <p>
      RE Required but may be empty. The element may be missing from the message, but shall be sent by the sending application if there is relevant data. A conformant sending application shall be capable of providing all "RE" elements. If the conformant sending application knows a value for the element, then it shall send that value. If the conformant sending application does not know a value, then that element may be omitted.
      <br />
      Receiving applications may ignore data contained in the element, but shall be able to successfully process the message if the element is omitted (no error message should be generated if the element is missing).
    </p>
    <p>O Optional. The usage for this field within the message is not defined. The sending application may choose to populate the field; the receiving application may choose to ignore the field.</p>
    <p>
      C Conditional. This usage has an associated condition predicate. (See HL7 Version 2.5, Chapter 2, Section 2.12.6.6, "Condition Predicate".)
      <br />
      If the predicate is satisfied: A compliant sending application shall populate the element. A compliant receiving application may ignore data in the element. It may raise an error if the element is not present.
      <br />
      If the predicate is NOT satisfied: A compliant sending application shall NOT populate the element. A compliant receiving application shall NOT raise an error if the condition predicate is false and the element is not present, though it may raise an error if the element IS present.
    </p>
    <p>
      CE Conditional but may be empty. This usage has an associated condition predicate. (See HL7 Version 2.5, Chapter 2, Section 2.12.6.6, "Condition Predicate".)
      <br />
      If the predicate is satisfied: If the conforming sending application knows the required values for the element, then the application must populate the element. If the conforming sending application does not know the values required for this element, then the element shall be omitted. The conforming sending application must be capable of populating the element (when the predicate is true) for all ‘CE’ elements. If the element is present, the conformant receiving application may ignore the values of that element. If the element is not present, the conformant receiving application shall not raise an error due to the presence or absence of the element.
      <br />
      If the predicate is NOT satisfied: The conformant sending application shall not populate the element. The conformant receiving application may raise an application error if the element is present.
    </p>
    <p>X Not supported. For conformant sending applications, the element will not be sent. Conformant receiving applications may ignore the element if it is sent, or may raise an application error.</p>
    <ul>
      <li>
        <p>Cardinality: Within square brackets, minimum and maximum number of occurrences authorized for this segment in the context of this Integration Profile.</p>
      </li>
      <li>
        <p>HL7 chapter: Reference of the HL7 v2.5 chapter that describes this segment.</p>
      </li>
    </ul>
    <h3 id="Appendix C.1.2">C.1.2 Static definition – Segment level and Data Type level</h3>
    <p>The Segment Table and the Data Type Table each contain 8 columns:</p>
    <ul>
      <li>
        <p>SEQ: Position (sequence) of the field within the segment.</p>
      </li>
      <li>
        <p>LEN: Maximum length of the field</p>
      </li>
      <li>
        <p>DT: Field Data Type</p>
      </li>
      <li>
        <p>Usage: Usage of the field within this IHE Integration Profile. Same coded values as in the message level: R, RE, C, CE, O, X.</p>
      </li>
      <li>
        <p>Cardinality: Minimum and maximum number of occurrences for the field in the context of this Integration Profile.</p>
      </li>
      <li>
        <p>TBL#: Table reference (for fields using a set of defined values)</p>
      </li>
      <li>
        <p>ITEM#: HL7 unique reference for this field</p>
      </li>
      <li>
        <p>Element Name: Name of the field in a Segment table. / Component Name: Name of a subfield in a Data Type table.</p>
      </li>
    </ul>
    <p>Table C.1.2-1: Example: The MSH segment description</p>
    <table>
      <tbody>
        <tr class="odd">
          <td>SEQ</td>
          <td>LEN</td>
          <td>DT</td>
          <td>Usage</td>
          <td>Card.</td>
          <td>TBL#</td>
          <td>ITEM#</td>
          <td>Element name</td>
        </tr>
        <tr class="even">
          <td>1</td>
          <td>1</td>
          <td>ST</td>
          <td>R</td>
          <td>[1..1]</td>
          <td />
          <td>00001</td>
          <td>Field Separator</td>
        </tr>
        <tr class="odd">
          <td>2</td>
          <td>4</td>
          <td>ST</td>
          <td>R</td>
          <td>[1..1]</td>
          <td />
          <td>00002</td>
          <td>Encoding characters</td>
        </tr>
        <tr class="even">
          <td>3</td>
          <td>227</td>
          <td>HD</td>
          <td>R</td>
          <td>[1..1]</td>
          <td>0361</td>
          <td>00003</td>
          <td>Sending Application</td>
        </tr>
        <tr class="odd">
          <td>…</td>
          <td />
          <td />
          <td />
          <td />
          <td />
          <td />
          <td />
        </tr>
      </tbody>
    </table>
    <h2 id="Appendix C.2">C.2 HL7 Implementation Notes</h2>
    <h3 id="Appendix C.2.1">C.2.1 Network Guidelines</h3>
    <p>The HL7 2.5 standard does not define a network communications protocol. Beginning with HL7 v2.2, the definitions of lower layer protocols were moved to the Implementation Guide, but are not HL7 requirements. The IHE Framework makes these recommendations:</p>
    <ol type="1">
      <li>
        <p>Applications shall use the Minimal Lower Layer Protocol defined in Appendix C of the HL7 Implementation Guide.</p>
      </li>
      <li>
        <p>An initiating application that wants to send a message (initiate a transaction) will initiate a network connection to start the transaction. The receiver application will respond with an acknowledgement or response to query over the open connection. The initiating application can initiate a new transaction on the same connection. However, the initiating application must be able to handle cases where the connection has been closed due to possible timeout by the accepting application. For example if the initiating application does not submit a request over the connection in a timely manner, the accepting application has the right to close the connection. When this condition is detected, the initiating application needs to open a new connection for subsequent requests.</p>
      </li>
    </ol>
    <h3 id="Appendix C.2.2">C.2.2 Message Control</h3>
    <p>According to the HL7 standard, each message shall begin with the MSH (message header) segment. Table C.2.2-1 identifies all required fields in this message. This table shall be interpreted according to the HL7 Standard unless otherwise noted in Appendix C.</p>
    <p>Table C.2.2-1: IHE Profile - MSH segment</p>
    <table>
      <tbody>
        <tr class="odd">
          <td>SEQ</td>
          <td>LEN</td>
          <td>DT</td>
          <td>OPT</td>
          <td>TBL#</td>
          <td>ITEM #</td>
          <td>Element Name</td>
        </tr>
        <tr class="even">
          <td>1</td>
          <td>1</td>
          <td>ST</td>
          <td>R</td>
          <td />
          <td>00001</td>
          <td>Field Separator</td>
        </tr>
        <tr class="odd">
          <td>2</td>
          <td>4</td>
          <td>ST</td>
          <td>R</td>
          <td />
          <td>00002</td>
          <td>Encoding Characters</td>
        </tr>
        <tr class="even">
          <td>3</td>
          <td>180</td>
          <td>HD</td>
          <td>R+</td>
          <td />
          <td>00003</td>
          <td>Sending Application</td>
        </tr>
        <tr class="odd">
          <td>4</td>
          <td>180</td>
          <td>HD</td>
          <td>R+</td>
          <td />
          <td>00004</td>
          <td>Sending Facility</td>
        </tr>
        <tr class="even">
          <td>5</td>
          <td>180</td>
          <td>HD</td>
          <td>R+</td>
          <td />
          <td>00005</td>
          <td>Receiving Application</td>
        </tr>
        <tr class="odd">
          <td>6</td>
          <td>180</td>
          <td>HD</td>
          <td>R+</td>
          <td />
          <td>00006</td>
          <td>Receiving Facility</td>
        </tr>
        <tr class="even">
          <td>7</td>
          <td>26</td>
          <td>TS</td>
          <td>R</td>
          <td />
          <td>00007</td>
          <td>Date/Time Of Message</td>
        </tr>
        <tr class="odd">
          <td>8</td>
          <td>40</td>
          <td>ST</td>
          <td>O</td>
          <td />
          <td>00008</td>
          <td>Security</td>
        </tr>
        <tr class="even">
          <td>9</td>
          <td>13</td>
          <td>CM</td>
          <td>R</td>
          <td>0076/ 0003</td>
          <td>00009</td>
          <td>Message Type</td>
        </tr>
        <tr class="odd">
          <td>10</td>
          <td>20</td>
          <td>ST</td>
          <td>R</td>
          <td />
          <td>00010</td>
          <td>Message Control ID</td>
        </tr>
        <tr class="even">
          <td>11</td>
          <td>3</td>
          <td>PT</td>
          <td>R</td>
          <td />
          <td>00011</td>
          <td>Processing ID</td>
        </tr>
        <tr class="odd">
          <td>12</td>
          <td>60</td>
          <td>VID</td>
          <td>R</td>
          <td>0104</td>
          <td>00012</td>
          <td>Version ID</td>
        </tr>
        <tr class="even">
          <td>13</td>
          <td>15</td>
          <td>NM</td>
          <td>O</td>
          <td />
          <td>00013</td>
          <td>Sequence Number</td>
        </tr>
        <tr class="odd">
          <td>14</td>
          <td>180</td>
          <td>ST</td>
          <td>O</td>
          <td />
          <td>00014</td>
          <td>Continuation Pointer</td>
        </tr>
        <tr class="even">
          <td>15</td>
          <td>2</td>
          <td>ID</td>
          <td>O</td>
          <td>0155</td>
          <td>00015</td>
          <td>Accept Acknowledgment Type</td>
        </tr>
        <tr class="odd">
          <td>16</td>
          <td>2</td>
          <td>ID</td>
          <td>O</td>
          <td>0155</td>
          <td>00016</td>
          <td>Application Acknowledgment Type</td>
        </tr>
        <tr class="even">
          <td>17</td>
          <td>3</td>
          <td>ID</td>
          <td>O</td>
          <td>0399</td>
          <td>00017</td>
          <td>Country Code</td>
        </tr>
        <tr class="odd">
          <td>18</td>
          <td>16</td>
          <td>ID</td>
          <td>C</td>
          <td>0211</td>
          <td>00692</td>
          <td>Character Set</td>
        </tr>
        <tr class="even">
          <td>19</td>
          <td>250</td>
          <td>CE</td>
          <td>O</td>
          <td />
          <td>00693</td>
          <td>Principal Language Of Message</td>
        </tr>
        <tr class="odd">
          <td>20</td>
          <td>20</td>
          <td>ID</td>
          <td>O</td>
          <td>0356</td>
          <td>01317</td>
          <td>Alternate Character Set Handling Scheme</td>
        </tr>
        <tr class="even">
          <td>21</td>
          <td>427</td>
          <td>EI</td>
          <td>O</td>
          <td />
          <td>01598</td>
          <td>Message Profile Identifier #</td>
        </tr>
      </tbody>
    </table>
    <p>
      <em>Adapted from the HL7 Standard, version 2.5 and version 2.3.1</em>
    </p>
    <p>Note: This element is only applicable in HL7 version 2.5 and later, and thus is only applicable for those transactions based on HL7 v2.5 and later.</p>
    <p>
      The IHE IT Infrastructure Technical Framework requires that applications support HL7-recommended values for the fields
      <em>MSH-1-Field Separator</em>
      and
      <em>MSH-2-Encoding Characters</em>
      .
    </p>
    <p>
      Field
      <em>MSH-18-Character Set</em>
      shall only be valued if the message utilizes character sets other than ISO IR-6, also known as ASCII.
    </p>
    <p>
      Implementations supporting sequence number protocol (and using the field
      <em>MSH-13-Sequence Number)</em>
      shall be configurable to allow them to perform transactions without such protocol.
    </p>
    <p>In messages conforming to an IHE Transaction using HL7 v2.5 and later, it is recommended that field MSH-21-Message Profile Identifier contain one field repetition with a value representing the IHE transaction identifier, in the form “&lt;domain&gt;-&lt;transaction number&gt;^IHE” (e.g., “ITI-10^IHE”). Other field repetitions may be present with global (HL7-registered), vendor specific, and/or realm specific message profile IDs.</p>
    <h3 id="Appendix C.2.3">C.2.3 Acknowledgment Modes</h3>
    <p>IHE supports both Acknowledgement Modes specified in HL7 standard v2.5 (see HL7 Standard, Section 2.9 “Message Processing Rules”): Original Acknowledgement Mode and Enhanced Acknowledgement Mode.</p>
    <p>An IHE transaction which uses HL7 messages will explicitly include the requirement for enhanced mode if used. If no such statement is specified, the transaction shall use only original mode.</p>
    <p>This section specifies the common structure of the Application Level Acknowledgement Message in the Original Mode (called Application ACK Message for short), and the Commit Acknowledgement Message in the Enhanced Mode (called Commit ACK Message for short).</p>
    <p>The Application Level Acknowledgement Message in the Enhanced Mode contains the application-specific content, and shall be explicitly specified in the corresponding transaction which requires it. A transaction can, however, refer to the Application ACK Message specified in this section as its Application Level Acknowledgement Message in the enhanced mode if it is suitable.</p>
    <p>Table C.2.3-1: Common ACK static definition:</p>
    <table>
      <tbody>
        <tr class="odd">
          <td>Segment</td>
          <td>Meaning</td>
          <td>Usage</td>
          <td>Card.</td>
          <td>HL7 chapter</td>
        </tr>
        <tr class="even">
          <td>MSH</td>
          <td>Message Header</td>
          <td>R</td>
          <td>[1..1]</td>
          <td>2</td>
        </tr>
        <tr class="odd">
          <td>MSA</td>
          <td>Message Acknowledgement</td>
          <td>R</td>
          <td>[1..1]</td>
          <td>2</td>
        </tr>
        <tr class="even">
          <td>ERR</td>
          <td>Error</td>
          <td>C</td>
          <td>[0..*]</td>
          <td>2</td>
        </tr>
      </tbody>
    </table>
    <p>In the original mode, the ACK message conveys application errors (if any) detailed by the receiving application.</p>
    <p>The receiving application shall reject an incoming message, if it does not recognize either the message type (MSH-9.1) or the trigger event (MSH-9.2).</p>
    <p>In the Application ACK message, this is an application-rejection, and field MSA-1 of the acknowledgement shall contain the value AR.</p>
    <p>In the Commit ACK message, this is a commit-rejection, and Field MSA-1 of the acknowledgement shall contain the value CR.</p>
    <p>The components of Field ERR-2 of the acknowledgement shall be populated as follows.</p>
    <p>ERR-2.1: MSH</p>
    <p>ERR-2.2: 1</p>
    <p>ERR-2.3: 9</p>
    <p>ERR-2.4: 1</p>
    <p>ERR-2.5: 1 if an unrecognized message type</p>
    <p>2 if an unrecognized trigger event</p>
    <p>The components of Field ERR-3 of the acknowledgement shall be populated as follows.</p>
    <p>ERR-3.1: 200 if an unrecognized message type</p>
    <blockquote>
      <p>201 if an unrecognized trigger event</p>
    </blockquote>
    <p>ERR-3.2: Unsupported message type or</p>
    <p>Unsupported trigger event as appropriate</p>
    <p>ERR-3.3: HL70357</p>
    <p>Details of field encoding of these segments are discussed in the following sections.</p>
    <h4 id="Appendix C.2.3.1">C.2.3.1 MSA - Message Acknowledgement segment</h4>
    <p>Standard Reference: HL7 Version 2.5, Chapter 2 (Section 2.15, “Message control”)</p>
    <p>This segment contains information sent while acknowledging another message.</p>
    <p>Table C.2.3.1-1: MSA - Message Acknowledgement</p>
    <table>
      <tbody>
        <tr class="odd">
          <td>SEQ</td>
          <td>LEN</td>
          <td>DT</td>
          <td>Usage</td>
          <td>Card.</td>
          <td>TBL#</td>
          <td>ITEM#</td>
          <td>Element name</td>
        </tr>
        <tr class="even">
          <td>1</td>
          <td>2</td>
          <td>ID</td>
          <td>R</td>
          <td>[1..1]</td>
          <td>0008</td>
          <td>00018</td>
          <td>Acknowledgement code</td>
        </tr>
        <tr class="odd">
          <td>2</td>
          <td>20</td>
          <td>ST</td>
          <td>R</td>
          <td>[1..1]</td>
          <td />
          <td>00010</td>
          <td>Message Control Id</td>
        </tr>
        <tr class="even">
          <td>3</td>
          <td>80</td>
          <td>ST</td>
          <td>X</td>
          <td>[0..0]</td>
          <td />
          <td>00020</td>
          <td>Text Message</td>
        </tr>
        <tr class="odd">
          <td>4</td>
          <td>15</td>
          <td>NM</td>
          <td>O</td>
          <td>[0..1]</td>
          <td />
          <td>00021</td>
          <td>Expected Sequence Number</td>
        </tr>
        <tr class="even">
          <td>5</td>
          <td />
          <td />
          <td>X</td>
          <td>[0..0]</td>
          <td />
          <td>00022</td>
          <td>Delayed Acknowledgment Type</td>
        </tr>
        <tr class="odd">
          <td>6</td>
          <td>250</td>
          <td>CE</td>
          <td>X</td>
          <td>[0..0]</td>
          <td>0357</td>
          <td>00023</td>
          <td>Error Condition</td>
        </tr>
      </tbody>
    </table>
    <p>MSA-1 Acknowledgment Code (ID), required.</p>
    <p>As is the case throughout IHE, original mode acknowledgement is in use. IHE ITI authorizes two value sets of the acknowledgement codes, both taken from HL7 Table 0008 - Acknowledgement code for the Application and Commit ACK messages, respectively.</p>
    <p>In the original mode, the Application ACK message shall use one of the following three codes to populate Field MSA-1:</p>
    <p>Table C.2.3.1-2: HL7 Table 0008 - Acknowledgement codes in Application ACK message</p>
    <table>
      <tbody>
        <tr class="odd">
          <td>Value</td>
          <td>Description</td>
          <td>Comment</td>
        </tr>
        <tr class="even">
          <td>AA</td>
          <td>Original mode: Application Accept</td>
          <td>The message has been accepted and integrated by the receiving application</td>
        </tr>
        <tr class="odd">
          <td>AE</td>
          <td>Original mode: Application Error</td>
          <td>The message contains errors. It SHALL not be sent again without correcting the error.</td>
        </tr>
        <tr class="even">
          <td>AR</td>
          <td>Original mode: Application Reject</td>
          <td>The message has been rejected by the receiving application. If the rejection is not related to an invalid value in the MSH segment, the sender may try again to send the message later.</td>
        </tr>
      </tbody>
    </table>
    <p>In the enhanced mode, the Commit ACK message shall use one of the following three codes to populate Field MSA-1:</p>
    <p>Table C.2.3.1-3: HL7 Table 0008 - Acknowledgement codes in Commit ACK message</p>
    <table>
      <tbody>
        <tr class="odd">
          <td>Value</td>
          <td>Description</td>
          <td>Comment</td>
        </tr>
        <tr class="even">
          <td>CA</td>
          <td>Enhanced mode: Commit Accept</td>
          <td>The message has been received and safe-kept in the receiving application for processing. No resend is required.</td>
        </tr>
        <tr class="odd">
          <td>CE</td>
          <td>Enhanced mode: Commit Error</td>
          <td>The message contains errors. It SHALL not be sent again without correcting the error.</td>
        </tr>
        <tr class="even">
          <td>CR</td>
          <td>Enhanced mode: Commit Reject</td>
          <td>The message has been rejected by the receiving application. If the rejection is not related to an invalid value in the MSH segment, the sender may try again to send the message later.</td>
        </tr>
      </tbody>
    </table>
    <p>MSA-2 Message Control ID (ST), required.</p>
    <p>Definition: This field contains the message control ID from Field MSH-10-Message Control ID of the incoming message for which the acknowledgement is sent.</p>
    <p>MSA-3 Text Message (ST), not supported. See the ERR segment.</p>
    <p>MSA-6 Error Condition (CE), not supported. See the ERR segment.</p>
    <h4 id="Appendix C.2.3.2">C.2.3.2 ERR - Error segment</h4>
    <p>Standard Reference: HL7 Version 2.5, Chapter 2 (Section 2.15, “Message control”)</p>
    <p>This segment is used to add error comments to acknowledgment messages.</p>
    <p>Table C.2.3.2-1: ERR – Error segment</p>
    <table>
      <tbody>
        <tr class="odd">
          <td>SEQ</td>
          <td>LEN</td>
          <td>DT</td>
          <td>Usage</td>
          <td>Card.</td>
          <td>TBL#</td>
          <td>ITEM#</td>
          <td>Element name</td>
        </tr>
        <tr class="even">
          <td>1</td>
          <td>493</td>
          <td>ELD</td>
          <td>X</td>
          <td>[0..0]</td>
          <td />
          <td>00024</td>
          <td>Error Code and Location</td>
        </tr>
        <tr class="odd">
          <td>2</td>
          <td>18</td>
          <td>ERL</td>
          <td>RE</td>
          <td>[0..*]</td>
          <td />
          <td>01812</td>
          <td>Error Location</td>
        </tr>
        <tr class="even">
          <td>3</td>
          <td>705</td>
          <td>CWE</td>
          <td>R</td>
          <td>[1..1]</td>
          <td>0357</td>
          <td>01813</td>
          <td>HL7 Error Code</td>
        </tr>
        <tr class="odd">
          <td>4</td>
          <td>2</td>
          <td>ID</td>
          <td>R</td>
          <td>[1..1]</td>
          <td>0516</td>
          <td>01814</td>
          <td>Severity</td>
        </tr>
        <tr class="even">
          <td>5</td>
          <td>705</td>
          <td>CWE</td>
          <td>O</td>
          <td>[0..1]</td>
          <td>0533</td>
          <td>01815</td>
          <td>Application Error Code</td>
        </tr>
        <tr class="odd">
          <td>6</td>
          <td>80</td>
          <td>ST</td>
          <td>O</td>
          <td>[0..10]</td>
          <td />
          <td>01816</td>
          <td>Application Error Parameter</td>
        </tr>
        <tr class="even">
          <td>7</td>
          <td>2048</td>
          <td>TX</td>
          <td>O</td>
          <td>[0..1]</td>
          <td />
          <td>01817</td>
          <td>Diagnostic Information</td>
        </tr>
        <tr class="odd">
          <td>8</td>
          <td>250</td>
          <td>TX</td>
          <td>O</td>
          <td>[0..1]</td>
          <td />
          <td>01818</td>
          <td>User Message</td>
        </tr>
        <tr class="even">
          <td>9</td>
          <td>20</td>
          <td>IS</td>
          <td>O</td>
          <td>[0..*]</td>
          <td>0517</td>
          <td>01819</td>
          <td>Inform Person Indicator</td>
        </tr>
        <tr class="odd">
          <td>10</td>
          <td>705</td>
          <td>CWE</td>
          <td>O</td>
          <td>[0..1]</td>
          <td>0518</td>
          <td>01820</td>
          <td>Override Type</td>
        </tr>
        <tr class="even">
          <td>11</td>
          <td>705</td>
          <td>CWE</td>
          <td>O</td>
          <td>[0..*]</td>
          <td>0519</td>
          <td>01821</td>
          <td>Override Reason Code</td>
        </tr>
        <tr class="odd">
          <td>12</td>
          <td>652</td>
          <td>XTN</td>
          <td>O</td>
          <td>[0..*]</td>
          <td />
          <td>01822</td>
          <td>Help Desk Contact Point</td>
        </tr>
      </tbody>
    </table>
    <p>
      ERR-1 is deprecated in HL7 Version 2.5 (
      <em>i.e.</em>
      , retained for backward compatibility only) and therefore not supported by IHE.
    </p>
    <p>
      ERR-2 is populated except when the error is not within an HL7 field, component or subcomponent. For example, if the receiver returns an acknowledgement containing
      <em>MSA-2-acknowledgement code</em>
      value AR or CR to indicate that the receiving application was unavailable, ERR-2 is not populated.
    </p>
    <p>ERR-3 HL7 Error Code (CWE) is required. It identifies the HL7 (communication) error code. Valid values are given by HL7 Table 0357:</p>
    <p>HL7 Table 0357: Message error condition codes</p>
    <table>
      <thead>
        <tr class="header">
          <th>Value</th>
          <th>Description</th>
          <th>Comment</th>
        </tr>
      </thead>
      <tbody>
        <tr class="odd">
          <td>0</td>
          <td>Message accepted</td>
          <td>Success. Optional, as the AA conveys success. Used for systems that must always return a status code.</td>
        </tr>
        <tr class="even">
          <td>100</td>
          <td>Segment sequence error</td>
          <td>Error: The message segments were not in the proper order, or required segments are missing.</td>
        </tr>
        <tr class="odd">
          <td>101</td>
          <td>Required field missing</td>
          <td>Error: A required field is missing from a segment</td>
        </tr>
        <tr class="even">
          <td>102</td>
          <td>Data type error</td>
          <td>Error: The field contained data of the wrong data type, e.g., an NM field contained "FOO".</td>
        </tr>
        <tr class="odd">
          <td>103</td>
          <td>Table value not found</td>
          <td>Error: A field of data type ID or IS was compared against the corresponding table, and no match was found.</td>
        </tr>
        <tr class="even">
          <td>200</td>
          <td>Unsupported message type</td>
          <td>Rejection: The Message Type is not supported.</td>
        </tr>
        <tr class="odd">
          <td>201</td>
          <td>Unsupported event code</td>
          <td>Rejection: The Event Code is not supported.</td>
        </tr>
        <tr class="even">
          <td>202</td>
          <td>Unsupported processing id</td>
          <td>Rejection: The Processing ID is not supported.</td>
        </tr>
        <tr class="odd">
          <td>203</td>
          <td>Unsupported version id</td>
          <td>Rejection: The Version ID is not supported.</td>
        </tr>
        <tr class="even">
          <td>204</td>
          <td>Unknown key identifier</td>
          <td>
            Rejection: The ID of the patient, order, etc., was not found. Used for transactions
            <em>other than</em>
            additions, e.g., transfer of a non-existent patient.
          </td>
        </tr>
        <tr class="odd">
          <td>205</td>
          <td>Duplicate key identifier</td>
          <td>Rejection: The ID of the patient, order, etc., already exists. Used in response to addition transactions (Admit, New Order, etc.).</td>
        </tr>
        <tr class="even">
          <td>206</td>
          <td>Application record locked</td>
          <td>Rejection: The transaction could not be performed at the application storage level, e.g., database locked.</td>
        </tr>
        <tr class="odd">
          <td>207</td>
          <td>Application internal error</td>
          <td>Rejection: A catchall for internal errors not explicitly covered by other codes.</td>
        </tr>
      </tbody>
    </table>
    <p>ERR-4 Severity (ID) is required. It identifies the severity of an application error. Valid values are given by HL7 Table 0516:</p>
    <p>HL7 Table 0516: Error severity</p>
    <table>
      <thead>
        <tr class="header">
          <th>Value</th>
          <th>Description</th>
          <th>Comment</th>
        </tr>
      </thead>
      <tbody>
        <tr class="odd">
          <td>W</td>
          <td>Warning</td>
          <td>Transaction successful, but there may be issues</td>
        </tr>
        <tr class="even">
          <td>I</td>
          <td>Information</td>
          <td>
            Transaction was successful but includes information,
            <em>e.g.,</em>
            inform patient
          </td>
        </tr>
        <tr class="odd">
          <td>E</td>
          <td>Error</td>
          <td>Transaction was unsuccessful</td>
        </tr>
      </tbody>
    </table>
    <h3 id="Appendix C.2.4">C.2.4 Common Segment Definitions</h3>
    <p>The following table specifies the contents of the EVN segment that is common to several HL7-based messages defined in ITI TF-2a and 2b.</p>
    <p>Table C.2.4-1: IHE Profile - EVN segment</p>
    <table>
      <tbody>
        <tr class="odd">
          <td>SEQ</td>
          <td>LEN</td>
          <td>DT</td>
          <td>OPT</td>
          <td>TBL#</td>
          <td>ITEM#</td>
          <td>ELEMENT NAME</td>
        </tr>
        <tr class="even">
          <td>1</td>
          <td>3</td>
          <td>ID</td>
          <td>O</td>
          <td>0003</td>
          <td>00099</td>
          <td>Event Type Code</td>
        </tr>
        <tr class="odd">
          <td>2</td>
          <td>26</td>
          <td>TS</td>
          <td>R</td>
          <td />
          <td>00100</td>
          <td>Recorded Date/Time</td>
        </tr>
        <tr class="even">
          <td>3</td>
          <td>26</td>
          <td>TS</td>
          <td>O</td>
          <td />
          <td>00101</td>
          <td>Date/Time Planned Event</td>
        </tr>
        <tr class="odd">
          <td>4</td>
          <td>3</td>
          <td>IS</td>
          <td>O</td>
          <td>0062</td>
          <td>00102</td>
          <td>Event Reason Code</td>
        </tr>
        <tr class="even">
          <td>5</td>
          <td>60</td>
          <td>XCN</td>
          <td>O</td>
          <td>0188</td>
          <td>00103</td>
          <td>Operator ID</td>
        </tr>
        <tr class="odd">
          <td>6</td>
          <td>26</td>
          <td>TS</td>
          <td>R2</td>
          <td />
          <td>01278</td>
          <td>Event Occurred</td>
        </tr>
        <tr class="even">
          <td>7</td>
          <td>180</td>
          <td>HD</td>
          <td>
            <p>O</p>
            <p>(Note 1)</p>
          </td>
          <td />
          <td>01534</td>
          <td>Event Facility #</td>
        </tr>
      </tbody>
    </table>
    <p>
      <em>Adapted from the HL7 Standard, version 2.5 and version 2.3.1</em>
    </p>
    <p>Note 1: This element is only applicable in HL7 version 2.5 and thus is only applicable for those transactions based on HL7 v2.5</p>
    <p>
      Field
      <em>EVN-1-Event Type Code</em>
      is optional; however, if present, its value shall be equal to the second component of the field
      <em>MSH-9-Message Type</em>
      .
    </p>
    <h3 id="Appendix C.2.5">C.2.5 Message granularity</h3>
    <p>The sending application shall send as many messages as there are events recorded. For instance, if at the same time there is a change both to the patient’s location (from emergency room to GI surgery ward) and to the patient’s attending doctor (from Dr. Eric Emergency to Dr. John Appendectomy), the sending application will transmit two movements using HL7 messages ADT^A02 (transfer) and ADT^A54 (change attending doctor). Both events will have the same effective date/time (EVN-6 – Event Occurred). If the Historic Movement Option is in use, each of these movements will have a unique identifier.</p>
    <p>The exceptions to this fine granularity are:</p>
    <ul>
      <li>
        <p>The Admit Inpatient (A01) and Register Outpatient (A04) events can also assign a location and an attending doctor to the patient, known when the event is recorded.</p>
      </li>
      <li>
        <p>A change of patient class (A06 or A07) also assigns at the same time a new location to the patient.</p>
      </li>
      <li>
        <p>The Cancel Discharge/End Visit event also includes at the same time the patient location after the cancellation has been processed.</p>
      </li>
    </ul>
    <h3 id="Appendix C.2.6">C.2.6 HL7 empty field convention</h3>
    <p>According to the HL7 standard, if the value of a field is not present, the receiver shall not change corresponding data in its database. However, if the sender defines the field value to be the explicit NULL value (i.e., two double quotes ""), it shall cause removal of any values for that field in the receiver's database. This convention is fully applied by IHE profiles based on HL7 v2.x messages.</p>
  </body>
</html>
