<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta charset="utf-8" />
    <title>IHE_ITI_TF_Rev16-0_Vol2b_FT</title>
    <link rel="stylesheet" href="../css/styles.css" />
  </head>
  <body>
    <p>
      <img src="media/image1.jpeg" class="IHE logo" alt="IHE_LOGO_for_tf-docs" />
    </p>
    <p>IHE IT Infrastructure (ITI)</p>
    <p>Technical Framework - Volume2b</p>
    <p>Revision 16.0 – Final Text</p>
    <p>
      <hr />
    </p>
    <h2 class="list-paragraph" id="3.42">3.42 Register Document Set-b [ITI-42]</h2>
    <p>This section corresponds to transaction [ITI-42] of the IHE IT Infrastructure Technical Framework. Register Document Set-b is used to register a set of document-associated metadata.</p>
    <h3 class="list-paragraph" id="3.42.1">3.42.1 Scope</h3>
    <p>The Register Document Set-b transaction passes a Document Submission Request (see <a href="../Volume3/ch-1.2.html#4.2.1.5">ITI TF-3: 4.2.1.5</a>) from a Content Sender to a Content Receiver.</p>
    <h3 class="list-paragraph" id="3.42.2">3.42.2 Actor Roles</h3>
    <p>The roles in this transaction are defined in the following table and may be played by the actors shown here:</p>
    <p id="Table 3.42.2-1">Table 3.42.2-1: Actor Roles</p>
    <table>
      <thead>
        <tr class="header">
          <th>
            <em>Role:</em>
          </th>
          <th>Content Sender: A system that submits a document metadata to a Content Receiver.</th>
        </tr>
      </thead>
      <tbody>
        <tr class="odd">
          <td>Actor(s):</td>
          <td>
            The following actors may play the role of Content Sender:
            <br />
            Document Repository, Integrated Document Source/Repository
          </td>
        </tr>
        <tr class="even">
          <td>Role:</td>
          <td>Content Receiver: A system that receives document metadata.</td>
        </tr>
        <tr class="odd">
          <td>Actor(s):</td>
          <td>
            The following actors may play the role of Content Receiver:
            <br />
            Document Registry
          </td>
        </tr>
      </tbody>
    </table>
    <p>Transaction text specifies behavior for each Role. The behavior of specific Actors may also be specified when it goes beyond that of the general Role.</p>
    <h3 class="list-paragraph" id="3.42.3">3.42.3 Referenced Standards</h3>
    <table>
      <thead>
        <tr class="header">
          <th>ebRIM</th>
          <th>
            <p>OASIS/ebXML Registry Information Model v3.0</p>
            <p>This model defines the types of metadata and content that can be stored in an ebXML Registry, a basis for and subset of Document Sharing metadata.</p>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr class="odd">
          <td>ebRS</td>
          <td>
            <p>OASIS/ebXML Registry Services Specifications v3.0</p>
            <p>This defines the services and protocols for an ebXML Registry, used as the basis for the XDS Document Registry</p>
          </td>
        </tr>
        <tr class="even">
          <td>HL7V2</td>
          <td>HL7 Version 2.5</td>
        </tr>
        <tr class="odd">
          <td>
            <p>See <a href="../Volume2x/ch-22.html#Appendix V">ITI TF-2x: Appendix V</a> for other referenced standards for SOAP encoding.</p>
            <p>See <a href="../Volume3/ch-1.2.html#4.2">ITI TF-3: 4.2</a> for other referenced standards for metadata element encoding.</p>
          </td>
          <td />
        </tr>
      </tbody>
    </table>
    <h3 class="list-paragraph" id="3.42.4">3.42.4 Messages</h3>
    <p id="Figure 3.42.4-1">Figure 3.42.4-1: Interaction Diagram</p>
    <h4 class="list-paragraph" id="3.42.4.1">3.42.4.1 Register Document Set-b Request</h4>
    <p>The Register Document Set-b Request message is used to register patient-specific healthcare documents through the use of metadata. Metadata enables the receiver to process the content of the message programmatically, without needing to understand the format or contents of the documents. For more details about metadata in the context of Document Sharing, see <a href="../Volume3/ch-1.html#4">ITI TF-3:4</a>.</p>
    <p>The Content Sender sends metadata for a set of documents to the Content Receiver.</p>
    <h5 class="list-paragraph" id="3.42.4.1.1">3.42.4.1.1 Trigger Events</h5>
    <p>The Register Document Set-b Request message is triggered when a Content Sender wants to register metadata for a set of documents it holds. These documents may have been stored in the Document Repository by a Document Source (using the Provide and Register Document Set-b transaction [ITI-41]) or generated internally by an Integrated Document Source/Repository.</p>
    <p>If an Integrated Document Source/Repository supports the Delayed Document Assembly Option and is registering a Stable Document Entry with size=0, it shall internally mark the document contents that will be assembled if a Retrieve Document Set [ITI-43] transaction is received containing the uniqueID of the registered Stable Document Entry.</p>
    <h5 class="list-paragraph" id="3.42.4.1.2">3.42.4.1.2 Message Semantics</h5>
    <p>The Register Document Set-b Request message shall use SOAP 1.2 and Simple SOAP. Implementors of this transaction shall comply with all requirements described in: <a href="../Volume2x/ch-22.html#Appendix V">ITI TF-2x: Appendix V</a>: Web Services for IHE Transactions.</p>
    <p>The Register Document Set-b Request message shall contain a Submission Request, as defined in <a href="../Volume3/ch-1.1.html#4.1.4">ITI TF-3: 4.1.4</a>.</p>
    <p>If the associationType is RPLC, XFRM_RPLC, or IsSnapshotOf, the targetObject of the Relationship Association in the Submission Request shall be a DocumentEntry already in the Document Registry.</p>
    <p>All DocumentEntry objects in this Submission Request shall be Stable DocumentEntry objects and, therefore, will not be On-Demand DocumentEntry objects. Associations included in the Submission Request may reference On-Demand DocumentEntry objects that have been registered previously.</p>
    <p>See <a href="../Volume3/ch-1.2.html#4.2.1.4">ITI TF-3: 4.2.1.4</a> for a description of the ebRS/ebRIM representation of a Submission Request. The metadata requirements for this Submission Request are defined in <a href="../Volume3/ch-1.3.html#4.3.1">ITI TF-3: 4.3.1</a>.</p>
    <p>A full example of document metadata submission can be found in <a href="../Volume2x/ch-23.html#Appendix W">ITI TF-2x: Appendix W</a>.</p>
    <p>XML namespace prefixes used in text and in examples below are for informative purposes only and are documented in <a href="../Volume2x/ch-22.html#Appendix V">ITI TF-2x: Appendix V</a>, Table V.2.4-1.</p>
    <p>The requirements for the request message are:</p>
    <ul>
      <li>
        <p>the &lt;wsa:Action&gt; SOAP element shall contain the value urn:ihe:iti:2007:RegisterDocumentSet-b</p>
      </li>
      <li>
        <p>the &lt;soap12:Body&gt; shall contain one &lt;lcm:SubmitObjectsRequest&gt; element representing the Submission Request (see <a href="../Volume3/ch-1.2.html#4.2.1.4">ITI TF-3: 4.2.1.4</a> for details of expressing a Submission Request).</p>
      </li>
    </ul>
    <p>A full XML Schema Document for the XDS types is available online on the IHE FTP site, see <a href="../Volume2x/ch-23.html#Appendix W">ITI TF-2x: Appendix W</a>.</p>
    <p>Below is an example of the SOAP Body for a Register Document Set-b Request message</p>
    <p>&lt;soap12:Body&gt;</p>
    <p>&lt;lcm:SubmitObjectsRequest&gt;</p>
    <p>&lt;!-- Submission Request contents – See <a href="../Volume3/ch-1.2.html#4.2.1.4">ITI TF-3: 4.2.1.4</a> --&gt;</p>
    <p>&lt;rim:RegistryObjectList&gt;</p>
    <p>&lt;!-- Registry Metadata goes here --&gt;</p>
    <p>&lt;/rim:RegistryObjectList&gt;</p>
    <p>&lt;/lcm:SubmitObjectsRequest&gt;</p>
    <p>&lt;/soap12:Body&gt;</p>
    <p>If the Content Sender supports the Asynchronous Web Services Exchange Option, it shall be able to generate a WS-Addressing based Asynchronous Web Services request as defined in <a href="../Volume2x/ch-22.html#Appendix V.3">ITI TF-2x: Appendix V.3</a>.</p>
    <h6 class="list-paragraph" id="3.42.4.1.2.1">3.42.4.1.2.1 Integrated Document Source / Repository Message Semantics</h6>
    <p>The Integrated Document Source / Repository may choose to support options which are listed in ITI TF-1: Table 10.2-1b and described in the sections that follow it.</p>
    <p>If the Integrated Document Source / Repository supports the Document Replacement Option, it shall be able to generate replace semantics as defined in ITI TF-3: 4.2.2.2.3.</p>
    <p>If the Integrated Document Source / Repository supports the Document Addendum Option, it shall be able to generate append semantics as defined in ITI TF-3: 4.2.2.2.1.</p>
    <p>If the Integrated Document Source / Repository supports the Document Transformation Option, it shall be able to generate transformation semantics as defined in ITI TF-3: 4.2.2.2.2.</p>
    <p>If the Integrated Document Source / Repository supports the Folder Management Option it, shall be able to generate folder semantics as defined in <a href="../Volume3/ch-1.2.html#4.2.1.3">ITI TF-3: 4.2.1.3</a> and <a href="../Volume3/ch-1.2.html#4.2.2.1.5">ITI TF-3: 4.2.2.1.5</a>.</p>
    <p>If the Integrated Document Source / Repository supports the Basic Patient Privacy Enforcement Option, it shall comply with the requirements as described in <a href="../Volume1/ch-10.html#10.2.9">ITI TF-1: 10.2.9</a>.</p>
    <p>If the Integrated Document Source/Repository supports the Delayed Document Assembly Option, shall be able to register a Stable Document Entry with the following attribute values</p>
    <ul>
      <li>
        <p>size = 0 (zero)</p>
      </li>
      <li>
        <p>hash = da39a3ee5e6b4b0d3255bfef95601890afd80709 (SHA1 hash of a zero length file).</p>
      </li>
    </ul>
    <h5 class="list-paragraph" id="3.42.4.1.3">3.42.4.1.3 Expected Actions</h5>
    <p>Upon receipt of a Register Document Set-b Request message, the Document Registry shall:</p>
    <ul>
      <li>
        <p>Perform metadata validations</p>
      </li>
      <li>
        <p>Store all IHE-defined metadata attributes received so that it is available to return in responses to future queries.</p>
      </li>
      <li>
        <p>Return a response message giving the status of the operation.</p>
      </li>
    </ul>
    <p>If the Document Registry rejects the metadata, it shall:</p>
    <ul>
      <li>
        <p>Return an error including at least one error message in the response. For a complete list of applicable codes, refer to ITI TF-3: Table 4.2.4.1-2.</p>
      </li>
      <li>
        <p>Roll back any changes made.</p>
      </li>
    </ul>
    <h6 class="list-paragraph" id="3.42.4.1.3.1">3.42.4.1.3.1 Atomicity of Submissions</h6>
    <p>XDS Submission requests shall be atomic operations. If any part of the Submission Request processing fails, the entire transaction shall fail and no changes result.</p>
    <p>No result of a Submission Request shall be made available until the atomic operation has successfully completed.</p>
    <h6 class="list-paragraph" id="3.42.4.1.3.2">3.42.4.1.3.2 Extra Metadata</h6>
    <p>The Document Registry may save extra metadata attributes.</p>
    <ul>
      <li>
        <p>If the Document Registry saves the extra metadata attributes, it shall include that metadata in later query responses. </p>
      </li>
      <li>
        <p>If there are extra metadata attributes in the Submission Request and the Document Registry does not save them, the Document Registry shall include the XDSExtraMetadataNotSaved warning in its response, as described in <a href="../Volume3/ch-1.2.html#4.2.3.1.6">ITI TF-3: 4.2.3.1.6</a></p>
      </li>
      <li>
        <p>Document Registry Actors that do not support the Reference ID Option may treat referenceIdList as a non-IHE-defined metadata attribute.</p>
      </li>
    </ul>
    <p>The Document Registry shall verify that extra metadata attributes conform to the requirements in <a href="../Volume3/ch-1.2.html#4.2.3.1.6">ITI TF-3: 4.2.3.1.6</a>.</p>
    <h6 class="list-paragraph" id="3.42.4.1.3.3">3.42.4.1.3.3 Enforcement of Attributes</h6>
    <p>The Document Registry shall validate the Submission Request objects and attributes as specified in <a href="../Volume3/ch-1.2.html#4.2">ITI TF-3: 4.2</a> and 4.3.1. In addition, the following constraints apply.</p>
    <p class="heading list-paragraph" id="3.42.4.1.3.3.1">3.42.4.1.3.3.1 DocumentEntry.uniqueId</p>
    <p>The Document Registry shall reject the message and return an error if the uniqueId attribute matches the uniqueId attribute of a DocumentEntry within the Document Registry and the size attributes or hash attributes of the two DocumentEntry objects differ.</p>
    <p>If the uniqueId, size, and hash attributes of a received DocumentEntry match those of a DocumentEntry already within the Document Registry, processing of the submission shall continue without an error. Thus, multiple registered DocumentEntry objects can have the same uniqueId attribute value (as long as all the size and hash attributes are the same).</p>
    <p>Note: The Document Entries may reference the same instance of the document or may reference different (identical) copies of the document (for example, stored on different Document Repositories).</p>
    <p class="heading list-paragraph" id="3.42.4.1.3.3.2">3.42.4.1.3.3.2 patientId Attributes</p>
    <p>Values of DocumentEntry.patientId, Folder.patientId, and SubmissionSet.patientId shall be verified against the patient identifiers received in the Patient Identity Feed [ITI-8] indicating that they are registered with the Patient ID Domain of the Affinity Domain. This validation requirement does not apply to DocumentEntry.sourcePatentId.</p>
    <p>All objects in the Submission Request (DocumentEntry, Folder and SubmissionSet) shall have the same patientId.</p>
    <p>The value of the patientId attribute of a DocumentEntry object shall match the value of the patientId attribute of any Folder that it is a member of. This implies that all DocumentEntry objects in a Folder have the same patientId.</p>
    <p>When the Submission Request includes a Document Relationship Association, both DocumentEntry objects referenced by the Association shall have the same patientId.</p>
    <p class="heading list-paragraph" id="3.42.4.1.3.3.3">3.42.4.1.3.3.3 Coded Attributes</p>
    <p>The XDS Affinity Domain may allow only a finite set of values for a given coded attribute conforming to <a href="../Volume3/ch-1.2.html#4.2.3.1.2">ITI TF-3: 4.2.3.1.2</a> or may not restrict the values at all. If the XDS Affinity Domain allows only a finite set, the Document Registry shall constrain the value to those allowed by the XDS Affinity Domain.</p>
    <p>The Document Registry shall not constrain the displayName.</p>
    <p>Note: In this section, "value" refers to the combination of a codeSystem and code.</p>
    <p class="heading list-paragraph" id="3.42.4.1.3.3.4">3.42.4.1.3.3.4 DocumentEntry.mimeType</p>
    <p>The value of the DocumentEntry.mimeType shall be constrained to those allowed by the XDS Affinity Domain.</p>
    <p class="heading list-paragraph" id="3.42.4.1.3.3.5">3.42.4.1.3.3.5 DocumentEntry.availabilityStatus</p>
    <p>The Document Registry shall set the availabilityStatus of all newly added DocumentEntry objects to Approved.</p>
    <p class="heading list-paragraph" id="3.42.4.1.3.3.6">3.42.4.1.3.3.6 DocumentEntry.serviceStartTime and DocumentEntry.serviceStopTime</p>
    <p>If the serviceStartTime and serviceStopTime attributes are both populated for a Document Entry in the Submission Request, the Document Registry shall verify that the serviceStartTime is before or equal to the serviceStopTime.</p>
    <p class="heading" id="submissionset.uniqueid">3.42.4.1.3.3.7 SubmissionSet.uniqueId</p>
    <p>The Document Registry shall verify that the SubmissionSet.uniqueId is not used as the uniqueId for any existing object in the registry (DocumentEntry, SubmissionSet, or Folder).</p>
    <h6 class="list-paragraph" id="3.42.4.1.3.4">3.42.4.1.3.4 Folder Membership</h6>
    <p>When the Submission Request includes an FD-DE HasMember Association, which identifies a Document Entry as a member of a Folder, the Document Registry shall verify that both the Document Entry and Folder have a status of Approved.</p>
    <h6 class="list-paragraph" id="3.42.4.1.3.5">3.42.4.1.3.5 Document Relationships</h6>
    <p>When the Submission Request includes an Association between two DocumentEntry objects, the Document Registry shall verify that:</p>
    <ul>
      <li>
        <p>Both DocumentEntry objects have the same patient identifier (XDSDocumentEntry.patientId attribute); otherwise it shall return the error XDSPatientIdDoesNotMatch. This comparison shall take into consideration patient identity merges as described in <a href="../Volume2a/ITI-8.html#3.8.4.2.4">ITI TF-2a: 3.8.4.2.4</a>.</p>
      </li>
      <li>
        <p>The sourceObject references a DocumentEntry in the submission; otherwise it shall return the error UnresolvedReferenceException.</p>
      </li>
    </ul>
    <p>The Document Registry shall verify the targetObject according the following:</p>
    <ul>
      <li>
        <p>If the associationType is RPLC, XFRM_RPLC, or IsSnapshotOf, that the targetObject references a DocumentEntry in the Document Registry.</p>
      </li>
      <li>
        <p>For all other associationTypes, that the targetObject references a DocumentEntry in the Document Registry or in the submission.</p>
      </li>
    </ul>
    <p>If this verification on targetObject fails, the Document Registry shall return the error UnresolvedReferenceException.</p>
    <p>When the targetObject references a DocumentEntry in the Document Registry, the Document Registry shall verify that:</p>
    <ul>
      <li>
        <p>The targetObject DocumentEntry has an availabilityStatus of Approved; otherwise, it shall return the error XDSRegistryDeprecatedDocumentError. This ensures that only the most recent version of a document can be replaced, etc.</p>
      </li>
    </ul>
    <p>When the Association type is "RPLC" or "XFRM_RPLC", the Document Registry shall also:</p>
    <ul>
      <li>
        <p>Change the status of the DocumentEntry that is being replaced to Deprecated.</p>
      </li>
      <li>
        <p>Change the status of all DocumentEntry objects that are transformations (XFRM) or addenda (APND) of the DocumentEntry being replaced to Deprecated.</p>
      </li>
    </ul>
    <ul>
      <li>
        <blockquote>
          <p>If the DocumentEntry being replaced is a member of one or more approved Folders, the Document Registry shall also:</p>
        </blockquote>
      </li>
    </ul>
    <ol type="1">
      <li>
        <blockquote>
          <p>Verify the replacement DocumentEntry and approved Folders have the same patient identifier (XDSDocumentEntry.patientId and XDSFolder.patientId attributes); otherwise it shall return the error XDSPatientIdDoesNotMatch. This comparison shall take into consideration patient identity merges as described in <a href="../Volume2a/ITI-8.html#3.8.4.2.4">ITI TF-2a: 3.8.4.2.4</a>.</p>
        </blockquote>
      </li>
      <li>
        <blockquote>
          <p>Create a new FD-DE HasMember Association connecting the replacement DocumentEntry to each approved Folder that held the original DocumentEntry as a member.</p>
        </blockquote>
      </li>
      <li>
        <blockquote>
          <p>For each FD-DE HasMember Association created, create a new SS-HM HasMember Association connecting the new FD-DE HasMember Association to the replacement DocumentEntry's Submission Set.</p>
        </blockquote>
      </li>
    </ol>
    <p>Note: For "RPLC" and "XFRM_RPLC" relationships, earlier versions of the Technical Framework referenced the error XDSReplaceFailed when verification fails. That error has been deprecated.</p>
    <p>When the Association type is "IsSnapshotOf", the Document Registry shall also:</p>
    <ul>
      <li>
        <p>Verify sourceObject references a Stable DocumentEntry</p>
      </li>
      <li>
        <p>Verify targetObject references an On-Demand DocumentEntry</p>
      </li>
    </ul>
    <p>As per Section 3.42.4.1.4.1, no changes to the status of any object shall occur if the Submission Request is not accepted and committed.</p>
    <h6 class="list-paragraph" id="3.42.4.1.3.6">3.42.4.1.3.6 Updates to Folder.lastUpdateTime</h6>
    <p>If the submission results in any DocumentEntry being placed into any Folder, the Document Registry shall set the lastUpdateTime attribute of those Folders to the current time. This includes Folders included in the Submission Request as well as Folders already existing in the Document Registry that are referenced by the Submission Request.</p>
    <p>As per Section 3.42.4.1.4.1, no changes to the lastUpdateTime of any Folder shall occur if the Submission Request is not accepted and committed.</p>
    <h6 class="list-paragraph" id="3.42.4.1.3.7">3.42.4.1.3.7 UUIDs and Symbolic Ids</h6>
    <p>Objects in the Submission Request have several UUID fields conforming to <a href="../Volume3/ch-1.2.html#4.2.3.1.5">ITI TF-3: 4.2.3.1.5</a>.</p>
    <p>If a field is formatted as a symbolic Id in the Submission Request, the Document Registry shall replace it with newly generated, properly formatted UUIDs upon acceptance of the submission. If the same symbolic Id appears more than once in the Submission Request, it shall be replaced with the same generated UUID.</p>
    <p>If a field is formatted as a valid UUID in the Submission Request, the Document Registry shall not change the value. </p>
    <p>Once a UUID-format Id value is assigned to a Registry Object, that value is permanent and shall not be changed.</p>
    <h4 class="list-paragraph" id="3.42.4.2">3.42.4.2 Register Document Set-b Response</h4>
    <h5 class="list-paragraph" id="3.42.4.2.1">3.42.4.2.1 Trigger Events</h5>
    <p>The Content Receiver finishes processing a Register Document Set-b Request Message and shall respond with Register Document Set-b Response</p>
    <h5 class="list-paragraph" id="3.42.4.2.2">3.42.4.2.2 Message Semantics</h5>
    <p>The Register Document Set-b Response message shall use SOAP 1.2 and Simple SOAP. Implementors of this transaction shall comply with all requirements described in: <a href="../Volume2x/ch-22.html#Appendix V">ITI TF-2x: Appendix V</a>: Web Services for IHE Transactions.</p>
    <p>The Register Document Set-b Response message shall carry the status of the requested operation. The response message may carry warning messages. If the requested operation fails, the response message shall carry at least one error message. The conditions of failure and possible warning and error messages are given in the ebRS standard and detailed in <a href="../Volume3/ch-1.2.html#4.2.4">ITI TF-3: 4.2.4</a> Error Reporting. This transaction does not support a partial success response.</p>
    <p>XML namespace prefixes used in text and in examples below are for informational purposes only and are documented in <a href="../Volume2x/ch-22.html#Appendix V">ITI TF-2x: Appendix V</a>, Table V.2.4-1.</p>
    <p>The requirements for the response message are:</p>
    <ul>
      <li>
        <p>the &lt;wsa:Action&gt; soap header shall contain the value urn:ihe:iti:2007:RegisterDocumentSet-bResponse</p>
      </li>
      <li>
        <p>the &lt;soap12:Body&gt; soap element shall contain one &lt;rs:RegistryResponse&gt; element</p>
      </li>
    </ul>
    <p>See <a href="../Volume3/ch-1.2.html#4.2.4">ITI TF-3: 4.2.4</a> for examples of response messages.</p>
    <p>If the Document Registry supports the Asynchronous Web Services Exchange Option and it receives a WS-Addressing based Asynchronous Web Services request, it shall respond as defined in <a href="../Volume2x/ch-22.html#Appendix V.3">ITI TF-2x: Appendix V.3</a>.</p>
    <h5 class="list-paragraph" id="3.42.4.2.3">3.42.4.2.3 Expected Actions</h5>
    <p>The Content Sender now knows that the transaction succeeded/failed and can continue. The metadata added to the Document Registry as a result of this transaction is now available for discovery.</p>
    <h6 class="list-paragraph" id="3.42.4.2.3.1">3.42.4.2.3.1 Document Repository Expected Actions</h6>
    <p>If the Register Document Set-b [ITI-42] response includes any errors or warnings, the Document Repository shall include all such errors and warnings in the Provide and Register Document Set-b [ITI-41] response.</p>
    <h3 class="list-paragraph" id="3.42.5">3.42.5 Security Considerations</h3>
    <p>Relevant XDS Affinity Domain Security background is discussed in the XDS Security Considerations Section (see <a href="../Volume1/ch-10.html#10.7">ITI TF-1: 10.7</a>).</p>
    <h4 class="list-paragraph" id="3.42.5.1">3.42.5.1 Audit Record Considerations</h4>
    <p>The Register Document Set-b transaction is either a PHI-Import event or a PHI-Export event, depending on actor, as defined in ITI TF-2a: Table 3.20.4.1.1.1-1, with the following exceptions.</p>
    <h5 class="list-paragraph" id="3.42.5.1.1">3.42.5.1.1 Document Repository or Integrated Document Source/Repository audit message:</h5>
    <table>
      <tbody>
        <tr class="odd">
          <td />
          <td>Field Name</td>
          <td>Opt</td>
          <td>Value Constraints</td>
        </tr>
        <tr class="even">
          <td>
            <p>Event</p>
            <p>
              AuditMessage/
              <br />
              EventIdentification
            </p>
          </td>
          <td>EventID</td>
          <td>M</td>
          <td>EV(110106, DCM, “Export”)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>EventActionCode</td>
          <td>M</td>
          <td>“R” (Read)</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>EventDateTime</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>EventOutcomeIndicator</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>EventTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-42”, “IHE Transactions”, “Register Document Set-b”)</td>
        </tr>
        <tr class="odd">
          <td>Source (Document Repository or Integrated Document Source/Repository) (1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="even">
          <td>Human Requestor (0..n)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="odd">
          <td>Destination (Document Registry) (1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="even">
          <td>Audit Source (Document Repository or Integrated Document Source/Repository) (1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="odd">
          <td>Patient (0..1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="even">
          <td>SubmissionSet (1)</td>
          <td />
          <td />
          <td />
        </tr>
      </tbody>
    </table>
    <p>Where:</p>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Source</p>
            <p>
              AuditMessage/
              <br />
              ActiveParticipant
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>If Asynchronous Web Services Exchange is being used, the content of the &lt;wsa:ReplyTo/&gt; element. Otherwise, not specialized.</td>
        </tr>
        <tr class="even">
          <td />
          <td>AlternativeUserID</td>
          <td>M</td>
          <td>the process ID as used within the local operating system in the local system logs.</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>UserName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>UserIsRequestor</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110153, DCM, “Source”)</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>NetworkAccessPointTypeCode</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>NetworkAccessPointID</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>The machine name or IP address.</td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Human Requestor (if known)</p>
            <p>
              AuditMessage/
              <br />
              ActiveParticipant
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>Identity of the human that initiated the transaction.</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>AlternativeUserID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>UserName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>UserIsRequestor</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>RoleIDCode</td>
          <td>U</td>
          <td>Access Control role(s) the user holds that allows this transaction.</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>NetworkAccessPointTypeCode</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>NetworkAccessPointID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Destination</p>
            <p>
              AuditMessage/
              <br />
              ActiveParticipant
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>SOAP endpoint URI.</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>AlternativeUserID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>UserName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>UserIsRequestor</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>“false”</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110152, DCM, “Destination”)</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>NetworkAccessPointTypeCode</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>NetworkAccessPointID</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>The machine name or IP address.</td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Audit Source</p>
            <p>
              AuditMessage/
              <br />
              AuditSourceIdentification
            </p>
          </td>
          <td>
            <em>AuditSourceID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>AuditEnterpriseSiteID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>AuditSourceTypeCode</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Patient (if known)</p>
            <p>
              (AuditMessage/
              <br />
              ParticipantObjectIdentification)
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“1” (person)</td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“1” (patient)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDataLifeCycle</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectIDTypeCode</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectSensitivity</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>the patient ID in HL7 CX format.</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectQuery</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDetail</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Submission Set</p>
            <p>
              (AuditMessage/
              <br />
              ParticipantObjectIdentification)
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“2” (System)</td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“20” (job)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDataLifeCycle</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>EV(“urn:uuid:a54d6aa5-d40d-43f9-88c5-b4633d873bdd”, “IHE XDS Metadata”, “submission set classificationNode”)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectSensitivity</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectID</td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>The submissionSet unique ID</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectQuery</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDetail</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <h5 id="3.42.5.1.2">3.42.5.1.2 Document Registry audit message:</h5>
    <table>
      <tbody>
        <tr class="odd">
          <td />
          <td>Field Name</td>
          <td>Opt</td>
          <td>Value Constraints</td>
        </tr>
        <tr class="even">
          <td>
            <p>Event</p>
            <p>
              AuditMessage/
              <br />
              EventIdentification
            </p>
          </td>
          <td>EventID</td>
          <td>M</td>
          <td>EV(110107, DCM, “Import”)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>EventActionCode</td>
          <td>M</td>
          <td>“C” (Create)</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>EventDateTime</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>EventOutcomeIndicator</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>EventTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-42”, “IHE Transactions”, “Register Document Set-b”)</td>
        </tr>
        <tr class="odd">
          <td>Source (Document Repository or Integrated Document Source/Repository) (1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="even">
          <td>Destination (Document Registry ) (1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="odd">
          <td>Audit Source (Document Registry) (1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="even">
          <td>Patient (0..1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="odd">
          <td>SubmissionSet (1)</td>
          <td />
          <td />
          <td />
        </tr>
      </tbody>
    </table>
    <p>Where:</p>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Source</p>
            <p>
              AuditMessage/
              <br />
              ActiveParticipant
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>If Asynchronous Web Services Exchange is being used, the content of the &lt;wsa:ReplyTo/&gt; element. Otherwise, not specialized.</td>
        </tr>
        <tr class="even">
          <td />
          <td>AlternativeUserID</td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>UserName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>UserIsRequestor</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110153, DCM, “Source”)</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>NetworkAccessPointTypeCode</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>NetworkAccessPointID</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>The machine name or IP address.</td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Destination</p>
            <p>
              AuditMessage/
              <br />
              ActiveParticipant
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>SOAP endpoint URI</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>AlternativeUserID</em>
          </td>
          <td>M</td>
          <td>the process ID as used within the local operating system in the local system logs.</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>UserName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>UserIsRequestor</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>“false”</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110152, DCM, “Destination”)</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>NetworkAccessPointTypeCode</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>NetworkAccessPointID</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>The machine name or IP address.</td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Audit Source</p>
            <p>
              AuditMessage/
              <br />
              AuditSourceIdentification
            </p>
          </td>
          <td>
            <em>AuditSourceID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>AuditEnterpriseSiteID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>AuditSourceTypeCode</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Patient (if known)</p>
            <p>
              (AuditMessage/
              <br />
              ParticipantObjectIdentification)
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“1” (person)</td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“1” (patient)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDataLifeCycle</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectIDTypeCode</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectSensitivity</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>the patient ID in HL7 CX format.</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectQuery</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDetail</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Submission Set</p>
            <p>
              (AuditMessage/
              <br />
              ParticipantObjectIdentification)
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“2” (System)</td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“20” (job)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDataLifeCycle</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>EV(“urn:uuid:a54d6aa5-d40d-43f9-88c5-b4633d873bdd”, “IHE XDS Metadata”, “submission set classificationNode”)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectSensitivity</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectID</td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>The submissionSet unique ID</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectQuery</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDetail</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>
