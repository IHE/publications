<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta charset="utf-8" />
    <title>IHE_ITI_TF_Rev16-0_Vol2b_FT</title>
    <link rel="stylesheet" href="../css/styles.css" />
  </head>
  <body>
    <p>
      <img src="media/image1.jpeg" class="IHE logo" alt="IHE_LOGO_for_tf-docs" />
    </p>
    <p>IHE IT Infrastructure (ITI)</p>
    <p>Technical Framework</p>
    <p>Revision 16.0 – Final Text</p>
    <p>
      <hr />
    </p>
    <h2 xmlns="" id="3.36">3.36 Archive Form [ITI-36]</h2>
    <p xmlns="">
      <span>This section corresponds to transaction [ITI-36] of the IHE IT Infrastructure Technical Framework. Transaction [ITI-36] is used by the Form Filler and Form Archiver Actors.</span>
    </p>
    <h3 xmlns="" id="3.36.1">3.36.1 Scope</h3>
    <p xmlns="">
      <span>This transaction involves a Form Filler submitting form instance data to a Form Archiver.</span>
    </p>
    <h3 xmlns="" id="3.36.2">3.36.2 Use Case Roles</h3>
    <img xmlns="" src="media/ak3aq-ow60c.023.png" width="373" height="129" alt="" />
    <p xmlns="">
      <span style="font-family:'Times New Roman'; font-weight:bold">Actor:</span>
      <span>Form Filler</span>
    </p>
    <p xmlns="">
      <span style="font-family:'Times New Roman'; font-weight:bold">Role:</span>
      <span>A forms display and editing system capable of allowing form fields to be completed.</span>
    </p>
    <p xmlns="">
      <span style="font-family:'Times New Roman'; font-weight:bold">Actor:</span>
      <span>Form Archiver</span>
    </p>
    <p xmlns="">
      <span style="font-family:'Times New Roman'; font-weight:bold">Role:</span>
      <span>A system that receives submitted forms for archival purposes.</span>
    </p>
    <h3 xmlns="" id="3.36.3">3.36.3 Referenced Standards</h3>
    <p xmlns="">
      <span>Implementors of this transaction shall comply with all requirements described in <a href="../Volume2x/ch-22.html#Appendix V">ITI TF-2x: Appendix V</a>: Web Services for IHE Transactions.</span>
    </p>
    <p xmlns="">
      <span>RFC1738, Uniform Resource Locators (URL), December 1994,</span>
      <a href="http://www.faqs.org/rfcs/rfc1738.html" style="text-decoration:none">
        <span style="font-family:'Times New Roman'; text-decoration:underline; color:#0000ff">http://www.faqs.org/rfcs/rfc1738.html</span>
      </a>
    </p>
    <p xmlns="">
      <span>RFC2616 HyperText Transfer Protocol HTTP/1.1</span>
    </p>
    <p xmlns="">
      <span>Extensible Markup Language (XML) 1.0 (Second Edition). W3C Recommendation 6 October 2000. .</span>
      <a href="http://www.w3.org/TR/REC-xml" style="text-decoration:none">
        <span style="font-family:'Times New Roman'; text-decoration:underline; color:#0000ff">http://www.w3.org/TR/REC-xml</span>
      </a>
    </p>
    <h3 xmlns="" id="3.36.4">3.36.4 Messages</h3>
    <img xmlns="" src="media/ak3aq-ow60c.024.png" width="411" height="241" alt="" />
    <p xmlns="" style="font-size:11pt">
      <span style="font-family:Arial; font-weight:bold">Figure 3.36.4-1: Interaction Diagram</span>
    </p>
    <h4 xmlns="" id="3.36.4.1">3.36.4.1 Archive Form</h4>
    <p xmlns="">
      <span>This transaction is initiated by a Form Filler submitting a data to a Form Archiver for archival purposes.</span>
    </p>
    <h5 xmlns="" id="3.36.4.1.1">3.36.4.1.1 Trigger Events</h5>
    <p xmlns="">
      <span>The Form Filler shall use this transaction to submit data to a Form Archiver for archival purposes. The Archive Form transaction may be initiated by a Form Filler, or it may be triggered as a secondary submission action from within a form.</span>
    </p>
    <h5 xmlns="" id="3.36.4.1.2">3.36.4.1.2 Message Semantics</h5>
    <p xmlns="">
      <a name="_Toc169380328">
        <span>The Archive Form transaction shall carry a</span>
        <span>n</span>
        <span>ArchiveFormRequest element, with submitted form data as XML child elements of the ArchiveFormRequest element. Content profiles may further constrain the content of the ArchiveFormRequest element.</span>
      </a>
    </p>
    <p xmlns="">
      <span>See the schema provided with the support materials (see <a href="../Volume2x/ch-23.html#Appendix W">ITI TF-2x: Appendix W</a>).</span>
    </p>
    <h5 xmlns="" id="3.36.4.1.3">3.36.4.1.3 Expected Actions</h5>
    <p xmlns="">
      <span>Upon receipt of the Archive Form request, the Form Archiver shall return an ArchiveFormResponse element, or errors with SOAP Faults, for example if the posted data cannot be recognized.</span>
    </p>
    <p xmlns="">
      <span>The Form Filler may display the results of the response from the Form Archiver.</span>
    </p>
    <p xmlns="">
      <span>The Form Archiver shall use the SOAP Faults defined in Table 3.36.4.1.3-1 when appropriate. Form Fillers shall be capable of accepting other values beyond the ones specified here.</span>
    </p>
    <p xmlns="" style="font-size:11pt">
      <span style="font-family:Arial; font-weight:bold">Table 3.36.4.1.3-1: SOAP Faults</span>
    </p>
    <table xmlns="" cellspacing="0" cellpadding="0" style="">
      <tr style="height:13.85pt">
        <td style="width:187.2pt;background-color:#d9d9d9">
          <p style="font-size:9pt">
            <span style="font-family:Arial; font-weight:bold">Description of error</span>
          </p>
        </td>
        <td style="width:52.2pt;background-color:#d9d9d9">
          <p style="font-size:9pt">
            <span style="font-family:Arial; font-weight:bold">Code</span>
          </p>
        </td>
        <td style="width:128.7pt;background-color:#d9d9d9">
          <p style="font-size:9pt">
            <span style="font-family:Arial; font-weight:bold">Reason Text</span>
          </p>
        </td>
      </tr>
      <tr style="height:11.8pt">
        <td style="width:187.2pt">
          <p style="font-size:9pt">
            <span>Cannot recognize the posted data</span>
          </p>
        </td>
        <td style="width:52.2pt">
          <p style="font-size:9pt">
            <span>Sender</span>
          </p>
        </td>
        <td style="width:128.7pt">
          <p style="font-size:9pt">
            <span>Required Information Missing</span>
          </p>
        </td>
      </tr>
    </table>
    <p xmlns="">
      <span>An example of a SOAP Fault is:</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">&lt;env:Envelope xmlns:env="http://www.w3.org/2003/05/soap-envelope"</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">       xmlns:xml="http://www.w3.org/XML/1998/namespace"&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">&lt;env:Body&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">  &lt;env:Fault&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">    &lt;env:Code&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">      &lt;env:Value&gt;env:Sender&lt;/env:Value&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">    &lt;/env:Code&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">    &lt;env:Reason&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">      &lt;env:Text xml:lang="en"&gt;Required Information Missing&lt;/env:Text&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">    &lt;/env:Reason&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">  &lt;/env:Fault&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">&lt;/env:Body&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">&lt;/env:Envelope&gt;</span>
    </p>
    <h4 xmlns="" id="3.36.4.2">3.36.4.2 Archive Form Response</h4>
    <h5 xmlns="" id="3.36.4.2.1">3.36.4.2.1 Trigger Events</h5>
    <p xmlns="">
      <span>This message is triggered by a Form Filler archiving form instance data.</span>
    </p>
    <h5 xmlns="" id="3.36.4.2.2">3.36.4.2.2 Message Semantics</h5>
    <p xmlns="">
      <span>An ArchiveFormResponse element is returned, which contains:</span>
    </p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:46.52pt;padding-left:7.48pt">
        <span>A responseCode string that may be constrained by Content Profiles</span>
      </li>
    </ul>
    <p xmlns="">
      <span>See the schema provided with the support materials (see <a href="../Volume2x/ch-23.html#Appendix W">ITI TF-2x: Appendix W</a>).</span>
    </p>
    <h5 xmlns="" id="3.36.4.2.3">3.36.4.2.3 Expected Actions</h5>
    <p xmlns="">
      <span>The Form Filler may display the results of the response from the Form Archiver. The form behavior may be further profiled by content domain profiles.</span>
    </p>
    <h3 xmlns="" id="3.36.5">3.36.5 Protocol Requirements</h3>
    <p xmlns="">
      <span>The Archive Form request and response shall be transmitted using Synchronous Web Services Exchange, according to the requirements specified in <a href="../Volume2x/ch-22.html#Appendix V">ITI TF-2x: Appendix V</a>.</span>
    </p>
    <p xmlns="">
      <span>The Archive Form transaction shall use SOAP 1.2.</span>
    </p>
    <p xmlns="" style="font-size:11pt">
      <span style="font-family:Arial; font-weight:bold">WSDL Namespace Definitions</span>
    </p>
    <table xmlns="" cellspacing="0" cellpadding="0" style="">
      <tr>
        <td style="width:89.1pt">
          <p style="font-size:9pt">
            <span>ihe</span>
          </p>
        </td>
        <td style="width:299.7pt">
          <p style="font-size:9pt">
            <span>urn:ihe:iti:rfd:2007</span>
          </p>
        </td>
      </tr>
      <tr>
        <td style="width:89.1pt">
          <p style="font-size:9pt">
            <span>soap12</span>
          </p>
        </td>
        <td style="width:299.7pt">
          <p style="font-size:9pt">
            <span>http://schemas.xmlsoap.org/wsdl/soap12/</span>
          </p>
        </td>
      </tr>
      <tr>
        <td style="width:89.1pt">
          <p style="font-size:9pt">
            <span>wsaw</span>
          </p>
        </td>
        <td style="width:299.7pt">
          <p style="font-size:9pt">
            <span>http://www.w3.org/2005/08/addressing</span>
          </p>
        </td>
      </tr>
      <tr>
        <td style="width:89.1pt">
          <p style="font-size:9pt">
            <span>xsd</span>
          </p>
        </td>
        <td style="width:299.7pt">
          <p style="font-size:9pt">
            <span>http://www.w3.org/2001/XMLSchema</span>
          </p>
        </td>
      </tr>
    </table>
    <p xmlns="">
      <span>These are the requirements for the Archive Form transaction presented in the order in which they would appear in the Archive Form WSDL definition:</span>
    </p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>The following types shall be imported (xds:import) in the /definitions/types section:</span>
      </li>
    </ul>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:46.52pt;padding-left:7.48pt">
        <span>Namespace=”urn:ihe:iti:rfd:2007”, schema=”RFD.xsd”</span>
      </li>
    </ul>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>The /definitions/message/part/@element attribute of the Archive Form Request message shall be defined as: “ihe:ArchiveFormRequest”</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>The /definitions/message/part/@element attribute of the Archive Form Response message shall be defined as: “ihe:ArchiveFormResponse”</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Refer to Table 3.36.5-1 for additional attribute requirements.</span>
      </li>
    </ul>
    <p xmlns="" style="font-size:11pt">
      <span style="font-family:Arial; font-weight:bold">Table 3.36.5-1: Additional Attribute Requirements</span>
    </p>
    <table xmlns="" cellspacing="0" cellpadding="0" style="width:395.05pt">
      <tr>
        <td style="width:211.35pt;background-color:#e6e6e6">
          <p style="font-size:9pt">
            <span style="font-family:Arial; font-weight:bold">Attribute</span>
          </p>
        </td>
        <td style="width:161.35pt;background-color:#e6e6e6">
          <p style="font-size:9pt">
            <span style="font-family:Arial; font-weight:bold">Value</span>
          </p>
        </td>
      </tr>
      <tr>
        <td style="width:211.35pt">
          <p style="font-size:9pt">
            <span>/definitions/portType/operation@name</span>
          </p>
        </td>
        <td style="width:161.35pt">
          <p style="font-size:9pt">
            <span>ArchiveForm</span>
          </p>
        </td>
      </tr>
      <tr>
        <td style="width:211.35pt">
          <p style="font-size:9pt">
            <span>/definitions/portType/operation/input/@wsaw:Action</span>
          </p>
        </td>
        <td style="width:161.35pt">
          <p style="font-size:9pt">
            <span>urn:ihe:iti:2007:ArchiveForm</span>
          </p>
        </td>
      </tr>
      <tr>
        <td style="width:211.35pt">
          <p style="font-size:9pt">
            <span>/definitions/portType/operation/output/@wsaw:Action</span>
          </p>
        </td>
        <td style="width:161.35pt">
          <p style="font-size:9pt">
            <span>urn:ihe:iti:2007:ArchiveFormResponse</span>
          </p>
        </td>
      </tr>
      <tr>
        <td style="width:211.35pt">
          <p style="font-size:9pt">
            <span>/definitions/binding/operation/wsoap12:operation/@soapActionRequired</span>
          </p>
        </td>
        <td style="width:161.35pt">
          <p style="font-size:9pt">
            <span>false</span>
          </p>
        </td>
      </tr>
    </table>
    <p xmlns="">
      <span>These are the requirements that affect the wire format of the SOAP message. The other WSDL properties are only used within the WSDL definition and do not affect interoperability. Full sample request and response messages are in Section 3.36.5.1 Sample SOAP Messages.</span>
    </p>
    <p xmlns="">
      <span>For informative WSDL see <a href="../Volume2x/ch-23.html#Appendix W">ITI TF-2x: Appendix W</a>.</span>
    </p>
    <p xmlns="">
      <span>The &lt;ihe:ArchiveFormRequest&gt; element is defined as:</span>
    </p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>One or more &lt;xs:any&gt; elements</span>
      </li>
    </ul>
    <p xmlns="">
      <span>This allows the Form Manager to construct forms that archive form data using any XML representation.</span>
    </p>
    <p xmlns="">
      <span>The &lt;ihe:ArchiveFormResponse&gt; element is defined as:</span>
    </p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>A required &lt;ihe:responseCode&gt; element of type xs:string.</span>
      </li>
    </ul>
    <h4 xmlns="" id="3.36.5.1">3.36.5.1 Sample SOAP Messages</h4>
    <p xmlns="">
      <span>The samples in the following two sections show a typical SOAP request and its relative SOAP response. The sample messages also show the WS-Addressing headers &lt;Action/&gt;,</span>
    </p>
    <p xmlns="">
      <span>&lt;MessageID/&gt;, .; these WS-Addressing headers are populated according to <a href="../Volume2x/ch-22.html#Appendix V">ITI TF-2x: Appendix V</a>: Web Services for IHE Transactions. Some of the body of the SOAP message is omitted for brevity.</span>
    </p>
    <h5 xmlns="" id="3.36.5.1.1">3.36.5.1.1 Sample Archive Form SOAP Request</h5>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'; background-color:#ffffff">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">&lt;soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">&lt;soap:Header&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'"> </span>
      <span style="width:25.2pt; display:inline-block"> </span>
      <span style="width:36pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">&lt;wsa:To&gt;http://localhost:4040/axis2/services/someservice&lt;/wsa:To&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">    &lt;wsa:MessageID&gt;urn:uuid:76A2C3D9BCD3AECFF31217932910053&lt;/wsa:MessageID&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">    &lt;wsa:Action soap:mustUnderstand="1"&gt;urn:ihe:iti: 2007:ArchiveForm&lt;/wsa:Action&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">&lt;/soap:Header&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">&lt;soap:Body&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block">  </span>
      <span style="font-family:'Courier New'">&lt;ArchiveFormRequest xmlns="urn:ihe:iti:rfd:2007"&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block">   </span>
      <span style="font-family:'Courier New'">…</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block">  </span>
      <span style="font-family:'Courier New'">&lt;/ArchiveFormRequest&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">&lt;/soap:Body&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">&lt;/soap:Envelope&gt;</span>
    </p>
    <h5 xmlns="" id="3.36.5.1.2">3.36.5.1.2 Sample Archive Form SOAP Response</h5>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'; background-color:#ffffff">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">&lt;soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">&lt;soap:Header&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">       </span>
      <span style="width:28.79pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">&lt;wsa:To&gt;http://localhost:4040/axis2/services/someservice&lt;/wsa:To&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">        &lt;wsa:MessageID&gt;urn:uuid:76A2C3D9BCD3AECFF31217932910053&lt;/wsa:MessageID&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">        &lt;wsa:Action soap:mustUnderstand="1"&gt;urn:ihe:iti: 2007:ArchiveFormResponse&lt;/wsa:Action&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">&lt;/soap:Header&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">&lt;soap:Body&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block">  </span>
      <span style="font-family:'Courier New'">&lt;ArchiveResponse xmlns="urn:ihe:iti:rfd:2007"&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block">   </span>
      <span style="font-family:'Courier New'">&lt;responseCode /&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block">  </span>
      <span style="font-family:'Courier New'">&lt;/ArchiveFormResponse&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="width:36pt; display:inline-block"> </span>
      <span style="font-family:'Courier New'">&lt;/soap:Body&gt;</span>
    </p>
    <p xmlns="" style="font-size:9pt">
      <span style="font-family:'Courier New'">&lt;/soap:Envelope&gt;</span>
    </p>
    <h3 xmlns="" id="3.36.6">3.36.6 Security Considerations</h3>
    <p xmlns="">
      <span>As noted in the mitigations section of <a href="../Volume1/ch-17.html#17.5">ITI TF-1: 17.5</a> Security Considerations, endpoints are free to implement TLS as needed for additional privacy and protection. Content profiles, based upon the nature of the data, may require use of ATNA.</span>
    </p>
  </body>
</html>
