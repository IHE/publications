<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta charset="utf-8" />
    <title>IHE_ITI_TF_Rev16-0_Vol2b_FT</title>
    <link rel="stylesheet" href="../css/styles.css" />
  </head>
  <body>
    <p>
      <img src="media/image1.jpeg" class="IHE logo" alt="IHE_LOGO_for_tf-docs" />
    </p>
    <p>IHE IT Infrastructure (ITI)</p>
    <p>Technical Framework - Volume2b</p>
    <p>Revision 16.0 – Final Text</p>
    <p>
      <hr />
    </p>
    <h2 class="list-paragraph" id="3.52">3.52 Document Metadata Subscribe [ITI-52]</h2>
    <p>This section corresponds to transaction [ITI-52] of the IHE IT Infrastructure Technical Framework. Transaction [ITI-52] is used by the Document Metadata Subscriber and the Document Metadata Notification Broker Actors.</p>
    <h3 class="list-paragraph" id="3.52.1">3.52.1 Scope</h3>
    <p>This transaction involves a request by the Document Metadata Subscriber to the Document Metadata Notification Broker to start a subscription using a particular set of filters, or to cancel an existing subscription.</p>
    <h3 class="list-paragraph" id="3.52.2">3.52.2 Use Case Roles</h3>
    <p>
      <img src=".//media/image52.png" style="width:4.63819in;height:2.09236in" alt="dsub_ucr1" />
    </p>
    <p>Actor: Document Metadata Subscriber</p>
    <p>Role: Sends, on the behalf of Document Metadata Notification Recipients, subscription requests, or subscription cancellation messages to the Document Metadata Notification Broker</p>
    <p>Actor: Document Metadata Notification Broker</p>
    <p>Role: Manages subscriptions of Document Metadata Notification Recipients</p>
    <h3 class="list-paragraph" id="3.52.3">3.52.3 Referenced Standards</h3>
    <ul>
      <li>
        <p>
          <a href="http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=wsn">OASIS Web Services Notification Family of Standards</a>
        </p>
      </li>
      <li>
        <p>
          <a href="http://docs.oasis-open.org/wsn/wsn-ws_base_notification-1.3-spec-os.pdf">WS-BaseNotification 1.3 OASIS Standard</a>
        </p>
      </li>
      <li>
        <p>
          <a href="http://docs.oasis-open.org/wsn/wsn-ws_brokered_notification-1.3-spec-os.pdf">WS-BrokeredNotification 1.3 OASIS Standard</a>
        </p>
      </li>
      <li>
        <p>
          <a href="http://docs.oasis-open.org/wsn/wsn-ws_topics-1.3-spec-os.pdf">WS-Topics 1.3 OASIS Standard</a>
        </p>
      </li>
      <li>
        <p><a href="../Volume2a/ITI-18.html#3.18">ITI TF-2a: 3.18</a> - Registry Stored Query Transaction</p>
      </li>
      <li>
        <p><a href="../Volume2x/ch-22.html#Appendix V">ITI TF-2x: Appendix V</a></p>
      </li>
    </ul>
    <h3 class="list-paragraph" id="3.52.4">3.52.4 Messages</h3>
    <p>
      <img src=".//media/image53.png" style="width:3.93819in;height:3.46944in" alt="DSubscribe_ID" />
    </p>
    <p>Figure 3.52.4‑1: Document Metadata Subscribe Sequence</p>
    <h4 class="list-paragraph" id="3.52.4.1">3.52.4.1 Subscribe Request Message</h4>
    <h5 class="list-paragraph" id="3.52.4.1.1">3.52.4.1.1 Trigger</h5>
    <p>A Document Metadata Notification Recipient's need to initiate a subscription will cause the Document Metadata Subscriber to trigger a Subscribe Request message.</p>
    <h5 class="list-paragraph" id="3.52.4.1.2">3.52.4.1.2 Message Semantics</h5>
    <p>
      The Subscribe Request message shall comply with the requirements in the WS-BaseNotification standard. Note that the value of the WS-Addressing Action element is prescribed in the standard, and differs from the requirements of Appendix V. The
      <em>wsnt:ConsumerReference</em>
      element describes the Web Service endpoint where notifications must be sent. The
      <em>wsnt:Filter</em>
      element shall contain the topics and values for these topics for which a notification shall be sent. Implementers of the pattern shall specify the topic content to be put within the
      <em>wsnt:Filter</em>
      element. The wsnt:Filter element shall contain a
      <em>TopicExpression</em>
      element.
    </p>
    <p>This transaction uses simple topics in accordance with the WS-Topics standard and as specified in Section 3.52.5.</p>
    <p>This transaction uses a filter based on the Registry Stored Query [ITI-18] transaction syntax and semantics as specified in Section 3.52.5 Subscription Topics and Filter Expressions.</p>
    <h5 class="list-paragraph" id="3.52.4.1.3">3.52.4.1.3 Expected Actions</h5>
    <p>The Notification Broker shall be capable of maintaining multiple concurrent Subscriptions.</p>
    <p>The Notification Broker shall keep track of each unique subscription and will provide a unique subscription reference which shall be used by the Subscriber to send subsequent cancellations</p>
    <p>
      The Subscriber may indicate the duration of the subscription using the
      <em>wsnt:InitialTerminationTime</em>
      element, where a time stamp (expressed as an XML Schema
      <em>dateTime</em>
      data type value) or a duration (expressed as an XML Schema
      <em>duration</em>
      data type value) can be used.
      <span class="underline" />
    </p>
    <p>If the Document Metadata Notification Broker is not able to understand a filter expression it SHALL create faults in accordance with the following rules:</p>
    <ul>
      <li>
        <p>InvalidFilterFault: the Subscribe message contained a filter that was not understood or supported by the Document Metadata Notification Broker. For example the ReferenceIdList filter parameter exists and the Document Metadata Notification Broker cannot satisfy it.</p>
      </li>
      <li>
        <p>TopicExpressionDialectUnknownFault: the Subscribe message contained a TopicExpression filter having a dialect that was not understood or supported by the Document Metadata Notification Broker.</p>
      </li>
      <li>
        <p>InvalidTopicExpressionFault: the Subscribe message contained a TopicExpression filter where the contents of the filter did not match the dialect specified.</p>
      </li>
      <li>
        <p>TopicNotSupportedFault: the Subscribe message contained a TopicExpression filter that referenced a topic that was not supported by the Document Metadata Notification Broker. This Fault SHALL be generated by a Document Metadata Notification Broker that does not support the Folder Subscription Option if it receives a request for a subscription using the topic ihe:FolderMetadata.</p>
      </li>
      <li>
        <p>SubscribeCreationFailedFault: The Document Metadata Notification Broker failed to process the Subscribe message. The Document Metadata Notification Broker SHOULD use a more specific fault message if possible. The Document Metadata Notification Broker MAY include a hint in the fault message indicating why it failed to process the Subscribe message.</p>
      </li>
    </ul>
    <h5 class="list-paragraph" id="3.52.4.1.4">3.52.4.1.4 Example Subscribe Request Message (subscription on a document filter)</h5>
    <p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</p>
    <p>&lt;s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope"</p>
    <p>xmlns:a="http://www.w3.org/2005/08/addressing"</p>
    <p>xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</p>
    <p>xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2"</p>
    <p>xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"</p>
    <p>xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2005/08/addressing http://www.w3.org/2005/08/addressing/ws-addr.xsd http://docs.oasis-open.org/wsn/b-2 http://docs.oasis-open.org/wsn/b-2.xsd urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0 ../schema/ebRS/rim.xsd"&gt;</p>
    <p>&lt;s:Header&gt;</p>
    <p>&lt;a:Action&gt;http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeRequest&lt;/a:Action&gt;</p>
    <p>&lt;a:MessageID&gt;382dcdc7-8e84-9fdc-8443-48fd83bca938&lt;/a:MessageID&gt;</p>
    <p>
      &lt;a:To s:mustUnderstand="1"&gt;
      <a href="http://localhost:8080/services/initiatingGateway/query%3c/a:To">http://localhost:8080/services/initiatingGateway/query</a>
      &lt;/a:To&gt;
    </p>
    <p>&lt;/s:Header&gt;</p>
    <p>&lt;s:Body&gt;</p>
    <p>&lt;wsnt:Subscribe&gt;</p>
    <p>&lt;!-- The Recipient on whose behalf the subscription is requested - the address where the notification is to be sent --&gt;</p>
    <p>&lt;wsnt:ConsumerReference&gt;</p>
    <p>&lt;a:Address&gt;https://NotificationRecipientServer/xdsBnotification&lt;/a:Address&gt;</p>
    <p>&lt;/wsnt:ConsumerReference&gt;</p>
    <p>&lt;wsnt:Filter&gt;</p>
    <p>&lt;wsnt:TopicExpression Dialect="http://docs.oasis-open.org/wsn/t-1/TopicExpression/Simple"&gt;ihe:MinimalDocumentEntry&lt;/wsnt:TopicExpression&gt;</p>
    <p>&lt;rim:AdhocQuery id="urn:uuid:aa2332d0-f8fe-11e0-be50-0800200c9a66"&gt;</p>
    <p>&lt;rim:Slot name="$XDSDocumentEntryPatientId"&gt;</p>
    <p>&lt;rim:ValueList&gt;</p>
    <p>&lt;rim:Value&gt;'st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO'&lt;/rim:Value&gt;</p>
    <p>&lt;/rim:ValueList&gt;</p>
    <p>&lt;/rim:Slot&gt;</p>
    <p>&lt;rim:Slot name="$XDSDocumentEntryHealthcareFacilityTypeCode"&gt;</p>
    <p>&lt;rim:ValueList&gt;</p>
    <p>&lt;rim:Value&gt;('Emergency Department^^healthcareFacilityCodingScheme')&lt;/rim:Value&gt;</p>
    <p>&lt;/rim:ValueList&gt;</p>
    <p>&lt;/rim:Slot&gt;</p>
    <p>&lt;/rim:AdhocQuery&gt;</p>
    <p>&lt;/wsnt:Filter&gt;</p>
    <p>&lt;wsnt:InitialTerminationTime&gt;2010-05-31T00:00:00.00000Z&lt;/wsnt:InitialTerminationTime&gt;</p>
    <p>&lt;/wsnt:Subscribe&gt;</p>
    <p>&lt;/s:Body&gt;</p>
    <p>&lt;/s:Envelope&gt;</p>
    <h4 class="list-paragraph" id="3.52.4.2">3.52.4.2 Subscribe Response Message</h4>
    <h5 class="list-paragraph" id="3.52.4.2.1">3.52.4.2.1 Trigger</h5>
    <p>This message is an immediate response to a Subscribe Request, and it is sent from the Document Metadata Notification Broker to the Document Metadata Subscriber.</p>
    <h5 class="list-paragraph" id="3.52.4.2.2">3.52.4.2.2 Message Semantics</h5>
    <p>The Subscribe Response message shall comply with the requirements in the WS-BaseNotification standard, including the use of the appropriate SOAP Fault messages. Note that the value of the WS-Addressing Action element is prescribed in the standard, and differs from the requirements of <a href="../Volume2x/ch-22.html#Appendix V">ITI TF-2x: Appendix V</a>.</p>
    <p>The subscription identifier is assigned by the Notification Broker as a subscription reference, communicated in the response in the SOAP body in wsnt:SubscribeResponse/wsnt:SubscriptionReference (a WS-Addressing endpoint). The subscription reference shall consist of:</p>
    <ul>
      <li>
        <p>
          an
          <em>Address</em>
          element, containing a webservices endpoint
        </p>
      </li>
    </ul>
    <p>In order to unsubscribe, the request shall be sent to the endpoint specified in the Address component of the SubscriptionReference.</p>
    <h5 class="list-paragraph" id="3.52.4.2.3">3.52.4.2.3 Expected Actions</h5>
    <p>
      If the Document Metadata Subscriber had indicated a requested duration for the subscription, the Document Metadata Notification Broker shall send the assigned duration for the subscription using the
      <em>wsnt:TerminationTime</em>
      element.
    </p>
    <p>
      If the Document Metadata Subscriber had not indicated a requested duration for the subscription, the Document Metadata Notification Broker may send an assigned duration for the subscription (if any), using the
      <em>wsnt:TerminationTime</em>
      element.
    </p>
    <p>If the Document Metadata Notification Broker sends an assigned duration for the subscription, the Subscriber shall associate the assigned duration with the accepted subscription request.</p>
    <p>The Document Metadata Subscriber shall associate the accepted subscription request with the subscription reference address assigned by the Document Metadata Notification Broker in order to be able to send cancellations for existing subscriptions.</p>
    <h5 class="list-paragraph" id="3.52.4.2.4">3.52.4.2.4 Example</h5>
    <p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</p>
    <p>&lt;s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope"</p>
    <p>xmlns:a="http://www.w3.org/2005/08/addressing"</p>
    <p>xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</p>
    <p>xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2"</p>
    <p>xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2005/08/addressing http://www.w3.org/2005/08/addressing/ws-addr.xsd http://docs.oasis-open.org/wsn/b-2 http://docs.oasis-open.org/wsn/b-2.xsd"&gt;</p>
    <p>&lt;s:Header&gt;</p>
    <p>&lt;a:Action&gt;http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeResponse&lt;/a:Action&gt;</p>
    <p>&lt;/s:Header&gt;</p>
    <p>&lt;s:Body&gt;</p>
    <p>&lt;wsnt:SubscribeResponse&gt;</p>
    <p>&lt;!-- A WS-Addressing endpoint, where modification and cancelation requests for this subscription must be sent --&gt;</p>
    <p>&lt;wsnt:SubscriptionReference&gt;</p>
    <p>&lt;a:Address&gt;https://NotificationBrokerServer/Subscription/382dcdc7-8e84-9fdc-8443&lt;/a:Address&gt;</p>
    <p>&lt;/wsnt:SubscriptionReference&gt;</p>
    <p>&lt;wsnt:TerminationTime&gt;2008-05-31T00:00:00Z&lt;/wsnt:TerminationTime&gt;</p>
    <p>&lt;/wsnt:SubscribeResponse&gt;</p>
    <p>&lt;/s:Body&gt;</p>
    <p>&lt;/s:Envelope&gt;</p>
    <h4 class="list-paragraph" id="3.52.4.3">3.52.4.3 Unsubscribe Request Message</h4>
    <h5 class="list-paragraph" id="3.52.4.3.1">3.52.4.3.1 Trigger</h5>
    <p>When a subscription is no longer needed, a Document Metadata Subscriber will trigger an Unsubscribe Request message.</p>
    <h5 class="list-paragraph" id="3.52.4.3.2">3.52.4.3.2 Message Semantics</h5>
    <p>The Unsubscribe Request message shall comply with the requirements in the WS-BaseNotification standard. The message conveys the request to cancel an existing subscription. Note that the value of the WS-Addressing Action element is prescribed in the standard, and differs from the requirements of <a href="../Volume2x/ch-22.html#Appendix V">ITI TF-2x: Appendix V</a>.</p>
    <h5 class="list-paragraph" id="3.52.4.3.3">3.52.4.3.3 Expected Actions</h5>
    <p>The Document Metadata Subscriber shall send this message to the endpoint associated with the existing subscription.</p>
    <p>The Document Metadata Notification Broker shall cancel the corresponding subscription, and respond with an Unsubscribe Response message. In the case when, for whatever reason, the subscription cannot be canceled, the Document Metadata Notification Broker shall respond with a ResourceUnknownFault or an UnableToDestroySubscriptionFault SOAP Fault message as appropriate.</p>
    <h5 class="list-paragraph" id="3.52.4.3.4">3.52.4.3.4 Example</h5>
    <p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</p>
    <p>&lt;s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope"</p>
    <p>xmlns:a="http://www.w3.org/2005/08/addressing"</p>
    <p>xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</p>
    <p>xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2"</p>
    <p>xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2005/08/addressing http://www.w3.org/2005/08/addressing/ws-addr.xsd http://docs.oasis-open.org/wsn/b-2 http://docs.oasis-open.org/wsn/b-2.xsd"&gt;</p>
    <p>&lt;s:Header&gt;</p>
    <p>&lt;a:Action&gt;http://docs.oasis-open.org/wsn/bw-2/SubscriptionManager/UnsubscribeRequest&lt;/a:Action&gt;</p>
    <p>&lt;a:MessageID&gt;382dcdc9-8e86-9fde-8445-48fd83bca93a&lt;/a:MessageID&gt;</p>
    <p>&lt;a:To&gt;https://NotificationBrokerServer/Subscription/382dcdc7-8e84-9fdc-8443&lt;/a:To&gt;</p>
    <p>&lt;/s:Header&gt;</p>
    <p>&lt;s:Body&gt;</p>
    <p>&lt;wsnt:Unsubscribe/&gt;</p>
    <p>&lt;/s:Body&gt;</p>
    <p>&lt;/s:Envelope&gt;</p>
    <h4 class="list-paragraph" id="3.52.4.4">3.52.4.4 Unsubscribe Response Message</h4>
    <h5 class="list-paragraph" id="3.52.4.4.1">3.52.4.4.1 Trigger</h5>
    <p>This message is an immediate response to an Unsubscribe Request message, and it is sent from the Document Metadata Notification Broker to the Document Metadata Subscriber.</p>
    <h5 class="list-paragraph" id="3.52.4.4.2">3.52.4.4.2 Message Semantics</h5>
    <p>The Unsubscribe Response message shall comply with the requirements in the WS-BaseNotification standard. This message indicates that an Unsubscribe message was successfully processed. Note that the value of the WS-Addressing Action element is prescribed in the standard, and differs from the requirements of <a href="../Volume2x/ch-22.html#Appendix V">ITI TF-2x: Appendix V</a>.</p>
    <h5 class="list-paragraph" id="3.52.4.4.3">3.52.4.4.3 Expected Actions</h5>
    <p>The Document Metadata Notification Broker shall cancel the corresponding subscription.</p>
    <p>The Document Metadata Subscriber shall mark the corresponding subscription as successfully terminated.</p>
    <h5 class="list-paragraph" id="3.52.4.4.4">3.52.4.4.4 Example</h5>
    <p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</p>
    <p>&lt;s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope"</p>
    <p>xmlns:a="http://www.w3.org/2005/08/addressing"</p>
    <p>xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</p>
    <p>xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2"</p>
    <p>xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2005/08/addressing http://www.w3.org/2005/08/addressing/ws-addr.xsd http://docs.oasis-open.org/wsn/b-2 http://docs.oasis-open.org/wsn/b-2.xsd"&gt;</p>
    <p>&lt;s:Header&gt;</p>
    <p>&lt;a:Action&gt;http://docs.oasis-open.org/wsn/bw-2/SubscriptionManager/UnsubscribeResponse&lt;/a:Action&gt;</p>
    <p>&lt;/s:Header&gt;</p>
    <p>&lt;s:Body&gt;</p>
    <p>&lt;wsnt:UnsubscribeResponse/&gt;</p>
    <p>&lt;/s:Body&gt;</p>
    <p>&lt;/s:Envelope&gt;</p>
    <h3 class="list-paragraph" id="3.52.5">3.52.5 Subscription Topics and Filter Expressions</h3>
    <p>This transaction restricts the subscription topic to be one of FullDocumentEntry or MinimalDocumentEntry (Section 3.52.5.1) and restricts the semantics of filter expressions to the semantics of a subset (Section 3.52.5.2) of the Registry Stored Query [ITI-18] transaction.</p>
    <h4 class="list-paragraph" id="3.52.5.1">3.52.5.1 Topics</h4>
    <p>This transaction defines simple topics as described in the WS-Topics specification. If the Document Metadata Notification Broker supports the Folder Subscription Option it shall support all the following topics in a Document Metadata Subscribe Request; otherwise it shall reject subscription Request which specify folder's topic generating a fault (see Section 3.52.4.1.3 “Expected Actions”). The Document Metadata Subscriber may support a subset of these topics:</p>
    <h5 class="list-paragraph" id="3.52.5.1.1">3.52.5.1.1 ihe:FullDocumentEntry</h5>
    <p>This topic indicates that the events for which the subscription is made shall be Document Entry registrations, and that the notification shall contain the full metadata describing each matching Document Entry as described in the Notification transaction in Section 3.53.4.1.2.</p>
    <h5 class="list-paragraph" id="3.52.5.1.2">3.52.5.1.2 ihe:MinimalDocumentEntry</h5>
    <p>This topic indicates that the events for which the subscription is made shall be Document Entry registrations, and that the notification shall contain the minimal set of data describing each matching Document Entry as described in the Document Metadata Notify transaction in Section 3.53.4.1.2.</p>
    <h5 class="list-paragraph" id="3.52.5.1.3">3.52.5.1.3 ihe:SubmissionSetMetadata</h5>
    <p>This topic indicates that the event for which the subscription is made shall be creating a SubmissionSet and that the notification shall contain the full metadata describing the match with the SubmissionSet object, as described in the Document Metadata Notify transaction in Section 3.53.4.1.2.</p>
    <h4 class="list-paragraph" id="3.52.5.2">3.52.5.2 Building Filter Expressions</h4>
    <p>The XDS metadata, specified in <a href="../Volume3/ch-1.1.html#4.1">ITI TF-3: 4.1</a>, describes the objects which are used in a document registration. The Registry Stored Query [ITI-18] transaction uses a subset of the metadata to build a list of queries available to a XDS Document Consumer to search for documents with specific characteristics. The list of queries is in <a href="../Volume2a/ITI-18.html#3.18.4.1.2.3.7">ITI TF-2a: 3.18.4.1.2.3.7</a>. The transaction Document Metadata Subscribe uses the syntax of the Registry Stored Query [ITI-18] transaction for the creation of the filtering expression.</p>
    <p>Filters can be created using the parameters of the FindDocuments, FindDocumentsByReferenceId, FindSubmissionSet queries defined within the Registry Stored Query transaction and use the syntax of the FindDocuments FindDocumentsByReferenceId or FindSubmissionSets queries to express the filter.</p>
    <p>The evaluation of filter expressions is based on the XDS metadata model. In this transaction, the stream of events for which subscriptions are possible is limited to events representing the existence of SubmissionSet and documentEntry Objects. The Document Metadata Notification Broker becomes aware of such events either via a Document Metadata Publish [ITI-54] transaction, or via other mechanisms not specified by IHE. The Document Metadata Notification Broker shall determine if there is a subscription which matches any of the Document Entry Objects or SubmissionSet Object in an event.</p>
    <p>A match means that if a Registry Stored Query, with the same parameters as the filter expression in the subscription, were sent to a XDS Document Registry containing the Document Entry Objects or SubmissionSet Object from the event, the result of this Stored Query would contain one or more of these Objects.</p>
    <p>In an XDS Affinity Domain context, the applicable events are likely to be Register Document Set [ITI-42] transaction containing one or more Document Entry objects. In this case, the Document Metadata Notification Broker may have to map between the model within which the events took place, and the Document Sharing metadata model.</p>
    <p>A good understanding of the Registry Stored Query transaction and the XDS metadata is necessary to understand how the filter expressions work. For example, if the filter expression below were implemented as a stored query on the registry</p>
    <p>&lt;rim:AdhocQuery id="urn:uuid:aa2332d0-f8fe-11e0-be50-0800200c9a66" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"&gt;</p>
    <p>&lt;rim:Slot name="$XDSDocumentEntryPatientId"&gt;</p>
    <p>&lt;rim:ValueList&gt;</p>
    <p>&lt;rim:Value&gt;'st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO'&lt;/rim:Value&gt;</p>
    <p>&lt;/rim:ValueList&gt;</p>
    <p>&lt;/rim:Slot&gt;</p>
    <p>&lt;rim:Slot name="$XDSDocumentEntryEventCodeList"&gt;</p>
    <p>&lt;rim:ValueList&gt;</p>
    <p>&lt;rim:Value&gt;('44950^^codScheme','44955^^codScheme','44960^^codScheme',' 44970^^codScheme','44979^^codScheme')&lt;/rim:Value&gt;</p>
    <p>&lt;/rim:ValueList&gt;</p>
    <p>&lt;/rim:Slot&gt;</p>
    <p>&lt;/rim:AdhocQuery&gt;</p>
    <p>it will return all document entries for patient with ID st3498702 (assigned by an authority identified by the OID 1.3.6.1.4.1.21367.2005.3.7) where the event code metadata contains at least one of the codes listed (in this case CPT codes for various appendectomies). When used as a filter expression, the same structure will yield a match against a document entry in an XDS registry submission, where the document entry is for patient with ID st3498702 and the event code is "44970". The following snippet shows an example of such a submission:</p>
    <p>&lt;lcm:SubmitObjectsRequest&gt;</p>
    <p>&lt;rim:RegistryObjectList&gt;</p>
    <p>&lt;rim:ExtrinsicObject id="Document01" mimeType="text/xml" objectType="urn:uuid:7edca82f-054d-47f2-a032-9b2a5b5186c1"&gt;</p>
    <p>...</p>
    <p>&lt;rim:Classification classificationScheme="urn:uuid:2c6b8cb7-8b2a-4051-b291-b1ae6a575ef4" classifiedObject="Document01" nodeRepresentation="44950"&gt;</p>
    <p>&lt;rim:Name&gt;</p>
    <p>&lt;rim:LocalizedString value="Appendectomy"/&gt;</p>
    <p>&lt;/rim:Name&gt;</p>
    <p>&lt;rim:Slot name="codingScheme"&gt;</p>
    <p>&lt;rim:ValueList&gt;</p>
    <p>&lt;rim:Value&gt;CPT codes&lt;/rim:Value&gt;</p>
    <p>&lt;/rim:ValueList&gt;</p>
    <p>&lt;/rim:Slot&gt;</p>
    <p>&lt;/rim:Classification&gt;</p>
    <p>...</p>
    <p>&lt;rim:ExternalIdentifier id="ei01" registryObject="Document01" identificationScheme="urn:uuid:58a6f841-87b3-4a3e-92fd-a8ffeff98427" value="'st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO'"&gt;</p>
    <p>&lt;rim:Name&gt;</p>
    <p>&lt;rim:LocalizedString value="XDSDocumentEntry.patientId"/&gt;</p>
    <p>&lt;/rim:Name&gt;</p>
    <p>&lt;/rim:ExternalIdentifier&gt;</p>
    <p>...</p>
    <p>&lt;rim:ExtrinsicObject&gt;</p>
    <p>&lt;/rim:RegistryObjectList&gt;</p>
    <p>&lt;/lcm:SubmitObjectsRequest&gt;</p>
    <p>When a Document Metadata Notification Subscriber constructs a filter expression, it shall include the whole stored query expression (as shown above) directly in the Subscribe Request message as a child of the wsnt:Filter element:</p>
    <p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</p>
    <p>&lt;s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope"</p>
    <p>xmlns:a="http://www.w3.org/2005/08/addressing"</p>
    <p>xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</p>
    <p>xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2"</p>
    <p>xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"</p>
    <p>xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2005/08/addressing http://www.w3.org/2005/08/addressing/ws-addr.xsd http://docs.oasis-open.org/wsn/b-2 http://docs.oasis-open.org/wsn/b-2.xsd urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0 ../schema/ebRS/rim.xsd"&gt;</p>
    <p>&lt;s:Header&gt;</p>
    <p>&lt;a:Action&gt;http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeRequest&lt;/a:Action&gt;</p>
    <p>&lt;a:MessageID&gt;382dcdc7-8e84-9fdc-8443-48fd83bca938&lt;/a:MessageID&gt;</p>
    <p>&lt;/s:Header&gt;</p>
    <p>&lt;s:Body&gt;</p>
    <p>&lt;wsnt:Subscribe&gt;</p>
    <p>&lt;!-- The Recipient on whose behalf the subscription is requested - the address where the notification is to be sent --&gt;</p>
    <p>&lt;wsnt:ConsumerReference&gt;</p>
    <p>&lt;a:Address&gt;https://NotificationRecipientServer/xdsBnotification&lt;/a:Address&gt;</p>
    <p>&lt;/wsnt:ConsumerReference&gt;</p>
    <p>&lt;wsnt:Filter&gt;</p>
    <p>&lt;wsnt:TopicExpression Dialect="http://docs.oasis-open.org/wsn/t-1/TopicExpression/Simple"&gt;ihe:FullDocumentEntry&lt;/wsnt:TopicExpression&gt;</p>
    <p>&lt;rim:AdhocQuery id="urn:uuid:aa2332d0-f8fe-11e0-be50-0800200c9a66"&gt;</p>
    <p>&lt;rim:Slot name="$XDSDocumentEntryPatientId"&gt;</p>
    <p>&lt;rim:ValueList&gt;</p>
    <p>&lt;rim:Value&gt;'st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO'&lt;/rim:Value&gt;</p>
    <p>&lt;/rim:ValueList&gt;</p>
    <p>&lt;/rim:Slot&gt;</p>
    <p>&lt;rim:Slot name="$XDSDocumentEntryEventCodeList"&gt;</p>
    <p>&lt;rim:ValueList&gt;</p>
    <p>&lt;rim:Value&gt;('44950^^codScheme','44955^^codScheme','44960^^codScheme',' 44970^^codScheme','44979^^codScheme')&lt;/rim:Value&gt;</p>
    <p>&lt;/rim:ValueList&gt;</p>
    <p>&lt;/rim:Slot&gt;</p>
    <p>&lt;/rim:AdhocQuery&gt;</p>
    <p>&lt;/wsnt:Filter&gt;</p>
    <p>&lt;wsnt:InitialTerminationTime&gt;2008-07-31T00:00:00.00000Z&lt;/wsnt:InitialTerminationTime&gt;</p>
    <p>&lt;/wsnt:Subscribe&gt;</p>
    <p>&lt;/s:Body&gt;</p>
    <p>&lt;/s:Envelope&gt;</p>
    <p>How the Document Metadata Notification Broker evaluates the filter expression, and how it performs the matching against the existing subscriptions, is out of scope of this transaction. It is expected that such implementation details will allow vendors to differentiate themselves in the marketplace.</p>
    <p>It is important to note that not all stored queries, and not all parameters defined for the stored queries, are suitable for filter expressions. The Document Metadata Notification Broker shall support the following filters and associated parameters when used in subscription requests, and the Document Metadata Subscriber may support a subset of these:</p>
    <h5 class="list-paragraph" id="3.52.5.2.1">3.52.5.2.1 Subscriptions for DocumentEntry metadata</h5>
    <p>A Document Metadata Notification Broker that accepts a Subscribe Request containing filter expressions created using DocumentEntry metadata shall yield a match as described in Section 3.52.5.2. Parameters that can be used for creating the filter expression are described below:</p>
    <ol type="1">
      <li>
        <p>$XDSDocumentEntryPatientId: this required parameter contains the patient ID for which a document entry is being registered in the XDS Document Registry</p>
      </li>
    </ol>
    <ol type="1">
      <li>
        <p>$XDSDocumentEntryClassCode: this parameter matches against the XDSDocumentEntry.classCode metadata elements in a given registry submission</p>
      </li>
      <li>
        <p>$XDSDocumentEntryTypeCode: this parameter matches against the XDSDocumentEntry.typeCode metadata elements in a given registry submission</p>
      </li>
      <li>
        <p>$XDSDocumentEntryReferenceIdList: this parameter matches against the XDSDocumentEntry.referenceIdList metadata elements in a given registry submission</p>
      </li>
    </ol>
    <p>Note: The ReferenceIdList attribute is optional. If the parameter is specified, the filter matches only documents where the ID contains the value conveyed in the parameter. If the document does not contain a value in the ReferenceIdList, there is no match.</p>
    <ol start="4" type="1">
      <li>
        <p>$XDSDocumentEntryPracticeSettingCode: this parameter matches against the XDSDocumentEntry.practiceSettingCode metadata elements in a given registry submission</p>
      </li>
      <li>
        <p>$XDSDocumentEntryHealthcareFacilityTypeCode: this parameter matches against the XDSDocumentEntry.healthcareFacilityTypeCode metadata elements in a given registry submission</p>
      </li>
      <li>
        <p>$XDSDocumentEntryEventCodeList: this parameter matches against the XDSDocumentEntry.eventCodeList metadata elements in a given registry submission</p>
      </li>
      <li>
        <p>$XDSDocumentEntryConfidentialityCode: this parameter matches against the XDSDocumentEntry.confidentialityCode metadata elements in a given registry submission</p>
      </li>
      <li>
        <p>$XDSDocumentEntryFormatCode: this parameter matches against the XDSDocumentEntry.formatCode metadata elements in a given registry submission</p>
      </li>
      <li>
        <p>$XDSDocumentEntryAuthorPerson: this parameter matches against the XDSDocumentEntry.author metadata elements in a given registry submission. All properties of this parameter specified in <a href="../Volume2a/ITI-18.html#3.18.4.1.2.3.7.1">ITI TF-2a: 3.18.4.1.2.3.7.1</a> are applicable in this transaction.</p>
      </li>
    </ol>
    <p>With the exception of $XDSDocumentEntryPatientId, all parameters may be multi-valued.</p>
    <p>The AdHocQuery/@id attribute SHALL store an identifier specific for the type of filter used in creating the subscription. The UUID that identifies subscriptions for DocumentEntry’s metadata is:</p>
    <p>“urn:uuid:aa2332d0-f8fe-11e0-be50-0800200c9a66”.</p>
    <p>An example of subscription on a document filter is presented below:</p>
    <p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</p>
    <p>
      &lt;s:Envelope xmlns:s="
      <a href="http://www.w3.org/2003/05/soap-envelope">http://www.w3.org/2003/05/soap-envelope</a>
      "
    </p>
    <p>
          xmlns:a="
      <a href="http://www.w3.org/2005/08/addressing">http://www.w3.org/2005/08/addressing</a>
      "
    </p>
    <p>
          xmlns:xsi="
      <a href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a>
      "
    </p>
    <p>
          xmlns:wsnt="
      <a href="http://docs.oasis-open.org/wsn/b-2">http://docs.oasis-open.org/wsn/b-2</a>
      "
    </p>
    <p>    xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"</p>
    <p>
          xsi:schemaLocation="
      <a href="http://www.w3.org/2003/05/soap-envelope">http://www.w3.org/2003/05/soap-envelope</a>
      <a href="http://www.w3.org/2003/05/soap-envelope">http://www.w3.org/2003/05/soap-envelope</a>
      <a href="http://www.w3.org/2005/08/addressing">http://www.w3.org/2005/08/addressing</a>
      <a href="http://www.w3.org/2005/08/addressing/ws-addr.xsd">http://www.w3.org/2005/08/addressing/ws-addr.xsd</a>
      <a href="http://docs.oasis-open.org/wsn/b-2">http://docs.oasis-open.org/wsn/b-2</a>
      <a href="http://docs.oasis-open.org/wsn/b-2.xsd">http://docs.oasis-open.org/wsn/b-2.xsd</a>
      urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0 ../schema/ebRS/rim.xsd"&gt;
    </p>
    <p>    &lt;s:Header&gt;</p>
    <p>
              &lt;a:Action&gt;
      <a href="http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeRequest">http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeRequest</a>
      &lt;/a:Action&gt;
    </p>
    <p>        &lt;a:MessageID&gt;382dcdc7-8e84-9fdc-8443-48fd83bca938&lt;/a:MessageID&gt;</p>
    <p>
              &lt;a:To s:mustUnderstand="1"&gt;
      <a href="http://localhost:8080/services/initiatingGateway/query%3c/a:To">http://localhost:8080/services/initiatingGateway/query&lt;/a:To</a>
      &gt;
    </p>
    <p>    &lt;/s:Header&gt;</p>
    <p>    &lt;s:Body&gt;</p>
    <p>        &lt;wsnt:Subscribe&gt;</p>
    <p>            &lt;!-- The Recipient on whose behalf the subscription is requested - the address where the notification is to be sent --&gt;</p>
    <p>            &lt;wsnt:ConsumerReference&gt;</p>
    <p>
                      &lt;a:Address&gt;
      <a href="https://NotificationRecipientServer/xdsBnotification">https://NotificationRecipientServer/xdsBnotification</a>
      &lt;/a:Address&gt;
    </p>
    <p>            &lt;/wsnt:ConsumerReference&gt;</p>
    <p>            &lt;wsnt:Filter&gt;</p>
    <p>
                      &lt;wsnt:TopicExpression Dialect="
      <a href="http://docs.oasis-open.org/wsn/t-1/TopicExpression/Simple">http://docs.oasis-open.org/wsn/t-1/TopicExpression/Simple</a>
      "&gt;ihe:MinimalDocumentEntry&lt;/wsnt:TopicExpression&gt;
    </p>
    <p>                &lt;rim:AdhocQuery id="urn:uuid:aa2332d0-f8fe-11e0-be50-0800200c9a66"&gt;</p>
    <p>                    &lt;rim:Slot name="$XDSDocumentEntryPatientId"&gt;</p>
    <p>                        &lt;rim:ValueList&gt;</p>
    <p>                            &lt;rim:Value&gt;'st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO'&lt;/rim:Value&gt;</p>
    <p>                        &lt;/rim:ValueList&gt;</p>
    <p>                    &lt;/rim:Slot&gt;</p>
    <p>                    &lt;rim:Slot name="$XDSDocumentEntryHealthcareFacilityTypeCode"&gt;</p>
    <p>                        &lt;rim:ValueList&gt;</p>
    <p>                            &lt;rim:Value&gt;('Emergency Department^^healthcareFacilityCodingScheme')&lt;/rim:Value&gt;</p>
    <p>                        &lt;/rim:ValueList&gt;</p>
    <p>                      &lt;/rim:Slot&gt;</p>
    <p>                &lt;/rim:AdhocQuery&gt;</p>
    <p>            &lt;/wsnt:Filter&gt;</p>
    <p>            &lt;wsnt:InitialTerminationTime&gt;2010-05-31T00:00:00.00000Z&lt;/wsnt:InitialTerminationTime&gt;</p>
    <p>        &lt;/wsnt:Subscribe&gt;</p>
    <p>    &lt;/s:Body&gt;</p>
    <p>&lt;/s:Envelope&gt;</p>
    <h5 class="list-paragraph" id="3.52.5.2.2">3.52.5.2.2 Subscriptions for SubmissionSets metadata</h5>
    <p>Document Metadata Notification Broker that accepts a Subscribe Request containing a filter expression based on the FindSubmissionSets stored query shall yield a match as described in Section 3.52.5.2. The subscription filter expression represents a subset of the FindSubmissionSets query parameters, with a specific extension. A Document Metadata Subscriber MAY be able to create a filter expression that includes XDSSubmissionSet.patientId, XDSSubmissionSet.sourceId, XDSSubmissionSet.authorPerson and XDSSubmissionSet.intendedRecipient. Parameters that can be used for this type of filter are described below:</p>
    <ol type="1">
      <li>
        <p>$XDSSubmissionSetPatientId: this is a required parameter that contains the identifier of the patient target of the clinical content published by a submission and represent the value of the XDSSubmissionSet.PatientId metadata.</p>
      </li>
    </ol>
    <ol start="2" type="1">
      <li>
        <p>$XDSSubmissionSetSourceId: this optional parameter identifies the source of the content published by the submission and represent the value of the XDSSubmissionSet.sourceId metadata. This parameter may be multi-valued.</p>
      </li>
      <li>
        <p>$XDSSubmissionSetAuthorPerson: this optional parameter identifies the authorPerson of the content published by the submission and represents the value of the XDSSubmissionSet.authorPerson metadata. This parameter may be multi-valued.</p>
      </li>
    </ol>
    <ol start="10" type="1">
      <li>
        <p>$XDSSubmissionSetIntendedRecipient: this is an optional parameter for the subscription. A Document Metadata Subscriber shall be able to subscribe this parameter in addition to other parameters which have direct correspondence with query parameters. This parameter represents the value of the XDSSubmissionSet.intendedRecipient metadata. This parameter identifies initial targets intended for a submission. This parameter may be multi-valued.</p>
      </li>
    </ol>
    <p>Note: intendedRecipient attribute is optional. If the parameter is specified, the filter matches only submissionSets where the intendedRecipient contains the value conveyed in the parameter. If the document does not contain a value in the intendedRecipient, there is no match.</p>
    <p>The AdHocQuery/@id attribute SHALL contain an identifier specific for the type of filter used in creating the subscription. The UUID that identifies subscriptions for SubmissionSet’s metadata is:</p>
    <p>“urn:uuid:fbede94e-dbdc-4f6b-bc1f-d730e677cece”</p>
    <p>An example of subscription on a SubmissionSet filter is presented below:</p>
    <p>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</p>
    <p>
      &lt;s:Envelope xmlns:s="
      <a href="http://www.w3.org/2003/05/soap-envelope">http://www.w3.org/2003/05/soap-envelope</a>
      "
    </p>
    <p>
          xmlns:a="
      <a href="http://www.w3.org/2005/08/addressing">http://www.w3.org/2005/08/addressing</a>
      "
    </p>
    <p>
          xmlns:xsi="
      <a href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a>
      "
    </p>
    <p>
          xmlns:wsnt="
      <a href="http://docs.oasis-open.org/wsn/b-2">http://docs.oasis-open.org/wsn/b-2</a>
      "
    </p>
    <p>    xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"</p>
    <p>
          xsi:schemaLocation="
      <a href="http://www.w3.org/2003/05/soap-envelope">http://www.w3.org/2003/05/soap-envelope</a>
      <a href="http://www.w3.org/2003/05/soap-envelope">http://www.w3.org/2003/05/soap-envelope</a>
      <a href="http://www.w3.org/2005/08/addressing">http://www.w3.org/2005/08/addressing</a>
      <a href="http://www.w3.org/2005/08/addressing/ws-addr.xsd">http://www.w3.org/2005/08/addressing/ws-addr.xsd</a>
      <a href="http://docs.oasis-open.org/wsn/b-2">http://docs.oasis-open.org/wsn/b-2</a>
      <a href="http://docs.oasis-open.org/wsn/b-2.xsd">http://docs.oasis-open.org/wsn/b-2.xsd</a>
      urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0 ../schema/ebRS/rim.xsd"&gt;
    </p>
    <p>    &lt;s:Header&gt;</p>
    <p>
              &lt;a:Action&gt;
      <a href="http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeRequest">http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeRequest</a>
      &lt;/a:Action&gt;
    </p>
    <p>        &lt;a:MessageID&gt;382dcdc7-8e84-9fdc-8443-48fd83bca938&lt;/a:MessageID&gt;</p>
    <p>
              &lt;a:To s:mustUnderstand="1"&gt;
      <a href="http://localhost:8080/services/initiatingGateway/query%3c/a:To">http://localhost:8080/services/initiatingGateway/query&lt;/a:To</a>
      &gt;
    </p>
    <p>    &lt;/s:Header&gt;</p>
    <p>    &lt;s:Body&gt;</p>
    <p>        &lt;wsnt:Subscribe&gt;</p>
    <p>            &lt;!-- The Recipient on whose behalf the subscription is requested - the address where the notification is to be sent --&gt;</p>
    <p>            &lt;wsnt:ConsumerReference&gt;</p>
    <p>
                      &lt;a:Address&gt;
      <a href="https://NotificationRecipientServer/xdsBnotification">https://NotificationRecipientServer/xdsBnotification</a>
      &lt;/a:Address&gt;
    </p>
    <p>            &lt;/wsnt:ConsumerReference&gt;</p>
    <p>            &lt;wsnt:Filter&gt;</p>
    <p>
                      &lt;wsnt:TopicExpression Dialect="
      <a href="http://docs.oasis-open.org/wsn/t-1/TopicExpression/Simple">http://docs.oasis-open.org/wsn/t-1/TopicExpression/Simple</a>
      "&gt;ihe:SubmissionSetMetadata&lt;/wsnt:TopicExpression&gt;
    </p>
    <p>                &lt;rim:AdhocQuery id="urn:uuid:fbede94e-dbdc-4f6b-bc1f-d730e677cece"&gt;</p>
    <p>                    &lt;rim:Slot name="$XDSSubmissionSetPatientId"&gt;</p>
    <p>                        &lt;rim:ValueList&gt;</p>
    <p>                            &lt;rim:Value&gt;'st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO'&lt;/rim:Value&gt;</p>
    <p>                        &lt;/rim:ValueList&gt;</p>
    <p>                    &lt;/rim:Slot&gt;</p>
    <p>                    &lt;rim:Slot name="$XDSSubmissionSetIntendedRecipient"&gt;</p>
    <p>                        &lt;rim:ValueList&gt;</p>
    <p>                            &lt;rim:Value&gt;('Some Hospital%')&lt;/rim:Value&gt;</p>
    <p>                            &lt;rim:Value&gt;('|Welby%')&lt;/rim:Value&gt;</p>
    <p>                        &lt;/rim:ValueList&gt;</p>
    <p>                      &lt;/rim:Slot&gt;</p>
    <p>                &lt;/rim:AdhocQuery&gt;</p>
    <p>            &lt;/wsnt:Filter&gt;</p>
    <p>            &lt;wsnt:InitialTerminationTime&gt;2010-05-31T00:00:00.00000Z&lt;/wsnt:InitialTerminationTime&gt;</p>
    <p>        &lt;/wsnt:Subscribe&gt;</p>
    <p>    &lt;/s:Body&gt;</p>
    <p>&lt;/s:Envelope&gt;</p>
    <h4 class="list-paragraph" id="3.52.5.3">3.52.5.3 Combining topics and filter expressions</h4>
    <p>A topic defines static rules for creating notifications. This transaction defines four topics in Section 3.52.5.1. Each subscription request shall contain exactly one topic expression.</p>
    <p>A filter expression is equivalent to a specific stored query with certain parameters. Filter conditions expressed as query parameters and used in the expressions must satisfy the same requirements as a corresponding Registry Stored Query:</p>
    <ul>
      <li>
        <p>the values for all specified query parameters must match (AND all different parameters)</p>
      </li>
      <li>
        <p>at least one of the values of multi-valued parameters must match (OR the values in a multi-valued query parameter)</p>
      </li>
    </ul>
    <p>Topics, defined in Section 3.52.5.1 and filter expressions, defined in Section 3.52.5.2, can only be used in specific combinations. These combinations are described in Table 3.52.5.3-1:</p>
    <p id="Table 3.52.5.3-1">Table 3.52.5.3-1: Topics and Filter Expression Combinations</p>
    <table>
      <thead>
        <tr class="header">
          <th>Filter Expression</th>
          <th>Topic Expression</th>
        </tr>
      </thead>
      <tbody>
        <tr class="odd">
          <td>subscription for DocumentEntry</td>
          <td>ihe:FullDocumentEntry</td>
        </tr>
        <tr class="even">
          <td />
          <td>ihe:MinimalDocumentEntry</td>
        </tr>
        <tr class="odd">
          <td>subscription for SubmissionSets</td>
          <td>ihe:SubmissionSetMetadata</td>
        </tr>
      </tbody>
    </table>
    <h3 class="list-paragraph" id="3.52.6">3.52.6 Security Considerations</h3>
    <p>
      The risk assessment for the Document Metadata Subscribe transaction is described in the risk assessment spreadsheet for the Document Metadata Subscription Profile, which is available from IHE at
      <a href="http://wiki.ihe.net/images/4/46/DSUB_risk_assesment.xls">http://wiki.ihe.net/images/4/46/DSUB_risk_assesment.xls</a>
      . The derived mitigations are as follows:
    </p>
    <ul>
      <li>
        <p>Document Metadata Subscriber and Document Metadata Notification Broker shall be grouped with a Secure Node or Secure Application in the Audit Trail and Node Authentication (ATNA) Profile.</p>
      </li>
      <li>
        <p>The use of encrypted TLS is recommended when the transmission is not otherwise secured (e.g., transmission over a secure network)</p>
      </li>
    </ul>
    <p>As it is possible through the document metadata subscribe transaction to maliciously overload the Document Metadata Notification Recipient Actors, it is recommended that a strong authentication be used in combination with access rights enforcement and that authentication data should be conveyed through the Cross-Enterprise User Assertion (XUA) Profile. This recommendation also addresses the possibility of malicious cancellations of subscriptions.</p>
    <p>Additionally, it is recommended that organizational measures be taken to avoid:</p>
    <ul>
      <li>
        <p>overload of a Document Metadata Notification Recipient through subscription which cannot be cancelled because the subscription id has been lost e.g., through an administrative service allowing cancellation of subscription under well-defined circumstances</p>
      </li>
      <li>
        <p>cancellation of a subscription unnoticed by the intended document metadata notification recipient e.g., through an informative message (out of the scope of this transaction) sent to the intended recipient</p>
      </li>
    </ul>
    <p>This profile provides the ihe:MinimalDocumentEntry topic expression to avoid disclosing sensitive information. Using this type of topic expression allows delegation of the access control decisions to the Document Sharing infrastructure.</p>
    <h4 class="list-paragraph" id="3.52.6.1">3.52.6.1 Audit Record Considerations</h4>
    <p>The Document Metadata Subscribe transaction is a Query Information event as defined in Table <a href="../Volume2a/ITI-20.html#3.20.4.1.1.1">ITI TF-2a: 3.20.4.1.1.1</a>-1. The actors involved shall record audit events according to the following:</p>
    <h5 class="list-paragraph" id="3.52.6.1.1">3.52.6.1.1 Document Metadata Subscriber audit message:</h5>
    <table>
      <tbody>
        <tr class="odd">
          <td />
          <td>Field Name</td>
          <td>Opt</td>
          <td>Value Constraints</td>
        </tr>
        <tr class="even">
          <td>
            <p>Event</p>
            <p>
              AuditMessage/
              <br />
              EventIdentification
            </p>
          </td>
          <td>EventID</td>
          <td>M</td>
          <td>EV(110112, DCM, “Query”)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>EventActionCode</td>
          <td>M</td>
          <td>
            <p>“C” (Create) for Subscribe message exchange</p>
            <p>“D” (Delete) for Unsubscribe message exchange</p>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>EventDateTime</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>EventOutcomeIndicator</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>EventTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-52”, “IHE Transactions”, “Document Metadata Subscribe”)</td>
        </tr>
        <tr class="odd">
          <td>Source (Document Metadata Subscriber) (1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="even">
          <td>Human Requestor (0..n)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="odd">
          <td>Destination (Document Metadata Notification Broker) (1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="even">
          <td>Audit Source (Document Metadata Subscriber) (1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="odd">
          <td>Subscription (0..1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="even">
          <td>Patient (0..1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="odd">
          <td>Query Parameters (0..1) (required for Subscribe message, not used for Unsubscribe message)</td>
          <td />
          <td />
          <td />
        </tr>
      </tbody>
    </table>
    <p>Where:</p>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Source</p>
            <p>
              AuditMessage/
              <br />
              ActiveParticipant
            </p>
          </td>
          <td>
            <em>UserID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>AlternativeUserID</td>
          <td>M</td>
          <td>the process ID as used within the local operating system in the local system logs.</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>UserName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>UserIsRequestor</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110153, DCM, “Source”)</td>
        </tr>
        <tr class="even">
          <td />
          <td>NetworkAccessPointTypeCode</td>
          <td>M</td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr class="odd">
          <td />
          <td>NetworkAccessPointID</td>
          <td>M</td>
          <td>The machine name or IP address</td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Human Requestor (if known)</p>
            <p>
              AuditMessage/
              <br />
              ActiveParticipant
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>Identity of the human that initiated the transaction.</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>AlternativeUserID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>UserName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>UserIsRequestor</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>RoleIDCode</td>
          <td>U</td>
          <td>Access Control role(s) the user holds that allows this transaction.</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>NetworkAccessPointTypeCode</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>NetworkAccessPointID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Destination</p>
            <p>
              AuditMessage/
              <br />
              ActiveParticipant
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>SOAP endpoint URI.</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>AlternativeUserID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>UserName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>UserIsRequestor</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110152, DCM, “Destination”)</td>
        </tr>
        <tr class="even">
          <td />
          <td>NetworkAccessPointTypeCode</td>
          <td>
            <em>M</em>
          </td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr class="odd">
          <td />
          <td>NetworkAccessPointID</td>
          <td>
            <em>M</em>
          </td>
          <td>The machine name or IP address</td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Audit Source</p>
            <p>
              AuditMessage/
              <br />
              AuditSourceIdentification
            </p>
          </td>
          <td>
            <em>AuditSourceID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized.</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>AuditEnterpriseSiteID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>AuditSourceTypeCode</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <thead>
        <tr class="header">
          <th>
            <p>Subscription</p>
            <p>(if known)</p>
            <p>
              (AuditMessage/
              <br />
              ParticipantObjectIdentification)
            </p>
          </th>
          <th>ParticipantObjectTypeCode</th>
          <th>M</th>
          <th>“2” (system object)</th>
        </tr>
      </thead>
      <tbody>
        <tr class="odd">
          <td />
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“20” (job)</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectDataLifeCycle</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-52”, “IHE Transactions”, “Document Metadata Subscribe”)</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectSensitivity</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>
            <p>For the Subscribe Message, the URI contained in the &lt;wsnt:SubscriptionReference/wsa:Address/&gt;</p>
            <p>For the Unsubscribe message, the URI contained in the &lt;soap12:Header/wsa:Address/&gt;</p>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectQuery</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectDetail</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>
              Patient
              <br />
              (if known)
            </p>
            <p>
              (AuditMessage/
              <br />
              ParticipantObjectIdentification)
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“1” (Person)</td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“1” (Patient)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDataLifeCycle</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectIDTypeCode</em>
          </td>
          <td>M</td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectSensitivity</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>The patient ID in HL7 CX format.</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectQuery</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDetail</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Query Parameters</p>
            <p>
              (AuditMessage/
              <br />
              ParticipantObjectIdentification)
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“2” (system object)</td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“24” (query)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDataLifeCycle</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-52”, “IHE Transactions”, “Document Metadata Subscribe”)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectSensitivity</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectID</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>The value of &lt;wsnt:Subscribe/wsnt:Filter/rim:AdhocQuery/@id/&gt;</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectQuery</em>
          </td>
          <td>M</td>
          <td>The value of &lt;wsnt:Subscribe/&gt; element, base64 encoded.</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDetail</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <h5 class="list-paragraph" id="3.52.6.1.2">3.52.6.1.2 Document Metadata Notification Broker audit message:</h5>
    <table>
      <tbody>
        <tr class="odd">
          <td />
          <td>Field Name</td>
          <td>Opt</td>
          <td>Value Constraints</td>
        </tr>
        <tr class="even">
          <td>
            <p>Event</p>
            <p>
              AuditMessage/
              <br />
              EventIdentification
            </p>
          </td>
          <td>EventID</td>
          <td>M</td>
          <td>EV(110112, DCM, “Query”)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>EventActionCode</td>
          <td>M</td>
          <td>
            <p>“C” (Create) for Subscribe message exchange</p>
            <p>“D” (Delete) for Unsubscribe message exchange</p>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>EventDateTime</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>EventOutcomeIndicator</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>EventTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-52”, “IHE Transactions”, “Document Metadata Subscribe”)</td>
        </tr>
        <tr class="odd">
          <td>Source (Document Metadata Subscriber) (1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="even">
          <td>Destination (Document Metadata Notification Broker) (1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="odd">
          <td>Audit Source (Document Metadata Notification Broker) (1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="even">
          <td>Subscription (0..1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="odd">
          <td>Patient (0..1)</td>
          <td />
          <td />
          <td />
        </tr>
        <tr class="even">
          <td>Query Parameters (0..1) (required for Subscribe message, not used for Unsubscribe message)</td>
          <td />
          <td />
          <td />
        </tr>
      </tbody>
    </table>
    <p>Where:</p>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Source</p>
            <p>
              AuditMessage/
              <br />
              ActiveParticipant
            </p>
          </td>
          <td>
            <em>UserID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>AlternativeUserID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>UserName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>UserIsRequestor</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110153, DCM, “Source”)</td>
        </tr>
        <tr class="even">
          <td />
          <td>NetworkAccessPointTypeCode</td>
          <td>
            <em>M</em>
          </td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr class="odd">
          <td />
          <td>NetworkAccessPointID</td>
          <td>
            <em>M</em>
          </td>
          <td>The machine name or IP address</td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Destination</p>
            <p>
              AuditMessage/
              <br />
              ActiveParticipant
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>SOAP endpoint URI.</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>AlternativeUserID</em>
          </td>
          <td>M</td>
          <td>the process ID as used within the local operating system in the local system logs.</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>UserName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>UserIsRequestor</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110152, DCM, “Destination”)</td>
        </tr>
        <tr class="even">
          <td />
          <td>NetworkAccessPointTypeCode</td>
          <td>
            <em>M</em>
          </td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr class="odd">
          <td />
          <td>NetworkAccessPointID</td>
          <td>
            <em>M</em>
          </td>
          <td>The machine name or IP address</td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Audit Source</p>
            <p>
              AuditMessage/
              <br />
              AuditSourceIdentification
            </p>
          </td>
          <td>
            <em>AuditSourceID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>AuditEnterpriseSiteID</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>AuditSourceTypeCode</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <thead>
        <tr class="header">
          <th>
            <p>Subscription</p>
            <p>(if known)</p>
            <p>
              (AuditMessage/
              <br />
              ParticipantObjectIdentification)
            </p>
          </th>
          <th>ParticipantObjectTypeCode</th>
          <th>M</th>
          <th>“2” (system object)</th>
        </tr>
      </thead>
      <tbody>
        <tr class="odd">
          <td />
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“20” (job)</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectDataLifeCycle</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-52”, “IHE Transactions”, “Document Metadata Subscribe ”)</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectSensitivity</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>
            <p>For the Subscribe Message, the URI contained in the &lt;wsnt:SubscriptionReference/wsa:Address/&gt;</p>
            <p>For the Unsubscribe message, the URI contained in the &lt;soap12:Header/wsa:Address/&gt;</p>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectQuery</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectDetail</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Patient</p>
            <p>(If known)</p>
            <p>
              (AuditMessage/
              <br />
              ParticipantObjectIdentification)
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“1” (Person)</td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“1” (Patient)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDataLifeCycle</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectIDTypeCode</em>
          </td>
          <td>
            <em>M</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectSensitivity</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>The patient ID in HL7 CX format.</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectName</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectQuery</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDetail</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
    <table>
      <tbody>
        <tr class="odd">
          <td>
            <p>Query Parameters</p>
            <p>
              (AuditMessage/
              <br />
              ParticipantObjectIdentification)
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“2” (system object)</td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“24” (query)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectDataLifeCycle</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-52”, “IHE Transactions”, “Document Metadata Subscribe”)</td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectSensitivity</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectID</em>
          </td>
          <td>M</td>
          <td>
            <em>The value of &lt;wsnt:Subscribe/wsnt:Filter/rim:AdhocQuery/@id/&gt;</em>
          </td>
        </tr>
        <tr class="odd">
          <td />
          <td>
            <em>ParticipantObjectQuery</em>
          </td>
          <td>M</td>
          <td>The value of &lt;wsnt:Subscribe/&gt; element, base64 encoded.</td>
        </tr>
        <tr class="even">
          <td />
          <td>
            <em>ParticipantObjectDetail</em>
          </td>
          <td>
            <em>U</em>
          </td>
          <td>
            <em>not specialized</em>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>
