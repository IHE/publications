<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta xmlns="" charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title xmlns="">IHE ITI TF Vol2</title>
    <link xmlns="" rel="stylesheet" href="../../../css/styles.css" />
    <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-HLBNC861DJ" async> </script> 
</head>
  <body xmlns="">
    <header>
        <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
          <button class="menu-icon" type="button" data-toggle="responsive-menu"></button>
          <div class="title-bar-title">IHE ITI Technical Framework</div>
        </div>
        <div class="top-bar" id="responsive-menu">
          <div class="top-bar-left">
            <img src="../../../IHE_INTERNATIONAL.png" class="IHE logo hide-for-small-only" alt="IHE logo" />
            <ul id="tf-small-menu" class="menu vertical show-for-small-only">
              <li><a class="ihe-purple" href="https://ihe.net" target="_blank">About IHE</a></li>
              <li class="menu-text">Sections
                <ul id="tf-small-menu-list" class="nested vertical menu">
                </ul>
              </li>
            </ul>
          </div>
          <div class="top-bar-right hide-for-small-only">
            <ul class="menu">
              <li class="menu-text tf-version">IHE IT Infrastructure (ITI) Technical Framework, Volume <span id="volumeNo"></span><br />Revision 19.0, June 17, 2022 – Final Text</li>
            </ul>
              <ul class="menu align-right">
                    <li><input id="ihe-search-field" type="search" placeholder="Search"></li>
                    <li><button id="ihe-search-button" type="button" class="button search">Search</button></li>
                </ul>
            </div>
        </div>
         </header>
    <div class="navigation">
      <nav aria-label="You are here:" role="navigation">
        <ul class="breadcrumbs">
        </ul>
      </nav>
    </div>
    <div class="scroll-top-wrapper">
      <span class="scroll-top-inner">
        <i class="size-icon-lg fi-arrow-up"></i>
      </span>
    </div>
    <div class="grid-container fluid">
      <div class="grid-x grid-margin-x align-center">
        <div class="cell medium-11">
          <div class="callout disclaimer warning text-center">              
          The Final Text ITI Technical Framework is published here in HTML format and is no longer published as PDF. Trial Implementation supplements are available from the <a href=https://profiles.ihe.net/ITI/TF/Volume1/index.html>Volume 1 Table of Contents</a>.
          </div>
        </div>
      </div>
      <main>
        <div class="grid-x grid-margin-x align-center">
          <div class="hide-for-small-only cell medium-2 large-2" data-sticky-container>
            <div id="section-menu" class="sticky" data-sticky data-anchor="main-top">
            </div>
          </div>
          <div id="main-top" class="cell medium-10 large-10">
      <h2 id="3.52">3.52 Document Metadata Subscribe [ITI-52]</h2>
      <p>This section corresponds to transaction [ITI-52] of the IHE IT Infrastructure Technical Framework. Transaction [ITI-52] is used by the Document Metadata Subscriber and the Document Metadata Notification Broker Actors.</p>
      <h3 id="3.52.1">3.52.1 Scope</h3>
      <p>This transaction involves a request by the Document Metadata Subscriber to the Document Metadata Notification Broker to start a subscription using a particular set of filters, or to cancel an existing subscription.</p>
      <h3 id="3.52.2">3.52.2 Use Case Roles</h3>
      <p>
        <span style="font-weight:bold">Actor:</span>
        <span>Document Metadata Subscriber</span>
      </p>
      <p>
        <span style="font-weight:bold">Role:</span>
        <span>Sends, on the behalf of Document Metadata Notification Recipients, subscription requests, or subscription cancellation messages to the Document Metadata Notification Broker</span>
      </p>
      <p>
        <span style="font-weight:bold">Actor:</span>
        <span>Document Metadata Notification Broker</span>
      </p>
      <p>
        <span style="font-weight:bold">Role:</span>
        <span>Manages subscriptions of Document Metadata Notification Recipients</span>
      </p>
      <h3 id="3.52.3">3.52.3 Referenced Standards</h3>
      <ul>
        <li class="bullet-list1">
          <a href="http://www.oasis-open.org/committees/tc_home.php?wg_abbrev=wsn">OASIS Web Services Notification Family of Standards</a>
        </li>
        <li class="bullet-list1">
          <a href="http://docs.oasis-open.org/wsn/wsn-ws_base_notification-1.3-spec-os.pdf">WS-BaseNotification 1.3 OASIS Standard</a>
          <span style="text-decoration:underline" />
        </li>
        <li class="bullet-list1">
          <a href="http://docs.oasis-open.org/wsn/wsn-ws_brokered_notification-1.3-spec-os.pdf">WS-BrokeredNotification 1.3 OASIS Standard</a>
          <span style="text-decoration:underline" />
        </li>
        <li class="bullet-list1">
          <a href="http://docs.oasis-open.org/wsn/wsn-ws_topics-1.3-spec-os.pdf">WS-Topics 1.3 OASIS Standard</a>
          <span style="text-decoration:underline" />
        </li>
        <li class="bullet-list1">
          <a href="../Volume2/ITI-18.html#3.18">ITI TF-2: 3.18</a>
          - Registry Stored Query Transaction
        </li>
        <li class="bullet-list1">
          <span style="text-decoration:underline">
            <a href="../Volume2/ch-V.html#Appendix V">ITI TF-2: Appendix V</a>
          </span>
        </li>
      </ul>
      <h3 id="3.52.4">3.52.4 Messages</h3>
      <div id="f3.52.4-1">
        <img src="media/Figure_3.52.4-1.png" alt="DSubscribe_ID" />
        <p class="figureTitle">Figure 3.52.4-1: Document Metadata Subscribe Sequence</p>
      </div>
      <h4 id="3.52.4.1">3.52.4.1 Subscribe Request Message</h4>
      <h5 id="3.52.4.1.1">3.52.4.1.1 Trigger</h5>
      <p>A Document Metadata Notification Recipient's need to initiate a subscription will cause the Document Metadata Subscriber to trigger a Subscribe Request message.</p>
      <h5 id="3.52.4.1.2">3.52.4.1.2 Message Semantics</h5>
      <p>
        <span>The Subscribe Request message shall comply with the requirements in the WS-BaseNotification standard. Note that the value of the WS-Addressing Action element is prescribed in the standard, and differs from the requirements of Appendix V. The</span>
        <span style="font-style:italic">wsnt:ConsumerReference</span>
        <span>element describes the Web Service endpoint where notifications must be sent. The</span>
        <span style="font-style:italic">wsnt:Filter</span>
        <span>element shall contain the topics and values for these topics for which a notification shall be sent. Implementers of the pattern shall specify the topic content to be put within the</span>
        <span style="font-style:italic">wsnt:Filter</span>
        <span>element. The wsnt:Filter element shall contain a</span>
        <span style="font-style:italic">TopicExpression</span>
        <span>element.</span>
      </p>
      <p>This transaction uses simple topics in accordance with the WS-Topics standard and as specified in Section 3.52.5.</p>
      <p>
        <span>This transaction uses a filter based on the</span>
        <span style="text-decoration:line-through" />
        <span>Registry Stored Query [ITI-18] transaction syntax and semantics as specified in Section 3.52.5 Subscription Topics and Filter Expressions.</span>
      </p>
      <h5 id="3.52.4.1.3">3.52.4.1.3 Expected Actions</h5>
      <p>The Notification Broker shall be capable of maintaining multiple concurrent Subscriptions.</p>
      <p>The Notification Broker shall keep track of each unique subscription and will provide a unique subscription reference which shall be used by the Subscriber to send subsequent cancellations</p>
      <p>
        <span>The Subscriber may indicate the duration of the subscription using the</span>
        <span style="font-style:italic">wsnt:InitialTerminationTime</span>
        <span>element, where a time stamp (expressed as an XML Schema</span>
        <span style="font-style:italic">dateTime</span>
        <span>data type value) or a duration (expressed as an XML Schema</span>
        <span style="font-style:italic">duration</span>
        <span>data type value) can be used.</span>
        <span style="font-weight:bold;text-decoration:underline" />
      </p>
      <p>If the Document Metadata Notification Broker is not able to understand a filter expression it SHALL create faults in accordance with the following rules:</p>
      <ul>
        <li class="bullet-list1">InvalidFilterFault: the Subscribe message contained a filter that was not understood or supported by the Document Metadata Notification Broker. For example the ReferenceIdList filter parameter exists and the Document Metadata Notification Broker cannot satisfy it.</li>
        <li class="bullet-list1">TopicExpressionDialectUnknownFault: the Subscribe message contained a TopicExpression filter having a dialect that was not understood or supported by the Document Metadata Notification Broker.</li>
        <li class="bullet-list1">InvalidTopicExpressionFault: the Subscribe message contained a TopicExpression filter where the contents of the filter did not match the dialect specified.</li>
        <li class="bullet-list1">TopicNotSupportedFault: the Subscribe message contained a TopicExpression filter that referenced a topic that was not supported by the Document Metadata Notification Broker. This Fault SHALL be generated by a Document Metadata Notification Broker that does not support the Folder Subscription Option if it receives a request for a subscription using the topic ihe:FolderMetadata.</li>
        <li class="bullet-list1">SubscribeCreationFailedFault: The Document Metadata Notification Broker failed to process the Subscribe message. The Document Metadata Notification Broker SHOULD use a more specific fault message if possible. The Document Metadata Notification Broker MAY include a hint in the fault message indicating why it failed to process the Subscribe message.</li>
      </ul>
      <h5 id="3.52.4.1.4">3.52.4.1.4 Example Subscribe Request Message (subscription on a document filter)</h5>
      <div style="border:0.75pt solid #000000; clear:both">
        <p style="font-size:8pt">
          <span>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:a="http://www.w3.org/2005/08/addressing"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2005/08/addressing http://www.w3.org/2005/08/addressing/ws-addr.xsd http://docs.oasis-open.org/wsn/b-2 http://docs.oasis-open.org/wsn/b-2.xsd urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0 ../schema/ebRS/rim.xsd"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Header&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;a:Action&gt;http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeRequest&lt;/a:Action&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;a:MessageID&gt;382dcdc7-8e84-9fdc-8443-48fd83bca938&lt;/a:MessageID&gt;</span>
          <span style="width:25.54pt;display:inline-block;-aw-tabstop-align:left;-aw-tabstop-pos:366.4pt"> </span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">        &lt;a:To s:mustUnderstand="1"&gt;</span>
          <a href="http://localhost:8080/services/initiatingGateway/query%3c/a:To">http://localhost:8080/services/initiatingGateway/query</a>
          <span style="font-size:8pt">&lt;/a:To&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Header&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;wsnt:Subscribe&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;!-- The Recipient on whose behalf the subscription is requested - the address where the notification is to be sent --&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:ConsumerReference&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;a:Address&gt;https://NotificationRecipientServer/xdsBnotification&lt;/a:Address&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;/wsnt:ConsumerReference&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:Filter&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;wsnt:TopicExpression Dialect="http://docs.oasis-open.org/wsn/t-1/TopicExpression/Simple"&gt;ihe:MinimalDocumentEntry&lt;/wsnt:TopicExpression&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;rim:AdhocQuery id="urn:uuid:aa2332d0-f8fe-11e0-be50-0800200c9a66"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;rim:Slot name="$XDSDocumentEntryPatientId"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                            &lt;rim:Value&gt;'st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO'&lt;/rim:Value&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;/rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;/rim:Slot&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;rim:Slot name="$XDSDocumentEntryHealthcareFacilityTypeCode"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                            &lt;rim:Value&gt;('Emergency Department^^healthcareFacilityCodingScheme')&lt;/rim:Value&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;/rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                      &lt;/rim:Slot&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;/rim:AdhocQuery&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;/wsnt:Filter&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:InitialTerminationTime&gt;2010-05-31T00:00:00.00000Z&lt;/wsnt:InitialTerminationTime&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;/wsnt:Subscribe&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;/s:Envelope&gt;</span>
        </p>
      </div>
      <p>
        <a name="_Toc428454150"> </a>
      </p>
      <h4 id="3.52.4.2">3.52.4.2 Subscribe Response Message</h4>
      <h5 id="3.52.4.2.1">3.52.4.2.1 Trigger</h5>
      <p>This message is an immediate response to a Subscribe Request, and it is sent from the Document Metadata Notification Broker to the Document Metadata Subscriber.</p>
      <h5 id="3.52.4.2.2">3.52.4.2.2 Message Semantics</h5>
      <p>
        The Subscribe Response message shall comply with the requirements in the WS-BaseNotification standard, including the use of the appropriate SOAP Fault messages. Note that the value of the WS-Addressing Action element is prescribed in the standard, and differs from the requirements of
        <a href="../Volume2/ch-V.html#Appendix V">ITI TF-2: Appendix V</a>.
      </p>
      <p>The subscription identifier is assigned by the Notification Broker as a subscription reference, communicated in the response in the SOAP body in wsnt:SubscribeResponse/wsnt:SubscriptionReference (a WS-Addressing endpoint). The subscription reference shall consist of:</p>
      <ul>
        <li class="bullet-list1">
          <span>an</span>
          <span style="font-style:italic">Address</span>
          <span>element, containing a webservices endpoint</span>
        </li>
      </ul>
      <p>In order to unsubscribe, the request shall be sent to the endpoint specified in the Address component of the SubscriptionReference.</p>
      <h5 id="3.52.4.2.3">3.52.4.2.3 Expected Actions</h5>
      <p>
        <span>If the Document Metadata Subscriber had indicated a requested duration for the subscription, the Document Metadata Notification Broker shall send the assigned duration for the subscription using the</span>
        <span style="font-style:italic">wsnt:TerminationTime</span>
        <span>element.</span>
      </p>
      <p>
        <span>If the Document Metadata Subscriber had not indicated a requested duration for the subscription, the Document Metadata Notification Broker may send an assigned duration for the subscription (if any), using the</span>
        <span style="font-style:italic">wsnt:TerminationTime</span>
        <span>element.</span>
      </p>
      <p>If the Document Metadata Notification Broker sends an assigned duration for the subscription, the Subscriber shall associate the assigned duration with the accepted subscription request.</p>
      <p>The Document Metadata Subscriber shall associate the accepted subscription request with the subscription reference address assigned by the Document Metadata Notification Broker in order to be able to send cancellations for existing subscriptions.</p>
      <h5 id="3.52.4.2.4">3.52.4.2.4 Example</h5>
      <div style="border:0.75pt solid #000000; clear:both">
        <p style="font-size:8pt">
          <span>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:a="http://www.w3.org/2005/08/addressing"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2005/08/addressing http://www.w3.org/2005/08/addressing/ws-addr.xsd http://docs.oasis-open.org/wsn/b-2 http://docs.oasis-open.org/wsn/b-2.xsd"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Header&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;a:Action&gt;http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeResponse&lt;/a:Action&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Header&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;wsnt:SubscribeResponse&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;!-- A WS-Addressing endpoint, where modification and cancelation requests for this subscription must be sent --&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:SubscriptionReference&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;a:Address&gt;https://NotificationBrokerServer/Subscription/382dcdc7-8e84-9fdc-8443&lt;/a:Address&gt;  </span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;/wsnt:SubscriptionReference&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:TerminationTime&gt;2008-05-31T00:00:00Z&lt;/wsnt:TerminationTime&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;/wsnt:SubscribeResponse&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;/s:Envelope&gt;</span>
        </p>
      </div>
      <h4 id="3.52.4.3">3.52.4.3 Unsubscribe Request Message</h4>
      <h5 id="3.52.4.3.1">3.52.4.3.1 Trigger</h5>
      <p>When a subscription is no longer needed, a Document Metadata Subscriber will trigger an Unsubscribe Request message.</p>
      <h5 id="3.52.4.3.2">3.52.4.3.2 Message Semantics</h5>
      <p>
        The Unsubscribe Request message shall comply with the requirements in the WS-BaseNotification standard. The message conveys the request to cancel an existing subscription. Note that the value of the WS-Addressing Action element is prescribed in the standard, and differs from the requirements of
        <a href="../Volume2/ch-V.html#Appendix V">ITI TF-2: Appendix V</a>.
      </p>
      <h5 id="3.52.4.3.3">3.52.4.3.3 Expected Actions</h5>
      <p>The Document Metadata Subscriber shall send this message to the endpoint associated with the existing subscription.</p>
      <p>The Document Metadata Notification Broker shall cancel the corresponding subscription, and respond with an Unsubscribe Response message. In the case when, for whatever reason, the subscription cannot be canceled, the Document Metadata Notification Broker shall respond with a ResourceUnknownFault or an UnableToDestroySubscriptionFault SOAP Fault message as appropriate.</p>
      <h5 id="3.52.4.3.4">3.52.4.3.4 Example</h5>
      <div style="border:0.75pt solid #000000; clear:both">
        <p style="font-size:8pt">
          <span>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:a="http://www.w3.org/2005/08/addressing"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2005/08/addressing http://www.w3.org/2005/08/addressing/ws-addr.xsd http://docs.oasis-open.org/wsn/b-2 http://docs.oasis-open.org/wsn/b-2.xsd"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Header&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;a:Action&gt;http://docs.oasis-open.org/wsn/bw-2/SubscriptionManager/UnsubscribeRequest&lt;/a:Action&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;a:MessageID&gt;382dcdc9-8e86-9fde-8445-48fd83bca93a&lt;/a:MessageID&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;a:To&gt;https://NotificationBrokerServer/Subscription/382dcdc7-8e84-9fdc-8443&lt;/a:To&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Header&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;wsnt:Unsubscribe/&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;/s:Envelope&gt;</span>
        </p>
      </div>
      <h4 id="3.52.4.4">3.52.4.4 Unsubscribe Response Message</h4>
      <h5 id="3.52.4.4.1">3.52.4.4.1 Trigger</h5>
      <p>This message is an immediate response to an Unsubscribe Request message, and it is sent from the Document Metadata Notification Broker to the Document Metadata Subscriber.</p>
      <h5 id="3.52.4.4.2">3.52.4.4.2 Message Semantics</h5>
      <p>
        The Unsubscribe Response message shall comply with the requirements in the WS-BaseNotification standard. This message indicates that an Unsubscribe message was successfully processed. Note that the value of the WS-Addressing Action element is prescribed in the standard, and differs from the requirements of
        <a href="../Volume2/ch-V.html#Appendix V">ITI TF-2: Appendix V</a>.
      </p>
      <h5 id="3.52.4.4.3">3.52.4.4.3 Expected Actions</h5>
      <p>The Document Metadata Notification Broker shall cancel the corresponding subscription.</p>
      <p>The Document Metadata Subscriber shall mark the corresponding subscription as successfully terminated.</p>
      <h5 id="3.52.4.4.4">3.52.4.4.4 Example</h5>
      <div style="border:0.75pt solid #000000; clear:both">
        <p style="font-size:8pt">
          <span>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:a="http://www.w3.org/2005/08/addressing"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2005/08/addressing http://www.w3.org/2005/08/addressing/ws-addr.xsd http://docs.oasis-open.org/wsn/b-2 http://docs.oasis-open.org/wsn/b-2.xsd"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Header&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;a:Action&gt;http://docs.oasis-open.org/wsn/bw-2/SubscriptionManager/UnsubscribeResponse&lt;/a:Action&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Header&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;wsnt:UnsubscribeResponse/&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;/s:Envelope&gt;</span>
        </p>
      </div>
      <h3 id="3.52.5">3.52.5 Subscription Topics and Filter Expressions</h3>
      <p>This transaction restricts the subscription topic to be one of FullDocumentEntry or MinimalDocumentEntry (Section 3.52.5.1) and restricts the semantics of filter expressions to the semantics of a subset (Section 3.52.5.2) of the Registry Stored Query [ITI-18] transaction.</p>
      <h4 id="3.52.5.1">3.52.5.1 Topics</h4>
      <p>This transaction defines simple topics as described in the WS-Topics specification. If the Document Metadata Notification Broker supports the Folder Subscription Option it shall support all the following topics in a Document Metadata Subscribe Request; otherwise it shall reject subscription Request which specify folder's topic generating a fault (see Section 3.52.4.1.3 “Expected Actions”). The Document Metadata Subscriber may support a subset of these topics:</p>
      <h5 id="3.52.5.1.1">3.52.5.1.1 ihe:FullDocumentEntry</h5>
      <p>This topic indicates that the events for which the subscription is made shall be Document Entry registrations, and that the notification shall contain the full metadata describing each matching Document Entry as described in the Notification transaction in Section 3.53.4.1.2.</p>
      <h5 id="3.52.5.1.2">3.52.5.1.2 ihe:MinimalDocumentEntry</h5>
      <p>This topic indicates that the events for which the subscription is made shall be Document Entry registrations, and that the notification shall contain the minimal set of data describing each matching Document Entry as described in the Document Metadata Notify transaction in Section 3.53.4.1.2.</p>
      <h5 id="3.52.5.1.3">3.52.5.1.3 ihe:SubmissionSetMetadata</h5>
      <p>This topic indicates that the event for which the subscription is made shall be creating a SubmissionSet and that the notification shall contain the full metadata describing the match with the SubmissionSet object, as described in the Document Metadata Notify transaction in Section 3.53.4.1.2.</p>
      <h4 id="3.52.5.2">3.52.5.2 Building Filter Expressions</h4>
      <p>
        The XDS metadata, specified in
        <a href="../Volume3/ch-4.1.html#4.1">ITI TF-3: 4.1</a>, describes the objects which are used in a document registration. The Registry Stored Query [ITI-18] transaction uses a subset of the metadata to build a list of queries available to a XDS Document Consumer to search for documents with specific characteristics. The list of queries is in
        <a href="../Volume2/ITI-18.html#3.18.4.1.2.3.7">ITI TF-2: 3.18.4.1.2.3.7</a>. The transaction Document Metadata Subscribe uses the syntax of the Registry Stored Query [ITI-18] transaction for the creation of the filtering expression.
      </p>
      <p>Filters can be created using the parameters of the FindDocuments, FindDocumentsByReferenceId, FindSubmissionSet queries defined within the Registry Stored Query transaction and use the syntax of the FindDocuments FindDocumentsByReferenceId or FindSubmissionSets queries to express the filter.</p>
      <p>
        <span>The evaluation of filter expressions is based on the XDS metadata model. In this transaction, the stream of events for which subscriptions are possible is limited to events representing the</span>
        <span style="font-weight:bold" />
        <span>existence of SubmissionSet and documentEntry Objects. The Document Metadata Notification Broker becomes aware of such events either via a Document Metadata Publish [ITI-54] transaction, or via other mechanisms not specified by IHE. The Document Metadata Notification Broker shall determine if there is a subscription which matches any of the Document Entry Objects or SubmissionSet Object in an event.</span>
      </p>
      <p>A match means that if a Registry Stored Query, with the same parameters as the filter expression in the subscription, were sent to a XDS Document Registry containing the Document Entry Objects or SubmissionSet Object from the event, the result of this Stored Query would contain one or more of these Objects.</p>
      <p>In an XDS Affinity Domain context, the applicable events are likely to be Register Document Set [ITI-42] transaction containing one or more Document Entry objects. In this case, the Document Metadata Notification Broker may have to map between the model within which the events took place, and the Document Sharing metadata model.</p>
      <p>A good understanding of the Registry Stored Query transaction and the XDS metadata is necessary to understand how the filter expressions work. For example, if the filter expression below were implemented as a stored query on the registry</p>
      <div style="border:0.75pt solid #000000; clear:both">
        <p style="font-size:8pt">
          <span>&lt;rim:AdhocQuery id="urn:uuid:aa2332d0-f8fe-11e0-be50-0800200c9a66" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;rim:Slot name="$XDSDocumentEntryPatientId"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;rim:Value&gt;'st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO'&lt;/rim:Value&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;/rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/rim:Slot&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;rim:Slot name="$XDSDocumentEntryEventCodeList"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;rim:Value&gt;('44950^^codScheme','44955^^codScheme','44960^^codScheme',' 44970^^codScheme','44979^^codScheme')&lt;/rim:Value&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;/rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/rim:Slot&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;/rim:AdhocQuery&gt;</span>
        </p>
      </div>
      <p>it will return all document entries for patient with ID st3498702 (assigned by an authority identified by the OID 1.3.6.1.4.1.21367.2005.3.7) where the event code metadata contains at least one of the codes listed (in this case CPT codes for various appendectomies). When used as a filter expression, the same structure will yield a match against a document entry in an XDS registry submission, where the document entry is for patient with ID st3498702 and the event code is "44970". The following snippet shows an example of such a submission:</p>
      <div style="border:0.75pt solid #000000; clear:both">
        <p style="font-size:8pt">
          <span>&lt;lcm:SubmitObjectsRequest&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;rim:RegistryObjectList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;rim:ExtrinsicObject id="Document01" mimeType="text/xml" objectType="urn:uuid:7edca82f-054d-47f2-a032-9b2a5b5186c1"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>...</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;rim:Classification classificationScheme="urn:uuid:2c6b8cb7-8b2a-4051-b291-b1ae6a575ef4" classifiedObject="Document01" nodeRepresentation="44950"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;rim:Name&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;rim:LocalizedString value="Appendectomy"/&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;/rim:Name&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;rim:Slot name="codingScheme"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;rim:Value&gt;CPT codes&lt;/rim:Value&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;/rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;/rim:Slot&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;/rim:Classification&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>...</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;rim:ExternalIdentifier id="ei01" registryObject="Document01" identificationScheme="urn:uuid:58a6f841-87b3-4a3e-92fd-a8ffeff98427" value="'st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO'"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span style="width:45.8pt;display:inline-block;-aw-tabstop-align:left;-aw-tabstop-pos:45.8pt"> </span>
          <span>        &lt;rim:Name&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;rim:LocalizedString value="XDSDocumentEntry.patientId"/&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;/rim:Name&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;/rim:ExternalIdentifier&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>...</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;rim:ExtrinsicObject&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/rim:RegistryObjectList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;/lcm:SubmitObjectsRequest&gt;</span>
        </p>
      </div>
      <p>When a Document Metadata Notification Subscriber constructs a filter expression, it shall include the whole stored query expression (as shown above) directly in the Subscribe Request message as a child of the wsnt:Filter element:</p>
      <div style="border:0.75pt solid #000000; clear:both">
        <p style="font-size:8pt">
          <span>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:a="http://www.w3.org/2005/08/addressing"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:wsnt="http://docs.oasis-open.org/wsn/b-2"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xsi:schemaLocation="http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2003/05/soap-envelope http://www.w3.org/2005/08/addressing http://www.w3.org/2005/08/addressing/ws-addr.xsd http://docs.oasis-open.org/wsn/b-2 http://docs.oasis-open.org/wsn/b-2.xsd urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0 ../schema/ebRS/rim.xsd"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Header&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;a:Action&gt;http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeRequest&lt;/a:Action&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;a:MessageID&gt;382dcdc7-8e84-9fdc-8443-48fd83bca938&lt;/a:MessageID&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Header&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;wsnt:Subscribe&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;!-- The Recipient on whose behalf the subscription is requested - the address where the notification is to be sent --&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:ConsumerReference&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;a:Address&gt;https://NotificationRecipientServer/xdsBnotification&lt;/a:Address&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;/wsnt:ConsumerReference&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:Filter&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;wsnt:TopicExpression Dialect="http://docs.oasis-open.org/wsn/t-1/TopicExpression/Simple"&gt;ihe:FullDocumentEntry&lt;/wsnt:TopicExpression&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;rim:AdhocQuery id="urn:uuid:aa2332d0-f8fe-11e0-be50-0800200c9a66"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;rim:Slot name="$XDSDocumentEntryPatientId"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                            &lt;rim:Value&gt;'st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO'&lt;/rim:Value&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;/rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;/rim:Slot&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;rim:Slot name="$XDSDocumentEntryEventCodeList"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                            &lt;rim:Value&gt;('44950^^codScheme','44955^^codScheme','44960^^codScheme',' 44970^^codScheme','44979^^codScheme')&lt;/rim:Value&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;/rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;/rim:Slot&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;/rim:AdhocQuery&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;/wsnt:Filter&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:InitialTerminationTime&gt;2008-07-31T00:00:00.00000Z&lt;/wsnt:InitialTerminationTime&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;/wsnt:Subscribe&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;/s:Envelope&gt;</span>
        </p>
      </div>
      <p>How the Document Metadata Notification Broker evaluates the filter expression, and how it performs the matching against the existing subscriptions, is out of scope of this transaction. It is expected that such implementation details will allow vendors to differentiate themselves in the marketplace.</p>
      <p>It is important to note that not all stored queries, and not all parameters defined for the stored queries, are suitable for filter expressions. The Document Metadata Notification Broker shall support the following filters and associated parameters when used in subscription requests, and the Document Metadata Subscriber may support a subset of these:</p>
      <h5 id="3.52.5.2.1">3.52.5.2.1 Subscriptions for DocumentEntry metadata</h5>
      <p>A Document Metadata Notification Broker that accepts a Subscribe Request containing filter expressions created using DocumentEntry metadata shall yield a match as described in Section 3.52.5.2. Parameters that can be used for creating the filter expression are described below:</p>
      <ul>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSDocumentEntryPatientId</span>
          <span>: this required parameter contains the patient ID for which a document entry is being registered in the XDS Document Registry</span>
        </li>
      </ul>
      <ul>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSDocumentEntryClassCode</span>
          <span>: this parameter matches against the</span>
          <span style="font-weight:bold">XDSDocumentEntry.classCode</span>
          <span>metadata elements in a given registry submission</span>
        </li>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSDocumentEntryTypeCode</span>
          <span>: this parameter matches against the</span>
          <span style="font-weight:bold">XDSDocumentEntry.typeCode</span>
          <span>metadata elements in a given registry submission</span>
        </li>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSDocumentEntryReferenceIdList</span>
          <span>: this parameter matches against the</span>
          <span style="font-weight:bold">XDSDocumentEntry.referenceIdList</span>
          <span>metadata elements in a given registry submission</span>
        </li>
      </ul>
      <p class="note">Note: The ReferenceIdList attribute is optional. If the parameter is specified, the filter matches only documents where the ID contains the value conveyed in the parameter. If the document does not contain a value in the ReferenceIdList, there is no match.</p>
      <ul>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSDocumentEntryPracticeSettingCode</span>
          <span>: this parameter matches against the</span>
          <span style="font-weight:bold">XDSDocumentEntry.practiceSettingCode</span>
          <span>metadata elements in a given registry submission</span>
        </li>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSDocumentEntryHealthcareFacilityTypeCode</span>
          <span>: this parameter matches against the</span>
          <span style="font-weight:bold">XDSDocumentEntry.healthcareFacilityTypeCode</span>
          <span>metadata elements in a given registry submission</span>
        </li>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSDocumentEntryEventCodeList</span>
          <span>: this parameter matches against the</span>
          <span style="font-weight:bold">XDSDocumentEntry.eventCodeList</span>
          <span>metadata elements in a given registry submission</span>
        </li>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSDocumentEntryConfidentialityCode</span>
          <span>: this parameter matches against the</span>
          <span style="font-weight:bold">XDSDocumentEntry.confidentialityCode</span>
          <span>metadata elements in a given registry submission</span>
        </li>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSDocumentEntryFormatCode</span>
          <span>: this parameter matches against the</span>
          <span style="font-weight:bold">XDSDocumentEntry.formatCode</span>
          <span>metadata elements in a given registry submission</span>
        </li>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSDocumentEntryAuthorPerson</span>
          <span>: this parameter matches against the</span>
          <span style="font-weight:bold">XDSDocumentEntry.author</span>
          <span>
            metadata elements in a given registry submission. All properties of this parameter specified in
            <a href="../Volume2/ITI-18.html#3.18.4.1.2.3.7.1">ITI TF-2: 3.18.4.1.2.3.7.1</a>
            are applicable in this transaction.
          </span>
        </li>
      </ul>
      <p>
        <span>With the exception of</span>
        <span style="font-weight:bold">$XDSDocumentEntryPatientId</span>
        <span>, all parameters may be multi-valued.</span>
      </p>
      <p>The AdHocQuery/@id attribute SHALL store an identifier specific for the type of filter used in creating the subscription. The UUID that identifies subscriptions for DocumentEntry’s metadata is:</p>
      <p>“urn:uuid:aa2332d0-f8fe-11e0-be50-0800200c9a66”.</p>
      <p>An example of subscription on a document filter is presented below:</p>
      <div style="border:0.75pt solid #000000; clear:both">
        <p style="font-size:8pt">
          <span>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">&lt;s:Envelope xmlns:s="</span>
          <a href="http://www.w3.org/2003/05/soap-envelope">http://www.w3.org/2003/05/soap-envelope</a>
          <span style="font-size:8pt">"</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">    xmlns:a="</span>
          <a href="http://www.w3.org/2005/08/addressing">http://www.w3.org/2005/08/addressing</a>
          <span style="font-size:8pt">"</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">    xmlns:xsi="</span>
          <a href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a>
          <span style="font-size:8pt">"</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">    xmlns:wsnt="</span>
          <a href="http://docs.oasis-open.org/wsn/b-2">http://docs.oasis-open.org/wsn/b-2</a>
          <span style="font-size:8pt">"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">    xsi:schemaLocation="</span>
          <a href="http://www.w3.org/2003/05/soap-envelope">http://www.w3.org/2003/05/soap-envelope</a>
          <span style="font-size:8pt" />
          <a href="http://www.w3.org/2003/05/soap-envelope">http://www.w3.org/2003/05/soap-envelope</a>
          <span style="font-size:8pt" />
          <a href="http://www.w3.org/2005/08/addressing">http://www.w3.org/2005/08/addressing</a>
          <span style="font-size:8pt" />
          <a href="http://www.w3.org/2005/08/addressing/ws-addr.xsd">http://www.w3.org/2005/08/addressing/ws-addr.xsd</a>
          <span style="font-size:8pt" />
          <a href="http://docs.oasis-open.org/wsn/b-2">http://docs.oasis-open.org/wsn/b-2</a>
          <span style="font-size:8pt" />
          <a href="http://docs.oasis-open.org/wsn/b-2.xsd">http://docs.oasis-open.org/wsn/b-2.xsd</a>
          <span style="font-size:8pt">urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0 ../schema/ebRS/rim.xsd"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Header&gt;</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">        &lt;a:Action&gt;</span>
          <a href="http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeRequest">http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeRequest</a>
          <span style="font-size:8pt">&lt;/a:Action&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;a:MessageID&gt;382dcdc7-8e84-9fdc-8443-48fd83bca938&lt;/a:MessageID&gt;</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">        &lt;a:To s:mustUnderstand="1"&gt;</span>
          <a href="http://localhost:8080/services/initiatingGateway/query%3c/a:To">http://localhost:8080/services/initiatingGateway/query&lt;/a:To</a>
          <span style="font-size:8pt">&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Header&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;wsnt:Subscribe&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;!-- The Recipient on whose behalf the subscription is requested - the address where the notification is to be sent --&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:ConsumerReference&gt;</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">                &lt;a:Address&gt;</span>
          <a href="https://NotificationRecipientServer/xdsBnotification">https://NotificationRecipientServer/xdsBnotification</a>
          <span style="font-size:8pt">&lt;/a:Address&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;/wsnt:ConsumerReference&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:Filter&gt;</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">                &lt;wsnt:TopicExpression Dialect="</span>
          <a href="http://docs.oasis-open.org/wsn/t-1/TopicExpression/Simple">http://docs.oasis-open.org/wsn/t-1/TopicExpression/Simple</a>
          <span style="font-size:8pt">"&gt;ihe:MinimalDocumentEntry&lt;/wsnt:TopicExpression&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;rim:AdhocQuery id="urn:uuid:aa2332d0-f8fe-11e0-be50-0800200c9a66"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;rim:Slot name="$XDSDocumentEntryPatientId"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                            &lt;rim:Value&gt;'st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO'&lt;/rim:Value&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;/rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;/rim:Slot&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;rim:Slot name="$XDSDocumentEntryHealthcareFacilityTypeCode"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                            &lt;rim:Value&gt;('Emergency Department^^healthcareFacilityCodingScheme')&lt;/rim:Value&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;/rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                      &lt;/rim:Slot&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;/rim:AdhocQuery&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;/wsnt:Filter&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:InitialTerminationTime&gt;2010-05-31T00:00:00.00000Z&lt;/wsnt:InitialTerminationTime&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;/wsnt:Subscribe&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;/s:Envelope&gt;</span>
        </p>
      </div>
      <p> </p>
      <h5 id="3.52.5.2.2">3.52.5.2.2 Subscriptions for SubmissionSets metadata</h5>
      <p>Document Metadata Notification Broker that accepts a Subscribe Request containing a filter expression based on the FindSubmissionSets stored query shall yield a match as described in Section 3.52.5.2. The subscription filter expression represents a subset of the FindSubmissionSets query parameters, with a specific extension. A Document Metadata Subscriber MAY be able to create a filter expression that includes XDSSubmissionSet.patientId, XDSSubmissionSet.sourceId, XDSSubmissionSet.authorPerson and XDSSubmissionSet.intendedRecipient. Parameters that can be used for this type of filter are described below:</p>
      <ul>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSSubmissionSetPatientId</span>
          <span>: this is a required parameter that contains the identifier of the patient target of the clinical content published by a submission and represent the value of the XDSSubmissionSet.PatientId metadata.</span>
        </li>
      </ul>
      <ul>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSSubmissionSetSourceId</span>
          <span>: this optional parameter identifies the source of the content published by the submission and represent the value of the XDSSubmissionSet.sourceId metadata. This parameter may be multi-valued.</span>
        </li>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSSubmissionSetAuthorPerson</span>
          <span>: this optional parameter identifies the authorPerson of the content published by the submission and represents the value of the XDSSubmissionSet.authorPerson metadata. This parameter may be multi-valued.</span>
        </li>
      </ul>
      <ul>
        <li class="bullet-list1">
          <span style="font-weight:bold">$XDSSubmissionSetIntendedRecipient</span>
          <span>: this is an optional parameter for the subscription. A Document Metadata Subscriber shall be able to subscribe this parameter in addition to other parameters which have direct correspondence with query parameters. This parameter represents the value of the XDSSubmissionSet.intendedRecipient metadata. This parameter identifies initial targets intended for a submission. This parameter may be multi-valued.</span>
        </li>
      </ul>
      <p class="note">Note: intendedRecipient attribute is optional. If the parameter is specified, the filter matches only submissionSets where the intendedRecipient contains the value conveyed in the parameter. If the document does not contain a value in the intendedRecipient, there is no match.</p>
      <p>The AdHocQuery/@id attribute SHALL contain an identifier specific for the type of filter used in creating the subscription. The UUID that identifies subscriptions for SubmissionSet’s metadata is:</p>
      <p>“urn:uuid:fbede94e-dbdc-4f6b-bc1f-d730e677cece”</p>
      <p>An example of subscription on a SubmissionSet filter is presented below:</p>
      <div style="border:0.75pt solid #000000; clear:both">
        <p style="font-size:8pt">
          <span>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">&lt;s:Envelope xmlns:s="</span>
          <a href="http://www.w3.org/2003/05/soap-envelope">http://www.w3.org/2003/05/soap-envelope</a>
          <span style="font-size:8pt">"</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">    xmlns:a="</span>
          <a href="http://www.w3.org/2005/08/addressing">http://www.w3.org/2005/08/addressing</a>
          <span style="font-size:8pt">"</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">    xmlns:xsi="</span>
          <a href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a>
          <span style="font-size:8pt">"</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">    xmlns:wsnt="</span>
          <a href="http://docs.oasis-open.org/wsn/b-2">http://docs.oasis-open.org/wsn/b-2</a>
          <span style="font-size:8pt">"</span>
        </p>
        <p style="font-size:8pt">
          <span>    xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">    xsi:schemaLocation="</span>
          <a href="http://www.w3.org/2003/05/soap-envelope">http://www.w3.org/2003/05/soap-envelope</a>
          <span style="font-size:8pt" />
          <a href="http://www.w3.org/2003/05/soap-envelope">http://www.w3.org/2003/05/soap-envelope</a>
          <span style="font-size:8pt" />
          <a href="http://www.w3.org/2005/08/addressing">http://www.w3.org/2005/08/addressing</a>
          <span style="font-size:8pt" />
          <a href="http://www.w3.org/2005/08/addressing/ws-addr.xsd">http://www.w3.org/2005/08/addressing/ws-addr.xsd</a>
          <span style="font-size:8pt" />
          <a href="http://docs.oasis-open.org/wsn/b-2">http://docs.oasis-open.org/wsn/b-2</a>
          <span style="font-size:8pt" />
          <a href="http://docs.oasis-open.org/wsn/b-2.xsd">http://docs.oasis-open.org/wsn/b-2.xsd</a>
          <span style="font-size:8pt">urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0 ../schema/ebRS/rim.xsd"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Header&gt;</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">        &lt;a:Action&gt;</span>
          <a href="http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeRequest">http://docs.oasis-open.org/wsn/bw-2/NotificationProducer/SubscribeRequest</a>
          <span style="font-size:8pt">&lt;/a:Action&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;a:MessageID&gt;382dcdc7-8e84-9fdc-8443-48fd83bca938&lt;/a:MessageID&gt;</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">        &lt;a:To s:mustUnderstand="1"&gt;</span>
          <a href="http://localhost:8080/services/initiatingGateway/query%3c/a:To">http://localhost:8080/services/initiatingGateway/query&lt;/a:To</a>
          <span style="font-size:8pt">&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Header&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;wsnt:Subscribe&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;!-- The Recipient on whose behalf the subscription is requested - the address where the notification is to be sent --&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:ConsumerReference&gt;</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">                &lt;a:Address&gt;</span>
          <a href="https://NotificationRecipientServer/xdsBnotification">https://NotificationRecipientServer/xdsBnotification</a>
          <span style="font-size:8pt">&lt;/a:Address&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;/wsnt:ConsumerReference&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:Filter&gt;</span>
        </p>
        <p style="font-size:10pt">
          <span style="font-size:8pt">                &lt;wsnt:TopicExpression Dialect="</span>
          <a href="http://docs.oasis-open.org/wsn/t-1/TopicExpression/Simple">http://docs.oasis-open.org/wsn/t-1/TopicExpression/Simple</a>
          <span style="font-size:8pt">"&gt;ihe:SubmissionSetMetadata&lt;/wsnt:TopicExpression&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;rim:AdhocQuery id="urn:uuid:fbede94e-dbdc-4f6b-bc1f-d730e677cece"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;rim:Slot name="$XDSSubmissionSetPatientId"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                            &lt;rim:Value&gt;'st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO'&lt;/rim:Value&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;/rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;/rim:Slot&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                    &lt;rim:Slot name="$XDSSubmissionSetIntendedRecipient"&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                            &lt;rim:Value&gt;('Some Hospital%')&lt;/rim:Value&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                            &lt;rim:Value&gt;('|Welby%')&lt;/rim:Value&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                        &lt;/rim:ValueList&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                      &lt;/rim:Slot&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>                &lt;/rim:AdhocQuery&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;/wsnt:Filter&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>            &lt;wsnt:InitialTerminationTime&gt;2010-05-31T00:00:00.00000Z&lt;/wsnt:InitialTerminationTime&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>        &lt;/wsnt:Subscribe&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>    &lt;/s:Body&gt;</span>
        </p>
        <p style="font-size:8pt">
          <span>&lt;/s:Envelope&gt;</span>
        </p>
      </div>
      <h4 id="3.52.5.3">3.52.5.3 Combining topics and filter expressions</h4>
      <p>A topic defines static rules for creating notifications. This transaction defines four topics in Section 3.52.5.1. Each subscription request shall contain exactly one topic expression.</p>
      <p>A filter expression is equivalent to a specific stored query with certain parameters. Filter conditions expressed as query parameters and used in the expressions must satisfy the same requirements as a corresponding Registry Stored Query:</p>
      <ul>
        <li class="bullet-list1">the values for all specified query parameters must match (AND all different parameters)</li>
        <li class="bullet-list1">at least one of the values of multi-valued parameters must match (OR the values in a multi-valued query parameter)</li>
      </ul>
      <p>Topics, defined in Section 3.52.5.1 and filter expressions, defined in Section 3.52.5.2, can only be used in specific combinations. These combinations are described in Table 3.52.5.3-1:</p>
      <p id="t3.52.5.3-1" class="tableTitle">Table 3.52.5.3-1: Topics and Filter Expression Combinations</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td class="tableHeader">Filter Expression</td>
          <td class="tableHeader">Topic Expression</td>
        </tr>
        <tr>
          <td rowspan="2">subscription for DocumentEntry</td>
          <td>ihe:FullDocumentEntry</td>
        </tr>
        <tr>
          <td>ihe:MinimalDocumentEntry</td>
        </tr>
        <tr>
          <td>subscription for SubmissionSets</td>
          <td>ihe:SubmissionSetMetadata</td>
        </tr>
      </table>
      <h3 id="3.52.6">3.52.6 Security Considerations</h3>
      <p>
        <span>The risk assessment for the Document Metadata Subscribe transaction is described in the risk assessment spreadsheet for the Document Metadata Subscription Profile, which is available from IHE at</span>
        <a href="http://wiki.ihe.net/images/4/46/DSUB_risk_assesment.xls">http://wiki.ihe.net/images/4/46/DSUB_risk_assesment.xls</a><span>. The derived mitigations are as follows:</span>
      </p>
      <ul>
        <li class="bullet-list1">Document Metadata Subscriber and Document Metadata Notification Broker shall be grouped with a Secure Node or Secure Application in the Audit Trail and Node Authentication (ATNA) Profile.</li>
        <li class="bullet-list1">The use of encrypted TLS is recommended when the transmission is not otherwise secured (e.g., transmission over a secure network)</li>
      </ul>
      <p>As it is possible through the document metadata subscribe transaction to maliciously overload the Document Metadata Notification Recipient Actors, it is recommended that a strong authentication be used in combination with access rights enforcement and that authentication data should be conveyed through the Cross-Enterprise User Assertion (XUA) Profile. This recommendation also addresses the possibility of malicious cancellations of subscriptions.</p>
      <p>Additionally, it is recommended that organizational measures be taken to avoid:</p>
      <ul>
        <li class="bullet-list1">overload of a Document Metadata Notification Recipient through subscription which cannot be cancelled because the subscription id has been lost e.g., through an administrative service allowing cancellation of subscription under well-defined circumstances</li>
        <li class="bullet-list1">cancellation of a subscription unnoticed by the intended document metadata notification recipient e.g., through an informative message (out of the scope of this transaction) sent to the intended recipient</li>
      </ul>
      <p>This profile provides the ihe:MinimalDocumentEntry topic expression to avoid disclosing sensitive information. Using this type of topic expression allows delegation of the access control decisions to the Document Sharing infrastructure.</p>
      <h4 id="3.52.6.1">3.52.6.1 Audit Record Considerations</h4>
      <p>
        The Document Metadata Subscribe transaction is a Query Information event as defined in Table
        <a href="../Volume2/ITI-20.html#3.20.4.1.1.1">ITI TF-2: 3.20.4.1.1.1</a>
        -1. The actors involved shall record audit events according to the following:
      </p>
      <h5 id="3.52.6.1.1">3.52.6.1.1 Document Metadata Subscriber audit message:</h5>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <div />
          </td>
          <td>Field Name</td>
          <td>Opt</td>
          <td>Value Constraints</td>
        </tr>
        <tr>
          <td rowspan="5">
            <p>Event</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">EventIdentification</span>
            </p>
          </td>
          <td>EventID</td>
          <td>M</td>
          <td>EV(110112, DCM, “Query”)</td>
        </tr>
        <tr>
          <td>EventActionCode</td>
          <td>M</td>
          <td>
            <p>“C” (Create) for Subscribe message exchange</p>
            <p> “D” (Delete) for Unsubscribe message exchange</p>
          </td>
        </tr>
        <tr>
          <td>EventDateTime</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>EventOutcomeIndicator</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>EventTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-52”, “IHE Transactions”, “Document Metadata Subscribe”)</td>
        </tr>
        <tr>
          <td colspan="4">Source (Document Metadata Subscriber) (1)</td>
        </tr>
        <tr>
          <td colspan="4">Human Requestor (0..n)</td>
        </tr>
        <tr>
          <td colspan="4">Destination (Document Metadata Notification Broker) (1)</td>
        </tr>
        <tr>
          <td colspan="4">Audit Source (Document Metadata Subscriber) (1)</td>
        </tr>
        <tr>
          <td colspan="4">Subscription (0..1)</td>
        </tr>
        <tr>
          <td colspan="4">Patient (0..1)</td>
        </tr>
        <tr>
          <td colspan="4">Query Parameters (0..1) (required for Subscribe message, not used for Unsubscribe message)</td>
        </tr>
      </table>
      <p>Where:</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="7">
            <p>Source</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ActiveParticipant</span>
            </p>
          </td>
          <td>UserID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>AlternativeUserID</td>
          <td>M</td>
          <td>the process ID as used within the local operating system in the local system logs.</td>
        </tr>
        <tr>
          <td>UserName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserIsRequestor</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110153, DCM, “Source”)</td>
        </tr>
        <tr>
          <td>NetworkAccessPointTypeCode</td>
          <td>M</td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr>
          <td>NetworkAccessPointID</td>
          <td>M</td>
          <td>The machine name or IP address</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="7">
            <p>Human Requestor (if known)</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ActiveParticipant</span>
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>Identity of the human that initiated the transaction.</td>
        </tr>
        <tr>
          <td>AlternativeUserID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserIsRequestor</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>RoleIDCode</td>
          <td>U</td>
          <td>Access Control role(s) the user holds that allows this transaction.</td>
        </tr>
        <tr>
          <td>NetworkAccessPointTypeCode</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>NetworkAccessPointID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="7">
            <p>Destination</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ActiveParticipant</span>
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>SOAP endpoint URI.</td>
        </tr>
        <tr>
          <td>AlternativeUserID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserIsRequestor</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110152, DCM, “Destination”)</td>
        </tr>
        <tr>
          <td>NetworkAccessPointTypeCode</td>
          <td>M</td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr>
          <td>NetworkAccessPointID</td>
          <td>M</td>
          <td>The machine name or IP address</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="3">
            <p>Audit Source</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">AuditSourceIdentification</span>
            </p>
          </td>
          <td>AuditSourceID</td>
          <td>U</td>
          <td>not specialized.</td>
        </tr>
        <tr>
          <td>AuditEnterpriseSiteID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>AuditSourceTypeCode</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="9">
            <p>Subscription</p>
            <p>(if known)</p>
            <p>
              <span style="font-weight:bold">(AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ParticipantObjectIdentification)</span>
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“2” (system object)</td>
        </tr>
        <tr>
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“20” (job)</td>
        </tr>
        <tr style="height:18.4pt">
          <td>ParticipantObjectDataLifeCycle</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-52”, “IHE Transactions”, “Document Metadata Subscribe”)</td>
        </tr>
        <tr>
          <td>ParticipantObjectSensitivity</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>
            <p>For the Subscribe Message, the URI contained in the &lt;wsnt:SubscriptionReference/wsa:Address/&gt; of the response message</p>
            <p>For the Unsubscribe message, the URI contained in the &lt;soap12:Header/wsa:To/&gt; of the request message</p>
          </td>
        </tr>
        <tr>
          <td>ParticipantObjectName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectQuery</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectDetail</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="9">
            <p>
              <span style="font-weight:bold">Patient</span>
              <br />
              <span style="font-weight:bold">(if known)</span>
            </p>
            <p>
              <span style="font-weight:bold">(AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ParticipantObjectIdentification)</span>
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“1” (Person)</td>
        </tr>
        <tr>
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“1” (Patient)</td>
        </tr>
        <tr>
          <td>ParticipantObjectDataLifeCycle</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectSensitivity</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>The patient ID in HL7 CX format.</td>
        </tr>
        <tr>
          <td>ParticipantObjectName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectQuery</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectDetail</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="9">
            <p>Query Parameters</p>
            <p>
              <span style="font-weight:bold">(AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ParticipantObjectIdentification)</span>
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“2” (system object)</td>
        </tr>
        <tr>
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“24” (query)</td>
        </tr>
        <tr>
          <td>ParticipantObjectDataLifeCycle</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-52”, “IHE Transactions”, “Document Metadata Subscribe”)</td>
        </tr>
        <tr>
          <td>ParticipantObjectSensitivity</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>The value of &lt;wsnt:Subscribe/wsnt:Filter/rim:AdhocQuery/@id/&gt;</td>
        </tr>
        <tr>
          <td>ParticipantObjectName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectQuery</td>
          <td>M</td>
          <td>The value of &lt;wsnt:Subscribe/&gt; element, base64 encoded.</td>
        </tr>
        <tr>
          <td>ParticipantObjectDetail</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
      <h5 id="3.52.6.1.2">3.52.6.1.2 Document Metadata Notification Broker audit message:</h5>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <div />
          </td>
          <td>Field Name</td>
          <td>Opt</td>
          <td>Value Constraints</td>
        </tr>
        <tr>
          <td rowspan="5">
            <p>Event</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">EventIdentification</span>
            </p>
          </td>
          <td>EventID</td>
          <td>M</td>
          <td>EV(110112, DCM, “Query”)</td>
        </tr>
        <tr>
          <td>EventActionCode</td>
          <td>M</td>
          <td>
            <p>“C” (Create) for Subscribe message exchange</p>
            <p>“D” (Delete) for Unsubscribe message exchange</p>
          </td>
        </tr>
        <tr>
          <td>EventDateTime</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>EventOutcomeIndicator</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>EventTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-52”, “IHE Transactions”, “Document Metadata Subscribe”)</td>
        </tr>
        <tr>
          <td colspan="4">Source (Document Metadata Subscriber) (1)</td>
        </tr>
        <tr>
          <td colspan="4">Destination (Document Metadata Notification Broker) (1)</td>
        </tr>
        <tr>
          <td colspan="4">Audit Source (Document Metadata Notification Broker) (1)</td>
        </tr>
        <tr>
          <td colspan="4">Subscription (0..1)</td>
        </tr>
        <tr>
          <td colspan="4">Patient (0..1)</td>
        </tr>
        <tr>
          <td colspan="4">Query Parameters (0..1) (required for Subscribe message, not used for Unsubscribe message)</td>
        </tr>
      </table>
      <p>Where:</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="7">
            <p>Source</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ActiveParticipant</span>
            </p>
          </td>
          <td>UserID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>AlternativeUserID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserIsRequestor</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110153, DCM, “Source”)</td>
        </tr>
        <tr>
          <td>NetworkAccessPointTypeCode</td>
          <td>M</td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr>
          <td>NetworkAccessPointID</td>
          <td>M</td>
          <td>The machine name or IP address</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="7">
            <p>Destination</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ActiveParticipant</span>
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>SOAP endpoint URI.</td>
        </tr>
        <tr>
          <td>AlternativeUserID</td>
          <td>M</td>
          <td>the process ID as used within the local operating system in the local system logs.</td>
        </tr>
        <tr>
          <td>UserName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserIsRequestor</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110152, DCM, “Destination”)</td>
        </tr>
        <tr>
          <td>NetworkAccessPointTypeCode</td>
          <td>M</td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr>
          <td>NetworkAccessPointID</td>
          <td>M</td>
          <td>The machine name or IP address</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="3">
            <p>Audit Source</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">AuditSourceIdentification</span>
            </p>
          </td>
          <td>AuditSourceID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>AuditEnterpriseSiteID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>AuditSourceTypeCode</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="9">
            <p>Subscription</p>
            <p>(if known)</p>
            <p>
              <span style="font-weight:bold">(AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ParticipantObjectIdentification)</span>
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“2” (system object)</td>
        </tr>
        <tr>
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“20” (job)</td>
        </tr>
        <tr>
          <td>ParticipantObjectDataLifeCycle</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-52”, “IHE Transactions”, “Document Metadata Subscribe ”)</td>
        </tr>
        <tr>
          <td>ParticipantObjectSensitivity</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>
            <p>For the Subscribe Message, the URI contained in the &lt;wsnt:SubscriptionReference/wsa:Address/&gt; of the response message</p>
            <p>For the Unsubscribe message, the URI contained in the &lt;soap12:Header/wsa:Address/&gt;</p>
          </td>
        </tr>
        <tr>
          <td>ParticipantObjectName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectQuery</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectDetail</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="9">
            <p>Patient</p>
            <p>(If known)</p>
            <p>
              <span style="font-weight:bold">(AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ParticipantObjectIdentification)</span>
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“1” (Person)</td>
        </tr>
        <tr>
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“1” (Patient)</td>
        </tr>
        <tr>
          <td>ParticipantObjectDataLifeCycle</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectSensitivity</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>The patient ID in HL7 CX format.</td>
        </tr>
        <tr>
          <td>ParticipantObjectName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectQuery</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectDetail</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="8">
            <p>Query Parameters</p>
            <p>
              <span style="font-weight:bold">(AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ParticipantObjectIdentification)</span>
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“2” (system object)</td>
        </tr>
        <tr>
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“24” (query)</td>
        </tr>
        <tr>
          <td>ParticipantObjectDataLifeCycle</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-52”, “IHE Transactions”, “Document Metadata Subscribe”)</td>
        </tr>
        <tr>
          <td>ParticipantObjectSensitivity</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>The value of &lt;wsnt:Subscribe/wsnt:Filter/rim:AdhocQuery/@id/&gt;</td>
        </tr>
        <tr>
          <td>ParticipantObjectQuery</td>
          <td>M</td>
          <td>The value of &lt;wsnt:Subscribe/&gt; element, base64 encoded.</td>
        </tr>
        <tr>
          <td>ParticipantObjectDetail</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
          </div>
        </div>
      </main>
    </div>
   <footer class="ihe-footer">
    <div class="grid-container fluid">
      <div class="grid-x grid-margin-x align-middle">
        <div class="cell medium-9 small-order-2 medium-order-1 text-center medium-text-left">
          © 2000 &mdash; <span id="current-year"></span> IHE International | TEL 1-630-481-1004 | 820&nbsp;Jorie&nbsp;Boulevard,
          Oak&nbsp;Brook, IL&nbsp;60523
        </div>
        <div class="cell medium-3 small-order-1 medium-order-2 text-center medium-text-right ihe-footer-icons">
          <a href="mailto:secretary@ihe.net"><i class="fi fi-mail"></i></a>
          <a href="https://www.linkedin.com/company/iheintl"><i class="fi fi-social-linkedin"></i></a>
          <a href="https://twitter.com/IHEIntl"><i class="fi fi-social-twitter" aria-hidden="true"></i></a>
          <a href="https://www.youtube.com/user/IHEIntl"><i class="fi fi-social-youtube" aria-hidden="true"></i></a>
        </div>
      </div>
    </div>
  </footer>
    <script src="../../../js/vendor/jquery.min.js"></script>
    <script src="../../../js/vendor/motion-ui.min.js"></script>
    <script src="../../../js/vendor/what-input.js"></script>
    <script src="../../../js/vendor/foundation.min.js"></script>
    <script src="../../../js/app.js"></script>
  	<script>
	 window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-HLBNC861DJ');
	</script>
</body>
</html>
