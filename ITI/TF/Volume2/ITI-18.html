<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>IHE ITI TF Vol2</title>
    <link rel="stylesheet" href="../../../css/styles.css"/>
    <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-HLBNC861DJ" async></script>
</head>
<body>
<header>
    <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
        <button class="menu-icon" type="button" data-toggle="responsive-menu"></button>
        <div class="title-bar-title">IHE ITI Technical Framework</div>
    </div>
    <div class="top-bar" id="responsive-menu">
        <div class="top-bar-left">
            <img src="../../../IHE_INTERNATIONAL.png" class="IHE logo hide-for-small-only" alt="IHE logo"/>
            <ul id="tf-small-menu" class="menu vertical show-for-small-only">
                <li><a class="ihe-purple" href="https://ihe.net" target="_blank">About IHE</a></li>
                <li class="menu-text">Sections
                    <ul id="tf-small-menu-list" class="nested vertical menu">
                    </ul>
                </li>
            </ul>
        </div>
        <div class="top-bar-right hide-for-small-only">
            <ul class="menu">
                <li class="menu-text tf-version">IHE IT Infrastructure (ITI) Technical Framework, Volume <span
                        id="volumeNo"></span><br/>Revision 19.0, June 17, 2022 – Final Text
                </li>
            </ul>
            <ul class="menu align-right">
                <li><input id="ihe-search-field" type="search" placeholder="Search"></li>
                <li>
                    <button id="ihe-search-button" type="button" class="button search">Search</button>
                </li>
            </ul>
        </div>
    </div>
</header>
<div class="navigation">
    <nav aria-label="You are here:" role="navigation">
        <ul class="breadcrumbs">
        </ul>
    </nav>
</div>
<div class="scroll-top-wrapper">
      <span class="scroll-top-inner">
        <i class="size-icon-lg fi-arrow-up"></i>
      </span>
</div>
<div class="grid-container fluid">
    <div class="grid-x grid-margin-x align-center">
        <div class="cell medium-11">
            <div class="callout disclaimer warning text-center">
                The Final Text ITI Technical Framework is published here in HTML format and is no longer published as
                PDF. Trial Implementation supplements are available from the <a
                    href=https://profiles.ihe.net/ITI/TF/Volume1/index.html>Volume 1 Table of Contents</a>.
            </div>
        </div>
    </div>
    <main>
        <div class="grid-x grid-margin-x align-center">
            <div class="hide-for-small-only cell medium-2 large-2" data-sticky-container>
                <div id="section-menu" class="sticky" data-sticky data-anchor="main-top">
                </div>
            </div>
            <div id="main-top" class="cell medium-10 large-10">
                <h2 id="3.18">3.18 Registry Stored Query [ITI-18]</h2>
                <p>This section corresponds to transaction [ITI-18] of the IHE Technical Framework. Transaction [ITI-18]
                    is used by the Document Registry and Document Consumer Actors.</p>
                <h3 id="3.18.1">3.18.1 Scope</h3>
                <p>The Registry Stored Query transaction supports a variety of pre-defined queries. Examples include the
                    following:</p>
                <ul>
                    <li class="bullet-list1">Query for DocumentEntry objects by patient (Id) for a time interval on
                        creation time and/or service time, by document type(s), by practice setting(s), by author person
                    </li>
                    <li class="bullet-list1">Query for SubmissionSets by Document Source</li>
                    <li class="bullet-list1">Query for Folders updated during a time interval</li>
                    <li class="bullet-list1">Query for all contents in a Folder or SubmissionSet</li>
                    <li class="bullet-list1">Query for SubmissionSets by time of submission</li>
                </ul>
                <p>Depending on the value of the returnType parameter, all queries return:</p>
                <ul>
                    <li class="bullet-list1">
                        Metadata for one or more types of registry object (see
                        <a href="../Volume3/ch-4.1.html#4.1.3">ITI TF-3: 4.1.3</a>), or
                    </li>
                    <li class="bullet-list1">Object references for one or more types of registry object</li>
                </ul>
                <h3 id="3.18.2">3.18.2 Use Case Roles</h3>
                <p>
                    <strong>Actor:</strong>
                    Document Consumer
                </p>
                <p>
                    <strong>Role:</strong>
                    Requests a query by identifier (UUID), and passes parameters to the query. A parameter controlling the format of the returned data is passed; it selects either object references or full objects.
                </p>
                <p>
                    <strong>Actor:</strong>
                    Document Registry
                </p>
                <p>
                    <strong>Role:</strong>
                    Services the query using its stored definitions of the queries defined for XDS.
                </p>
                <p>
                    <strong>Actor:</strong>
                    Initiating Gateway
                </p>
                <p>
                    <strong>Role:</strong>
                    Services the stored query by initiating transactions with a selected set of Responding Gateways, Document Registries or other appropriate systems.
                </p>
                <h3 id="3.18.3">3.18.3 Referenced Standards</h3>
                <p>ITI TF-3:4 Metadata used in Document Sharing Profiles.</p>
                <p>
                    Implementors of this transaction shall comply with all requirements described in
                    <a href="../Volume2/ch-V.html#Appendix V">ITI TF-2: Appendix V</a>: Web Services for IHE
                    transactions.
                </p>
                <p>
                    <span style="width:80px;display:inline-block">ebRIM</span>
                    OASIS/ebXML Registry Information Model v3.0<br/>
                    <span style="width:80px;display:inline-block">ebRS</span>
                    OASIS/ebXML Registry Services Specifications v3.0
                </p>
                <h3 id="3.18.4">3.18.4 Messages</h3>

                <div id="f3.18.4-1">

                    <img src="media/Figure_3.18.4-1.png" alt="Interaction Diagram">
                    <p class="figureTitle">Figure 3.18.4-1: Interaction Diagram</p>

                </div>
                <h4 id="3.18.4.1">3.18.4.1 Registry Stored Query</h4>
                <p>This is a query request to the Document Registry from a Document Consumer. The query request
                    contains:</p>
                <ul>
                    <li class="bullet-list1">A reference to a pre-defined query stored on the Document Registry Actor.
                    </li>
                    <li class="bullet-list1">Parameters to the query.</li>
                </ul>
                <h5 id="3.18.4.1.1">3.18.4.1.1 Trigger Events</h5>
                <p>This message is initiated when the Document Consumer wants to query/retrieve document metadata.</p>
                <h5 id="3.18.4.1.2">3.18.4.1.2 Message Semantics</h5>
                <p>
                    The semantics of Stored Query are defined in Section 6.3 <em>Stored Query Support</em> of ebRS
                    version 3.0.
                    This transaction corresponds to Section 6.3.2 <em>Invoking a Stored Query</em> and 6.3.3 <em>Response
                    to a Stored Query Invocation</em>.
                    This profile does not specify how the queries come to be stored in the Registry nor how they are to
                    be translated for other database architectures.
                </p>
                <h6 id="3.18.4.1.2.1">3.18.4.1.2.1 Version 3.0 ebXML Registry Standard</h6>
                <p>This transaction uses ebXML Registry version 3.0.</p>
                <h6 id="3.18.4.1.2.2">3.18.4.1.2.2 Sample Query Request</h6>
                <p>The sample query is included under <a href="#3.18.4.1.3">Section 3.18.4.1.3 Expected Actions</a>.</p>
                <h6 id="3.18.4.1.2.3">3.18.4.1.2.3 Query Request Parameters – Coding Style</h6>
                <p>Registry Stored Query supports the following parameters:</p>
                <ul>
                    <li class="bullet-list1">returnType – 'LeafClass' or 'ObjectRef'</li>
                    <li class="bullet-list1">Query ID – a UUID from <a href="#3.18.4.1.2.4">Section 3.18.4.1.2.4</a>
                    </li>
                    <li class="bullet-list1">Query Parameters – as defined in the subsections under <a
                            href="#3.18.4.1.2.3.7">Section 3.18.4.1.2.3.7</a>, that correspond to the Query ID
                    </li>
                </ul>
                <p class="heading7" id="3.18.4.1.2.3.1">3.18.4.1.2.3.1 Parameter returnType</p>
                <p>Registry Stored Query supports the following values for the parameter returnType:</p>
                <ul>
                    <li class="bullet-list1">ObjectRef – a list of object UUIDs (references)</li>
                    <li class="bullet-list1">LeafClass – list of XML elements representing the leaf class of the object
                        returned
                    </li>
                </ul>
                <p>The 'LeafClass' returnType is meant for returning a small amount of fully specified ebXML objects
                    (such as a list of ExtrinsicObject (XDSDocumentEntry) elements with full contents: slots, external
                    identifiers, classifications etc.). This type of query result is self-contained, everything known
                    about the object(s) is returned. The specific query documented in this section describes which
                    object types will be included. ObjectRef elements are also returned. These represent objects not
                    included in the returned object list that are referenced by objects in the returned object list.
                    These ObjectRefs are optional by the registry standard version 3.0.</p>
                <p>The 'ObjectRef' returnType returns references to the registry objects that match the query. This type
                    query is recommended when the returned object list could be large. An initial query returning
                    ObjectRefs for all objects of interest followed by secondary queries requesting full metadata (query
                    type LeafClass) is an efficient way to query for large bodies of metadata. This strategy is
                    particularly easy to use when querying for a single object type (XDSDocumentEntry or
                    XDSSubmissionSet are examples) since only a single object type is involved.</p>
                <p>An ObjectRef looks like:</p>
                <p class="indent">
                    <code class="xml">&lt;ObjectRef id="urn:uuid:58a6f841-87b3-4a3e-92fd-a8ffeff98427"/&gt;</code>
                </p>
                <p class="heading7" id="3.18.4.1.2.3.2">3.18.4.1.2.3.2 Parameter Query ID</p>
                <p>This parameter holds the UUID assigned to the query to be invoked. UUIDs are assigned by this profile
                    (see <a href="#3.18.4.1.2.4">Section 3.18.4.1.2.4</a>) to each of the queries defined in <a
                            href="#3.18.4.1.2.3.7.">Section 3.18.4.1.2.3.7</a>.</p>
                <p class="heading7" id="3.18.4.1.2.3.3">3.18.4.1.2.3.3 Date/Time Coding</p>
                <p>All Date/time values are to be inclusive, interpreted as:</p>
                <p>$XDSDocumentEntryCreationTimeFrom &lt;= XDSDocumentEntry.creationTime &lt;
                    $XDSDocumentEntryCreationTimeTo</p>
                <p>for example.</p>
                <p>The 'From' time or the 'To' time may be omitted.</p>
                <p class="heading8" id="3.18.4.1.2.3.3.1">3.18.4.1.2.3.3.1 Comparing serviceStartTime and
                    serviceStopTime</p>
                <p>Special consideration is needed when processing the query parameters related to serviceStartTime and
                    serviceStopTime since these DocumentEntry metadata attributes may not be present:</p>
                <ul>
                    <li class="bullet-list0">If the DocumentEntry.serviceStartTime attribute of a DocumentEntry contains
                        no value and if the query includes a value for $XDSDocumentEntryServiceStartTimeFrom or
                        $XDSDocumentEntryServiceStartTimeTo, those query parameters shall not be used for deciding
                        whether this DocumentEntry matches the query.
                    </li>
                    <li class="bullet-list0">If the DocumentEntry.serviceStopTime attribute of a DocumentEntry contains
                        no value and if the query includes a value for $XDSDocumentEntryServiceStopTimeFrom or
                        $XDSDocumentEntryServiceStopTimeTo, those query parameters shall not be used for deciding
                        whether this DocumentEntry matches the query.
                    </li>
                </ul>
                <p class="heading7" id="3.18.4.1.2.3.4">3.18.4.1.2.3.4 Coding of Code/Code-Scheme</p>
                <p>When specifying a coded value parameter, an abbreviated form of the HL7 V2.5 CE format shall be used.
                    Only the first (identifier) and third (coding scheme) elements shall be specified. Both are
                    required. The second element shall be empty. The HL7 V2.5 length limits shall not apply. The ebRIM
                    limit on Slot Value size does apply. An example of this format is:</p>
                <p class="indent">
                    <code>code^^coding-scheme</code>
                </p>
                <p>This style parameter always accepts multiple values so example codings in context look like:</p>
                <p class="indent">
                    <code>&lt;Value&gt;('code1^^coding-scheme1')&lt;/Value&gt;</code>
                </p>
                <p>or</p>
                <p class="indent">
                    <code>&lt;Value&gt;('code1^^coding-scheme1','code2^^coding-scheme2')&lt;/Value&gt;</code>
                </p>
                <p>within the parameter Slot.</p>
                <p class="heading7" id="3.18.4.1.2.3.5">3.18.4.1.2.3.5 Coding of Single/Multiple Values</p>
                <p>Single values are coded as</p>
                <ul>
                    <li class="bullet-list1"><code>123</code> - without quotes for numbers</li>
                    <li class="bullet-list1"><code
                            class="urn">'urn:oasis:names:tc:ebxml-regrep:StatusType:Approved'</code> - in
                        single quotes for strings.
                    </li>
                    <li class="bullet-list1"><code>'Children''s Hospital'</code> – a single quote is inserted in a
                        string by specifying two single quotes
                    </li>
                </ul>
                <p>For parameters defined to be compatible with the SQL 'LIKE' keyword: </p>
                <ul>
                    <li class="bullet-list1">Underscore ('_') matches an arbitrary character</li>
                    <li class="bullet-list1">Percent ('%') matches an arbitrary string (0 or more characters)</li>
                </ul>
                <p>Format for multiple values is</p>
                <ul>
                    <li class="bullet-list1"><code>(value,value,value,…)</code></li>
                </ul>
                <p>OR</p>
                <ul>
                    <li class="bullet-list1"><code>(value)</code> if only one value is to be specified.</li>
                </ul>
                <p>where each value is coded as described above for single values.</p>
                <p>When coding multiple values there is a potential conflict between needing to code a long list of
                    values and the length restriction imposed by Schema on the size of the value of the <code
                            class="xml">&lt;Value/&gt;</code>
                    element. Slot values shall never exceed the Schema-enforced limit. Therefore, the use of multiple
                    Value elements within the Slot shall be acceptable. Splits may occur only between values, where each
                    Value element is surrounded by parentheses. The following example shows multiple values, split
                    across multiple Value elements:</p>
                <pre><code class="code-block">&lt;Slot name="$uuid"&gt;
  &lt;ValueList&gt;
    &lt;Value&gt;('urn:uuid:a96d7361-6617-488a-891c-ee3f37d1f218','urn:uuid: 5655a680-1b6a-11dd-bd0b-0800200c9a66')&lt;/Value&gt;
    &lt;Value&gt;('urn:uuid:ae315e81-2056-4829-a5b4-cf9531941f96')&lt;/Value&gt;
  &lt;/ValueList&gt;
&lt;/Slot&gt;</code></pre>
                <p>This example shall be treated as equivalent to:</p>
                <pre><code class="code-block">&lt;Slot name="$uuid"&gt;
  &lt;ValueList&gt;
    &lt;Value&gt;('urn:uuid:a96d7361-6617-488a-891c-ee3f37d1f218','urn:uuid: 5655a680-1b6a-11dd-bd0b-0800200c9a66','urn:uuid:ae315e81-2056-4829-a5b4-cf9531941f96')&lt;/Value&gt;
  &lt;/ValueList&gt;
&lt;/Slot&gt;</code></pre>
                <p>
                    Character comparisons shall be performed in accordance with the rules in
                    <a href="../Volume2/ch-F.html#Appendix F">ITI TF-2: Appendix F</a>
                    Character String Comparisons.
                </p>
                <p>And/or semantics for the coding of parameters shall be available only on parameters for multi-valued
                    metadata elements (such as $XDSDocumentEntryEventCodeList). Multi-valued parameters shall be coded
                    in two ways with different interpretations.</p>
                <p>A parameter specified as a Slot with multiple values shall be interpreted as disjunction (OR
                    semantics). For example:</p>
                <pre><code class="code-block">&lt;rim:Slot name="$XDSDocumentEntryEventCodeList"&gt;
  &lt;rim:ValueList&gt;
    &lt;rim:Value&gt;('a')&lt;/rim:Value&gt;
    &lt;rim:Value&gt;('b')&lt;/rim:Value&gt;
  &lt;/rim:ValueList&gt;
&lt;/rim:Slot&gt;</code></pre>
                <p>shall match an XDSDocumentEntry object with an eventCodeList attribute containing either 'a' or 'b'.
                    The following coding of the parameter shall yield the same results:</p>
                <pre><code class="code-block">&lt;rim:Slot name="$XDSDocumentEntryEventCodeList"&gt;
  &lt;rim:ValueList&gt;
    &lt;rim:Value&gt;('a','b')&lt;/rim:Value&gt;
  &lt;/rim:ValueList&gt;
&lt;/rim:Slot&gt;</code></pre>
                <p>A parameter specified as multiple Slots shall be interpreted as conjunction (AND semantics). For
                    example:</p>
                <pre><code class="code-block">&lt;rim:Slot name="$XDSDocumentEntryEventCodeList"&gt;
  &lt;rim:ValueList&gt;
    &lt;rim:Value&gt;('a')&lt;/rim:Value&gt;
  &lt;/rim:ValueList&gt;
&lt;/rim:Slot&gt;
&lt;rim:Slot name="$XDSDocumentEntryEventCodeList"&gt;
  &lt;rim:ValueList&gt;
    &lt;rim:Value&gt;('b')&lt;/rim:Value&gt;
  &lt;/rim:ValueList&gt;
&lt;/rim:Slot&gt;</code></pre>
                <p>shall match an XDSDocumentEntry object with an eventCodeList attribute containing both 'a' and
                    'b'.</p>
                <p>Furthermore, the following specification of the $XDSDocumentEntryEventCodeList parameter:</p>
                <pre><code class="code-block">&lt;rim:Slot name="$XDSDocumentEntryEventCodeList"&gt;</span>
                    &lt;rim:ValueList&gt;
    &lt;rim:Value&gt;('a','b')&lt;/rim:Value&gt;
  &lt;/rim:ValueList&gt;
&lt;/rim:Slot&gt;
&lt;rim:Slot name="$XDSDocumentEntryEventCodeList"&gt;
  &lt;rim:ValueList&gt;
    &lt;rim:Value&gt;('c')&lt;/rim:Value&gt;
  &lt;/rim:ValueList&gt;
&lt;/rim:Slot&gt;</code></pre>
                <p>shall be interpreted as matching a document having eventCode (a OR b) AND c.</p>
                <p class="heading7" id="3.18.4.1.2.3.6">3.18.4.1.2.3.6 Valid Document Status Values</p>
                <p>The Registry Object status values, in ebRIM v 3.0 format, used by XDS are:</p>
                <p class="indent">
                    <code class="urn">urn:oasis:names:tc:ebxml-regrep:StatusType:Approved</code><br/>
                    <code class="urn">urn:oasis:names:tc:ebxml-regrep:StatusType:Deprecated</code>
                </p>
                <p>If the Document Registry receives in a Registry Stored Query transaction a value for the
                    $XDSDocumentEntryStatus parameter that it does not understand then the Document Registry shall
                    ignore the value and process the Registry Stored Query transaction as if the not understood value
                    were not specified. This means that if the only value present is one that is not understood an error
                    will be generated because the $XDSDocumentEntryStatus parameter is required.</p>
                <p class="heading8" id="3.18.4.1.2.3.6.1">3.18.4.1.2.3.6.1 Valid AdhocQueryResponse Status Values</p>
                <p>The status attribute of AdhocQueryResponse shall contain one of the following values:</p>
                <p class="indent">
                    <code class="urn">urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Success</code><br/>
                    <code class="urn">urn:ihe:iti:2007:ResponseStatusType:PartialSuccess</code><br/>
                    <code class="urn">urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Failure</code>
                </p>
                <p>
                    See
                    <a href="../Volume3/ch-4.2.html#4.2.4">ITI TF-3: 4.2.4</a>
                    Error Reporting for the interpretation of these values.
                </p>
                <p class="heading8" id="3.18.4.1.2.3.6.2">3.18.4.1.2.3.6.2 Valid DocumentEntryType Parameter Values</p>
                <p>The objectType attribute on an ExtrinsicObject (DocumentEntry) is used to distinguish Stable
                    DocumentEntries from On-Demand DocumentEntries.</p>
                <p>The following objectType values are used:</p>
                <ul>
                    <li class="bullet-list0"><code class="uuid">urn:uuid:7edca82f-054d-47f2-a032-9b2a5b5186c1</code> –
                        Stable
                    </li>
                    <li class="bullet-list0"><code class="uuid">urn:uuid:34268e47-fdf5-41a6-ba33-82133c465248</code> –
                        On-Demand
                    </li>
                </ul>
                <p>The valid DocumentEntryType parameter values used in the Registry Stored Query are:</p>
                <ul>
                    <li class="bullet-list0"><code class="uuid">urn:uuid:7edca82f-054d-47f2-a032-9b2a5b5186c1</code> –
                        requests
                        Stable Document Entries be included in the response. This is the default value.
                    </li>
                    <li class="bullet-list0"><code class="uuid">urn:uuid:34268e47-fdf5-41a6-ba33-82133c465248</code> –
                        requests
                        On-Demand Document Entries be included in the response. Used only by Document Consumers which
                        support the On-Demand Documents Option.
                    </li>
                </ul>
                <p>If no value is specified for DocumentEntryType, the value requesting only Stable Document Entries
                    shall be assumed. To get all Document Entry types, the query shall contain both of the valid values
                    in the request.</p>
                <p class="heading7" id="3.18.4.1.2.3.7">3.18.4.1.2.3.7 Parameters for Required Queries</p>
                <p>The sections below document the queries defined in the Registry Stored Query [ITI-18] transaction.
                    These sections document a collection of Stored Queries. Document Registry Actors implementing this
                    transaction shall support all queries in this collection and all parameters defined for each query.
                    Document Consumer Actors implementing this transaction shall implement one or more of these queries
                    as needed to support the use cases it implements.</p>
                <p>Note that dollar sign ($) prefix on query parameters is required by ebRS 3.0.</p>
                <p>In the query parameter tables below, each row represents a query parameter. Optional parameters which
                    are not included in the query invocation have no effect on the query. Queries return registry
                    objects that match all the supplied parameters. See <a href="#3.18.4.1.2.3.5">Section
                        3.18.4.1.2.3.5</a> for information on
                    specifying multiple values for a parameter.</p>
                <p class="heading8" id="3.18.4.1.2.3.7.1">3.18.4.1.2.3.7.1 FindDocuments</p>
                <p>Find documents (XDSDocumentEntry objects) in the registry for a given patientID with a matching
                    availabilityStatus attribute. The other parameters can be used to restrict the set of
                    XDSDocumentEntry objects returned.</p>
                <p>
                    <strong>Returns:</strong>
                    XDSDocumentEntry objects matching the query parameters
                </p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$XDSDocumentEntryPatientId</td>
                        <td>XDSDocumentEntry.patientId</td>
                        <td>R</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryClassCode <sup>1</sup></td>
                        <td>XDSDocumentEntry.classCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryTypeCode <sup>1</sup></td>
                        <td>XDSDocumentEntry.typeCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryPracticeSettingCode <sup>1</sup></td>
                        <td>XDSDocumentEntry.practiceSettingCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryCreationTimeFrom <sup>6</sup></td>
                        <td>Lower value of XDSDocumentEntry.creationTime</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryCreationTimeTo <sup>6</sup></td>
                        <td>Upper value of XDSDocumentEntry.creationTime</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryServiceStartTimeFrom</td>
                        <td>Lower value of XDSDocumentEntry.serviceStartTime</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryServiceStartTimeTo</td>
                        <td>Upper value of XDSDocumentEntry.serviceStartTime</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryServiceStopTimeFrom</td>
                        <td>Lower value of XDSDocumentEntry.serviceStopTime</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryServiceStopTimeTo</td>
                        <td>Upper value of XDSDocumentEntry.serviceStopTime</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryHealthcareFacilityTypeCode <sup>1</sup></td>
                        <td>XDSDocumentEntry.healthcareFacilityTypeCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryEventCodeList <sup>1</sup></td>
                        <td>XDSDocumentEntry.eventCodeList <sup>3</sup></td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryConfidentialityCode <sup>1</sup></td>
                        <td>XDSDocumentEntry.confidentialityCode <sup>3</sup></td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryAuthorPerson <sup>4</sup></td>
                        <td>XDSDocumentEntry.author</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryFormatCode <sup>1</sup></td>
                        <td>XDSDocumentEntry.formatCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryStatus</td>
                        <td>XDSDocumentEntry.availabilityStatus</td>
                        <td>R</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryType <sup>5</sup></td>
                        <td>XDSDocumentEntryobjectType</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    Shall be coded according to specification in <a href="#3.18.4.1.2.3.4">Section 3.18.4.1.2.3.4 Coding of Code/Code-Scheme</a>.
                </p>
                <p>
                    <sup>3</sup>
                    Supports AND/OR semantics as specified in <a
                            href="#3.18.4.1.2.3.5.">Section 3.18.4.1.2.3.5</a>.
                </p>
                <p>
                    <sup>4</sup>
                    The value for this parameter is a pattern compatible with the SQL keyword LIKE which allows the use of the following wildcard characters: % to match any (or no) characters and _ to match a single character. The match shall be applied to the text contained in the Value elements of the authorPerson Slot on the author Classification (value strings of the authorPerson sub-attribute)
                </p>
                <p>
                    <sup>5</sup>
                    See <a href="#3.18.4.1.2.3.6.2">Section 3.18.4.1.2.3.6.2</a>
                </p>
                <p>
                    <sup>6</sup>
                    CreationTimeFrom and CreationTimeTo are ignored when evaluating an On-Demand Document Entry's selection for inclusion in the query response.
                </p>
                <p class="heading8" id="3.18.4.1.2.3.7.2">3.18.4.1.2.3.7.2 FindSubmissionSets</p>
                <p>Find submission sets (XDSSubmissionSet objects) in the registry for a given patientID with matching
                    'status' attribute. The other parameters can be used to restrict the collection of XDSSubmissionSet
                    objects returned.</p>
                <p>
                    <strong>Returns:</strong>
                    XDSSubmissionSet objects matching the query parameters
                </p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$XDSSubmissionSetPatientId</td>
                        <td>XDSSubmissionSet.patientId</td>
                        <td>R</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSSubmissionSetSourceId</td>
                        <td>XDSSubmissionSet.sourceId</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSSubmissionSetSubmissionTimeFrom</td>
                        <td>XDSSubmissionSet.submissionTime Lower value</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSSubmissionSetSubmissionTimeTo</td>
                        <td>XDSSubmissionSet.submissionTime Upper value</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSSubmissionSetAuthorPerson <sup>1</sup></td>
                        <td>XDSSubmissionSet.authorPerson</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSSubmissionSetContentType <sup>2</sup></td>
                        <td>XDSSubmissionSet.contentTypeCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSSubmissionSetStatus</td>
                        <td>XDSSubmissionSet.availabilityStatus</td>
                        <td>R</td>
                        <td>M</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    The value for this parameter is a pattern compatible with the SQL keyword LIKE which allows the use of the following wildcard characters: % to match any (or no) characters and _ to match a single character. The match shall be applied to the text contained in the Value elements of the authorPerson Slot on the author Classification (value strings of the authorPerson sub-attribute).
                </p>
                <p>
                    <sup>2</sup>
                    Shall be coded according to specification in <a href="#3.18.4.1.2.3.4">Section 3.18.4.1.2.3.4 Coding of Code/Code-Scheme</a>.
                </p>
                <p class="heading8" id="3.18.4.1.2.3.7.3">3.18.4.1.2.3.7.3 FindFolders</p>
                <p>Find folders (XDSFolder objects) in the registry for a given patientID with matching 'status'
                    attribute. The other parameters can be used to restrict the collection of XDSFolder objects
                    returned.</p>
                <p>
                    <strong>Returns:</strong>
                    XDSFolder objects matching the query parameters
                </p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$XDSFolderPatientId</td>
                        <td>XDSFolder.patientId</td>
                        <td>R</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSFolderLastUpdateTimeFrom</td>
                        <td>XDSFolder.lastUpdateTime lower value</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSFolderLastUpdateTimeTo</td>
                        <td>XDSFolder.lastUpdateTime upper bound</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSFolderCodeList <sup>1,2</sup></td>
                        <td>XDSFolder.codeList</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSFolderStatus</td>
                        <td>XDSFolder.availabilityStatus</td>
                        <td>R</td>
                        <td>M</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    Shall be coded according to specification in <a href="#3.18.4.1.2.3.4">Section 3.18.4.1.2.3.4 Coding of Code/Code-Scheme</a>.
                </p>
                <p>
                    <sup>2</sup>
                    Supports AND/OR semantics as specified in <a
                            href="#3.18.4.1.2.3.5.">Section 3.18.4.1.2.3.5</a>.
                </p>
                <p class="heading8" id="3.18.4.1.2.3.7.4">3.18.4.1.2.3.7.4 GetAll</p>
                <p>Get all registry content for a patient given the indicated status, format codes, and confidentiality
                    codes.</p>
                <p>
                    <strong>Returns:</strong>
                </p>
                <ul>
                    <li class="bullet-list1">XDSSubmissionSet, XDSDocumentEntry, and XDSFolder objects with patientId
                        attribute matching $patientId parameter
                    </li>
                    <li class="bullet-list1">Association objects with sourceObject or targetObject attribute matching
                        one of the above objects
                    </li>
                </ul>
                <p class="note">Note: Associations may be returned that reference objects not in the return set. For
                    example, this could occur when:</p>
                <ul>
                    <li class="bullet-list2 note">the $XDSDocumentEntryStatus parameter is Approved and a
                        submitted DocumentEntry has been replaced and is, therefore, Deprecated, or
                    </li>
                    <li class="bullet-list2 note">a SubmissionSet is linked to a DocumentEntry with a
                        different Patient ID, i.e., for a mother and child.
                    </li>
                </ul>
                <p class="note">Document Consumers should be prepared to handle these situations.</p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$patientId</td>
                        <td>XDSFolder.patientId, XDSSubmissionSet.patientId, XDSDocumentEntry.patientId</td>
                        <td>R</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryStatus</td>
                        <td>XDSDocumentEntry.availabilityStatus</td>
                        <td>R</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSSubmissionSetStatus</td>
                        <td>XDSSubmissionSet.availabilityStatus</td>
                        <td>R</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSFolderStatus</td>
                        <td>XDSFolder.availabilityStatus</td>
                        <td>R</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryFormatCode <sup>2</sup></td>
                        <td>XDSDocumentEntry.formatCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryConfidentialityCode <sup>1,2</sup></td>
                        <td>XDSDocumentEntry.confidentialityCode <sup>1</sup></td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryType <sup>3</sup></td>
                        <td>XDSDocumentEntry.objectType</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    Supports AND/OR semantics as specified in <a
                            href="#3.18.4.1.2.3.5.">Section 3.18.4.1.2.3.5</a>.
                </p>
                <p>
                    <sup>2</sup>
                    Shall be coded according to specification in <a href="#3.18.4.1.2.3.4">Section 3.18.4.1.2.3.4 Coding of Code/Code-Scheme</a>
                </p>
                <p>
                    <sup>3</sup>
                    See <a href="#3.18.4.1.2.3.6.2">Section 3.18.4.1.2.3.6.2</a>
                </p>
                <p class="heading8" id="3.18.4.1.2.3.7.5">3.18.4.1.2.3.7.5 GetDocuments</p>
                <p>Retrieve a collection of XDSDocumentEntry objects. XDSDocumentEntry objects are selected either by
                    their entryUUID or uniqueId attribute.</p>
                <p>
                    <strong>Returns:</strong>
                    XDSDocumentEntry objects requested
                </p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$XDSDocumentEntryEntryUUID <sup>3</sup></td>
                        <td>XDSDocumentEntry.entryUUID</td>
                        <td>O<sup>1</sup></td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryUniqueId <sup>3</sup></td>
                        <td>XDSDocumentEntry.uniqueId</td>
                        <td>O <sup>1</sup></td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$homeCommunityId</td>
                        <td>None</td>
                        <td>O <sup>2</sup></td>
                        <td>—</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    Either $XDSDocumentEntryEntryUUID or $XDSDocumentEntryUniqueId shall be specified. This transaction shall return an XDSStoredQueryParamNumber error if both parameters are specified.
                </p>
                <p>
                    <sup>2</sup>
                    The homeCommunityId value is specified as the home attribute on the AdhocQuery element of the query request, as in: <code
                            class="xml">&lt;AdhocQuery id="…" home="urn:oid:1.2.3" … &gt;</code>. Document Consumer Actors shall specify the homeCommunityId value if they received a value for this attribute as part of the previous Registry Stored Query response entry which contained the specified EntryUUID or UniqueID. See <a
                            href="#3.18.4.1.2.3.8">Section 3.18.4.1.2.3.8</a> for more details.
                </p>
                <p class="note">
                    Note: A query for a single XDSDocumentEntry.uniqueId can return multiple results. See
                    <a href="../Volume3/ch-4.1.html#4.1.4">ITI TF-3: 4.1.4</a>
                    under the topic of Document metadata duplication for explanation.
                </p>
                <p>
                    <sup>3</sup>
                    If the Stored Query specifies a returnType of LeafClass then the Document Registry shall verify that all requested DocumentEntry objects to be returned will contain the same Patient ID. If this validation fails an XDSResultNotSinglePatient error shall be returned and no metadata shall be returned.
                </p>
                <p class="heading8" id="3.18.4.1.2.3.7.6">3.18.4.1.2.3.7.6 GetFolders</p>
                <p>Retrieve a collection of XDSFolder objects. XDSFolder objects are selected either by their entryUUID
                    or uniqueId attribute.</p>
                <p>
                    <strong>Returns:</strong>
                    XDSFolder objects requested.
                </p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$XDSFolderEntryUUID <sup>3</sup></td>
                        <td>XDSFolder.entryUUID</td>
                        <td>O <sup>1</sup></td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSFolderUniqueId <sup>3</sup></td>
                        <td>XDSFolder.uniqueId</td>
                        <td>O <sup>1</sup></td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$homeCommunityId</td>
                        <td>None</td>
                        <td>O <sup>2</sup></td>
                        <td>—</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    Either $XDSFolderEntryUUID or $XDSFolderUniqueId shall be specified. This transaction shall return an XDSStoredQueryParamNumber error if both parameters are specified.
                </p>
                <p>
                    <sup>2</sup>
                    The homeCommunityId value is specified as the home attribute on the AdhocQuery element of the query request, as in: <code
                            class="xml">&lt;AdhocQuery id="…" home="urn:oid:1.2.3" … &gt;</code>. Document Consumer Actors shall specify the homeCommunityId value if they received a value for this attribute as part of the previous Registry Stored Query response entry which contained the specified EntryUUID or UniqueID. See <a
                            href="#3.18.4.1.2.3.8">Section 3.18.4.1.2.3.8</a> for more details.
                </p>
                <p>
                    <sup>3</sup>
                    If the Stored Query specifies a returnType of LeafClass then the Document Registry shall verify that all requested Folder objects to be returned will contain the same Patient ID. If this validation fails an XDSResultNotSinglePatient error shall be returned and no metadata shall be returned.
                </p>
                <p class="heading8" id="3.18.4.1.2.3.7.7">3.18.4.1.2.3.7.7 GetAssociations</p>
                <p>Retrieve Association objects whose sourceObject or targetObject attribute match $uuid.</p>
                <p>
                    <strong>Returns:</strong>
                    Association objects
                </p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$uuid</td>
                        <td>None</td>
                        <td>R</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$homeCommunityId</td>
                        <td>None</td>
                        <td>O <sup>1</sup></td>
                        <td>-</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    The homeCommunityId value is specified as the home attribute on the AdhocQuery element of the query request, as in: <code
                            class="xml">&lt;AdhocQuery id="…" home="urn:oid:1.2.3" … &gt;</code>.  Document Consumer Actors shall specify the homeCommunityId value if they received a value for this attribute as part of the previous Registry Stored Query response entry which contained the specified EntryUUID or UniqueID. See <a
                            href="#3.18.4.1.2.3.8">Section 3.18.4.1.2.3.8</a> for more details.
                </p>
                <p class="heading8" id="3.18.4.1.2.3.7.8">3.18.4.1.2.3.7.8 GetDocumentsAndAssociations</p>
                <p>Retrieve a collection of XDSDocumentEntry objects and the Association objects surrounding them.
                    XDSDocumentEntry objects are selected either by their entryUUID or uniqueId attribute. This is the
                    GetDocuments query and GetAssociations query combined into a single query.</p>
                <p>
                    <strong>Returns:</strong>
                </p>
                <ul>
                    <li class="bullet-list1">XDSDocumentEntry objects</li>
                    <li class="bullet-list1">Association objects whose sourceObject or targetObject attribute matches
                        one of the above objects
                    </li>
                </ul>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$XDSDocumentEntryEntryUUID <sup>3</sup></td>
                        <td>XDSDocumentEntry.entryUUID</td>
                        <td>O <sup>1</sup></td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryUniqueId <sup>3</sup></td>
                        <td>XDSDocumentEntry.uniqueId</td>
                        <td>O <sup>1</sup></td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$homeCommunityId</td>
                        <td>None</td>
                        <td>O <sup>2</sup></td>
                        <td>—</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    Either $XDSDocumentEntryEntryUUID or $XDSDocumentEntryUniqueId shall be specified. This transaction shall return an XDSStoredQueryParamNumber error if both parameters are specified.
                </p>
                <p>
                    <sup>2</sup>
                    The homeCommunityId value is specified as the home attribute on the AdhocQuery element of the query request, as in: <code
                            class="xml">&lt;AdhocQuery id="…" home="urn:oid:1.2.3" … &gt;</code>. Document Consumer Actors shall specify the homeCommunityId value if they received a value for this attribute as part of the previous Registry Stored Query response entry which contained the specified EntryUUID or UniqueID. See <a
                            href="#3.18.4.1.2.3.8">Section 3.18.4.1.2.3.8</a> for more details.
                </p>
                <p>
                    <sup>3</sup>
                    If the Stored Query specifies a returnType of LeafClass then the Document Registry shall verify that all requested DocumentEntry objects to be returned will contain the same Patient ID. If this validation fails an XDSResultNotSinglePatient error shall be returned and no metadata shall be returned.
                </p>
                <p class="heading8" id="3.18.4.1.2.3.7.9">3.18.4.1.2.3.7.9 GetSubmissionSets</p>
                <p>Retrieve the XDSSubmissionSet objects used to submit a collection of XDSDocumentEntry and XDSFolder
                    objects. The XDSDocumentEntry and XDSFolder objects of interest are identified by their UUIDs in the
                    $uuid parameter.</p>
                <p>
                    <strong>Selection:</strong>
                    XDSSubmissionSet objects are selected because Association objects exist that have:
                </p>
                <ul>
                    <li class="bullet-list1">Type HasMember</li>
                    <li class="bullet-list1">targetObject attribute containing one of the UUIDs provided in the $uuid
                        parameter
                    </li>
                    <li class="bullet-list1">sourceObject attribute referencing an XDSSubmissionSet object</li>
                </ul>
                <p>
                    <strong>Returns:</strong>
                </p>
                <ul>
                    <li class="bullet-list1">XDSSubmissionSet objects described above</li>
                    <li class="bullet-list1">Association objects described in the Selection section above</li>
                </ul>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$uuid <sup>2</sup></td>
                        <td>
                            <p>XDSDocumentEntry.entryUUID and</p>
                            <p>XDSFolder.entryUUID</p>
                        </td>
                        <td>R</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$homeCommunityId</td>
                        <td>None</td>
                        <td>O <sup>1</sup></td>
                        <td>—</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    The homeCommunityId value is specified as the home attribute on the AdhocQuery element of the query request, as in: <code
                            class="xml">&lt;AdhocQuery id="…" home="urn:oid:1.2.3" … &gt;</code>. Document Consumer Actors shall specify the homeCommunityId value if they received a value for this attribute as part of the previous Registry Stored Query response entry which contained the specified EntryUUID or UniqueID. See <a
                            href="#3.18.4.1.2.3.8">Section 3.18.4.1.2.3.8</a> for more details.
                </p>
                <p>
                    <sup>2</sup>
                    If the Stored Query specifies a returnType of LeafClass then the Document Registry shall verify that all requested Submission Set objects to be returned will contain the same Patient ID. If this validation fails an XDSResultNotSinglePatient error shall be returned and no metadata shall be returned.
                </p>
                <p class="heading8" id="3.18.4.1.2.3.7.10">3.18.4.1.2.3.7.10 GetSubmissionSetAndContents</p>
                <p>Retrieve a SubmissionSet and its contents. SubmissionSet objects is selected either by its entryUUID
                    or uniqueId attribute. The DocumentEntry objects returned may be constrained by their formatCode and
                    confidentialityCode attributes. More specifically, the DocumentEntries returned shall be limited by
                    the following rules: </p>
                <ul>
                    <li class="bullet-list1">If the $XDSDocumentEntryConfidentialityCode parameter is present in the
                        query, then DocumentEntries shall be returned only if they match this parameter.
                    </li>
                    <li class="bullet-list1">If the $XDSDocumentEntryFormatCode parameter is present in the query, then
                        DocumentEntries shall be returned only if they match this parameter
                    </li>
                </ul>
                <p>
                    <strong>Returns:</strong>
                </p>
                <ul>
                    <li class="bullet-list1">SubmissionSet identified</li>
                    <li class="bullet-list1">DocumentEntries linked to the SubmissionSet by HasMember Associations
                        (DocumentEntries shall pass the above rules)
                    </li>
                    <li class="bullet-list1">The HasMember Associations identified in the previous rule</li>
                    <li class="bullet-list1">Folders linked to the SubmissionSet by HasMember Associations</li>
                    <li class="bullet-list1">The HasMember Associations identified in the previous rule</li>
                    <li class="bullet-list1">Associations linked to the SubmissionSet by HasMember Associations where
                        the Associations link two objects already in the return set
                    </li>
                    <li class="bullet-list1">The HasMember Associations identified in the previous rule</li>
                </ul>
                <p>In the above rules, Associations are only returned if both of the objects they connect are part of
                    the return set.</p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$XDSSubmissionSetEntryUUID <sup>5</sup></td>
                        <td>XDSSubmissionSet.entryUUID</td>
                        <td>O <sup>1</sup></td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSSubmissionSetUniqueId <sup>5</sup></td>
                        <td>XDSSubmissionSet.uniqueId</td>
                        <td>O <sup>1</sup></td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryFormatCode <sup>4</sup></td>
                        <td>XDSDocumentEntry.formatCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryConfidentialityCode <sup>4</sup></td>
                        <td>XDSDocumentEntry.confidentialityCode <sup>2</sup></td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$homeCommunityId</td>
                        <td>None</td>
                        <td>O <sup>3</sup></td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryType <sup>6</sup></td>
                        <td>XDSDocumentEntry.objectType</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    Either $XDSSubmissionSetEntryUUID or $XDSSubmissionSetUniqueId shall be specified. This transaction shall return an XDSStoredQueryParamNumber error if both parameters are specified.
                </p>
                <p>
                    <sup>2</sup>
                    Supports AND/OR semantics as specified in <a
                            href="#3.18.4.1.2.3.5.">Section 3.18.4.1.2.3.5</a>.
                </p>
                <p>
                    <sup>3</sup>
                    The homeCommunityId value is specified as the home attribute on the AdhocQuery element of the query request, as in: <code
                            class="xml">&lt;AdhocQuery id="…" home="urn:oid:1.2.3" … &gt;</code>. Document Consumer Actors shall specify the homeCommunityId value if they received a value for this attribute as part of the previous Registry Stored Query response entry which contained the specified EntryUUID or UniqueID. See <a
                            href="#3.18.4.1.2.3.8">Section 3.18.4.1.2.3.8</a> for more details.
                </p>
                <p>
                    <sup>4</sup>
                    Shall be coded according to specification in <a href="#3.18.4.1.2.3.4">Section 3.18.4.1.2.3.4 Coding of Code/Code-Scheme</a>.
                </p>
                <p>
                    <sup>5</sup>
                    If the Stored Query specifies a returnType of LeafClass then the Document Registry shall verify that all requested Submission Set, Folder, and DocumentEntry objects to be returned will contain the same Patient ID. If this validation fails an XDSResultNotSinglePatient error shall be returned and no metadata shall be returned.
                </p>
                <p>
                    <sup>6</sup>
                    See <a href="#3.18.4.1.2.3.6.2">Section 3.18.4.1.2.3.6.2</a>
                </p>
                <p class="heading8" id="3.18.4.1.2.3.7.11">3.18.4.1.2.3.7.11 GetFolderAndContents</p>
                <p>Retrieve a Folder and its contents. The Folder object is selected either by its entryUUID or uniqueId
                    attribute. The DocumentEntry objects returned may be constrained by their formatCode and
                    confidentialityCode attributes. More specifically, the DocumentEntries shall be limited by the
                    following rules:</p>
                <ul>
                    <li class="bullet-list1">If the $XDSDocumentEntryConfidentialityCode parameter is present in the
                        query, then DocumentEntries shall be returned only if they match this parameter.
                    </li>
                    <li class="bullet-list1">If the $XDSDocumentEntryFormatCode parameter is present in the query, then
                        DocumentEntries shall be returned only if they match this parameter
                    </li>
                </ul>
                <p>
                    <strong>Returns:</strong>
                </p>
                <ul>
                    <li class="bullet-list1">Folder identified</li>
                    <li class="bullet-list1">DocumentEntries linked to the Folder by HasMember Associations
                        (DocumentEntries shall pass the above rules)
                    </li>
                    <li class="bullet-list1">The HasMember Associations identified in the previous rule</li>
                </ul>

                <p>In the above rules, Associations are only returned if both of the objects they connect are part of
                    the return set.</p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$XDSFolderEntryUUID <sup>5</sup></td>
                        <td>XDSFolder.entryUUID</td>
                        <td>O <sup>1</sup></td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSFolderUniqueId <sup>5</sup></td>
                        <td>XDSFolder.uniqueId</td>
                        <td>O <sup>1</sup></td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryFormatCode <sup>4</sup></td>
                        <td>XDSDocumentEntry.formatCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryConfidentialityCode <sup>4</sup></td>
                        <td>XDSDocumentEntry.confidentialityCode <sup>2</sup></td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$homeCommunityId</td>
                        <td>None</td>
                        <td>O <sup>3</sup></td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryType <sup>6</sup></td>
                        <td>XDSDocumentEntry.objectType</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    Either $XDSFolderEntryUUID or $XDSFolderUniqueId shall be specified. This transaction shall return an XDSStoredQueryParamNumber error if both parameters are specified.
                </p>
                <p>
                    <sup>2</sup>
                    Supports AND/OR semantics as specified in <a
                            href="#3.18.4.1.2.3.5.">Section 3.18.4.1.2.3.5</a>.
                </p>
                <p>
                    <sup>3</sup>
                    The homeCommunityId value is specified as the home attribute on the AdhocQuery element of the query request, as in: <code
                            class="xml">&lt;AdhocQuery id="…" home="urn:oid:1.2.3" … &gt;</code>. Document Consumer Actors shall specify the homeCommunityId value if they received a value for this attribute as part of the previous Registry Stored Query response entry which contained the specified EntryUUID or UniqueID. See <a
                            href="#3.18.4.1.2.3.8">Section 3.18.4.1.2.3.8</a> for more details.
                </p>
                <p>
                    <sup>4</sup>
                    Shall be coded according to specification in <a href="#3.18.4.1.2.3.4">Section 3.18.4.1.2.3.4 Coding of Code/Code-Scheme</a>.
                </p>
                <p>
                    <sup>5</sup>
                    If the Stored Query specifies a returnType of LeafClass then the Document Registry shall verify that all requested Folder, and DocumentEntry objects to be returned will contain the same Patient ID. If this validation fails an XDSResultNotSinglePatient error shall be returned and no metadata shall be returned.
                </p>
                <p>
                    <sup>6</sup>
                    See <a href="#3.18.4.1.2.3.6.2">Section 3.18.4.1.2.3.6.2</a>
                </p>
                <p class="heading8" id="3.18.4.1.2.3.7.12">3.18.4.1.2.3.7.12 GetFoldersForDocument</p>
                <p>Retrieve XDSFolder objects that contain the XDSDocumentEntry object provided with the query.
                    XDSDocumentEntry objects are selected either by their entryUUID or uniqueId attribute.</p>
                <p>
                    <strong>Returns:</strong>
                    XDSFolder objects that contain specified XDSDocumentEntry object. More specifically, for each Association object of type HasMember that has a targetObject attribute referencing the target XDSDocumentEntry object, return the object referenced by its sourceObject if it is of type XDSFolder.
                </p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$XDSDocumentEntryEntryUUID</td>
                        <td>XDSDocumentEntry.entryUUID</td>
                        <td>O <sup>1</sup></td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryUniqueId</td>
                        <td>XDSDocumentEntry.uniqueId</td>
                        <td>O <sup>1</sup></td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$homeCommunityId</td>
                        <td>None</td>
                        <td>O <sup>2</sup></td>
                        <td>—</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    Either $XDSDocumentEntryEntryUUID or $XDSDocumentEntryUniqueId shall be specified. This transaction shall return an XDSStoredQueryParamNumber error if both parameters are specified.
                </p>
                <p>
                    <sup>2</sup>
                    The homeCommunityId value is specified as the home attribute on the AdhocQuery element of the query request, as in: <code
                            class="xml">&lt;AdhocQuery id="…" home="urn:oid:1.2.3" … &gt;</code>. Document Consumer Actors shall specify the homeCommunityId value if they received a value for this attribute as part of the previous Registry Stored Query response entry which contained the specified EntryUUID or UniqueID. See <a
                            href="#3.18.4.1.2.3.8">Section 3.18.4.1.2.3.8</a> for more details.
                </p>
                <p class="note">
                    Note: A query for a single XDSDocumentEntry.uniqueId can return multiple results. See
                    <a href="../Volume3/ch-4.1.html#4.1.4">ITI TF-3: 4.1.4</a>
                    under the topic of Document Metadata Duplication for explanation.
                </p>
                <p class="heading8" id="3.18.4.1.2.3.7.13">3.18.4.1.2.3.7.13 GetRelatedDocuments</p>
                <p>Retrieve XDSDocumentEntry objects that are related to the specified document via Association objects.
                    Also return the Association objects. The specified document is designated by UUID or uniqueId. The
                    query shall return</p>
                <ul>
                    <li class="bullet-list1">Association objects where:</li>
                </ul>
                <ul>
                    <li class="bullet-list2">The sourceObject attribute OR the targetObject attribute references the
                        specified document AND
                    </li>
                    <li class="bullet-list2">Both sourceObject attribute and targetObject attribute reference documents
                        AND
                    </li>
                    <li class="bullet-list2">The associationType attribute matches a value included in the
                        $AssociationTypes parameter
                    </li>
                </ul>
                <ul>
                    <li class="bullet-list1">XDSDocumentEntry objects referenced by the targetObject attribute OR the
                        sourceObject attribute of an Association object matched above.
                    </li>
                </ul>
                <p class="note">Note: A side effect of the query is that the specified document is returned in the
                    results if at least one Association is returned.</p>
                <p class="note">Note: A side effect of this query is that if the document specified by the
                    $XDSDocumentEntryEntryUUID or $XDSDocumentEntryUniqueId parameters has no associations linking it to
                    other documents, then no documents and no associations are returned.</p>
                <p>See ITI TF-3: 4.1.6 Document Relationships and Associations for background.</p>
                <p>
                    <strong>Returns:</strong>
                    Association objects and related XDSDocumentEntry objects
                </p>
                <p>
                    <strong>Given:</strong>
                    An XDSDocumentEntry object and a collection of association types.
                </p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$XDSDocumentEntryEntryUUID</td>
                        <td>XDSDocumentEntry.entryUUID</td>
                        <td>O <sup>1</sup></td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryUniqueId</td>
                        <td>XDSDocumentEntry.uniqueId</td>
                        <td>O <sup>1</sup></td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$AssociationTypes</td>
                        <td>Not a named attribute</td>
                        <td>R</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$homeCommunityId</td>
                        <td>None</td>
                        <td>O <sup>2</sup></td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryType <sup>3</sup></td>
                        <td>XDSDocumentEntry.objectType</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    Either $XDSDocumentEntryEntryUUID or $XDSDocumentEntryUniqueId shall be specified. This transaction shall return an XDSStoredQueryParamNumber error if both parameters are specified.
                </p>
                <p>
                    <sup>2</sup>
                    The homeCommunityId value is specified as the home attribute on the AdhocQuery element of the query request, as in: <code
                            class="xml">&lt;AdhocQuery id="…" home="urn:oid:1.2.3" … &gt;</code>. Document Consumer Actors shall specify the homeCommunityId value if they received a value for this attribute as part of the previous Registry Stored Query response entry which contained the specified EntryUUID or UniqueID. See <a
                            href="#3.18.4.1.2.3.8">Section 3.18.4.1.2.3.8</a> for more details.
                </p>
                <p>
                    <sup>3</sup>
                    See <a href="#3.18.4.1.2.3.6.2">Section 3.18.4.1.2.3.6.2</a>
                </p>
                <p class="note">
                    Note: A query for a single XDSDocumentEntry.uniqueId can return multiple results. See
                    <a href="../Volume3/ch-4.1.html#4.1.4">ITI TF-3: 4.1.4</a>
                    under the topic of Document Metadata Duplication for explanation.
                </p>
                <p class="heading8" id="3.18.4.1.2.3.7.14">3.18.4.1.2.3.7.14 FindDocumentsByReferenceId</p>
                <p>This query shall be supported by Registries claiming the "Reference ID" Option. Find documents
                    (XDSDocumentEntry objects) in the registry for a given patientID with a matching 'status' attribute.
                    The other parameters can be used to restrict the set of XDSDocumentEntry objects returned.</p>
                <p>This query is semantically identical to the FindDocuments Stored Query (see <a
                        href="#3.18.4.1.2.3.7.1">Section 3.18.4.1.2.3.7.1</a>)
                    except:</p>
                <ul>
                    <li class="bullet-list1">$XDSDocumentEntryReferenceIdList contains one or more values to match
                        against the referenceIdList document entry. Since referencedIdList is a rim:Slot, entries in the
                        referencedIdList are matched as exact matches against the query parameter values.
                    </li>
                </ul>
                <p>
                    <strong>Returns:</strong>
                    XDSDocumentEntry objects matching the query parameters
                </p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Parameter Name</td>
                        <td>Attribute</td>
                        <td>Opt</td>
                        <td>Mult</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>$XDSDocumentEntryPatientId</td>
                        <td>XDSDocumentEntry.patientId</td>
                        <td>R</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryReferenceIdList <sup>5</sup></td>
                        <td>XDSDocumentEntry.referenceIdList <sup>3</sup></td>
                        <td>R</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryClassCode <sup>1</sup></td>
                        <td>XDSDocumentEntry.classCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryTypeCode <sup>1</sup></td>
                        <td>XDSDocumentEntry.typeCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryPracticeSettingCode <sup>1</sup></td>
                        <td>XDSDocumentEntry.practiceSettingCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryCreationTimeFrom</td>
                        <td>Lower value of XDSDocumentEntry.creationTime</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryCreationTimeTo</td>
                        <td>Upper value of XDSDocumentEntry.creationTime</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryServiceStartTimeFrom</td>
                        <td>Lower value of XDSDocumentEntry.serviceStartTime</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryServiceStartTimeTo</td>
                        <td>Upper value of XDSDocumentEntry.serviceStartTime</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryServiceStopTimeFrom</td>
                        <td>Lower value of XDSDocumentEntry.serviceStopTime</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryServiceStopTimeTo</td>
                        <td>Upper value of XDSDocumentEntry.serviceStopTime</td>
                        <td>O</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryHealthcareFacilityTypeCode <sup>1</sup></td>
                        <td>XDSDocumentEntry.healthcareFacilityTypeCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryEventCodeList <sup>1</sup></td>
                        <td>XDSDocumentEntry.eventCodeList <sup>3</sup></td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryConfidentialityCode <sup>1</sup></td>
                        <td>XDSDocumentEntry.confidentialityCode <sup>3</sup></td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryAuthorPerson <sup>4</sup></td>
                        <td>XDSDocumentEntry.author</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryFormatCode <sup>1</sup></td>
                        <td>XDSDocumentEntry.formatCode</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryStatus</td>
                        <td>XDSDocumentEntry.availabilityStatus</td>
                        <td>R</td>
                        <td>M</td>
                    </tr>
                    <tr>
                        <td>$XDSDocumentEntryType <sup>6</sup></td>
                        <td>XDSDocumentEntry.objectType</td>
                        <td>O</td>
                        <td>M</td>
                    </tr>
                    </tbody>
                </table>
                <p>
                    <sup>1</sup>
                    Shall be coded according to specification in <a href="#3.18.4.1.2.3.4">Section 3.18.4.1.2.3.4 Coding of Code/Code-Scheme</a>.
                </p>
                <p>
                    <sup>3</sup>
                    Supports AND/OR semantics as specified in <a
                            href="#3.18.4.1.2.3.5.">Section 3.18.4.1.2.3.5</a>.
                </p>
                <p>
                    <sup>4</sup>
                    The value for this parameter is a pattern compatible with the SQL keyword LIKE which allows the use of the following wildcard characters: % to match any (or no) characters and _ to match a single character. The match shall be applied to the text contained in the Value elements of the authorPerson Slot on the author Classification (value strings of the authorPerson sub-attribute)
                </p>
                <p>
                    <sup>5</sup>
                    The value for this parameter is a pattern compatible with the SQL keyword LIKE which allows the use of the following wildcard characters: % to match any (or no) characters and _ to match a single character.
                </p>
                <p>
                    <sup>6</sup>
                    See <a href="#3.18.4.1.2.3.6.2.">Section 3.18.4.1.2.3.6.2</a>.
                </p>
                <p class="heading7" id="3.18.4.1.2.3.8">3.18.4.1.2.3.8 Use of homeCommunityId</p>
                <p>The Registry Stored Query makes use of the homeCommunityId which is a globally unique identifier for
                    a community and is used to obtain the Web Services endpoint of services that provide access to data
                    in that community. The homeCommunityId is structured as an OID limited to 64 characters and is
                    specified in URI syntax; for example, the homeCommunityId of 1.2.3 would be formatted as <code
                            class="oid">urn:oid:1.2.3</code>.
                </p>
                <p>Its use is as follows:</p>
                <ul>
                    <li class="bullet-list1">It is returned within the response to Registry Stored Query and Cross
                        Gateway Query transactions to indicate the association of a response element with a community.
                        It is specified as the ebRIM 'home' attribute within the ExtrinsicObject, RegistryPackage and
                        ObjectRef elements. Document Consumers process the value as an opaque unique identifier.
                    </li>
                    <li class="bullet-list1">It is an optional parameter to Registry Stored Query requests, not
                        requiring a patient id parameter, and Retrieve Document Set requests to indicate which community
                        to direct the request.
                    </li>
                </ul>
                <p>For stored queries which do not require the patient id as a parameter, meaning query by EntryUUID or
                    UniqueID:</p>
                <ul>
                    <li class="bullet-list1">If the Registry Stored Query is being addressed to an Initiating Gateway
                        then the Document Consumer may have previously sent a Registry Stored Query to the Initiating
                        Gateway which included a patient id and saved the homeCommunityId which was returned on the
                        element containing the EntryUUID or uniqueID. If this is not the case the Document Consumer
                        shall have access to the correct homeCommunityId through some other means.
                    </li>
                    <li class="bullet-list1">If the Document Consumer received the EntryUUID or uniqueID in a previous
                        Registry Stored Query response which contained a homeCommunityId, then the Document Consumer
                        shall specify the homeCommunityId parameter.
                    </li>
                    <li class="bullet-list1">
                        The homeCommunityId value is specified as the home attribute on the AdhocQuery element of the query request, as in:<br/>
                        <code class="xml">&lt;AdhocQuery id="…" home="urn:oid:1.2.3" … &gt;</code>
                    </li>
                    <li class="bullet-list1">Each query request can have at most one homeCommunityId value. If the
                        Document Consumer specifies multiple entryUUID or uniqueID values they must all be associated
                        with the same homeCommunityId value. Multiple individual query requests can be used to retrieve
                        data associated with different homeCommunityIds.
                    </li>
                </ul>
                <p class="heading7" id="3.18.4.1.2.3.9">3.18.4.1.2.3.9 Merge Patient ID</p>
                <p>
                    Patient identifiers can be merged via messages received through the <a href="../Volume2/ITI-8.html">Patient
                    Identity Feed [ITI-8]</a> or
                    the <a href="../Volume2/ITI-44.html">Patient Identity Feed v3 [ITI-44]</a> transaction. See <a
                        href="../Volume2/ITI-8.html#3.8.4.2">Section 3.8.4.2</a> and
                    <a href="../Volume2/ITI-44.html#3.44.4.2.4">ITI TF-2: 3.44.4.2.4</a>
                    for details.
                </p>
                <p>This section defines the effects that merged patient identifiers have on the Registry Stored Query
                    transaction. The process of merging patient identifiers involves two patient identifiers: the
                    subsumed patient identifier and the surviving patient identifier. The subsumed patient identifier
                    stops being used and all patient records that were associated with that identifier are now
                    associated with the surviving patient identifier. See <a href="../Volume2/ITI-8.html#3.8.4.2.4">Section
                        3.8.4.2.4</a> for how these identifiers
                    map into the Merge Patient Identifier message.</p>
                <p>Several transactions handle processing of merged patient identifiers, e.g.:</p>

                <ul>
                    <li class="bullet-list1"><a href="../Volume2/ITI-8.html">Patient Identity Feed [ITI-8]</a> and <a
                            href="../Volume2/ITI-44.html">Patient Identity Feed v3 [ITI-44]</a> –
                        accept the merge request
                    </li>
                    <li class="bullet-list1"><a href="../Volume2/ITI-42.html">Register Document Set-b [ITI-42]</a> –
                        accepts metadata containing patient
                        identifiers
                    </li>
                    <li class="bullet-list1">Registry Stored Query [ITI-18] – retrieves metadata containing patient
                        identifiers.
                    </li>
                </ul>
                <p>The above transactions and the profiles that use them do not specify how patient identifier merging
                    is to be implemented. They do specify the results of the merge in terms of possible rejection of
                    Register Document Set-b transactions and results returned in Registry Stored Query transactions.</p>
                <p>The following two sections document the responsibilities of the Document Registry and the Document
                    Consumer in processing Registry Stored Query transactions that reference patient identifiers that
                    are involved in merges.</p>
                <p class="heading8" id="3.18.4.1.2.3.9.1">3.18.4.1.2.3.9.1 Responsibilities of the Document Registry
                    Actor</p>
                <p>The rules governing the handling of patient identity merges depend on the following factors:</p>
                <ul>
                    <li class="bullet-list1">Does the stored query contain patient identifier parameters?</li>
                    <li class="bullet-list1">Has the registry received a patient identity merge message which references
                        the patient identity parameter as either the subsumed patient identifier or the surviving
                        patient identifier?
                    </li>
                    <li class="bullet-list1">The content of any previously received merge message can contribute to the
                        result of a stored query.
                    </li>
                    <li class="bullet-list1">More than one merge message may contribute to the results of a stored query
                        (e.g., Patient ID A merged into Patient ID B merged into Patient ID C etc.)
                    </li>
                </ul>
                <p>The following assertions shall be met by a Document Registry when returning metadata in a Registry
                    Stored Query transaction. The terms 'subsumed patient identifier' and 'surviving patient identifier'
                    refer to the contents of any previously received merge message.</p>
                <ul>
                    <li class="bullet-list1">If the query includes a patient identifier parameter and that patient
                        identity matches the subsumed patient identifier of a merge message then the query shall return
                        no results or an XDSUnknownPatientId error, depending on XDS Affinity Domain policy.
                    </li>
                    <li class="bullet-list1">If the query includes a patient identifier and that patient identifier
                        matches the surviving patient identifier of a previous merge message then the query shall return
                        the composite of:
                    </li>
                    <li class="bullet-list1">Metadata registered against the surviving patient identifier</li>
                    <li class="bullet-list1">Metadata registered against the subsumed patient identifier</li>
                    <li class="bullet-list1">Metadata returned shall show the surviving patient identifier in these
                        metadata attributes:
                    </li>
                </ul>
                <ul>
                    <li class="bullet-list2">XDSSubmissionSet.patientId</li>
                    <li class="bullet-list2">XDSDocumentEntry.patientId</li>
                    <li class="bullet-list2">XDSFolder.patientId</li>
                </ul>
                <ul>
                    <li class="bullet-list1">Patient identifiers may be affected by multiple patient identity merges.
                    </li>
                    <li class="bullet-list1">The subsumed patient identifier may have been referenced in a prior A40
                        Merge message as the surviving patient identifier.
                    </li>
                    <li class="bullet-list1">The surviving patient identifier may have been referenced in a prior A40
                        Merge message as the surviving patient identifier.
                    </li>
                    <li class="bullet-list1">Patient demographics in XDSDocumentEntry.sourcePatientInfo shall not be
                        altered as a result of an A40 Merge.
                    </li>
                </ul>
                <p class="heading8" id="3.18.4.1.2.3.9.2">3.18.4.1.2.3.9.2 Responsibilities of the Document Consumer
                    Actor</p>
                <p>The following assertions affect the Document Consumer:</p>
                <ul>
                    <li class="bullet-list1">The Document Consumer shall depend on the patient identity in the following
                        metadata attributes after a patient identifier is merged:
                    </li>
                </ul>
                <ul>
                    <li class="bullet-list2">XDSSubmissionSet.patientId</li>
                    <li class="bullet-list2">XDSDocumentEntry.patientId</li>
                    <li class="bullet-list2">XDSFolder.patientId</li>
                </ul>
                <ul>
                    <li class="bullet-list1">The Document Registry is required to return the surviving patient
                        identifier of a merge in place of the original subsumed patient identifier.
                    </li>
                </ul>
                <ul>
                    <li class="bullet-list2">The Document Consumer shall not depend on the patient demographics found in
                        XDSDocumentEntry.sourcePatientInfo after a patient identifier is merged. Patient demographics
                        should be accessed through PIX/PDQ services or their equivalent.
                    </li>
                </ul>
                <h6 id="3.18.4.1.2.4">3.18.4.1.2.4 Stored Query IDs</h6>
                <p>The standard XDS queries are assigned the following Query IDs. These IDs are used in the
                    AdhocQueryRequest to reference queries stored on the Document Registry Actor. Query IDs are in UUID
                    format (<a href="https://datatracker.ietf.org/doc/html/rfc4122">RFC4122</a>). An error shall be
                    returned when an unsupported stored query ID is received.</p>
                <p class="note">Note: This query mechanism can be extended by adding a query by allocating a Query ID,
                    defining query parameters, and implementing the query in the Document Registry.</p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Query Name</td>
                        <td>Query ID</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>FindDocuments</td>
                        <td><code class="uuid">urn:uuid:14d4debf-8f97-4251-9a74-a90016b0af0d</code></td>
                    </tr>
                    <tr>
                        <td>FindSubmissionSets</td>
                        <td><code class="uuid">urn:uuid:f26abbcb-ac74-4422-8a30-edb644bbc1a9</code></td>
                    </tr>
                    <tr>
                        <td>FindFolders</td>
                        <td><code class="uuid">urn:uuid:958f3006-baad-4929-a4de-ff1114824431</code></td>
                    </tr>
                    <tr>
                        <td>GetAll</td>
                        <td><code class="uuid">urn:uuid:10b545ea-725c-446d-9b95-8aeb444eddf3</code></td>
                    </tr>
                    <tr>
                        <td>GetDocuments</td>
                        <td><code class="uuid">urn:uuid:5c4f972b-d56b-40ac-a5fc-c8ca9b40b9d4</code></td>
                    </tr>
                    <tr>
                        <td>GetFolders</td>
                        <td><code class="uuid">urn:uuid:5737b14c-8a1a-4539-b659-e03a34a5e1e4</code></td>
                    </tr>
                    <tr>
                        <td>GetAssociations</td>
                        <td><code class="uuid">urn:uuid:a7ae438b-4bc2-4642-93e9-be891f7bb155</code></td>
                    </tr>
                    <tr>
                        <td>GetDocumentsAndAssociations</td>
                        <td><code class="uuid">urn:uuid:bab9529a-4a10-40b3-a01f-f68a615d247a</code></td>
                    </tr>
                    <tr>
                        <td>GetSubmissionSets</td>
                        <td><code class="uuid">urn:uuid:51224314-5390-4169-9b91-b1980040715a</code></td>
                    </tr>
                    <tr>
                        <td>GetSubmissionSetAndContents</td>
                        <td><code class="uuid">urn:uuid:e8e3cb2c-e39c-46b9-99e4-c12f57260b83</code></td>
                    </tr>
                    <tr>
                        <td>GetFolderAndContents</td>
                        <td><code class="uuid">urn:uuid:b909a503-523d-4517-8acf-8e5834dfc4c7</code></td>
                    </tr>
                    <tr>
                        <td>GetFoldersForDocument</td>
                        <td><code class="uuid">urn:uuid:10cae35a-c7f9-4cf5-b61e-fc3278ffb578</code></td>
                    </tr>
                    <tr>
                        <td>GetRelatedDocuments</td>
                        <td><code class="uuid">urn:uuid:d90e5407-b356-4d91-a89f-873917b4b0e6</code></td>
                    </tr>
                    <tr>
                        <td>FindDocumentsByReferenceId</td>
                        <td><code class="uuid">urn:uuid:12941a89-e02e-4be5-967c-ce4bfc8fe492</code></td>
                    </tr>
                    </tbody>
                </table>
                <h6 id="3.18.4.1.2.5">3.18.4.1.2.5 Compatibility of Options</h6>
                <p>The presence or absence of the optional $XDSDocumentEntryType parameter triggers different behaviors
                    on the Document Registry. If this parameter is specified, and the Document Registry does not support
                    it, the Document Registry shall ignore. If it is specified, and the Document Registry does support
                    it, the proper information is returned.</p>
                <ul>
                    <li class="bullet-list1">If the Document Consumer does not support the On-Demand Documents Option,
                        it will send a Registry Stored Query request which does not contain the $XDSDocumentEntryType
                        parameter. The Document Registry will therefore not supply any On-Demand Document Entries in the
                        query response.
                    </li>
                    <li class="bullet-list1">If the Document Consume does support the On-Demand Documents Option<, then
                        it will be able to specify the $XDSDocumentEntryType parameter containing the uuid for On-Demand
                        Document Entries in a Registry Stored Query. A Document Registry with the On-Demand Documents
                        Option will recognize the $XDSDocumentEntryType parameter and process accordingly. A Document
                        Registry which does not support the On-Demand Documents Option will ignore the
                        $XDSDocumentEntryType parameter. Since there cannot be any On-Demand Document Entries held by a
                        Document Registry which does not support On-Demand Documents, this is a consistent response to
                        the request.
                    </li>
                </ul>
                <h6 id="3.18.4.1.2.6">3.18.4.1.2.6 Managing Large Query Responses</h6>
                <p>ebXML version 3.0 supports query results pagination (ebRS version 3.0 chapter 6.2). The interactions
                    between the stored query capability and the query results pagination capability within the standard
                    have never been reconciled and are not recommended for use together. It is recommended instead that
                    query pagination be implemented within the Document Consumer Actor.</p>
                <p>This can be accomplished by specifying <code class="xml">returnType="ObjectRef"</code> on all large
                    queries. This returns a
                    list of references (UUIDs) instead of full objects (large XML structures). This is practical for
                    queries returning thousands of objects. To construct a page for display, a small number of objects
                    can be retrieved through a second query. This is repeated for each page. As an example, the
                    following sequence of queries could be used to list a large number of documents:</p>
                <ul>
                    <li class="bullet-list1">FindDocuments query with <code class="xml">returnType="ObjectRef"</code>
                        which returns a large
                        collections of ObjectRefs (UUIDs)
                    </li>
                    <li class="bullet-list1">GetDocuments query with <code class="xml">returnType="LeafClass"</code>
                        issued with a subset of the
                        above returned UUIDs which returns the details to construct one page of listing
                    </li>
                </ul>
                <p>OR</p>
                <ul>
                    <li class="bullet-list1">GetDocumentsAndAssociations query with <code class="xml">returnType="LeafClass"</code>
                        issued with a
                        subset of the above returned UUIDs which returns the details to construct one page of listing.
                        By retrieving the Association objects, the existence of document replacement, transformation,
                        and amendment can be included into the display.
                    </li>
                </ul>
                <h6 id="3.18.4.1.2.7">3.18.4.1.2.7 Web Services Transport</h6>
                <p>
                    The query request and response will be transmitted using Web Services, according to the requirements
                    specified in
                    <a href="../Volume2/ch-V.html#Appendix V">ITI TF-2: Appendix V</a>. The specific values for the WSDL
                    describing the Stored Query Service are described in this section.
                </p>
                <p>The Document Registry shall accept a Registry Stored Query Request formatted as a SIMPLE SOAP message
                    and respond with a Registry Stored Query Response formatted as a SIMPLE SOAP message. The Document
                    Consumer shall generate the Registry Stored Query Request formatted as a SIMPLE SOAP message and
                    accept a Registry Stored Query Response formatted as a SIMPLE SOAP message.</p>
                <p>
                    <strong>IHE-WSP201) The attribute /wsdl:definitions/@name shall be "DocumentRegistry".</strong>
                </p>
                <p>The following WSDL naming conventions shall apply:</p>
                <pre class="XMLname">wsdl:definitions/@name="DocumentRegistry":
query message    -&gt; "RegistryStoredQuery_Message"
query response   -&gt; "RegistryStoredQueryResponse_Message"
portType         -&gt; "DocumentRegistry_PortType"
operation        -&gt; "RegistryStoredQuery"
SOAP 1.2 binding -&gt; "DocumentRegistry_Binding_Soap12"
SOAP 1.2 port    -&gt; "DocumentRegistry_Port_Soap12"</pre>
                <p>
                    <strong>IHE-WSP202) The targetNamespace of the WSDL shall be "urn:ihe:iti:xds-b:2007"</strong>
                </p>
                <p>Document Registry: These are the requirements for the Registry Stored Query transaction presented in
                    the order in which they would appear in the Document Registry WSDL definition:</p>
                <ul>
                    <li class="bullet-list1">The following types shall be imported (xsd:import) in the
                        /definitions/types section:
                    </li>
                </ul>
                <ul>
                    <li class="bullet-list2">namespace="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0",
                        schemaLocation="query.xsd"
                    </li>
                </ul>
                <ul>
                    <li class="bullet-list1">The /definitions/message/part/@element attribute of the Registry Stored
                        Query Request message shall be defined as "query:AdhocQueryRequest"
                    </li>
                    <li class="bullet-list1">The /definitions/message/part/@element attribute of the Registry Stored
                        Query Response message shall be defined as "query:AdhocQueryResponse"
                    </li>
                    <li class="bullet-list1">Refer to Table 3.18.4.1.2.7-1 below for additional attribute requirements
                    </li>
                    <li class="bullet-list1">To support the Asynchronous Web Services Exchange Option on the Document
                        Consumer, the Document Registry shall support the use of a non-anonymous response EPR in the
                        WS-Addressing replyTo header.
                    </li>
                </ul>
                <p id="t3.18.4.1.2.7-1" class="tableTitle">Table 3.18.4.1.2.7-1: Additional Attribute Requirements</p>
                <table class="hover">
                    <thead>
                    <tr>
                        <td>Attribute</td>
                        <td>Value</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>/definitions/portType/operation@name</td>
                        <td>DocumentRegistry_RegistryStoredQuery</td>
                    </tr>
                    <tr>
                        <td>/definitions/portType/operation/input/@wsaw:Action</td>
                        <td><code class="urn">urn:ihe:iti:2007:RegistryStoredQuery</code></td>
                    </tr>
                    <tr>
                        <td>/definitions/portType/operation/output/@wsaw:Action</td>
                        <td><code class="urn">urn:ihe:iti:2007:RegistryStoredQueryResponse</code></td>
                    </tr>
                    <tr>
                        <td>/definitions/binding/operation/wsoap12:operation/@soapActionRequired</td>
                        <td>false</td>
                    </tr>
                    </tbody>
                </table>
                <p>The following WSDL fragment shows an example of Registry Stored Query transaction definition:</p>
                <pre><code class="code-block xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;definitions …&gt;
  …
  &lt;types&gt;
    &lt;xsd:schema elementFormDefault="qualified" targetNamespace="urn:ihe:iti:xds-b:2007"&gt;
      &lt;xsd:import namespace="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" schemaLocation="schema\query.xsd"/&gt;
      …
    &lt;/xsd:schema&gt;
  &lt;/types&gt;
  &lt;message name="RegistryStoredQuery_Message"&gt;
    &lt;documentation&gt;Registry Stored Query&lt;/documentation&gt;
    &lt;part name="body" element="query:AdhocQueryRequest"/&gt;
  &lt;/message&gt;
  &lt;message name="RegistryStoredQueryResponse_Message"&gt;
    &lt;documentation&gt;Registry Stored Query Response&lt;/documentation&gt;
    &lt;part name="body" element="query:AdhocQueryResponse"/&gt;
  &lt;/message&gt;
  …
  &lt;portType name="DocumentRegistry_PortType"&gt;
    &lt;operation name="DocumentRegistry_RegistryStoredQuery"&gt;
      &lt;input message="ihe:RegistryStoredQuery_Message" wsaw:Action="urn:ihe:iti:2007:RegistryStoredQuery"/&gt;
      &lt;output message="ihe:RegistryStoredQueryResponse_Message" wsaw:Action="urn:ihe:iti:2007:RegistryStoredQueryResponse"/&gt;
    &lt;/operation&gt;
    …
  &lt;/portType&gt;
  …
&lt;/definitions&gt;</code></pre>
                <p>
                    A full WSDL for the Document Repository and Document Registry Actors is found online: see
                    <a href="../Volume2/ch-W.html#Appendix W">ITI TF-2: Appendix W</a>.
                </p>
                <p class="heading7" id="3.18.4.1.2.7.1">3.18.4.1.2.7.1 Sample SOAP Messages</p>
                <p>
                    The samples in the following two sections show a typical SOAP request and its relative SOAP
                    response. The sample messages also show the WS-Addressing headers <code class="xml">&lt;a:Action/&gt;</code>,
                    <code class="xml">&lt;a:MessageID/&gt;</code>,
                    <code class="xml">&lt;a:ReplyTo/&gt;</code>…; these WS-Addressing headers are populated according to
                    <a href="../Volume2/ch-V.html#Appendix V">ITI TF-2: Appendix V</a>: Web Services for IHE
                    transactions.
                    The body of the SOAP message is omitted for brevity; in a real scenario the empty element will be
                    populated with the appropriate metadata.
                </p>
                <p>
                    Samples presented in this section are also available online: see
                    <a href="../Volume2/ch-W.html#Appendix W">ITI TF-2: Appendix W</a>.
                </p>
                <p class="heading8" id="3.18.4.1.2.7.1.1">3.18.4.1.2.7.1.1 Sample Registry Stored Query SOAP Request</p>
                <h9 id="3.18.4.1.2.7.1.1">3.18.4.1.2.7.1.1.1 Synchronous Web Services Exchange</h9>
                <pre><code class="code-block xml">&lt;s:Envelope xmlns:a="http://www.w3.org/2005/08/addressing" xmlns:s="http://www.w3.org/2003/05/soap-envelope"&gt;
  &lt;s:Header&gt;
    &lt;a:Action s:mustUnderstand="1"&gt;urn:ihe:iti:2007:RegistryStoredQuery&lt;/a:Action&gt;
    &lt;a:MessageID&gt;urn:uuid:def119ad-dc13-49c1-a3c7-e3742531f9b3&lt;/a:MessageID&gt;
    &lt;a:ReplyTo s:mustUnderstand="1"&gt;
      &lt;a:Address&gt;http://www.w3.org/2005/08/addressing/anonymous&lt;/a:Address&gt;
    &lt;/a:ReplyTo&gt;
    &lt;a:To&gt;http://localhost/service/IHEXDSRegistry.svc&lt;/a:To&gt;
  &lt;/s:Header&gt;
  &lt;s:Body&gt;
    &lt;query:AdhocQueryRequest xmlns:query="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:rs="urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0"&gt;
      &lt;query:ResponseOption returnComposedObjects="true" returnType="LeafClass"/&gt;
      &lt;rim:AdhocQuery id="urn:uuid:14d4debf-8f97-4251-9a74-a90016b0af0d"&gt;
        &lt;rim:Slot name="$XDSDocumentEntryPatientId"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;'st3498702^^^&amp;1.3.6.1.4.1.21367.2005.3.7&amp;ISO'&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Slot name="$XDSDocumentEntryStatus"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;('urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Approved')&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Slot name="$XDSDocumentEntryCreationTimeFrom"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;200412252300&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Slot name="$XDSDocumentEntryCreationTimeTo"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;200501010800&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Slot name="$XDSDocumentEntryHealthcareFacilityTypeCode"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;('35971002^^2.16.840.1.113883.6.96')&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
      &lt;/rim:AdhocQuery&gt;
    &lt;/query:AdhocQueryRequest&gt;
  &lt;/s:Body&gt;
&lt;/s:Envelope&gt;</code></pre>
                <h9 id="3.18.4.1.2.7.1.1.2">3.18.4.1.2.7.1.1.2 Asynchronous Web Services Exchange</h9>
                <pre><code class="code-block xml">&lt;s:Envelope xmlns:a="http://www.w3.org/2005/08/addressing" xmlns:s="http://www.w3.org/2003/05/soap-envelope"&gt;
  &lt;s:Header&gt;
    &lt;a:Action s:mustUnderstand="1"&gt;urn:ihe:iti:2007:RegistryStoredQuery&lt;/a:Action&gt;
    &lt;a:MessageID&gt;urn:uuid:a02ca8cd-86fa-4afc-a27c-616c183b2055&lt;/a:MessageID&gt;
    &lt;a:ReplyTo&gt;
      &lt;a:Address&gt;http://192.168.2.4:9080/XDS/DocumentConsumerReceiver.svc&lt;/a:Address&gt;
    &lt;/a:ReplyTo&gt;
    &lt;a:To s:mustUnderstand="1"&gt;http://localhost:2647/XdsService/DocumentRegistryReceiver.svc&lt;/a:To&gt;
  &lt;/s:Header&gt;
  &lt;s:Body&gt;
    &lt;query:AdhocQueryRequest xmlns:query="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:rs="urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0"&gt;
      &lt;query:ResponseOption returnComposedObjects="true" returnType="LeafClass"/&gt;
      &lt;rim:AdhocQuery id=" urn:uuid:14d4debf-8f97-4251-9a74-a90016b0af0d "&gt;
        &lt;rim:Slot name="$XDSDocumentEntryPatientId"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;st3498702^^^&amp;1.3.6.1.4.1.21367.2005.3.7&amp;ISO&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Slot name="$XDSDocumentEntryStatus"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;('urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Approved')&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Slot name="$XDSDocumentEntryCreationTimeFrom"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;200412252300&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Slot name="$XDSDocumentEntryCreationTimeTo"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;200501010800&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Slot name="$XDSDocumentEntryHealthcareFacilityTypeCode"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;('Emergency Department')&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
      &lt;/rim:AdhocQuery&gt;
    &lt;/query:AdhocQueryRequest&gt;
  &lt;/s:Body&gt;
&lt;/s:Envelope&gt;</code></pre>
                <p class="heading8" id="3.18.4.1.2.7.1.2">3.18.4.1.2.7.1.2 Sample Registry Stored Query SOAP
                    Response</p>
                <h9 id="3.18.4.1.2.7.1.2.1">3.18.4.1.2.7.1.2.1 Synchronous Web Services Exchange</h9>
                <pre><code class="code-block xml">&lt;s:Envelope xmlns:a="http://www.w3.org/2005/08/addressing" xmlns:s="http://www.w3.org/2003/05/soap-envelope"&gt;
  &lt;s:Header&gt;
    &lt;a:Action s:mustUnderstand="1"&gt;urn:ihe:iti:2007:RegistryStoredQueryResponse&lt;/a:Action&gt;
    &lt;a:RelatesTo&gt;urn:uuid:def119ad-dc13-49c1-a3c7-e3742531f9b3&lt;/a:RelatesTo&gt;
  &lt;/s:Header&gt;
  &lt;s:Body&gt;
    &lt;query:AdhocQueryResponse xmlns:query="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0"/&gt;
  &lt;/s:Body&gt;
&lt;/s:Envelope&gt;</code></pre>
                <h9 id="3.18.4.1.2.7.1.2.2">3.18.4.1.2.7.1.2.2 Asynchronous Web Services Exchange</h9>
                <pre><code class="code-block xml">&lt;s:Envelope xmlns:a="http://www.w3.org/2005/08/addressing" xmlns:s="http://www.w3.org/2003/05/soap-envelope"&gt;
  &lt;s:Header&gt;
    &lt;a:Action s:mustUnderstand="1"&gt;urn:ihe:iti:2007:RegistryStoredQueryResponse&lt;/a:Action&gt;
    &lt;a:MessageID&gt;urn:uuid:D6C21225-8E7B-454E-9750-821622C099DB&lt;/a:MessageID&gt;
    &lt;a:RelatesTo&gt;urn:uuid:a02ca8cd-86fa-4afc-a27c-616c183b2055&lt;/a:RelatesTo&gt;
    &lt;a:To s:mustUnderstand="1"&gt;http://localhost:2647/XdsService/DocumentConsumerReceiver.svc&lt;/a:To&gt;
  &lt;/s:Header&gt;
  &lt;s:Body&gt;
    &lt;query:AdhocQueryResponse status="Success" xmlns:query="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"&gt;
    &lt;!-- Rest of AdhocQueryResponse message goes here --&gt;
    &lt;/query:AdhocQueryResponse&gt;
  &lt;/s:Body&gt;
&lt;/s:Envelope&gt;</code></pre>
                <h5 id="3.18.4.1.3">3.18.4.1.3 Expected Actions</h5>
                <p>The Document Registry shall:</p>
                <ol>
                    <li class="numbered-list1">Accept a parameterized query in an AdhocQueryRequest message</li>
                    <li class="numbered-list1">Verify the required parameters are included in the request. Additionally,
                        special rules documented in the above section 'Parameters for Required Queries' shall be
                        verified.
                    </li>
                    <li class="numbered-list1">Errors shall be returned for the following conditions:</li>
                </ol>
                <ul>
                    <li class="bullet-list2">Unknown query ID (error code XDSUnknownStoredQuery)</li>
                    <li class="bullet-list2">Required parameter missing (error code XDSStoredQueryMissingParam)</li>
                </ul>
                <p>
                    See
                    <a href="../Volume3/ch-4.2.html#4.2.4">ITI TF-3: 4.2.4</a>
                    Error Reporting for additional error codes and general information on formatting error responses.
                </p>
                <ol start="4">
                    <li class="numbered-list1">Process the query as appropriate:</li>
                </ol>
                <ul>
                    <li class="bullet-list1">
                        <strong>For Document Registry Actors:</strong>
                        Retrieve the internal implementation template of the query based on the Query ID supplied in the query request. Substitute appropriate parameters as indicated in <a
                                href="#3.18.4.1.2.3.7">Section 3.18.4.1.2.3.7 Parameters for Required Queries</a> and execute the query. The Document Registry shall accept the homeCommunityId value if it is specified in a Registry Stored Query request. If a patient identifier specified as a parameter to the query is unknown to the Document Registry it shall return a successful response with no elements, or an XDSUnknownPatientId error, depending on XDS Affinity Domain policy.
                    </li>
                    <li class="bullet-list1">
                        <strong>For Initiating Gateway Actors:</strong></li>
                </ul>
                <ul>
                    <li class="bullet-list2">Initiating Gateway receives a Registry Stored Query by patient id: It shall
                        determine a) which Responding Gateways this request should be sent to and b) what patient id to
                        use in the Cross Gateway Query. Detailed specification of these steps is not in the intended
                        scope of this profile. Combination of this profile with other existing profiles (e.g., PIX/PDQ),
                        future profiles or configuration mechanisms is possible. Please refer to ITI TF-1: E.7 XCA and
                        Patient Identification Management for possible use of existing profiles PIX and PDQ. For each
                        Responding Gateway identified, the Initiating Gateway shall update the query with the correct
                        patient identifier corresponding to the Responding Gateway's community and initiates a Cross
                        Gateway Query transaction to the Responding Gateway. If the Initiating Gateway is grouped with a
                        Document Consumer it will also initiate a Registry Stored Query to the local Document Registry.
                    </li>
                    <li class="bullet-list2">
                        Initiating Gateway receives a Registry Stored Query by entryUUID or uniqueID: Verify
                        homeCommunityId has been specified. If missing return Failure status with
                        XDSMissingHomeCommunityId error code. If homeCommunityId not recognized return a Failure or
                        PartialSuccess status with XDSUnknownCommunity error code. Determine which Responding Gateway to
                        contact by using the homeCommunityId to obtain the Web Services endpoint of the Responding
                        Gateway. The process of obtaining the Web Services endpoint is not further specified in this
                        profile. If the homeCommunityId represents the local community the Initiating Gateway shall
                        initiate a Registry Stored Query to the local Document Registry. The Initiating Gateway shall
                        specify the homeCommunityId in the Cross Gateway Query by entryUUID or uniqueID which identifies
                        the community associated with the Responding Gateway. For details regarding the homeCommunityId
                        see <a href="#3.18.4.1.2.3.8">Section 3.18.4.1.2.3.8</a> and
                        <a href="../Volume2/ITI-38.html#3.38.4.1.2.1">ITI TF-2: 3.38.4.1.2.1</a>.
                    </li>
                </ul>
                <ol start="5">
                    <li class="numbered-list1">Return XML formatted metadata in an AdhocQueryResponse message.</li>
                </ol>
                <ul>
                    <li class="bullet-list2">The Document Registry may specify the homeCommunityID attribute on any
                        appropriate elements
                    </li>
                    <li class="bullet-list2">
                        The Initiating Gateway shall specify the homeCommunityID attribute on all appropriate elements.
                        If the Initiating Gateway contacted a Document Registry, the Document Registry response might
                        not contain the homeCommunityId. In this case the Initiating Gateway shall add the
                        homeCommunityId of its local community to the Document Registry response prior to including it
                        in the consolidated response to the Document Consumer. The homeCommunityId attribute corresponds
                        to the 'home' attribute specified in the ebRIM standard. For more information on homeCommunityId
                        see <a href="#3.18.4.1.2.3.8">Section 3.18.4.1.2.3.8</a> and
                        <a href="../Volume2/ITI-38.html#3.38.4.1.2.1">ITI TF-2: 3.38.4.1.2.1</a>. The elements that
                        shall
                        include the home attribute are:
                    </li>
                    <li class="bullet-list2">If <code class="xml">returntype="LeafClass"</code> the ExtrinsicObject and
                        RegistryPackage elements
                        shall contain the home attribute.
                    </li>
                    <li class="bullet-list2">If <code class="xml">returnType="ObjectRef"</code> the ObjectRef element
                        shall contain the home
                        attribute
                    </li>
                    <li class="bullet-list2">If the Initiating Gateway is unable to get an appropriate response from a
                        selected Responding Gateway it shall include in its response to the Document Consumer an
                        XDSUnavailableCommunity error code where the context identifies the unavailable Responding
                        Gateway. In this case, and any other error from a Responding Gateway, the Initiating Gateway
                        shall return to the Document Consumer either a Failure status (if no part was successful) or a
                        PartialSuccess status.
                    </li>
                </ul>
                <ol start="6">
                    <li class="numbered-list1">When the Document Consumer receives the query response from the
                        Initiating Gateway it must account for two aspects of the response; namely that a) the
                        homeCommunityId attribute will be specified b) the Document Consumer may not be able to map the
                        repository id value directly to the Document Repository. XCA assumes a common coding/vocabulary
                        scheme is used across all communities. For example, all communities shall have common privacy
                        consent vocabularies. The Document Consumer shall retain the values of the homeCommunityId
                        attribute for future interaction with the Initiating Gateway.
                    </li>
                </ol>
                <p>
                    This transaction may return both errors and results in an AdhocQueryResponse message. To do this,
                    the returned AdhocQueryResponse message would contain both a RegistryObjectList element and a
                    RegistryErrorList element. See
                    <a href="../Volume3/ch-4.2.html#4.2.4">ITI TF-3: 4.2.4</a>
                    Error Reporting for additional details on formatting of error responses.
                </p>
                <p>If the Document Consumer supports the Delayed Document Assembly Option it shall accept the following
                    values of hash and size to indicate that the assembly of the document content has been delayed until
                    the document is retrieved.</p>
                <ul>
                    <li class="bullet-list1">size = 0 (zero)</li>
                    <li class="bullet-list1">hash = da39a3ee5e6b4b0d3255bfef95601890afd80709 (SHA1 hash of a zero length
                        file)
                    </li>
                </ul>
                <h6 id="3.18.4.1.3.1">3.18.4.1.3.1 Sample Query Request</h6>
                <p>This example query specifies:</p>
                <ul>
                    <li class="bullet-list1">The FindDocuments query (id attribute of AdhocQuery element)</li>
                    <li class="bullet-list1">patientID st3498702^^^&amp;1.3.6.1.4.1.21367.2005.3.7&amp;ISO</li>
                    <li class="bullet-list1">Return Approved documents only</li>
                    <li class="bullet-list1">Time range (creation time) 200412252300 to 200501010800</li>
                    <li class="bullet-list1">Healthcare Facility Type Code of Emergency Department</li>
                </ul>
                <p>Note that ebRS 3.0 specifies the use of Slot to specify name/value(s) pairs as parameters to a Stored
                    Query.</p>
                <pre><code class="code-block xml">&lt;query:AdhocQueryRequest xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:query="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:rs="urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0"&gt;
  &lt;query:ResponseOption returnComposedObjects="true" returnType="LeafClass"/&gt;
  &lt;rim:AdhocQuery id="urn:uuid:14d4debf-8f97-4251-9a74-a90016b0af0d"&gt;
    &lt;rim:Slot name="$XDSDocumentEntryPatientId"&gt;
      &lt;rim:ValueList&gt;
        &lt;rim:Value&gt;'st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO'&lt;/rim:Value&gt;
      &lt;/rim:ValueList&gt;
    &lt;/rim:Slot&gt;
    &lt;rim:Slot name="$XDSDocumentEntryStatus"
      &lt;rim:ValueList&gt;
        &lt;rim:Value&gt;('urn:oasis:names:tc:ebxml-regrep:StatusType:Approved')&lt;/rim:Value&gt;
      &lt;/rim:ValueList&gt;
    &lt;/rim:Slot&gt;
    &lt;rim:Slot name="$XDSDocumentEntryCreationTimeFrom"&gt;
      &lt;rim:ValueList&gt;
        &lt;rim:Value&gt;200412252300&lt;/rim:Value&gt;
      &lt;/rim:ValueList&gt;
    &lt;/rim:Slot&gt;
    &lt;rim:Slot name="$XDSDocumentEntryCreationTimeTo"&gt;
      &lt;rim:ValueList&gt;
        &lt;rim:Value&gt;200501010800&lt;/rim:Value&gt;
      &lt;/rim:ValueList&gt;
    &lt;/rim:Slot&gt;
    &lt;rim:Slot name="$XDSDocumentEntryHealthcareFacilityTypeCode"&gt;
      &lt;rim:ValueList&gt;
        &lt;rim:Value&gt;('Emergency Department')&lt;/rim:Value&gt;
      &lt;/rim:ValueList&gt;
    &lt;/rim:Slot&gt;
  &lt;/rim:AdhocQuery&gt;
&lt;/query:AdhocQueryRequest&gt;</code></pre>
                <p>The following example shows a get documents query for XDSDocumentEntry objects for a specified list
                    of entryUUIDs (<code class="uuid">urn:uuid:aff99222-18e3-4812-bc71-c410b2860e18</code>,
                    <code class="uuid">urn:uuid:aff99222-18e3-4812-bc71-c410b2860e19</code>, <code class="uuid">urn:uuid:aff99222-18e3-4812-bc71-c410b2860e20</code>)
                    and
                    corresponding homeCommunityId value (<code class="oid">urn:oid:1.2.3</code>):</p>
                <pre><code class="code-block xml">&lt;query:AdhocQueryRequest … &gt;
  &lt;query:ResponseOption returnComposedObjects="true" returnType="LeafClass"/&gt;
  &lt;rim:AdhocQuery id="urn:uuid:5c4f972b-d56b-40ac-a5fc-c8ca9b40b9d4" home="urn:oid:1.2.3"&gt;
    &lt;rim:Slot name="$XDSDocumentEntryEntryUUID"&gt;
      &lt;rim:ValueList&gt;
        &lt;rim:Value&gt;("urn:uuid:aff99222-18e3-4812-bc71-c410b2860e18","urn:uuid:aff99222-18e3-4812-bc71-c410b2860e19","urn:uuid:aff99222-18e3-4812-bc71-c410b2860e20")&lt;/rim:Value&gt;
      &lt;/rim:ValueList&gt;
    &lt;/rim:Slot&gt;
  &lt;/rim:AdhocQuery&gt;
&lt;/query:AdhocQueryRequest&gt;</code></pre>
                <h6 id="3.18.4.1.3.2">3.18.4.1.3.2 Intentionally Left Blank</h6>
                <h6 id="3.18.4.1.3.3">3.18.4.1.3.3 Sample Query Response</h6>
                <p>
                    This sample query response corresponds to the above query. Note that the query response message is coded in version 3.0 ebRIM and ebRS. This sample response and the ebXML Registry version 3.0 schema files are available online. The Implementation Guide found at
                    <a href="https://wiki.ihe.net/index.php/ITI_Implementation_Guide">https://wiki.ihe.net/index.php/ITI_Implementation_Guide</a>
                    contains such supplemental material.
                </p>
                <pre><code class="code-block xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;AdhocQueryResponse status="urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Success" xmlns="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0 file:/Users/bill/RegSchema/V3.0/query.xsd"&gt;
  &lt;rim:RegistryObjectList&gt;
    &lt;rim:ExtrinsicObject id="urn:uuid:08a15a6f-5b4a-42de-8f95-89474f83abdf" isOpaque="false" mimeType="text/xml" objectType="urn:uuid:7edca82f-054d-47f2-a032-9b2a5b5186c1" status="urn:oasis:names:tc:ebxml-regrep:StatusType:Approved" xmlns:q="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"&gt;
      &lt;rim:Slot name="URI"&gt;
        &lt;rim:ValueList&gt;
          &lt;rim:Value&gt;http://localhost:8080/XDS/Repository/08a15a6f-5b4a-42de-8f95-89474f83abdf.xml&lt;/rim:Value&gt;
        &lt;/rim:ValueList&gt;
      &lt;/rim:Slot&gt;
      &lt;rim:Slot name="authorInstitution"&gt;
        &lt;rim:ValueList&gt;
          &lt;rim:Value&gt;Some Hospital^^^^^^^^^1.2.3.4.5.6.7.8.9.1789.45&lt;/rim:Value&gt;
        &lt;/rim:ValueList&gt;
      &lt;/rim:Slot&gt;
      &lt;rim:Slot name="creationTime"&gt;
        &lt;rim:ValueList&gt;
          &lt;rim:Value&gt;200412261119&lt;/rim:Value&gt;
        &lt;/rim:ValueList&gt;
      &lt;/rim:Slot&gt;
      &lt;rim:Slot name="hash"&gt;
        &lt;rim:ValueList&gt;
          &lt;rim:Value&gt;4cf4f82d78b5e2aac35c31bca8cb79fe6bd6a41e&lt;/rim:Value&gt;
        &lt;/rim:ValueList&gt;
      &lt;/rim:Slot&gt;
      &lt;rim:Slot name="languageCode"&gt;
        &lt;rim:ValueList&gt;
          &lt;rim:Value&gt;en-us&lt;/rim:Value&gt;
        &lt;/rim:ValueList&gt;
      &lt;/rim:Slot&gt;
      &lt;rim:Slot name="serviceStartTime"&gt;
        &lt;rim:ValueList&gt;
          &lt;rim:Value&gt;200412230800&lt;/rim:Value&gt;
        &lt;/rim:ValueList&gt;
      &lt;/rim:Slot&gt;
      &lt;rim:Slot name="serviceStopTime"&gt;
        &lt;rim:ValueList&gt;
          &lt;rim:Value&gt;200412230801&lt;/rim:Value&gt;
        &lt;/rim:ValueList&gt;
      &lt;/rim:Slot&gt;
      &lt;rim:Slot name="size"&gt;
        &lt;rim:ValueList&gt;
          &lt;rim:Value&gt;54449&lt;/rim:Value&gt;
        &lt;/rim:ValueList&gt;
      &lt;/rim:Slot&gt;
      &lt;rim:Slot name="sourcePatientId"&gt;
        &lt;rim:ValueList&gt;
          &lt;rim:Value&gt;jd12323^^^wsh&lt;/rim:Value&gt;
        &lt;/rim:ValueList&gt;
      &lt;/rim:Slot&gt;
      &lt;rim:Slot name="sourcePatientInfo"&gt;
        &lt;rim:ValueList&gt;
          &lt;rim:Value&gt;PID-3|pid1^^^domain&lt;/rim:Value&gt;
          &lt;rim:Value&gt;PID-5|Doe^John^^^&lt;/rim:Value&gt;
          &lt;rim:Value&gt;PID-7|19560527&lt;/rim:Value&gt;
          &lt;rim:Value&gt;PID-8|M&lt;/rim:Value&gt;
          &lt;rim:Value&gt;PID-11|100 Main St^^Metropolis^Il^44130^USA&lt;/rim:Value&gt;
        &lt;/rim:ValueList&gt;
      &lt;/rim:Slot&gt;
      &lt;rim:Name&gt;
        &lt;rim:LocalizedString charset="UTF-8" value="Sample document 1" xml:lang="en-us"/&gt;
      &lt;/rim:Name&gt;
      &lt;rim:Description/&gt;
      &lt;rim:Classification classificationScheme="urn:uuid:41a5887f-8865-4c09-adf7-e362475b143a" classifiedObject="urn:uuid:08a15a6f-5b4a-42de-8f95-89474f83abdf" id="urn:uuid:ac872fc0-1c6e-439f-84d1-f76770a0ccdf" nodeRepresentation="Education" objectType="Urn:oasis:names:tc:ebxml-regrep:ObjectType:RegistryObject:Classification"&gt;
        &lt;rim:Slot name="codingScheme"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;Connect-a-thon classCodes&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Name&gt;
          &lt;rim:LocalizedString charset="UTF-8" value="Education" xml:lang="en-us"/&gt;
        &lt;/rim:Name&gt;
        &lt;rim:Description/&gt;
      &lt;/rim:Classification&gt;
      &lt;rim:Classification classificationScheme="urn:uuid:f4f85eac-e6cb-4883-b524-f2705394840f" classifiedObject="urn:uuid:08a15a6f-5b4a-42de-8f95-89474f83abdf" id="urn:uuid:f1a8c8e4-3593-4777-b7e0-8b0773378705" nodeRepresentation="C" objectType="Urn:oasis:names:tc:ebxml-regrep:ObjectType:RegistryObject:Classification"&gt;
        &lt;rim:Slot name="codingScheme"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;Connect-a-thon confidentialityCodes&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Name&gt;
          &lt;rim:LocalizedString charset="UTF-8" value="Celebrity" xml:lang="en-us"/&gt;
        &lt;/rim:Name&gt;
        &lt;rim:Description/&gt;
      &lt;/rim:Classification&gt;
      &lt;rim:Classification classificationScheme="urn:uuid:a09d5840-386c-46f2-b5ad-9c3699a4309d" classifiedObject="urn:uuid:08a15a6f-5b4a-42de-8f95-89474f83abdf" id="urn:uuid:b6e49c73-96c8-4058-8c95-914d83bd262a" nodeRepresentation="CDAR2/IHE 1.0" objectType="Urn:oasis:names:tc:ebxml-regrep:ObjectType:RegistryObject:Classification"&gt;
        &lt;rim:Slot name="codingScheme"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;Connect-a-thon formatCodes&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Name&gt;
          &lt;rim:LocalizedString charset="UTF-8" value="CDAR2/IHE 1.0" xml:lang="en-us"/&gt;
        &lt;/rim:Name&gt;
        &lt;rim:Description/&gt;
      &lt;/rim:Classification&gt;
      &lt;rim:Classification classificationScheme="urn:uuid:f33fb8ac-18af-42cc-ae0e-ed0b0bdb91e1" classifiedObject="urn:uuid:08a15a6f-5b4a-42de-8f95-89474f83abdf" id="urn:uuid:61e2b376-d74a-4984-ac21-dcd0b8890f9d" nodeRepresentation="Emergency Department" objectType="Urn:oasis:names:tc:ebxml-regrep:ObjectType:RegistryObject:Classification"&gt;
        &lt;rim:Slot name="codingScheme"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;Connect-a-thon healthcareFacilityTypeCodes&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Name&gt;
          &lt;rim:LocalizedString charset="UTF-8" value="Assisted Living" xml:lang="en-us"/&gt;
        &lt;/rim:Name&gt;
        &lt;rim:Description/&gt;
      &lt;/rim:Classification&gt;
      &lt;rim:Classification classificationScheme="urn:uuid:cccf5598-8b07-4b77-a05e-ae952c785ead" classifiedObject="urn:uuid:08a15a6f-5b4a-42de-8f95-89474f83abdf" id="urn:uuid:fb7677c5-c42f-485d-9010-dce0f3cd4ad5" nodeRepresentation="Cardiology" objectType="Urn:oasis:names:tc:ebxml-regrep:ObjectType:RegistryObject:Classification"&gt;
        &lt;rim:Slot name="codingScheme"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;Connect-a-thon practiceSettingCodes&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Name&gt;
          &lt;rim:LocalizedString charset="UTF-8" value="Cardiology" xml:lang="en-us"/&gt;
        &lt;/rim:Name&gt;
        &lt;rim:Description/&gt;
      &lt;/rim:Classification&gt;
      &lt;rim:Classification classificationScheme="urn:uuid:f0306f51-975f-434e-a61c-c59651d33983" classifiedObject="urn:uuid:08a15a6f-5b4a-42de-8f95-89474f83abdf" id="urn:uuid:0a8a8ed9-8be5-4a63-9b68-a511adee8ed5" nodeRepresentation="34098-4" objectType="Urn:oasis:names:tc:ebxml-regrep:ObjectType:RegistryObject:Classification"&gt;
        &lt;rim:Slot name="codingScheme"&gt;
          &lt;rim:ValueList&gt;
            &lt;rim:Value&gt;LOINC&lt;/rim:Value&gt;
          &lt;/rim:ValueList&gt;
        &lt;/rim:Slot&gt;
        &lt;rim:Name&gt;
          &lt;rim:LocalizedString charset="UTF-8" value="Conference Evaluation Note" xml:lang="en-us"/&gt;
        &lt;/rim:Name&gt;
        &lt;rim:Description/&gt;
      &lt;/rim:Classification&gt;
      &lt;rim:ExternalIdentifier id="urn:uuid:db9f4438-ffff-435f-9d34-d76190728637" identificationScheme="urn:uuid:58a6f841-87b3-4a3e-92fd-a8ffeff98427" objectType="ExternalIdentifier" registryObject="urn:uuid:08a15a6f-5b4a-42de-8f95-89474f83abdf" value="st3498702^^^&amp;amp;1.3.6.1.4.1.21367.2005.3.7&amp;amp;ISO"&gt;
        &lt;rim:Name&gt;
          &lt;rim:LocalizedString charset="UTF-8" value="XDSDocumentEntry.patientId" xml:lang="en-us"/&gt;
        &lt;/rim:Name&gt;
        &lt;rim:Description/&gt;
      &lt;/rim:ExternalIdentifier&gt;
      &lt;rim:ExternalIdentifier id="urn:uuid:c3fcbf0e-9765-4f5b-abaa-b37ac8ff05a5" identificationScheme="urn:uuid:2e82c1f6-a085-4c72-9da3-8640a32e42ab" objectType="ExternalIdentifier" registryObject="urn:uuid:08a15a6f-5b4a-42de-8f95-89474f83abdf" value="1.3.6.1.4.1.21367.2005.3.99.1.1010"&gt;
        &lt;rim:Name&gt;
          &lt;rim:LocalizedString charset="UTF-8" value="XDSDocumentEntry.uniqueId" xml:lang="en-us"/&gt;
        &lt;/rim:Name&gt;
        &lt;rim:Description/&gt;
      &lt;/rim:ExternalIdentifier&gt;
    &lt;/rim:ExtrinsicObject&gt;
    &lt;rim:ObjectRef id="urn:uuid:41a5887f-8865-4c09-adf7-e362475b143a" xmlns:q="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"/&gt;
    &lt;rim:ObjectRef id="urn:uuid:f4f85eac-e6cb-4883-b524-f2705394840f" xmlns:q="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"/&gt;
    &lt;rim:ObjectRef id="urn:uuid:a09d5840-386c-46f2-b5ad-9c3699a4309d" xmlns:q="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"/&gt;
    &lt;rim:ObjectRef id="urn:uuid:f33fb8ac-18af-42cc-ae0e-ed0b0bdb91e1" xmlns:q="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"/&gt;
    &lt;rim:ObjectRef id="urn:uuid:cccf5598-8b07-4b77-a05e-ae952c785ead" xmlns:q="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"/&gt;
    &lt;rim:ObjectRef id="urn:uuid:f0306f51-975f-434e-a61c-c59651d33983" xmlns:q="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"/&gt;
    &lt;rim:ObjectRef id="urn:uuid:58a6f841-87b3-4a3e-92fd-a8ffeff98427" xmlns:q="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"/&gt;
    &lt;rim:ObjectRef id="urn:uuid:2e82c1f6-a085-4c72-9da3-8640a32e42ab" xmlns:q="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:rim="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0"/&gt;
  &lt;/rim:RegistryObjectList&gt;
&lt;/AdhocQueryResponse&gt;</code></pre>
                <p>The following query response is the same as above (repeated sections replaced with …) with the <code>homeCommunityId</code>
                    attribute specified. Subsequent requests specifying entryUUID of <code class="uuid">urn:uuid:08a15a6f-5b4a-42de-8f95-89474f83abdf</code>
                    or uniqueID of <code class="oid">1.3.6.1.4.1.21367.2005.3.99.1.1010</code> shall include the
                    homeCommunityId
                    value of <code class="oid">urn:oid:1.2.3</code> in the query.</p>
                <pre><code class="code-block xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;AdhocQueryResponse … status="Success"&gt;
  &lt;rim:RegistryObjectList&gt;
    &lt;rim:ExtrinsicObject … id="urn:uuid:08a15a6f-5b4a-42de-8f95-89474f83abdf" isOpaque="false" mimeType="text/xml" objectType="urn:uuid:7edca82f-054d-47f2-a032-9b2a5b5186c1" status="urn:oasis:names:tc:ebxml-regrep:StatusType:Approved" home="urn:oid:1.2.3"&gt;
      …
      &lt;rim:ExternalIdentifier id="urn:uuid:c3fcbf0e-9765-4f5b-abaa-b37ac8ff05a5" registryObject="urn:uuid:08a15a6f-5b4a-42de-8f95-89474f83abdf" identificationScheme="urn:uuid:2e82c1f6-a085-4c72-9da3-8640a32e42ab" objectType="ExternalIdentifier" value="1.3.6.1.4.1.21367.2005.3.99.1.1010"&gt;
        &lt;rim:Name&gt;
          &lt;rim:LocalizedString charset="UTF-8" value="XDSDocumentEntry.uniqueId" xml:lang="en-us"/&gt;
        &lt;/rim:Name&gt;
        &lt;rim:Description/&gt;
      &lt;/rim:ExternalIdentifier&gt;
    &lt;/rim:ExtrinsicObject&gt;
  &lt;/rim:RegistryObjectList&gt;
&lt;/AdhocQueryResponse&gt;</code></pre>
                <h6 id="3.18.4.1.3.4">3.18.4.1.3.4 Intentionally Left Blank</h6>
                <h6 id="3.18.4.1.3.5">3.18.4.1.3.5 Basic Patient Privacy Enforcement Option</h6>
                <p>If the Basic Patient Privacy Enforcement Option is implemented:</p>
                <ol>
                    <li class="numbered-list1">All Document Consumer Actors may provide a list of confidentialityCode in
                        XDS Registry Stored Query Transaction and the XDS Registry will return only document that have
                        at least one matching confidentialityCode. In this way documents without at least one of the
                        requested codes will not be returned.
                    </li>
                    <li class="numbered-list1">The Document Consumer shall be able to be configured with the Patient
                        Privacy Policies, Patient Privacy Policy Identifiers (OIDs) and associated information necessary
                        to understand and enforce the XDS Affinity Domain Policy. The details of this are product
                        specific and not specified by IHE.
                    </li>
                    <li class="numbered-list1">The Document Consumer shall not allow access to documents for which the
                        Document Consumer does not understand at least one of the confidentialityCode returned. This
                        assures that a Document Consumer will not improperly handle documents with confidentialityCode
                        that may be more restrictive than the Document Consumer is configured to support.
                    </li>
                    <li class="numbered-list1">The Document Consumer shall abide by the XDS Affinity Domain Policies
                        represented by the confidentialityCode in the metadata associated with the document. The
                        Document Consumer likely will have user access controls or business rule capabilities to
                        determine the details of how confidentiality codes apply to query results. The details of this
                        are product specific and not specified by IHE. These rules shall reduce the query results to
                        only those that are appropriate to the current situation for that actor and user.
                    </li>
                    <li class="numbered-list1">Note: The Registry is already required to return only documents that
                        match the requested confidentialityCode (filter) indicated in the Registry Stored Query.
                    </li>
                    <li class="numbered-list1">Note: Products implementing the Document Registry may be able to further
                        filter Registry Stored Query results through looking at all the Patient Privacy Acknowledgement
                        Documents registered for the patient that have the availabilityStatus of Approved and for which
                        have not expired.
                    </li>
                </ol>
                <h6 id="3.18.4.1.3.6">3.18.4.1.3.6 Basic Patient Privacy Proof Option</h6>
                <p>If the Basic Patient Privacy Consents Proof Option is implemented:</p>
                <p>The Document Consumer shall be capable of querying for 'Approved' Patient Privacy Acknowledgement
                    Documents in the XDS Affinity Domain. This query should be done by document class so as to catch
                    both formats of document (Consent). The Document Consumer shall be capable of recognizing the
                    eventCodeList from the resulting XDS Metadata. There is no required handling of Patient Privacy
                    Consent Acknowledgement Document XDS Metadata. There is no requirement for the Document Consumer to
                    retrieve the Patient Privacy Acknowledgement Document content.</p>
                <h3 id="3.18.5">3.18.5 Security Considerations</h3>
                <p>
                    Relevant XDS Affinity Domain Security background is discussed in the XDS Security Considerations
                    Section (see
                    <a href="../Volume1/ch-10.html#10.7">ITI TF-1: 10.7</a>).
                </p>
                <h4 id="3.18.5.1">3.18.5.1 Audit Record Considerations</h4>
                <p>The Registry Stored Query [ITI-18] transaction is a Query Information event as defined in <a
                        href="../Volume2/ITI-20.html#t3.20.4.1.1.1-1">Table
                    3.20.4.1.1.1-1</a>. If a status of PartialSuccess is returned, the Actors involved shall record both
                    a
                    success and a failure audit event. The Actors involved shall record audit events according to the
                    following:</p>
                <h5 id="3.18.5.1.1">3.18.5.1.1 Document Consumer audit message:</h5>

                <table cellspacing="0" cellpadding="0">
                    <tr>
                      <td>
                        <div />
                      </td>
                      <td class="tableHeader">Field Name</td>
                      <td class="tableHeader">Opt</td>
                      <td class="tableHeader">Value Constraints</td>
                    </tr>
                    <tr>
                      <td rowspan="5">
                        <p>Event</p>
                        <p>
                          <span style="font-weight:bold">AuditMessage/</span>
                          <br />
                          <span style="font-weight:bold">EventIdentification</span>
                        </p>
                      </td>
                      <td>EventID</td>
                      <td>M</td>
                      <td>EV(110112, DCM, “Query”)</td>
                    </tr>
                    <tr>
                      <td>EventActionCode</td>
                      <td>M</td>
                      <td>“E” (Execute)</td>
                    </tr>
                    <tr>
                      <td>EventDateTime</td>
                      <td>M</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>EventOutcomeIndicator</td>
                      <td>M</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>EventTypeCode</td>
                      <td>M</td>
                      <td>EV(“ITI-18”, “IHE Transactions”, “Registry Stored Query”)</td>
                    </tr>
                    <tr>
                      <td colspan="4">Source (Document Consumer) (1)</td>
                    </tr>
                    <tr>
                      <td colspan="4">Human Requestor (0..n)</td>
                    </tr>
                    <tr>
                      <td colspan="4">Destination (Document Registry) (1)</td>
                    </tr>
                    <tr>
                      <td colspan="4">Audit Source (Document Consumer) (1)</td>
                    </tr>
                    <tr>
                      <td colspan="4">Patient (0..1)</td>
                    </tr>
                    <tr>
                      <td colspan="4">Query Parameters (1)</td>
                    </tr>
                  </table>
                  <p>Where:</p>
                  <table cellspacing="0" cellpadding="0">
                    <tr>
                      <td rowspan="7">
                        <p>Source</p>
                        <p>
                          <span style="font-weight:bold">AuditMessage/</span>
                          <br />
                          <span style="font-weight:bold">ActiveParticipant</span>
                        </p>
                      </td>
                      <td>UserID</td>
                      <td>M</td>
                      <td>If Asynchronous Web Services Exchange is being used, the content of the &lt;wsa:ReplyTo/&gt; element. Otherwise, not specialized.</td>
                    </tr>
                    <tr>
                      <td>AlternativeUserID</td>
                      <td>M</td>
                      <td>The process ID as used within the local operating system in the local system logs.</td>
                    </tr>
                    <tr>
                      <td>UserName</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>UserIsRequestor</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>RoleIDCode</td>
                      <td>M</td>
                      <td>EV(110153, DCM, “Source”)</td>
                    </tr>
                    <tr>
                      <td>NetworkAccessPointTypeCode</td>
                      <td>M</td>
                      <td>“1” for machine (DNS) name, “2” for IP address</td>
                    </tr>
                    <tr>
                      <td>NetworkAccessPointID</td>
                      <td>M</td>
                      <td>The machine name or IP address.</td>
                    </tr>
                  </table>
                  <table cellspacing="0" cellpadding="0">
                    <tr>
                      <td rowspan="7">
                        <p>Human Requestor (if known)</p>
                        <p>
                          <span style="font-weight:bold">AuditMessage/</span>
                          <br />
                          <span style="font-weight:bold">ActiveParticipant</span>
                        </p>
                      </td>
                      <td>UserID</td>
                      <td>M</td>
                      <td>Identity of the human that initiated the transaction.</td>
                    </tr>
                    <tr>
                      <td>AlternativeUserID</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>UserName</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>UserIsRequestor</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>RoleIDCode</td>
                      <td>U</td>
                      <td>Access Control role(s) the user holds that allows this transaction.</td>
                    </tr>
                    <tr>
                      <td>NetworkAccessPointTypeCode</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>NetworkAccessPointID</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                  </table>
                  <table cellspacing="0" cellpadding="0">
                    <tr>
                      <td rowspan="7">
                        <p>Destination</p>
                        <p>
                          <span style="font-weight:bold">AuditMessage/</span>
                          <br />
                          <span style="font-weight:bold">ActiveParticipant</span>
                        </p>
                      </td>
                      <td>UserID</td>
                      <td>M</td>
                      <td>SOAP endpoint URI.</td>
                    </tr>
                    <tr>
                      <td>AlternativeUserID</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>UserName</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>UserIsRequestor</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>RoleIDCode</td>
                      <td>M</td>
                      <td>EV(110152, DCM, “Destination”)</td>
                    </tr>
                    <tr>
                      <td>NetworkAccessPointTypeCode</td>
                      <td>M</td>
                      <td>“1” for machine (DNS) name, “2” for IP address</td>
                    </tr>
                    <tr>
                      <td>NetworkAccessPointID</td>
                      <td>M</td>
                      <td>The machine name or IP address.</td>
                    </tr>
                  </table>
                  <table cellspacing="0" cellpadding="0">
                    <tr>
                      <td rowspan="3">
                        <p>Audit Source</p>
                        <p>
                          <span style="font-weight:bold">AuditMessage/</span>
                          <br />
                          <span style="font-weight:bold">AuditSourceIdentification</span>
                        </p>
                      </td>
                      <td>AuditSourceID</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>AuditEnterpriseSiteID</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>AuditSourceTypeCode</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                  </table>
                  <table cellspacing="0" cellpadding="0">
                    <tr>
                      <td rowspan="9">
                        <p>Patient</p>
                        <p>
                          <span style="font-weight:bold">(AuditMessage/</span>
                          <br />
                          <span style="font-weight:bold">ParticipantObjectIdentification)</span>
                        </p>
                      </td>
                      <td>ParticipantObjectTypeCode</td>
                      <td>M</td>
                      <td>“1” (Person)</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectTypeCodeRole</td>
                      <td>M</td>
                      <td>“1” (Patient)</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectDataLifeCycle</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectIDTypeCode</td>
                      <td>M</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectSensitivity</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectID</td>
                      <td>M</td>
                      <td>The patient ID in HL7 CX format.</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectName</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectQuery</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectDetail</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                  </table>
                  <table cellspacing="0" cellpadding="0">
                    <tr>
                      <td rowspan="9">
                        <p>Query Parameters</p>
                        <p>
                          <span style="font-weight:bold">(AuditMessage/</span>
                          <br />
                          <span style="font-weight:bold">ParticipantObjectIdentification)</span>
                        </p>
                      </td>
                      <td>ParticipantObjectTypeCode</td>
                      <td>M</td>
                      <td>“2” (system object)</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectTypeCodeRole</td>
                      <td>M</td>
                      <td>“24” (query)</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectDataLifeCycle</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectIDTypeCode</td>
                      <td>M</td>
                      <td>EV(“ITI-18”, “IHE Transactions”, “Registry Stored Query”)</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectSensitivity</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectID</td>
                      <td>M</td>
                      <td>Stored Query ID (UUID)</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectName</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectQuery</td>
                      <td>M</td>
                      <td>the AdhocQueryRequest, base64 encoded.</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectDetail</td>
                      <td>C</td>
                      <td>
                        <p>The ParticipantObjectDetail element may occur more than once.</p>
                        <p>
                          <span>In one element, set “QueryEncoding”as the value of the attribute</span>
                          <span style="font-style:italic">type</span>
                          <span>, Set the attribute</span>
                          <span style="font-style:italic">value</span>
                          <span>to the character encoding, such as “UTF-8”, used to encode the ParticipantObjectQuery before base64 encoding.</span>
                        </p>
                        <p>In another element, set “urn:ihe:iti:xca:2010:homeCommunityId” as the value of the attribute type and the value of the homeCommunityID as the value of the attribute value, if known.</p>
                      </td>
                    </tr>
                  </table>
                  <h5 id="3.18.5.1.2">3.18.5.1.2 Document Registry audit message:</h5>
                  <table cellspacing="0" cellpadding="0">
                    <tr>
                      <td>
                        <div />
                      </td>
                      <td class="tableHeader">Field Name</td>
                      <td class="tableHeader">Opt</td>
                      <td class="tableHeader">Value Constraints</td>
                    </tr>
                    <tr>
                      <td rowspan="5">
                        <p>Event</p>
                        <p>
                          <span style="font-weight:bold">AuditMessage/</span>
                          <br />
                          <span style="font-weight:bold">EventIdentification</span>
                        </p>
                      </td>
                      <td>EventID</td>
                      <td>M</td>
                      <td>EV(110112, DCM, “Query”)</td>
                    </tr>
                    <tr>
                      <td>EventActionCode</td>
                      <td>M</td>
                      <td>“E” (Execute)</td>
                    </tr>
                    <tr>
                      <td>EventDateTime</td>
                      <td>M</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>EventOutcomeIndicator</td>
                      <td>M</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>EventTypeCode</td>
                      <td>M</td>
                      <td>EV(“ITI-18”, “IHE Transactions”, “Registry Stored Query”)</td>
                    </tr>
                    <tr>
                      <td colspan="4">Source (Document Consumer) (1)</td>
                    </tr>
                    <tr>
                      <td colspan="4">Destination (Document Registry) (1)</td>
                    </tr>
                    <tr>
                      <td colspan="4">Audit Source (Document Registry) (1)</td>
                    </tr>
                    <tr>
                      <td colspan="4">Patient (0..1)</td>
                    </tr>
                    <tr>
                      <td colspan="4">Query Parameters (1)</td>
                    </tr>
                  </table>
                  <p>Where:</p>
                  <table cellspacing="0" cellpadding="0">
                    <tr>
                      <td rowspan="7">
                        <p>Source</p>
                        <p>
                          <span style="font-weight:bold">AuditMessage/</span>
                          <br />
                          <span style="font-weight:bold">ActiveParticipant</span>
                        </p>
                      </td>
                      <td>UserID</td>
                      <td>M</td>
                      <td>If Asynchronous Web Services Exchange is being used, the content of the &lt;wsa:ReplyTo/&gt; element. Otherwise, not specialized.</td>
                    </tr>
                    <tr>
                      <td>AlternativeUserID</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>UserName</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>UserIsRequestor</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>RoleIDCode</td>
                      <td>M</td>
                      <td>EV(110153, DCM, “Source”)</td>
                    </tr>
                    <tr>
                      <td>NetworkAccessPointTypeCode</td>
                      <td>M</td>
                      <td>“1” for machine (DNS) name, “2” for IP address</td>
                    </tr>
                    <tr>
                      <td>NetworkAccessPointID</td>
                      <td>M</td>
                      <td>The machine name or IP address.</td>
                    </tr>
                  </table>
                  <table cellspacing="0" cellpadding="0">
                    <tr>
                      <td rowspan="7">
                        <p>Destination</p>
                        <p>
                          <span style="font-weight:bold">AuditMessage/</span>
                          <br />
                          <span style="font-weight:bold">ActiveParticipant</span>
                        </p>
                      </td>
                      <td>UserID</td>
                      <td>M</td>
                      <td>SOAP endpoint URI.</td>
                    </tr>
                    <tr>
                      <td>AlternativeUserID</td>
                      <td>M</td>
                      <td>The process ID as used within the local operating system in the local system logs.</td>
                    </tr>
                    <tr>
                      <td>UserName</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>UserIsRequestor</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>RoleIDCode</td>
                      <td>M</td>
                      <td>EV(110152, DCM, “Destination”)</td>
                    </tr>
                    <tr>
                      <td>NetworkAccessPointTypeCode</td>
                      <td>M</td>
                      <td>“1” for machine (DNS) name, “2” for IP address</td>
                    </tr>
                    <tr>
                      <td>NetworkAccessPointID</td>
                      <td>M</td>
                      <td>The machine name or IP address.</td>
                    </tr>
                  </table>
                  <table cellspacing="0" cellpadding="0">
                    <tr>
                      <td rowspan="3">
                        <p>Audit Source</p>
                        <p>
                          <span style="font-weight:bold">AuditMessage/</span>
                          <br />
                          <span style="font-weight:bold">AuditSourceIdentification</span>
                        </p>
                      </td>
                      <td>AuditSourceID</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>AuditEnterpriseSiteID</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>AuditSourceTypeCode</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                  </table>
                  <table cellspacing="0" cellpadding="0">
                    <tr>
                      <td rowspan="9">
                        <p>Patient</p>
                        <p>
                          <span style="font-weight:bold">(AuditMessage/</span>
                          <br />
                          <span style="font-weight:bold">ParticipantObjectIdentification)</span>
                        </p>
                      </td>
                      <td>ParticipantObjectTypeCode</td>
                      <td>M</td>
                      <td>“1” (Person)</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectTypeCodeRole</td>
                      <td>M</td>
                      <td>“1” (Patient)</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectDataLifeCycle</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectIDTypeCode</td>
                      <td>M</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectSensitivity</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectID</td>
                      <td>M</td>
                      <td>The patient ID in HL7 CX format.</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectName</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectQuery</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectDetail</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                  </table>
                  <table cellspacing="0" cellpadding="0">
                    <tr>
                      <td rowspan="9">
                        <p>Query Parameters</p>
                        <p>
                          <span style="font-weight:bold">(AuditMessage/</span>
                          <br />
                          <span style="font-weight:bold">ParticipantObjectIdentification)</span>
                        </p>
                      </td>
                      <td>ParticipantObjectTypeCode</td>
                      <td>M</td>
                      <td>“2” (system object)</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectTypeCodeRole</td>
                      <td>M</td>
                      <td>“24” (query)</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectDataLifeCycle</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectIDTypeCode</td>
                      <td>M</td>
                      <td>EV(“ITI-18”, “IHE Transactions”, “Registry Stored Query”)</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectSensitivity</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectID</td>
                      <td>M</td>
                      <td>Stored Query ID (UUID)</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectName</td>
                      <td>U</td>
                      <td>not specialized</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectQuery</td>
                      <td>M</td>
                      <td>the AdhocQueryRequest, base64 encoded.</td>
                    </tr>
                    <tr>
                      <td>ParticipantObjectDetail</td>
                      <td>C</td>
                      <td>
                        <p>The ParticipantObjectDetail element may occur more than once.</p>
                        <p>
                          <span>In one element, set “QueryEncoding”as the value of the attribute</span>
                          <span style="font-style:italic">type</span>
                          <span>, Set the attribute</span>
                          <span style="font-style:italic">value</span>
                          <span>to the character encoding, such as “UTF-8”, used to encode the ParticipantObjectQuery before base64 encoding.</span>
                        </p>
                        <p>In another element, set “urn:ihe:iti:xca:2010:homeCommunityId” as the value of the attribute type and the value of the homeCommunityID as the value of the attribute value, if known.</p>
                      </td>
                    </tr>
                  </table>
            

            </div>
        </div>
    </main>
</div>
<footer class="ihe-footer">
    <div class="grid-container fluid">
        <div class="grid-x grid-margin-x align-middle">
            <div class="cell medium-9 small-order-2 medium-order-1 text-center medium-text-left">
                © 2000 &mdash; <span id="current-year"></span> IHE International | TEL 1-630-481-1004 | 820&nbsp;Jorie&nbsp;Boulevard,
                Oak&nbsp;Brook, IL&nbsp;60523
            </div>
            <div class="cell medium-3 small-order-1 medium-order-2 text-center medium-text-right ihe-footer-icons">
                <a href="mailto:secretary@ihe.net"><i class="fi fi-mail"></i></a>
                <a href="https://www.linkedin.com/company/iheintl"><i class="fi fi-social-linkedin"></i></a>
                <a href="https://twitter.com/IHEIntl"><i class="fi fi-social-twitter" aria-hidden="true"></i></a>
                <a href="https://www.youtube.com/user/IHEIntl"><i class="fi fi-social-youtube"
                                                                  aria-hidden="true"></i></a>
            </div>
        </div>
    </div>
</footer>
<script src="../../../js/vendor/jquery.min.js"></script>
<script src="../../../js/vendor/motion-ui.min.js"></script>
<script src="../../../js/vendor/what-input.js"></script>
<script src="../../../js/vendor/foundation.min.js"></script>
<script src="../../../js/app.js"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HLBNC861DJ');
</script>
</body>
</html>
