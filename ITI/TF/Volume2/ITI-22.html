<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta xmlns="" charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title xmlns="">IHE ITI TF Vol2</title>
    <link xmlns="" rel="stylesheet" href="../../../css/styles.css" />
    <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-HLBNC861DJ" async> </script> 
</head>
  <body xmlns="">
    <header>
        <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
          <button class="menu-icon" type="button" data-toggle="responsive-menu"></button>
          <div class="title-bar-title">IHE ITI Technical Framework</div>
        </div>
        <div class="top-bar" id="responsive-menu">
          <div class="top-bar-left">
            <img src="../../../IHE_INTERNATIONAL.png" class="IHE logo hide-for-small-only" alt="IHE logo" />
            <ul id="tf-small-menu" class="menu vertical show-for-small-only">
              <li><a class="ihe-purple" href="https://ihe.net" target="_blank">About IHE</a></li>
              <li class="menu-text">Sections
                <ul id="tf-small-menu-list" class="nested vertical menu">
                </ul>
              </li>
            </ul>
          </div>
          <div class="top-bar-right hide-for-small-only">
            <ul class="menu">
              <li class="menu-text tf-version">IHE IT Infrastructure (ITI) Technical Framework, Volume <span id="volumeNo"></span><br />Revision 19.0, June 17, 2022 – Final Text</li>
            </ul>
              <ul class="menu align-right">
                    <li><input id="ihe-search-field" type="search" placeholder="Search"></li>
                    <li><button id="ihe-search-button" type="button" class="button search">Search</button></li>
                </ul>
            </div>
        </div>
         </header>
    <div class="navigation">
      <nav aria-label="You are here:" role="navigation">
        <ul class="breadcrumbs">
        </ul>
      </nav>
    </div>
    <div class="scroll-top-wrapper">
      <span class="scroll-top-inner">
        <i class="size-icon-lg fi-arrow-up"></i>
      </span>
    </div>
    <div class="grid-container fluid">
      <div class="grid-x grid-margin-x align-center">
        <div class="cell medium-11">
          <div class="callout disclaimer warning text-center">              
          The Final Text ITI Technical Framework is published here in HTML format and is no longer published as PDF. Trial Implementation supplements are available from the <a href=https://profiles.ihe.net/ITI/TF/Volume1/index.html>Volume 1 Table of Contents</a>.
          </div>
        </div>
      </div>
      <main>
        <div class="grid-x grid-margin-x align-center">
          <div class="hide-for-small-only cell medium-2 large-2" data-sticky-container>
            <div id="section-menu" class="sticky" data-sticky data-anchor="main-top">
            </div>
          </div>
          <div id="main-top" class="cell medium-10 large-10">
      <h2 id="3.22">3.22 Patient Demographics and Visit Query [ITI-22]</h2>
      <p>This section corresponds to transaction [ITI-22] of the IHE IT Infrastructure Technical Framework. Transaction [ITI-22] is used by the Patient Demographics Consumer and Patient Demographics Supplier Actors.</p>
      <h3 id="3.22.1">3.22.1 Scope</h3>
      <p>This transaction involves a request by the Patient Demographics Consumer for information about patients whose demographic and visit data match data provided in the query message. The request is received by the Patient Demographics Supplier Actor. The Patient Demographics Supplier immediately processes the request and returns a response in the form of demographic and visit information for matching patients.</p>
      <h3 id="3.22.2">3.22.2 Use Case Roles</h3>
      <p>
        <span style="font-weight:bold">Actor:</span>
        <span>Patient Demographics Consumer</span>
      </p>
      <p>
        <span style="font-weight:bold">Role:</span>
        <span>Requests a list of patients matching a minimal set of demographic (e.g., ID or partial name) and visit criteria from the Patient Demographics Supplier. Populates its attributes with demographic and visit information received from the Patient Demographics Supplier.</span>
      </p>
      <p>
        <span style="font-weight:bold">Actor:</span>
        <span>Patient Demographics Supplier</span>
      </p>
      <p>
        <span style="font-weight:bold">Role:</span>
        <span>Returns demographic and visit information for all patients matching the demographic and visit criteria provided by the Patient Demographics Consumer.</span>
      </p>
      <h3 id="3.22.3">3.22.3  Referenced Standards</h3>
      <p>
        <span style="font-weight:bold">HL7</span>
        <span>:</span>
        <span style="width:9.33pt;display:inline-block"> </span>
      </p>
      <p>Version 2.5, Chapter 2 – Control</p>
      <p>Version 2.5, Chapter 3 – Patient Administration</p>
      <p>Version 2.5, Chapter 5 – Query</p>
      <h3 id="3.22.4">3.22.4  Messages</h3>
      <div id="f3.22.4-1">
        <img src="media/Figure_3.22.4-1.png" alt="" />
        <p class="figureTitle">Figure 3.22.4-1: Interaction Diagram</p>
      </div>
      <h4 id="3.22.4.1">3.22.4.1 Patient Demographics and Visit Query</h4>
      <h5 id="3.22.4.1.1">3.22.4.1.1 Trigger Events</h5>
      <p>A Patient Demographics Consumer’s need to select a patient based on demographic and visit information about patients whose information matches a minimal set of known data will trigger the Patient Demographics and Visit Query based on the following HL7 trigger event:</p>
      <p>ZV1 – Find Candidates from Visit Information</p>
      <h5 id="3.22.4.1.2">3.22.4.1.2 Message Semantics</h5>
      <p>The Patient Demographics and Visit Query transaction is conducted by the HL7 QBP^ZV1 message. The Patient Demographics Consumer shall generate the query message whenever it needs to select from a list of patients whose information matches a minimal set of demographic and visit data. The segments of the message listed below are required, and their detailed descriptions are provided in the following subsections.</p>
      <p id="t3.22-1" class="tableTitle">Table 3.22-1: QBP Query by Parameter</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td class="tableHeader">QBP</td>
          <td class="tableHeader">Query by Parameter</td>
          <td class="tableHeader">Chapter in HL7 v2.5</td>
        </tr>
        <tr>
          <td>MSH</td>
          <td>Message Header</td>
          <td>2</td>
        </tr>
        <tr>
          <td>QPD</td>
          <td>Query Parameter Definition</td>
          <td>5</td>
        </tr>
        <tr>
          <td>RCP</td>
          <td>Response Control Parameter</td>
          <td>5</td>
        </tr>
        <tr>
          <td>[DSC]</td>
          <td>Continuation Pointer</td>
          <td>2</td>
        </tr>
      </table>
      <p>The receiver shall respond to the query by sending the RSP^ZV2 message. This satisfies the requirements of original mode acknowledgment; no intermediate ACK message is to be sent.</p>
      <p>
        <span>Each Patient Demographics and Visit Query request specifies two distinct concepts. The Patient Demographics and Visit Query is always targeted at a single source of patient demographic information (referred to in this transaction as the</span>
        <span style="font-weight:bold;font-style:italic">patient information source</span>
        <span>). A Patient Demographics Supplier may have knowledge of more than one source of demographics. A Patient Demographics Supplier shall support at least one source of patient demographics and may support multiple sources of demographics. Section 3.21.4.1.2.1 describes how the Patient Demographics Consumer specifies which source of demographics are requested by the query. Each query response shall return demographics from a single patient information source.</span>
      </p>
      <p>The second concept present in the query is the set of patient identifier domains referenced by the query. These patient identifier domains may or may not be associated with the patient information source. A Patient Demographics Supplier shall support at least one patient identifier domain and may support multiple identifier domains. Section 3.21.4.1.2.2 describes how the Patient Demographics Consumer requests identifiers from one or more patient identifier domains. Query responses may return patient identifiers from 0, 1 or multiple patient identifier domains.</p>
      <h6 id="3.22.4.1.2.1">3.22.4.1.2.1 MSH Segment</h6>
      <p>The MSH segment shall be constructed as defined in the “Message Control” section (ITI TF-2: C.2.2).</p>
      <p>
        <span>The Patient Demographics Supplier is able to obtain demographics from at least one and possibly multiple patient information sources. When more than one patient information source is available, Field</span>
        <span style="font-style:italic">MSH-5-Receiving Application</span>
        <span>specifies the patient information source that this query is targeting. The Patient Demographics Supplier shall return this value in</span>
        <span style="font-style:italic">MSH-3-Sending Application</span>
        <span>of the RSP^ZV2 response. The value specified in MSH-5 is not related to the value requested in QPD-8 What Domains Returned.</span>
      </p>
      <p>A list shall be published of all Receiving Applications that the Patient Demographics Supplier supports, for the Patient Demographics Consumer to choose from. Each query is processed against one and only one source of patient demographic information.</p>
      <p>
        <span>Field</span>
        <span style="font-style:italic">MSH-9-Message Type</span>
        <span>shall have all three components populated with a value. The first component shall have a value of</span>
        <span style="font-weight:bold">QBP</span>
        <span>; the second component shall have a value of</span>
        <span style="font-weight:bold">ZV1</span>
        <span>. The third component shall have a value of</span>
        <span style="font-weight:bold">QBP_Q21</span>
        <span>.</span>
      </p>
      <h6 id="3.22.4.1.2.2">3.22.4.1.2.2 QPD Segment</h6>
      <p>The Patient Demographics Consumer shall send attributes within the QPD segment as described in Table 3.22-2.</p>
      <p id="t3.22-2" class="tableTitle">Table 3.22-2: IHE Profile - QPD segment</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td class="tableHeader">SEQ</td>
          <td class="tableHeader">LEN</td>
          <td class="tableHeader">DT</td>
          <td class="tableHeader">OPT</td>
          <td class="tableHeader">TBL#</td>
          <td class="tableHeader">ITEM#</td>
          <td class="tableHeader">ELEMENT NAME</td>
        </tr>
        <tr>
          <td>1</td>
          <td>250</td>
          <td>CE</td>
          <td>R</td>
          <td>0471</td>
          <td>01375</td>
          <td>Message Query Name</td>
        </tr>
        <tr>
          <td>2</td>
          <td>32</td>
          <td>ST</td>
          <td>R+</td>
          <td />
          <td>00696</td>
          <td>Query Tag</td>
        </tr>
        <tr>
          <td>3</td>
          <td />
          <td>QIP</td>
          <td>R</td>
          <td />
          <td />
          <td>Demographics and Visit Fields</td>
        </tr>
        <tr>
          <td>8</td>
          <td />
          <td>CX</td>
          <td>O</td>
          <td />
          <td />
          <td>What Domains Returned</td>
        </tr>
      </table>
      <p>
        <span style="font-style:italic">Adapted from the HL7 standard, version 2.5</span>
      </p>
      <p>The Consumer shall specify “IHE PDQ Query” for QPD-1.1 Message Query Name. All other components of Message Query Name shall not be populated.</p>
      <h7 id="3.22.4.1.2.2.1">3.22.4.1.2.2.1 Parameters in QPD-3-Demographics and Visit-Related Fields</h7>
      <p>
        <span>Field</span>
        <span style="font-style:italic">QPD-3-Demographics and Visit-Related Fields</span>
        <span>consists of one or more repetitions, each of which contains two components that together contain the name and value of a distinct parameter to the query. Acceptable segments are PID, PD1, PV1, and PV2.</span>
      </p>
      <p>The first component of each parameter contains the name of an HL7 element in the form</p>
      <p>
        <span style="width:36pt;display:inline-block"> </span>
        <span>@&lt;seg&gt;.&lt;field no&gt;.&lt;component no&gt;.&lt;subcomponent no&gt;</span>
      </p>
      <p>The above format is populated according to common HL7 usage for specifying elements used in query parameters, as follows:</p>
      <p>&lt;seg&gt; represents a 3-character segment ID from the HL7 Standard.</p>
      <p>&lt;field no&gt; is the number of a field within the segment as shown in the SEQ column of the segment attribute table for the segment selected.</p>
      <p>&lt;component no&gt;, for fields whose data types contain multiple components, shall contain the cardinal number of the component being valued. For fields whose data types do not contain multiple components, &lt;component no&gt; shall not be valued and its preceding period should not appear.</p>
      <p>&lt;subcomponent no&gt;, for components whose data types contain multiple subcomponents, shall contain the cardinal number of the subcomponent being valued. For components whose data types do not contain multiple subcomponents, &lt;subcomponent no&gt; shall not be valued and its preceding period shall not appear.</p>
      <p>The second subcomponent of each parameter contains the value that is to be matched. If it is desired to constrain the quality of a match within the bounds of an algorithm known to the Supplier, the algorithm and constraint values may be specified in Fields QPD-4 through QPD-7.</p>
      <p>The Patient Demographics Consumer may specify, and the Patient Demographics Supplier shall support, the fields in Table 3.22-3. If the Pediatric Demographics Option is supported, then additionally, the Patient Demographics Consumer may specify, and the Patient Demographics Supplier shall support, the fields in Table 3.22-3a.</p>
      <p id="t3.22-3" class="tableTitle">Table 3.22-3: IHE Profile – QPD-3 fields required to be supported</p>
      <table cellspacing="0" cellpadding="0">
        <thead>
          <tr>
            <td class="tableHeader">FLD</td>
            <td class="tableHeader">ELEMENT NAME</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>PID.3</td>
            <td>Patient Identifier List</td>
          </tr>
          <tr>
            <td>PID.5</td>
            <td>Patient Name</td>
          </tr>
          <tr>
            <td>PID.7</td>
            <td>Date/Time of Birth</td>
          </tr>
          <tr>
            <td>PID.8</td>
            <td>Administrative Sex</td>
          </tr>
          <tr>
            <td>PID.11</td>
            <td>Patient Address</td>
          </tr>
          <tr>
            <td>PID.18</td>
            <td>Patient Account Number</td>
          </tr>
        </tbody>
      </table>
      <p id="t3.22-3a" class="tableTitle">Table 3.22-3a: IHE Profile – QPD-3 fields required to be additionally supported if Pediatric Demographics is supported</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td class="tableHeader">FLD</td>
          <td class="tableHeader">ELEMENT NAME</td>
        </tr>
        <tr>
          <td>PID.6</td>
          <td>Mother’s Maiden Name</td>
        </tr>
        <tr>
          <td>PID.13</td>
          <td>Phone Number - Home</td>
        </tr>
      </table>
      <p>In addition, the Patient Demographics Supplier should support the fields in the following table, and it shall support at least one of them. Some fields may not be relevant to particular care settings (e.g., inpatient, day patient) and will thus not be supportable by domains in those care settings.</p>
      <p id="t3.22-4" class="tableTitle">Table 3.22-4: IHE Profile – QPD-3 fields recommended to be supported </p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td class="tableHeader">FLD</td>
          <td class="tableHeader">ELEMENT NAME</td>
        </tr>
        <tr>
          <td>PV1.2</td>
          <td>Patient Class</td>
        </tr>
        <tr>
          <td>PV1.3</td>
          <td>Assigned Patient Location</td>
        </tr>
        <tr>
          <td>PV1.7</td>
          <td>Attending Doctor</td>
        </tr>
        <tr>
          <td>PV1.8</td>
          <td>Referring Doctor</td>
        </tr>
        <tr>
          <td>PV1.9</td>
          <td>Consulting Doctor</td>
        </tr>
        <tr>
          <td>PV1.10</td>
          <td>Hospital Service</td>
        </tr>
        <tr>
          <td>PV1.17</td>
          <td>Admitting Doctor</td>
        </tr>
        <tr>
          <td>PV1.19</td>
          <td>Visit Number</td>
        </tr>
      </table>
      <p>The Patient Demographics Supplier shall return demographic records that reflect the best fit to all of the search criteria.</p>
      <p>Examples of parameter expressions in QPD-3:</p>
      <p class="indent"><code>@PID.5.1.1^SMITH~@PID.8^F</code></p>
      <p>requests all patients whose family name (first subcomponent (data type ST) of the first component (data type FN) of PID-5-Patient Name (data type XPN)) matches the value ‘SMITH’ and whose sex (PID-8-Sex (data type IS)) matches the value ‘female’.</p>
      <p class="indent"><code>@PV1.3.2^389~@PV1.3.3^2</code></p>
      <p>requests all patients whose room number (second component (data type IS) of PV1-3-Assigned Patient Location (data type PL)) matches the value 389 and whose bed number (third component (data type IS) of PV1-3-Assigned Patient Location (data type PL)) matches the value 2.</p>
      <h7 id="3.22.4.1.2.2.2">3.22.4.1.2.2.2 Populating QPD-8-What Domains Returned</h7>
      <p>As in the Patient Demographics Query [ITI-21] transaction, field QPD-8 restricts the set of domains for which identifiers are returned in PID-3:</p>
      <ol>
        <li class="numbered-list1">
          <span>In a multiple-domain environment, QPD-8 may be used to identify one or more domains of interest to the Patient Demographics Consumer and from which the Consumer wishes to obtain a value for</span>
          <span style="font-style:italic">PID-3-Patient Identifier</span>
          <span>. Note that the patient information source designated by MSH-5 may or may not be associated with any of the Patient ID Domains listed in</span>
          <span style="font-style:italic">QPD-8-What Domains Returned</span>
          <span>.</span>
        </li>
        <li class="numbered-list1">If QPD-8 is empty, the Patient Demographics Supplier shall return all Patient IDs known by the Patient Demographics Supplier for each patient that matches the search criteria. See Case 1 in Section 3.21.4.2.2.8 for details on how this information is returned.</li>
        <li class="numbered-list1">If QPD-8 is specified and the domains are recognized, the Patient Demographics Supplier shall return the Patient IDs for each patient that matches the search criteria. See Case 2 in Section 3.21.4.2.2.8 for details on how this information is returned.</li>
        <li class="numbered-list1">Any domain not recognized by the Patient Demographics Supplier is an error condition. See Case 3 in Section 3.21.4.2.2.8 how to handle this condition.</li>
        <li class="numbered-list1">In a single-domain environment, QPD-8 may be ignored by the Patient Demographics Supplier. The Supplier shall always return the identifier from the Patient ID Domain known by the Patient Demographics Supplier.</li>
      </ol>
      <p>Within field QPD-8, only component 4 (Assigning Authority) shall be valued.</p>
      <p>
        The Patient Demographics Supplier may or may not be able to supply additional identifiers from the domains specified in QPD-8. A discussion of how QPD-8 is processed is included in the architectural discussion in the “Using Patient Data Query (PDQ) in a Multi-Domain Environment” section (
        <a href="../Volume2/ch-M.html#Appendix M">ITI TF-2: Appendix M</a>
        ).
      </p>
      <p>The Patient Demographics Consumer shall be able to support at least one of the following mechanisms for specifying QPD-8:</p>
      <ol>
        <li class="numbered-list1">Transmit an empty value and receive all identifiers in all domains known by the Patient Demographics Supplier (one or more domains), or</li>
        <li class="numbered-list1">Transmit a single value and receive zero or more identifiers in a single domain, or</li>
        <li class="numbered-list1">Transmit multiple values and receive multiple identifiers in those multiple domains.</li>
      </ol>
      <h6 id="3.22.4.1.2.3">3.22.4.1.2.3 RCP Segment</h6>
      <p>The Patient Demographics Consumer shall send attributes within the RCP segment as described in Table 3.22-5. Fields not listed are optional.</p>
      <p id="t3.22-5" class="tableTitle">Table 3.22-5: IHE Profile - RCP segment</p>
      <table cellspacing="0" cellpadding="0">
        <thead>
          <tr>
            <td class="tableHeader">SEQ</td>
            <td class="tableHeader">LEN</td>
            <td class="tableHeader">DT</td>
            <td class="tableHeader">OPT</td>
            <td class="tableHeader">TBL#</td>
            <td class="tableHeader">ITEM#</td>
            <td class="tableHeader">ELEMENT NAME</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>1</td>
            <td>ID</td>
            <td>R</td>
            <td>0091</td>
            <td>00027</td>
            <td>Query Priority</td>
          </tr>
          <tr>
            <td>2</td>
            <td>10</td>
            <td>CQ</td>
            <td>O</td>
            <td>0126</td>
            <td>00031</td>
            <td>Quantity Limited Request</td>
          </tr>
        </tbody>
      </table>
      <p>
        <span style="font-style:italic">Adapted from the HL7 standard, version 2.5</span>
      </p>
      <h7 id="3.22.4.1.2.3.1">3.22.4.1.2.3.1 Populating RCP-1-Query Priority </p>
      <p>
        <span>Field</span>
        <span style="font-style:italic">RCP-1-Query Priority</span>
        <span>shall always contain</span>
        <span style="font-weight:bold">I</span>
        <span>, signifying that the response to the query is to be returned in Immediate mode.</span>
      </p>
      <h7 id="3.22.4.1.2.3.2">3.22.4.1.2.3.2 Populating RCP-2-Quantity Limited Request</p>
      <p>The Patient Demographics Consumer may request that responses to the query be sent, using the HL7 Continuation Protocol, in increments of a specified number of patient records. (In the context of the HL7 query, a patient record is defined as the PID segment and any segments accompanying it for each patient.) It is desirable to request an incremental response if the query could result in hundreds or thousands of matches or “hits.”</p>
      <p>The Patient Demographics Supplier shall support the HL7 Continuation Protocol.</p>
      <p>Field RCP-2 is of data type CQ, which contains two components. The first component contains the number of increments, always expressed as an integer greater than 0, while the second component contains the kind of increment, always RD to signify that incremental replies are specified in terms of records.</p>
      <p>For example, 50^RD requests 50 records at a time.</p>
      <p>See the “Incremental Response Processing” Section 3.22.4.1.3.3 and the “Expected Actions” Section 3.22.4.2.3 of the Patient Demographics Query Response message for more information on the implementation of the continuation protocol.</p>
      <h6 id="3.22.4.1.2.4">3.22.4.1.2.4 DSC Segment</h6>
      <p>The Patient Demographics Consumer may request additional increments of data by specifying this segment on the query request. This segment should be omitted on the initial query request. Its purpose is to request additional increments of the data from the Patient Demographic Supplier.</p>
      <p id="t3.22-5a" class="tableTitle">Table 3.22-5a: IHE Profile - DSC segment</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td class="tableHeader">SEQ</td>
          <td class="tableHeader">LEN</td>
          <td class="tableHeader">DT</td>
          <td class="tableHeader">OPT</td>
          <td class="tableHeader">TBL#</td>
          <td class="tableHeader">ITEM#</td>
          <td class="tableHeader">ELEMENT NAME</td>
        </tr>
        <tr>
          <td>1</td>
          <td>180</td>
          <td>ST</td>
          <td>O</td>
          <td />
          <td>00014</td>
          <td>Continuation Pointer</td>
        </tr>
        <tr>
          <td>2</td>
          <td>1</td>
          <td>ID</td>
          <td>O</td>
          <td>0398</td>
          <td>01354</td>
          <td>Continuation Style</td>
        </tr>
      </table>
      <h7 id="3.22.4.1.2.4.1">3.22.4.1.2.4.1 Populating DSC-1 Continuation Pointer</p>
      <p>
        <span>To request additional increments of data, DSC-1 (Continuation Pointer)</span>
        <span style="font-style:italic" />
        <span>shall echo the value from RSP^K22 DSC-1.</span>
      </p>
      <h7 id="3.22.4.1.2.4.2">3.22.4.1.2.4.2 Populating DSC-2 Continuation Style</p>
      <p>DSC-2 (Continuation Style) shall always contain “I”, signifying that this is part of an interactive continuation message.</p>
      <h5 id="3.22.4.1.3">3.22.4.1.3 Expected Actions</h5>
      <h6 id="3.22.4.1.3.1">3.22.4.1.3.1 Immediate Acknowledgement</h6>
      <p>
        <span>The Patient Demographics Supplier shall immediately return an RSP^ZV2 response message as specified below in Section 3.22.4.2, “Patient Demographics Response.” The RSP^ZV2 response message incorporates original mode application acknowledgment as specified in the “Acknowledgment Modes” section (ITI TF-2: C.2.3). The Supplier shall use Field</span>
        <span style="font-style:italic">MSH-3-Sending Application</span>
        <span>of the RSP^ZV2 message to return the value it received from the Patient Demographics Consumer in Field</span>
        <span style="font-style:italic">MSH-5-Receiving Application</span>
        <span>of the QBP^ZV1 message.</span>
      </p>
      <h6 id="3.22.4.1.3.2">3.22.4.1.3.2 Query Parameter Processing</h6>
      <p>The Patient Demographics Supplier shall be capable of accepting, searching on, and responding with attributes in the QPD segment as specified in Table 3.22-2.</p>
      <p>The Patient Demographics Supplier must be capable of receiving all valid combinations of subcomponents that make up the Assigning Authority component (i.e., all valid combinations of QPD-3.8).</p>
      <p>Handling of phonetic issues, alternate spellings, upper and lower case, wildcards, accented characters, etc., if deemed appropriate, is to be supported by the Patient Demographics Supplier rather than by the Patient Demographics Consumer. The Supplier shall return at least all exact matches to the query parameters sent by the Consumer; IHE does not further specify matching requirements.</p>
      <h6 id="3.22.4.1.3.3">3.22.4.1.3.3 Incremental Response Processing</h6>
      <p>
        <span>The Patient Demographics Supplier shall be capable of accepting and processing attributes in the RCP segment as listed in Table 3.22-5. In particular, the Patient Demographics Supplier shall respond in immediate mode (as specified by a</span>
        <span style="font-style:italic">RCP-1-Query Priority</span>
        <span>value of</span>
        <span style="font-weight:bold">I</span>
        <span>).</span>
      </p>
      <p>
        <span>Also, the Patient Demographics Supplier shall be able to interpret</span>
        <span style="font-style:italic">RCP-2-Quantity Limited Request</span>
        <span>to return successive responses of partial lists of records according to the HL7 Continuation Protocol, as described in Section 3.22.4.2 below and in the HL7 Standard.</span>
      </p>
      <h4 id="3.22.4.2">3.22.4.2 Patient Demographics and Visit Response</h4>
      <h5 id="3.22.4.2.1">3.22.4.2.1 Trigger Events</h5>
      <p>The Patient Demographics Supplier’s response to the Find Candidates with Visit Information message shall be the following message:</p>
      <p>ZV2 – Find Candidates with Visit Information response</p>
      <h5 id="3.22.4.2.2">3.22.4.2.2 Message Semantics</h5>
      <p>The Patient Demographics and Visit Response transaction is conducted by the RSP^ZV2 message. The Patient Demographics Supplier shall generate this message in direct response to the QBP^ZV1 message previously received. This message satisfies the Application Level, Original Mode Acknowledgement for the HL7 QBP^ZV1 message.</p>
      <p>The segments of the message listed without enclosing square brackets in Table 3.22-6 are required. Detailed descriptions of all segments listed in the table below are provided in the following subsections. Other segments of the message are optional.</p>
      <p id="t3.22-6" class="tableTitle">Table 3.22-6: RSP Segment Pattern Response</p>
      <table cellspacing="0" cellpadding="0">
        <thead>
          <tr>
            <td class="tableHeader">RSP</td>
            <td class="tableHeader">Segment Pattern Response</td>
            <td class="tableHeader">Chapter in HL7 v2.5</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>MSH</td>
            <td>Message Header</td>
            <td>2</td>
          </tr>
          <tr>
            <td>MSA</td>
            <td>Message Acknowledgement</td>
            <td>2</td>
          </tr>
          <tr>
            <td>[ {ERR} ]</td>
            <td>Error</td>
            <td>2</td>
          </tr>
          <tr>
            <td>QAK</td>
            <td>Query Acknowledgement</td>
            <td>5</td>
          </tr>
          <tr>
            <td>QPD</td>
            <td>Query Parameter Definition</td>
            <td>5</td>
          </tr>
          <tr>
            <td>[ { PID</td>
            <td>Patient Identification</td>
            <td>3</td>
          </tr>
          <tr>
            <td>  [ PD1 ]</td>
            <td>Additional Patient Demographics</td>
            <td>3</td>
          </tr>
          <tr>
            <td>  PV1</td>
            <td>Patient Visit</td>
            <td>3</td>
          </tr>
          <tr>
            <td>  [ PV2 ]</td>
            <td>Patient Visit – Additional Information</td>
            <td>3</td>
          </tr>
          <tr>
            <td>  [ QRI ] } ]</td>
            <td>Query Response Instance</td>
            <td>5</td>
          </tr>
          <tr>
            <td>[ DSC ]</td>
            <td>Continuation Pointer</td>
            <td>2</td>
          </tr>
        </tbody>
      </table>
      <h6 id="3.22.4.2.2.1">3.22.4.2.2.1 MSH Segment</h6>
      <p>The MSH segment shall be constructed as defined in the “Message Control” section (ITI TF-2: C.2.2).</p>
      <p>
        <span>Field</span>
        <span style="font-style:italic">MSH-3-Sending Application</span>
        <span>specifies the patient information source that processed the query. The Patient Demographics Supplier shall use Field</span>
        <span style="font-style:italic">MSH-3-Sending Application</span>
        <span>of the RSP^ZV2 message to return the value it received from the Patient Demographics Consumer in Field</span>
        <span style="font-style:italic">MSH-5-Receiving Application</span>
        <span>of the QBP^Q22 message.</span>
      </p>
      <p>
        <span>Field</span>
        <span style="font-style:italic">MSH-9-Message Type</span>
        <span>shall have all three components populated with a value. The first component shall have a value of</span>
        <span style="font-weight:bold">RSP</span>
        <span>; the second component shall have a value of</span>
        <span style="font-weight:bold">ZV2</span>
        <span>. The third component shall have a value of</span>
        <span style="font-weight:bold">RSP_ZV2</span>
        <span>.</span>
      </p>
      <h6 id="3.22.4.2.2.2">3.22.4.2.2.2 MSA Segment</h6>
      <p>The Patient Demographics Supplier is not required to send any attributes within the MSA segment beyond what is specified in the HL7 standard. See the “Acknowledgment Modes” section (ITI TF-2: C.2.3) for the list of all required and optional fields within the MSA segment.</p>
      <h6 id="3.22.4.2.2.3">3.22.4.2.2.3 QAK Segment</h6>
      <p>The Patient Demographics Supplier shall send attributes within the QAK segment as defined in Table 3.22-7. For the details on filling in QAK-2 (Query Response Status) refer to the “Patient Demographics Supplier Actor Query Response Behavior” Section 3.22.4.2.2.11.</p>
      <p>QAK-1 (Query Tag) shall echo the same value of QPD-2 (Query Tag) of the QBP^Q22 message, to allow the Patient Demographics Query Consumer to match the response to the corresponding query request.</p>
      <p id="t3.22-7" class="tableTitle">Table 3.22-7: IHE Profile - QAK segment</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td class="tableHeader">SEQ</td>
          <td class="tableHeader">LEN</td>
          <td class="tableHeader">DT</td>
          <td class="tableHeader">OPT</td>
          <td class="tableHeader">TBL#</td>
          <td class="tableHeader">ITEM#</td>
          <td class="tableHeader">ELEMENT NAME</td>
        </tr>
        <tr>
          <td>1</td>
          <td>32</td>
          <td>ST</td>
          <td>R</td>
          <td />
          <td>00696</td>
          <td>Query Tag</td>
        </tr>
        <tr>
          <td>2</td>
          <td>2</td>
          <td>ID</td>
          <td>R+</td>
          <td>0208</td>
          <td>00708</td>
          <td>Query Response Status</td>
        </tr>
      </table>
      <p>
        <span style="font-style:italic">Adapted from the HL7 standard, version 2.5</span>
      </p>
      <h6 id="3.22.4.2.2.4">3.22.4.2.2.4 QPD Segment</h6>
      <p>The Patient Demographics Supplier shall echo the QPD Segment value that was sent in the QBP^ZV1 message.</p>
      <h6 id="3.22.4.2.2.5">3.22.4.2.2.5 PID Segment</h6>
      <p>The Patient Demographics Supplier shall return one PID segment group (i.e., one PID segment plus any segments associated with it in the message syntax shown in Table 3.22-6) for each matching patient record found. The Supplier shall return the attributes within the PID segment as specified in Table 3.22-8. If the Pediatric Demographics Option is supported, then additionally, the Supplier shall return the attributes within the PID segment as specified in Table 3.22-9. In addition, the Patient Demographics Supplier shall return all other attributes within the PID segment for which it is able to supply values.</p>
      <p id="t3.22-8" class="tableTitle">Table 3.22-8: IHE Profile - PID segment</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td class="tableHeader">SEQ</td>
          <td class="tableHeader">LEN</td>
          <td class="tableHeader">DT</td>
          <td class="tableHeader">OPT</td>
          <td class="tableHeader">TBL#</td>
          <td class="tableHeader">ITEM#</td>
          <td class="tableHeader">ELEMENT NAME</td>
        </tr>
        <tr>
          <td>3</td>
          <td>250</td>
          <td>CX</td>
          <td>R</td>
          <td />
          <td>00106</td>
          <td>Patient Identifier List</td>
        </tr>
        <tr>
          <td>5</td>
          <td>250</td>
          <td>XPN</td>
          <td>R</td>
          <td />
          <td>00108</td>
          <td>Patient Name</td>
        </tr>
        <tr>
          <td>7</td>
          <td>26</td>
          <td>TS</td>
          <td>R2</td>
          <td />
          <td>00110</td>
          <td>Date/Time of Birth</td>
        </tr>
        <tr>
          <td>8</td>
          <td>1</td>
          <td>IS</td>
          <td>R2</td>
          <td>0001</td>
          <td>00111</td>
          <td>Administrative Sex</td>
        </tr>
        <tr>
          <td>11</td>
          <td>250</td>
          <td>XAD</td>
          <td>R2</td>
          <td />
          <td>00114</td>
          <td>Patient Address</td>
        </tr>
        <tr>
          <td>18</td>
          <td>250</td>
          <td>CX</td>
          <td>R2</td>
          <td />
          <td>00121</td>
          <td>Patient Account Number</td>
        </tr>
      </table>
      <p id="t3.22-8a" class="tableTitle">Table 3.22-8a: IHE Profile, Pediatric Demographics Option - PID segment  </p>
      <table cellspacing="0" cellpadding="0">
        <thead>
          <tr>
            <td class="tableHeader">SEQ</td>
            <td class="tableHeader">LEN</td>
            <td class="tableHeader">DT</td>
            <td class="tableHeader">OPT</td>
            <td class="tableHeader">TBL#</td>
            <td class="tableHeader">ITEM#</td>
            <td class="tableHeader">ELEMENT NAME</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>6</td>
            <td>250</td>
            <td>XPN</td>
            <td>R2</td>
            <td />
            <td>00109</td>
            <td>Mother’s Maiden Name</td>
          </tr>
          <tr>
            <td>13</td>
            <td>250</td>
            <td>XTN</td>
            <td>R2</td>
            <td />
            <td>00116</td>
            <td>Phone Number - Home</td>
          </tr>
          <tr>
            <td>24</td>
            <td>1</td>
            <td>ID</td>
            <td>R2</td>
            <td>0136</td>
            <td>00127</td>
            <td>Multiple Birth Indicator</td>
          </tr>
          <tr>
            <td>25</td>
            <td>2</td>
            <td>NM</td>
            <td>R2</td>
            <td />
            <td>00128</td>
            <td>Birth Order (within live births)</td>
          </tr>
          <tr>
            <td>33</td>
            <td>26</td>
            <td>TS</td>
            <td>R2</td>
            <td />
            <td>01537</td>
            <td>Last Update Date/Time</td>
          </tr>
          <tr>
            <td>34</td>
            <td>241</td>
            <td>HD</td>
            <td>R2</td>
            <td />
            <td>01538</td>
            <td>Last Update Facility</td>
          </tr>
        </tbody>
      </table>
      <p>
        <span style="font-style:italic">Adapted from the HL7 standard, version 2.5</span>
      </p>
      <p>The Patient Demographics Supplier may or may not be able to supply additional identifiers from the domains specified in QPD-8. Inability to supply an identifier in a particular domain is not an error, provided that the domain is recognized.</p>
      <p>
        <span>The PID segment and the PD1, PV1, PV2, and QRI segments that are associated with it are returned only when the Patient Demographics Supplier is able to associate the search information in QPD-3 with one or more patient records in the patient information source associated with</span>
        <span style="font-style:italic">MSH-5-Receiving Application</span>
        <span>. See the “Patient Demographics Supplier Actor Query Response Behavior” Section 3.22.4.2.2.11) for a detailed description of how the Patient Demographics Supplier responds to the query request under various circumstances.</span>
      </p>
      <h6 id="3.22.4.2.2.6">3.22.4.2.2.6 PD1 Segment</h6>
      <p>For each patient for which the Patient Demographics Supplier returns a PID segment, it may optionally return the PD1 (Patient Additional Demographics) segment, but is not required to do so.</p>
      <h6 id="3.22.4.2.2.7">3.22.4.2.2.7 PV1 Segment</h6>
      <p>For each patient for which the Patient Demographics Supplier returns a PID segment, it shall also return a PV1 Segment in which attributes are populated as specified in Table 3.22-9. In addition, the Patient Demographics Supplier shall return all other attributes within the PV1 segment for which it is able to supply values.</p>
      <p id="t3.22-9" class="tableTitle">Table 3.22-9: IHE Profile – PV1 segment</p>
      <table cellspacing="0" cellpadding="0">
        <thead>
          <tr>
            <td class="tableHeader">SEQ</td>
            <td class="tableHeader">LEN</td>
            <td class="tableHeader">DT</td>
            <td class="tableHeader">OPT</td>
            <td class="tableHeader">TBL#</td>
            <td class="tableHeader">ITEM#</td>
            <td class="tableHeader">ELEMENT NAME</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>2</td>
            <td>1</td>
            <td>IS</td>
            <td>R</td>
            <td>0004</td>
            <td>00132</td>
            <td>Patient Class</td>
          </tr>
          <tr>
            <td>3</td>
            <td>80</td>
            <td>PL</td>
            <td>R2</td>
            <td />
            <td>00133</td>
            <td>Assigned Patient Location</td>
          </tr>
          <tr>
            <td>7</td>
            <td>250</td>
            <td>XCN</td>
            <td>R2</td>
            <td>0010</td>
            <td>00137</td>
            <td>Attending Doctor</td>
          </tr>
          <tr>
            <td>8</td>
            <td>250</td>
            <td>XCN</td>
            <td>R2</td>
            <td>0010</td>
            <td>00138</td>
            <td>Referring Doctor</td>
          </tr>
          <tr>
            <td>9</td>
            <td>250</td>
            <td>XCN</td>
            <td>R2</td>
            <td>0010</td>
            <td>00139</td>
            <td>Consulting Doctor</td>
          </tr>
          <tr>
            <td>10</td>
            <td>3</td>
            <td>IS</td>
            <td>R2</td>
            <td>0069</td>
            <td>00140</td>
            <td>Hospital Service</td>
          </tr>
          <tr>
            <td>17</td>
            <td>250</td>
            <td>XCN</td>
            <td>R2</td>
            <td>0010</td>
            <td>00147</td>
            <td>Admitting Doctor</td>
          </tr>
          <tr>
            <td>19</td>
            <td>250</td>
            <td>CX</td>
            <td>R2</td>
            <td />
            <td>00149</td>
            <td>Visit Number</td>
          </tr>
        </tbody>
      </table>
      <p>
        <span style="font-style:italic">Adapted from the HL7 standard, version 2.5</span>
      </p>
      <h6 id="3.22.4.2.2.8">3.22.4.2.2.8 PV2 Segment</h6>
      <p>For each patient for which the Patient Demographics Supplier returns a PID segment, it may optionally return the PV2 (Patient Visit – Additional Information) segment, but is not required to do so.</p>
      <h6 id="3.22.4.2.2.9">3.22.4.2.2.9 QRI Segment</h6>
      <p>For each patient for which the Patient Demographics Supplier returns a PID segment, it may optionally return the QRI (Query Response Instance) segment, but is not required to do so. Refer to the HL7 Standard, Version 2.5, Chapter 5, Section 5.5.5, for more information.</p>
      <h6 id="3.22.4.2.2.10">3.22.4.2.2.10 DSC Segment</h6>
      <p>
        <span>If a number of records is specified in</span>
        <span style="font-style:italic">RCP-2-Quantity Limited Request</span>
        <span>, the Patient Demographics Supplier shall return an incremental response of that number of records when the number of matching records it finds exceeds the number of records specified in RCP-2.</span>
      </p>
      <p>As long as the Patient Demographics Supplier has records to return in additional to those returned in the incremental response, the Supplier shall return a DSC Segment. The single field of the DSC Segment shall contain a unique alphanumeric value (the Continuation Pointer) that the Patient Demographics Consumer may return in the DSC segment of the QBP^ZV1 message to request the next increment of responses. The Supplier shall return increments as many times as the Consumer requests them (and there are increments to return), and shall stop when the Consumer sends a cancel query (QCN^J01) message (or when there are no more increments to return). The Supplier shall signal no more increments by omitting the DSC segment.</p>
      <h6 id="3.22.4.2.2.11">3.22.4.2.2.11 Patient Demographics Supplier Actor Query Response Behavior</h6>
      <p>
        <span>The Patient Demographics Supplier shall perform the matching of patient data based on the query parameter values it receives. The information provided by the Patient Demographics Supplier to Patient Demographics Consumer Actors is a list of possible matching patients from the patient information source associated with the value that the Consumer sent in</span>
        <span style="font-style:italic">MSH-5-Receiving Application</span>
        <span>of the query message.</span>
      </p>
      <p>
        <span>If domains are specified in</span>
        <span style="font-style:italic">QPD-8-What Domains Returned</span>
        <span>and are recognized by the Patient Demographics Supplier, the response will also, for each patient, contain any Patient ID values found in the specified domains.</span>
      </p>
      <p>The mechanics of the matching algorithms used are internal to the Patient Demographics Supplier and are outside of the scope of this framework.</p>
      <p>The Patient Demographics Supplier shall respond to the query request as described by the following 3 cases:</p>
      <p>
        <span style="font-weight:bold">Case 1</span>
        <span>: The Patient Demographics Supplier finds (in the patient information source associated with</span>
        <span style="font-style:italic">MSH-5-Receiving Application</span>
        <span>) at least one patient record matching the criteria sent in</span>
        <span style="font-style:italic">QPD-3-Demographics Fields</span>
        <span>. No patient identifier domains are requested in</span>
        <span style="font-style:italic">QPD-8-What Domains Returned</span>
        <span>.</span>
      </p>
      <p>
        <span style="font-weight:bold">AA</span>
        <span>(application accept) is returned in MSA-1.</span>
      </p>
      <p>
        <span style="font-weight:bold">OK</span>
        <span>(data found, no errors) is returned in QAK-2.</span>
      </p>
      <p>One PID-PV1 segment group (i.e., one PID segment and one PV1 segment, plus any segments associated with them in the message syntax shown in Table 3.22-6) is returned from the patient information source for each patient record found. If the Patient Demographics Supplier returns data for multiple patients, it shall return these data in successive occurrences of the PID-PV1 segment group.</p>
      <p>
        <span>Within each PID segment, field</span>
        <span style="font-style:italic">PID-3-Patient Identifier List</span>
        <span>contains one or more identifiers from the set of Patient ID Domains known by the Patient Demographics Supplier.</span>
      </p>
      <p>
        <span>If an incremental number of records are specified in</span>
        <span style="font-style:italic">RCP-2</span>
        <span>-</span>
        <span style="font-style:italic">Quantity Limited Request</span>
        <span>, and the number of records found exceeds that incremental number, the Supplier returns only the incremental number of records, followed by a DSC segment containing a uniquely valued Continuation Pointer.</span>
      </p>
      <p>The consumer will specify the value of the continuation pointer in the DSC segment on the subsequent query request to request the next increment of responses.</p>
      <p>
        <span style="font-weight:bold">Case 2</span>
        <span>: The Patient Demographics Supplier finds (in the patient information source associated with</span>
        <span style="font-style:italic">MSH-5-Receiving Application</span>
        <span>) at least one patient record matching the criteria sent in</span>
        <span style="font-style:italic">QPD-3-Demographics Fields</span>
        <span>. One or more patient identifier domains are requested in</span>
        <span style="font-style:italic">QPD-8-What Domains Returned</span>
        <span>;</span>
        <span style="font-style:italic" />
        <span>the Supplier recognizes all the requested domains.</span>
      </p>
      <p>
        <span style="font-weight:bold">AA</span>
        <span>(application accept) is returned in MSA-1.</span>
      </p>
      <p>
        <span style="font-weight:bold">OK</span>
        <span>(data found, no errors) is returned in QAK-2.</span>
      </p>
      <p>One PID-PV1 segment group (i.e., one PID and one PV1 segment plus any segments associated with them in the message syntax shown in Table 3.22-6) is returned for each matching patient record found. If the Patient Demographics Supplier returns data for multiple patients, it shall return these data in successive occurrences of the PID segment group.</p>
      <p>
        <span>Within each PID segment, field</span>
        <span style="font-style:italic">PID-3-Patient Identifier List</span>
        <span>contains, in successive occurrences delimited by the repetition separator, the identifiers from all the Patient ID Domains requested in QPD-8. In each occurrence of PID-3, component 4 contains the assigning authority value for one Patient ID Domain, and component 1 contains the Patient ID value in that domain. If an identifier does not exist for a domain that was specified on QPD-8, nothing is returned in the list.</span>
      </p>
      <p>
        <span>If an incremental number of records is specified in</span>
        <span style="font-style:italic">RCP-2</span>
        <span>-</span>
        <span style="font-style:italic">Quantity Limited Request</span>
        <span>, and the number of records to be sent exceeds that incremental number, the Supplier returns only the incremental number of records, followed by a DSC segment containing a uniquely valued Continuation Pointer.</span>
      </p>
      <p>The consumer will specify the value of the continuation pointer in the DSC segment on the subsequent query request to request the next increment of responses.</p>
      <p>
        <span style="font-weight:bold">Case 3</span>
        <span>: The Patient Demographics Supplier does not recognize one or more of the domains in</span>
        <span style="font-style:italic">QPD-8-What Domains Returned</span>
        <span>.</span>
      </p>
      <p>
        <span style="font-weight:bold">AE</span>
        <span>(application error) is returned in MSA-1 and in QAK-2.</span>
      </p>
      <p>
        <span>For each domain that was not recognized, an ERR segment is returned in which the components of</span>
        <span style="font-style:italic">ERR-2-Error Location</span>
        <span>are valued as follows.</span>
      </p>
      <table cellspacing="0" cellpadding="0">
        <thead>
          <tr>
            <td class="tableHeader">COMP #</td>
            <td class="tableHeader">COMPONENT NAME</td>
            <td class="tableHeader">VALUE</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>Segment ID</td>
            <td>QPD</td>
          </tr>
          <tr>
            <td>2</td>
            <td>Sequence</td>
            <td>1</td>
          </tr>
          <tr>
            <td>3</td>
            <td>Field Position</td>
            <td>8</td>
          </tr>
          <tr>
            <td>4</td>
            <td>Field Repetition</td>
            <td>(see below)</td>
          </tr>
          <tr>
            <td>5</td>
            <td>Component Number</td>
            <td>(empty)</td>
          </tr>
          <tr>
            <td>6</td>
            <td>Subcomponent Number</td>
            <td>(empty)</td>
          </tr>
        </tbody>
      </table>
      <p>
        <span style="font-style:italic">ERR-2.4-Field Repetition</span>
        <span>identifies the ordinal occurrence of QPD-8 that contained the unrecognized domain. As specified by HL7,</span>
        <span style="font-style:italic">ERR-2.5-Component Number</span>
        <span>and</span>
        <span style="font-style:italic">ERR-2.6-Subcomponent Number</span>
        <span>are not valued because we are referring to the entire field QPD-8.</span>
      </p>
      <p>
        <span style="font-style:italic">ERR-3-HL7 Error Code</span>
        <span>is populated with the error condition code 204 (unknown key identifier). Together with the values in ERR-2, this signifies that the Patient Demographics Supplier did not recognize the domain for</span>
        <span style="font-style:italic">QPD-8-What Domains Returned</span>
        <span>.</span>
      </p>
      <h5 id="3.22.4.2.3">3.22.4.2.3 Expected Actions</h5>
      <p>The Patient Demographics Consumer will use the demographic information provided by the Patient Demographics Supplier to perform the functions for which it requested the information, e.g., providing a pick list to the user.</p>
      <p>If the Supplier has sent a DSC segment containing a continuation pointer value, additional increments of data are available upon request by the Consumer. After receiving each increment of data that includes a DSC segment containing a continuation pointer value, the Consumer should take one of the following actions.</p>
      <ul>
        <li class="bullet-list1">
          <span>If the Consumer wishes to receive another increment of the data, the Consumer reissues the query message using a new unique value in</span>
          <span style="font-style:italic">MSH-10-message control ID</span>
          <span>and adding the DSC segment after the RCP segment. DSC-1 shall echo the continuation pointer returned in RSP^K22 DSC-1 segment.</span>
        </li>
        <li class="bullet-list1">If the Consumer does not wish to receive another increment of the data, the Consumer issues a cancel query (QCN^J01) message.</li>
        <li class="bullet-list1">If the Consumer does not reissue the query or send a cancel query message, the query will eventually terminate.</li>
      </ul>
      <p>If the Supplier has not sent a DSC segment containing a continuation pointer value, no more increments of data are available and no further action by the Consumer is required.</p>
      <h4 id="3.22.4.3">3.22.4.3 Canceling a query</h4>
      <p>The Patient Demographic Consumer can send a cancel trigger to notify the Patient Demographic Supplier that no more incremental response will be requested, and interactive query can be terminated. This cancellation trigger is optional. How long the Patient Demographic Supplier retains query results (for incremental response) is an implementation decision and therefore beyond the scope of IHE.</p>
      <h5 id="3.22.4.3.1">3.22.4.3.1 Trigger Events</h5>
      <p>The Patient Demographic Consumer which received a RSP^K22 response message indicating there more incremental response data available, can terminate the interactive query with the following HL7 trigger event:</p>
      <p>J01 – Cancel query status</p>
      <h5 id="3.22.4.3.2">3.22.4.3.2 Message Semantics</h5>
      <p>Canceling a query is conducted by the QCN^J01 message. The Patient Demographic Consumer can generate this message to notify the Patient Demographic Supplier that no more data is desired. The segments of the message listed below are required, and their details descriptions are provided in the following subsections.</p>
      <p id="t3.22-10" class="tableTitle">Table 3.22-10: QCN Cancel query</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td class="tableHeader">QCN</td>
          <td class="tableHeader">Cancel query</td>
          <td class="tableHeader">Chapter in HL7 v2.5</td>
        </tr>
        <tr>
          <td>MSH</td>
          <td>Message Header</td>
          <td>2</td>
        </tr>
        <tr>
          <td>QID</td>
          <td>Query identification Segment</td>
          <td>5</td>
        </tr>
      </table>
      <p>The receiver shall acknowledge this cancel by the HL7 ACK message. See ITI TF-2: C.2.3, “Acknowledgement Modes”, for definition and discussion of the ACK message.</p>
      <h6 id="3.22.4.3.2.1">3.22.4.3.2.1 MSH Segment</h6>
      <p>The MSH segment shall be constructed as defined in the “Message Control” section (ITI TF-2: C.2.2).</p>
      <p>MSH-9 (Message Type) shall have three components. The first component shall have the value of QCN; the second component shall have a value of J01. The third component shall have the value of QCN_J01.</p>
      <h6 id="3.22.4.3.2.2">3.22.4.3.2.2 QID Segment</h6>
      <p>The QID segment contains the information necessary to uniquely identify the query being cancelled.</p>
      <p id="t3.22-11" class="tableTitle">Table 3.22-11: IHE Profile - QID segment</p>
      <table cellspacing="0" cellpadding="0">
        <thead>
          <tr>
            <td class="tableHeader">SEQ</td>
            <td class="tableHeader">LEN</td>
            <td class="tableHeader">DT</td>
            <td class="tableHeader">OPT</td>
            <td class="tableHeader">TBL#</td>
            <td class="tableHeader">ITEM#</td>
            <td class="tableHeader">ELEMENT NAME</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>32</td>
            <td>ST</td>
            <td>R</td>
            <td />
            <td>00696</td>
            <td>Query Tag</td>
          </tr>
          <tr>
            <td>2</td>
            <td>250</td>
            <td>CE</td>
            <td>R</td>
            <td>0471</td>
            <td>01375</td>
            <td>Message Query Name</td>
          </tr>
        </tbody>
      </table>
      <p>
        <span style="font-weight:bold">3.22.4.3.2.2.1</span>
        <span style="font:7pt 'Times New Roman'">                       </span>
        <a name="_Toc174249063">Populating QID-1 Query Tag</a>
      </p>
      <p>QID-1 (Query Tag) uniquely identifies the query to be canceled. This field shall contain the same value specified in QPD-2.</p>
      <p>
        <span style="font-weight:bold">3.22.4.3.2.2.2</span>
        <span style="font:7pt 'Times New Roman'">                       </span>
        <a name="_Toc174249064">Populating QID-2 Message Query Name</a>
      </p>
      <p>QID-2 (Message Query Name) identifies the name of the query. It is an identifier of the conformance statement for this query. This field shall contain the same value specified in QPD-1.</p>
      <h3 id="3.22.5">3.22.5 Security Considerations</h3>
      <h4 id="3.22.5.1">3.22.5.1 Audit Record Considerations</h4>
      <p>The Patient Demographics Query Transaction is a Query Information event as defined in Table 3.20.4.1.1.1-1. The Actors involved shall record audit events according to the following:</p>
      <h5 id="3.22.5.1.1">3.22.5.1.1 Patient Demographics Consumer audit message:</h5>

      <table cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <div />
          </td>
          <td class="tableHeader">Field Name</td>
          <td class="tableHeader">Opt</td>
          <td class="tableHeader">Value Constraints</td>
        </tr>
        <tr>
          <td rowspan="5">
            <p>Event</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">EventIdentification</span>
            </p>
          </td>
          <td>EventID</td>
          <td>M</td>
          <td>EV(110112, DCM, “Query”)</td>
        </tr>
        <tr>
          <td>EventActionCode</td>
          <td>M</td>
          <td>“E” (Execute)</td>
        </tr>
        <tr>
          <td>EventDateTime</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>EventOutcomeIndicator</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>EventTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-22”, “IHE Transactions”, “Patient Demographics and Visit Query”)</td>
        </tr>
        <tr>
          <td colspan="4">Source (Patient Demographics Consumer) (1)</td>
        </tr>
        <tr>
          <td colspan="4">Human Requestor (0..n)</td>
        </tr>
        <tr>
          <td colspan="4">Destination (Patient Demographics Supplier) (1)</td>
        </tr>
        <tr>
          <td colspan="4">Audit Source (Patient Demographics Consumer) (1)</td>
        </tr>
        <tr>
          <td colspan="4">Patient (0..n)</td>
        </tr>
        <tr>
          <td colspan="4">Query Parameters (1)</td>
        </tr>
      </table>
      <p>Where:</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="7">
            <p>Source</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ActiveParticipant</span>
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>The identity of the Patient Demographics Consumer facility and sending application from the HL7 message; concatenated together, separated by the | character.</td>
        </tr>
        <tr>
          <td>AlternativeUserID</td>
          <td>M</td>
          <td>The process ID as used within the local operating system in the local system logs.</td>
        </tr>
        <tr>
          <td>UserName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserIsRequestor</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110153, DCM, “Source”)</td>
        </tr>
        <tr>
          <td>NetworkAccessPointTypeCode</td>
          <td>M</td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr>
          <td>NetworkAccessPointID</td>
          <td>M</td>
          <td>The machine name or IP address.</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="7">
            <p>Human Requestor (if known)</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ActiveParticipant</span>
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>Identity of the human that initiated the transaction.</td>
        </tr>
        <tr>
          <td>AlternativeUserID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserIsRequestor</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>RoleIDCode</td>
          <td>U</td>
          <td>Access Control role(s) the user holds that allows this transaction.</td>
        </tr>
        <tr>
          <td>NetworkAccessPointTypeCode</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>NetworkAccessPointID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="7">
            <p>Destination</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ActiveParticipant</span>
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>The identity of the Patient Demographics Source facility and receiving application from the HL7 message; concatenated together, separated by the | character.</td>
        </tr>
        <tr>
          <td>AlternativeUserID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserIsRequestor</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110152, DCM, “Destination”)</td>
        </tr>
        <tr>
          <td>NetworkAccessPointTypeCode</td>
          <td>M</td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr>
          <td>NetworkAccessPointID</td>
          <td>M</td>
          <td>The machine name or IP address.</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="3">
            <p>Audit Source</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">AuditSourceIdentification</span>
            </p>
          </td>
          <td>AuditSourceID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>AuditEnterpriseSiteID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>AuditSourceTypeCode</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="9">
            <p>Patient</p>
            <p>
              <span style="font-weight:bold">(AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ParticipantObjectIdentification)</span>
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“1” (Person)</td>
        </tr>
        <tr>
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“1” (Patient)</td>
        </tr>
        <tr>
          <td>ParticipantObjectDataLifeCycle</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectSensitivity</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>The patient ID in HL7 CX format.</td>
        </tr>
        <tr>
          <td>ParticipantObjectName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectQuery</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectDetail</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="9">
            <p>Query Parameters</p>
            <p>
              <span style="font-weight:bold">(AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ParticipantObjectIdentification)</span>
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“2” (system object)</td>
        </tr>
        <tr>
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“24” (query)</td>
        </tr>
        <tr>
          <td>ParticipantObjectDataLifeCycle</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-22”, “IHE Transactions”, “Patient Demographics and Visit Query”)</td>
        </tr>
        <tr>
          <td>ParticipantObjectSensitivity</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectQuery</td>
          <td>M</td>
          <td>the QPD segment of the query - Base64 encoded</td>
        </tr>
        <tr>
          <td>ParticipantObjectDetail</td>
          <td>M</td>
          <td>Type=MSH-10 (the literal string), Value=the value of MSH-10 (from the message content, base64 encoded)</td>
        </tr>
      </table>
      <h5 id="3.22.5.1.2">3.22.5.1.2 Patient Demographics Source audit message:</h5>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <div />
          </td>
          <td class="tableHeader">Field Name</td>
          <td class="tableHeader">Opt</td>
          <td class="tableHeader">Value Constraints</td>
        </tr>
        <tr>
          <td rowspan="5">
            <p>Event</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">EventIdentification</span>
            </p>
          </td>
          <td>EventID</td>
          <td>M</td>
          <td>EV(110112, DCM, “Query”)</td>
        </tr>
        <tr>
          <td>EventActionCode</td>
          <td>M</td>
          <td>“E” (Execute)</td>
        </tr>
        <tr>
          <td>EventDateTime</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>EventOutcomeIndicator</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>EventTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-22”, “IHE Transactions”, “Patient Demographics and Visit Query”)</td>
        </tr>
        <tr>
          <td colspan="4">Source (Patient Demographics Consumer) (1)</td>
        </tr>
        <tr>
          <td colspan="4">Destination (Patient Demographics Supplier) (1)</td>
        </tr>
        <tr>
          <td colspan="4">Audit Source (Patient Demographics Supplier) (1)</td>
        </tr>
        <tr>
          <td colspan="4">Patient (0..n)</td>
        </tr>
        <tr>
          <td colspan="4">Query Parameters (1)</td>
        </tr>
      </table>
      <p>Where:</p>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="7">
            <p>Source</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ActiveParticipant</span>
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>The identity of the Patient Demographics Consumer facility and sending application from the HL7 message; concatenated together, separated by the | character.</td>
        </tr>
        <tr>
          <td>AlternativeUserID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserIsRequestor</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110153, DCM, “Source”)</td>
        </tr>
        <tr>
          <td>NetworkAccessPointTypeCode</td>
          <td>M</td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr>
          <td>NetworkAccessPointID</td>
          <td>M</td>
          <td>The machine name or IP address.</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="7">
            <p>Destination</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ActiveParticipant</span>
            </p>
          </td>
          <td>UserID</td>
          <td>M</td>
          <td>The identity of the Patient Demographics Supplier facility and receiving application from the HL7 message; concatenated together, separated by the | character.</td>
        </tr>
        <tr>
          <td>AlternativeUserID</td>
          <td>M</td>
          <td>The process ID as used within the local operating system in the local system logs.</td>
        </tr>
        <tr>
          <td>UserName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>UserIsRequestor</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>RoleIDCode</td>
          <td>M</td>
          <td>EV(110152, DCM, “Destination”)</td>
        </tr>
        <tr>
          <td>NetworkAccessPointTypeCode</td>
          <td>M</td>
          <td>“1” for machine (DNS) name, “2” for IP address</td>
        </tr>
        <tr>
          <td>NetworkAccessPointID</td>
          <td>M</td>
          <td>The machine name or IP address.</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="3">
            <p>Audit Source</p>
            <p>
              <span style="font-weight:bold">AuditMessage/</span>
              <br />
              <span style="font-weight:bold">AuditSourceIdentification</span>
            </p>
          </td>
          <td>AuditSourceID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>AuditEnterpriseSiteID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>AuditSourceTypeCode</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="9">
            <p>Patient</p>
            <p>
              <span style="font-weight:bold">(AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ParticipantObjectIdentification)</span>
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“1” (Person)</td>
        </tr>
        <tr>
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“1” (Patient)</td>
        </tr>
        <tr>
          <td>ParticipantObjectDataLifeCycle</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectSensitivity</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectID</td>
          <td>M</td>
          <td>The patient ID in HL7 CX format.</td>
        </tr>
        <tr>
          <td>ParticipantObjectName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectQuery</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectDetail</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
      </table>
      <table cellspacing="0" cellpadding="0">
        <tr>
          <td rowspan="9">
            <p>Query Parameters</p>
            <p>
              <span style="font-weight:bold">(AuditMessage/</span>
              <br />
              <span style="font-weight:bold">ParticipantObjectIdentification)</span>
            </p>
          </td>
          <td>ParticipantObjectTypeCode</td>
          <td>M</td>
          <td>“2” (system object)</td>
        </tr>
        <tr>
          <td>ParticipantObjectTypeCodeRole</td>
          <td>M</td>
          <td>“24” (query)</td>
        </tr>
        <tr>
          <td>ParticipantObjectDataLifeCycle</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectIDTypeCode</td>
          <td>M</td>
          <td>EV(“ITI-22”, “IHE Transactions”, “Patient Demographics and Visit Query”)</td>
        </tr>
        <tr>
          <td>ParticipantObjectSensitivity</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectID</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectName</td>
          <td>U</td>
          <td>not specialized</td>
        </tr>
        <tr>
          <td>ParticipantObjectQuery</td>
          <td>M</td>
          <td>the QPD segment of the query - Base64 encoded</td>
        </tr>
        <tr>
          <td>ParticipantObjectDetail</td>
          <td>M</td>
          <td>Type=MSH-10 (the literal string), Value=the value of MSH-10 (from the message content, base64 encoded)</td>
        </tr>
      </table>


          </div>
        </div>
      </main>
    </div>
   <footer class="ihe-footer">
    <div class="grid-container fluid">
      <div class="grid-x grid-margin-x align-middle">
        <div class="cell medium-9 small-order-2 medium-order-1 text-center medium-text-left">
          © 2000 &mdash; <span id="current-year"></span> IHE International | TEL 1-630-481-1004 | 820&nbsp;Jorie&nbsp;Boulevard,
          Oak&nbsp;Brook, IL&nbsp;60523
        </div>
        <div class="cell medium-3 small-order-1 medium-order-2 text-center medium-text-right ihe-footer-icons">
          <a href="mailto:secretary@ihe.net"><i class="fi fi-mail"></i></a>
          <a href="https://www.linkedin.com/company/iheintl"><i class="fi fi-social-linkedin"></i></a>
          <a href="https://twitter.com/IHEIntl"><i class="fi fi-social-twitter" aria-hidden="true"></i></a>
          <a href="https://www.youtube.com/user/IHEIntl"><i class="fi fi-social-youtube" aria-hidden="true"></i></a>
        </div>
      </div>
    </div>
  </footer>
    <script src="../../../js/vendor/jquery.min.js"></script>
    <script src="../../../js/vendor/motion-ui.min.js"></script>
    <script src="../../../js/vendor/what-input.js"></script>
    <script src="../../../js/vendor/foundation.min.js"></script>
    <script src="../../../js/app.js"></script>
  	<script>
	 window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-HLBNC861DJ');
	</script>
</body>
</html>
