<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta charset="utf-8" />
    <title>IHE_ITI_TF_Rev16-0_Vol2a_FT</title>
    <link rel="stylesheet" href="../css/styles.css" />
  </head>
  <body>
    <p>
      <img src="media/image1.jpeg" class="IHE logo" alt="IHE_LOGO_for_tf-docs" />
    </p>
    <p>IHE IT Infrastructure (ITI)</p>
    <p>Technical Framework</p>
    <p>Volume 2</p>
    <p>Revision 16.0 – Final Text</p>
    <p>
      <hr />
    </p>
    <h2 xmlns="" id="3.12">3.12 Retrieve Document for Display [ITI-12]</h2>
    <p xmlns="">This section corresponds to transaction [ITI-12] of the IHE IT Infrastructure Technical Framework. Transaction [ITI-12] is used by the Information Source and Display Actors.</p>
    <h3 xmlns="" id="3.12.1">3.12.1 Scope</h3>
    <p xmlns="">This transaction involves the retrieval of a document (persistent object) for presentation purposes. The uniquely identifiable persistent object means that retrieving the same document instance at a different point in time will provide the same semantics for its presented content. The information content of the document is immutable even if the presentation of such content is provided with the use of different formats, stylesheets, etc.</p>
    <h3 xmlns="" id="3.12.2">3.12.2 Use Case Roles</h3>
    <img xmlns="" src="media/alql6-rgeyz.028.png" width="365" height="125" alt="" />
    <p xmlns="">
      <span style="font-weight:bold">Actor:</span>
      <span>Display</span>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">Role:</span>
      <span>A system that requests a document/object for display, and displays it.</span>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">Actor:</span>
      <span>Information Source</span>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">Role:</span>
      <span>A system that provides specific information in response to the request from the Display Actor, in a presentation-ready format.</span>
    </p>
    <h3 xmlns="" id="3.12.3">3.12.3 Referenced Standards</h3>
    <p xmlns="">RFC2616 HyperText Transfer Protocol HTTP/1.1</p>
    <p xmlns="">
      <span>Extensible Markup Language (XML) 1.0 (Second Edition). W3C Recommendation 6 October 2000. .</span>
      <a href="http://www.w3.org/TR/REC-xml" style="text-decoration:none">
        <span style="text-decoration:underline">http://www.w3.org/TR/REC-xml</span>
      </a>
    </p>
    <p xmlns="">
      <span>Web Services Description Language (WSDL) 1.1. W3C Note 15 March 2001. .</span>
      <a href="http://www.w3.org/TR/wsdl" style="text-decoration:none">
        <span style="text-decoration:underline">http://www.w3.org/TR/wsdl</span>
      </a>
    </p>
    <h3 xmlns="" id="3.12.4">3.12.4 Messages</h3>
    <img xmlns="" src="media/alql6-rgeyz.029.png" width="392" height="192" alt="" />
    <p xmlns="" class="figureTitle">Figure 3.12-1: Request for Persistent Document Sequence</p>
    <h4 xmlns="" id="3.12.4.1">3.12.4.1 Request for Persistent Document</h4>
    <h5 xmlns="" id="3.12.4.1.1">3.12.4.1.1 Trigger Events</h5>
    <p xmlns="">The request for a document is triggered when a user of the Display needs to review a particular document that is stored by the Information Source Actor.</p>
    <h5 xmlns="" id="3.12.4.1.2">3.12.4.1.2 Message Semantics</h5>
    <p xmlns="">The Retrieve Document for Display transaction is performed by the invocation of a web service. The Display shall generate the web service request whenever a user needs to review the document stored as part of a patient’s clinical history on the Information Source Actor.</p>
    <p xmlns="">The web service request shall include the following parameters (keys) to identify the document to be returned and its format (see Table 3.12.4-1). All parameter names and values are case-sensitive.</p>
    <p xmlns="" class="tableTitle">Table 3.12.4-1: Query Keys</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <thead>
        <tr>
          <td style="width:87.2pt" class="tableHeader">Parameter Name</td>
          <td style="width:33.35pt" class="tableHeader">REQ</td>
          <td style="width:140.45pt" class="tableHeader">Description</td>
          <td style="width:178.1pt" class="tableHeader">Values</td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="width:87.2pt">requestType</td>
          <td style="width:33.35pt">R</td>
          <td style="width:140.45pt">This parameter is required to have a value of DOCUMENT.</td>
          <td style="width:178.1pt">DOCUMENT</td>
        </tr>
        <tr>
          <td style="width:87.2pt">documentUID</td>
          <td style="width:33.35pt">R</td>
          <td style="width:140.45pt">Identifies document’s UID as known to both actors.</td>
          <td style="width:178.1pt">This value shall be a properly defined Object identifier (OID) as specified in <a href="../Volume2x/ch-2.html#Appendix B">ITI TF-2x: Appendix B</a>.</td>
        </tr>
        <tr>
          <td style="width:87.2pt">preferredContentType</td>
          <td style="width:33.35pt">R</td>
          <td style="width:140.45pt">This parameter is required to identify the preferred format the document is to be provided in (as MIME content type).</td>
          <td style="width:178.1pt">
            <p>Display may specify one of the following formats:</p>
            <p>image/jpeg</p>
            <p>application/x-hl7-cda-level-one+xml (see note)</p>
            <p>application/pdf (see note)</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p xmlns="" class="note">Note: see IANA registry for details about hl7-cda-level-one and PDF, such as version. Applications creating PDF may use this MIME type for other versions of PDF up to 1.3. Receivers shall support document encoded in this version and previous versions.</p>
    <p xmlns="" class="note">
      <span>Note: see HL7 CDA</span>
      <span style="font-size:6pt;vertical-align:super">®</span>
      <a href="#_ftn3" style="text-decoration:none">
        <span style="font-size:6pt;vertical-align:super">[3]</span>
      </a>
      <span>framework release 1.0 for details about application/x-hl7-cda-level-one+xml.</span>
    </p>
    <p xmlns="">Formal definition of the web service in WSDL is provided in <a href="../Volume2x/ch-1.html#Appendix A">ITI TF-2x: Appendix A</a>.</p>
    <p xmlns="">The only binding required for both the Display and Information Source is the binding to the HTTP-GET. In this binding the sample message will be formatted as follows:</p>
    <p xmlns="">http://&lt;location&gt;/IHERetrieveDocument?requestType=DOCUMENT&amp;documentUID=1.2.3&amp;preferredContentType=application%2fpdf</p>
    <p xmlns="">The &lt;location&gt; part of the URL is configurable by the implementation, and must contain the host name, an optional port address, and may be followed by an optional path. The path if present may not contain a ‘?’ character. The remainder of the URL, including IHERetrieveDocument and the following request parameters are specified by the WSDL and may not be changed. See the discussion about location in Section 3.11.4.1.2 Message Semantics above.</p>
    <p xmlns="">In addition, the Display shall support the following fields of the HTTP request:</p>
    <p xmlns="" class="tableTitle">Table 3.12.4-3: HTTP Request and Response Fields</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <thead>
        <tr>
          <td style="width:54.8pt" class="tableHeader">HTTP Field</td>
          <td style="width:29.75pt" class="tableHeader">REQ</td>
          <td style="width:171.95pt" class="tableHeader">Description</td>
          <td style="width:182.6pt" class="tableHeader">Values</td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="width:54.8pt">Accept</td>
          <td style="width:29.75pt">O</td>
          <td style="width:171.95pt">This field may be used to specify certain media types which are acceptable for the response</td>
          <td style="width:182.6pt">
            <p>At least one of the following values:</p>
            <p>image/jpeg</p>
            <p>application/x-hl7-cda-level-one+xml</p>
            <p>application/pdf</p>
            <p>*/*</p>
            <p>Other values may be included as well</p>
          </td>
        </tr>
        <tr>
          <td style="width:54.8pt">Accept-Language</td>
          <td style="width:29.75pt">O</td>
          <td style="width:171.95pt">This field is similar to Accept, but restricts the set of natural languages that are preferred as a response to the request.</td>
          <td style="width:182.6pt">Any valid value according to RFC2616</td>
        </tr>
        <tr>
          <td style="width:54.8pt">Expires</td>
          <td style="width:29.75pt">R</td>
          <td style="width:171.95pt">This field gives the date/time after which the response is considered stale</td>
          <td style="width:182.6pt">Any valid value according to RFC2616, or 0</td>
        </tr>
      </tbody>
    </table>
    <p xmlns="">The Information Source shall support the following field of the HTTP response.</p>
    <p xmlns="" class="tableTitle">Table 3.12.4-4: HTTP Response Fields</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <thead>
        <tr>
          <td style="width:53.1pt" class="tableHeader">HTTP Field</td>
          <td style="width:31.45pt" class="tableHeader">REQ</td>
          <td style="width:171.95pt" class="tableHeader">Description</td>
          <td style="width:181.7pt" class="tableHeader">Values</td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="width:53.1pt">Expires</td>
          <td style="width:31.45pt">R</td>
          <td style="width:171.95pt">This field gives the date/time after which the response is considered stale</td>
          <td style="width:181.7pt">Any valid value according to RFC2616, or 0</td>
        </tr>
      </tbody>
    </table>
    <p xmlns="">The Display may provide list of content types it supports in the HTTP Accept field. If the HTTP Accept Field is absent, it means that any content type is acceptable by the Display Actor.</p>
    <p xmlns="">The preferredContentType parameter shall specify the content type desired by the Display Actor. The value of the preferredContentType parameter of the request shall be one of the values from the Table 3.12.4-1 and shall not contradict values specified in the HTTP Accept field.</p>
    <p xmlns="">The Information Source shall provide info in preferredContentType if capable, otherwise it shall only use a type specified in the Accept Field as appropriate given the information to be returned.</p>
    <p xmlns="">If necessary, the Display may perform the request to the web service utilizing HTTPS protocol.</p>
    <p xmlns="">Information Source Actors may return HTTP redirect responses (responses with values of 301, 302, 303 or 307) in response to a request. Display Actors can expect to receive an error response, or the data requested, or a request to look elsewhere for the data. A Display must follow redirects, but if a loop is detected, it may report an error.</p>
    <h5 xmlns="" id="3.12.4.1.3">3.12.4.1.3 Expected Actions</h5>
    <p xmlns="">Upon reception of the Request for Specific Information, the Information Source shall parse the request and shall return the retrieved document as specified in Section 3.12.4.2, and HTTP response code 200 - OK.</p>
    <p xmlns="">If the requestType specified is a not a legal value according to this profile, the Information Source shall return HTTP response-code 403 (forbidden) with the suggested reason-phrase “requestType not supported”.</p>
    <p xmlns="">If the Information Source is not able to format the document in any content types listed in the 'Accept' field, it shall return HTTP response code 406 – Not Acceptable.</p>
    <p xmlns="">If the specified documentUID is not known to the Information Source Actor, it shall return HTTP response-code 404 (not found) with the suggested reason-phrase “Document UID not found”.</p>
    <p xmlns="">If the documentUID, preferredContentType or requestType parameters are missing, the Information Source shall return HTTP response code 400 - Bad Request.</p>
    <p xmlns="">If the documentUID or preferredContentType parameters are malformed, the Information Source shall return HTTP response code 400 - Bad Request.</p>
    <p xmlns="">If the specified preferredContentType is not consistent with the setting of the HTTP Accept field, the Information Source shall return HTTP response code 400 – Bad Request.</p>
    <p xmlns="" class="note">Note: Other HTTP response codes may be returned by the Information Source Actor, indicating conditions outside of the scope of this profile, for example, 401 – Authentication Failed might be returned if Information Source is grouped with the Kerberized Server Actor.</p>
    <p xmlns="" class="note">Note:  It is recommended that the Information Source complement returned error code with a human readable description of the error condition.</p>
    <p xmlns="">If an error condition cannot be automatically recovered, at a minimum, the error should be displayed to the user by the Display Actor.</p>
    <h4 xmlns="" id="3.12.4.2">3.12.4.2 Delivery of Persistent Document</h4>
    <h5 xmlns="" id="3.12.4.2.1">3.12.4.2.1 Trigger Events</h5>
    <p xmlns="">The Delivery of Persistent Document message is the transmission of the requested document in specified format from the Information Source to the Display. This transmission will happen if such document, identified by the documentUID parameter in the request, has been successfully located by the Information Source Actor.</p>
    <h5 xmlns="" id="3.12.4.2.2">3.12.4.2.2 Message Semantics</h5>
    <p xmlns="">In response to the request from the Display Actor, the Information Source shall format the document according to the preferredContentType specified, and return it in the HTTP response. See Section 3.12.4.1.2 for a discussion of the rules related to preferredContentType.</p>
    <p xmlns="">The Information Source shall maintain global uniqueness of object identifiers.</p>
    <p xmlns="">The Information Source shall set an expiration date compatible with the policies associated with the possible removal of instances of persistent documents (no more than a week).</p>
    <h5 xmlns="" id="3.12.4.2.3">3.12.4.2.3 Expected Actions</h5>
    <p xmlns="">The Display shall render the received document for the user.</p>
  </body>
</html>
