<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta charset="utf-8" />
    <title>IHE_ITI_TF_Rev16-0_Vol2a_FT</title>
    <link rel="stylesheet" href="../css/styles.css" />
  </head>
  <body>
    <p>
      <img src="media/image1.jpeg" class="IHE logo" alt="IHE_LOGO_for_tf-docs" />
    </p>
    <p>IHE IT Infrastructure (ITI)</p>
    <p>Technical Framework</p>
    <p>Revision 16.0 – Final Text</p>
    <p>
      <hr />
    </p>
    <h2 xmlns="" id="3.19">3.19 Authenticate Node [ITI-19]</h2>
    <p xmlns="">This section corresponds to transaction [19] of the IHE ITI Technical Framework. Transaction [ITI-19] is used by the Secure Node Actors</p>
    <h3 xmlns="" id="3.19.1">3.19.1  Scope</h3>
    <p xmlns="">In the Authenticate Node transaction, the local Secure Node presents its identity to a remote Secure Node, and authenticates the identity of the remote node. After this mutual authentication, other secure transactions may take place through this secure pipe between the two nodes.</p>
    <p xmlns="">In addition, the Secure Node authenticates the identity of the user who requests access to the node. This user authentication is a local operation that does not involve communication with a remote node.</p>
    <h3 xmlns="" id="3.19.2">3.19.2  Use Case Roles</h3>
    <p xmlns="">
      <img src="media/alql6-rgeyz.034.png" width="464" height="205" alt="" />
      <br />
    </p>
    <p xmlns="">
      <span style="font-weight:bold">Actor:</span>
      <span style="width:2.69pt;display:inline-block"> </span>
      <span>Secure Node</span>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">Role:</span>
      <span style="width:8.68pt;display:inline-block"> </span>
      <span>Establish a protocol specific trust relationship between two nodes in a network. Establishes the identity of a user, and authorizes access to the patient data and applications at the node.</span>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">Actor:</span>
      <span>User</span>
    </p>
    <p xmlns="">
      <span style="font-weight:bold">Role:</span>
      <span>Someone who wants to have access to the data and applications available at the node.</span>
    </p>
    <h3 xmlns="" id="3.19.3">3.19.3  Referenced Standards</h3>
    <p xmlns="">
      <span style="font-weight:bold">DICOM:</span>
    </p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>PS3.15 Security Profiles. Annex B:  Secure Transport Connection Profiles</span>
      </li>
    </ul>
    <p xmlns="">
      <span style="font-weight:bold">IETF:</span>
      <span style="width:4pt;display:inline-block"> </span>
    </p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>RFC2246 - Transport Layer Security (TLS) 1.0 and later revisions</span>
      </li>
    </ul>
    <p xmlns="">RFC7525 - Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>RFC3851 - Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1                        Message Specification</span>
      </li>
    </ul>
    <p xmlns="">
      <span style="font-weight:bold">ITU-T:</span>
    </p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Recommendation X.509 (03/00). “Information technology - Open Systems Interconnection - The directory: Public-key and attribute certificate frameworks"</span>
      </li>
    </ul>
    <h3 xmlns="" id="3.19.4">3.19.4  Messages</h3>
    <p xmlns="" style="font-size:9pt">Note: This diagram does not imply sequencing of Authentication Node and Local User Authentication.</p>
    <img xmlns="" src="media/alql6-rgeyz.035.png" width="472" height="289" alt="" />
    <p xmlns="" class="figureTitle">Figure 3.19.4-1: Interaction Diagram</p>
    <h3 xmlns="" id="3.19.5">3.19.5  Trigger Events</h3>
    <p xmlns="">The Local Secure Node starts the authentication process with the Remote Secure Node when information exchange between the two nodes is requested. The first transaction shall be the Authenticate Node transaction, and all other PHI transactions performed by IHE actors shall be secure transactions. This authentication process is needed when a secure connection is established.</p>
    <p xmlns="">The Basic Secure Node shall always apply the Authenticate Node process to every DICOM, HTTP, or HL7 connection.</p>
    <h3 xmlns="" id="3.19.6">3.19.6  Message Semantics</h3>
    <p xmlns="">The Authenticate node transaction involves the exchange of certificates representing the identities of the nodes. These identities are used to authenticate the nodes, to inform authorization, and audit logging.</p>
    <h4 xmlns="" id="3.19.6.1">3.19.6.1 Certificate Validation</h4>
    <p xmlns="">The local organization (e.g., XDS Affinity Domain) will make the choice of what mixture of chain of trust and direct comparison is used to authenticate communications. This may be entirely based on chaining trust to selected CAs, entirely based upon provision of node certificates for direct comparison, or a mixture of both.</p>
    <p xmlns="" style="font-size:9pt">
      <span>Note:</span>
      <span style="width:13.75pt;text-indent:0pt;display:inline-block"> </span>
      <span>The CAs used for ATNA chain of trust will be different than the default browser trusted list of CAs used for authenticating internet web servers. A worldwide CA, such as VeriSign, is not generally trusted to determine which individual nodes within an organization should and should not communicate patient identifiable information.</span>
    </p>
    <p xmlns="">When Authenticating the Remote Secure Node, the Local Secure Node:</p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Shall be able to perform certificate validation based on signature by a trusted CA (see Section 3.19.6.1.1) and</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Shall be able to perform direct certificate validation to a set of trusted certificates (see Section 3.19.6.1.2)</span>
      </li>
    </ul>
    <p xmlns="">It may reject communications when the certificate validation fails, or may restrict communications to only that which is appropriate for an unidentified other party.</p>
    <h5 xmlns="" id="3.19.6.1.1">3.19.6.1.1             Chain to a trusted certificate authority</h5>
    <p xmlns="">The Secure Node or Secure Application:</p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Shall provide the means for configuring which CAs are trusted to authenticate node certificates for use in a chain of trust. These CAs shall be identified by means of the public signing certificate for the signing CA.</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Shall support digital certificates encoded using both Deterministic Encoding Rules (DER) and Basic Encoding Rules (BER).</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Shall accept communications for which there is a certificate that is signed by a CA that is listed as a trusted signing authority.</span>
      </li>
    </ul>
    <h5 xmlns="" id="3.19.6.1.2">3.19.6.1.2             Direct certificate validation</h5>
    <p xmlns="">The Secure Node or Secure Application:</p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Shall provide means for installing of the required certificates, for example, via removable media or network interchange (where the set of trusted certificates can be a mixture of CA signed certificates and self-signed certificates).</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Shall support digital certificates encoded using both Deterministic Encoding Rules (DER) and Basic Encoding Rules (BER).</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Shall accept communications for which there is a certificate configured as acceptable for direct certificate validation.</span>
      </li>
    </ul>
    <h5 xmlns="" id="3.19.6.1.3">3.19.6.1.3             Other Certificate requirements</h5>
    <p xmlns="">The Secure Node shall not require any specific certificate attribute contents, nor shall it reject certificates that contain unknown attributes or other parameters. Note that for node certificates the CN often is a hostname, attempting to use this hostname provides no additional security and will introduce a new failure mode (e.g., DNS failure).</p>
    <p xmlns="">The certificates used for mutual authentication shall be X.509 certificates based on RSA key with key length in the range of 1024-4096, where the key length chosen is based on local site policy. Maximum expiration time acceptable for certificates should be defined in the applicable security policy. The IHE Technical Framework recommends a maximum expiration time of 2 years.</p>
    <p xmlns="">The method used to determine whether a node is authorized to perform transactions is not specified. This may be use of a set of trusted certificates, based on some attribute value contained in the certificates, access control lists, or some other method. Using a certificate chain back to an external trusted certificate authority to determine authorizations is strongly discouraged.</p>
    <h4 xmlns="" id="3.19.6.2">3.19.6.2 All Connections carrying Protected Information (PI)</h4>
    <p xmlns="">When configured for use on a physically secured network, the normal connection mechanisms may be used.</p>
    <p xmlns="">
      <span>When configured for use not on a physically secured network implementations shall use the TLS protocol, and the following  shall be supported:</span>
      <a name="OLE_LINK18">
        <span>ciphersuite</span>
      </a>
      <span style="font-weight:bold" />
    </p>
    <p xmlns="">TLS_RSA_WITH_AES_128_CBC_SHA.</p>
    <p xmlns="">The recommended "well-known port 2762" as specified by DICOM shall be used when the Secure node is configured for use not on a physically secured network. When the secure node is configured for use on a physically secured network, a different port number shall be used, preferably the standard port 104. HL7 does not specify port numbers, but the port number used when configured for use on a physically secured network shall be different than the port number used when configured for use not on a physically secured network.</p>
    <p xmlns="">All Secure Nodes shall be configurable for use on a physically secured network or not on a physically secured network. If Secure Node is configured for physical security, then it may use the non-TLS DICOM port and protocol.</p>
    <p xmlns="">See RFC7525 “Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)” for recommendations on proper use of TLS and appropriate fallback rules.</p>
    <h4 xmlns="" id="3.19.6.3">3.19.6.3  This Header is empty to preserve header numbering</h4>
    <h4 xmlns="" id="3.19.6.4">3.19.6.4 Web-Services carrying Protected Information (PI)</h4>
    <p xmlns="">A trusted association shall be established between the two nodes utilizing WS-I Basic Security Profile Version 1.1. This association will be used for all secure transactions between the IHE actors in the two nodes. Note that Section 3.19.6.2 “All Connections carrying Protected Information (PI)” and WS-I Basic Security Profile – Section 3 “Transport Layer Mechanisms” (i.e., http://ws-i.org/profiles/basic-security/1.1/transport) are identical and interoperable.</p>
    <h4 xmlns="" id="3.19.6.5">3.19.6.5 SMTP communication</h4>
    <p xmlns="">When configured to use email on a network that is not physically secured, implementations shall use S/MIME (RFC3851):</p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>The message shall be signed using the signedData format (i.e., encapsulated signature rather than multipart/signed format for detached signature) making the signature verification easier for the remote node. The email shall be digitally signed by the sender, by a one level only detached signature. This digital signature shall be interpreted to mean that the sender is attesting to their authorization to disclose the information to the intended recipient(s). RSA/SHA-1 signature shall be supported by both the sender and the receiver.</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>All the certificates of the "trust chain" shall be contained within the signature when using a PKI or out of bound certificate.</span>
      </li>
    </ul>
    <p xmlns="">The following ciphersuites shall also be supported for encrypted email:</p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>S/MIME_RSA_WITH_AES_128_CBC_SHA (sender).</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>S/MIME_RSA_WITH_3DES_128_CBC_SHA (sender and receiver). Receivers must be able to receive older encryption methods, but for IHE Authenticate Node compliance the sender will use AES.</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>The email shall be digitally signed by the sender, by a one level only detached signature, applied BEFORE the encryption. This digital signature shall be interpreted to mean that the sender is attesting to their authorization to disclose the information to the intended recipient(s).</span>
      </li>
    </ul>
    <p xmlns="">As explained in S/MIME, the sender will generate a unique session key, encrypt the payload of the message using the symmetrical AES algorithm, encrypt the key using the RSA asymmetrical algorithm with each one of receiver(s) public key and attach the result to the message. Each one of the receiver(s) will decrypt this result using its private key, revealing the session key, and decrypt the payload of the message.</p>
    <p xmlns="">This profile does not specify how certificates and keys are obtained or exchanged.</p>
    <h3 xmlns="" id="3.19.7">3.19.7  Local User Authentication</h3>
    <p xmlns="">The Secure Node starts the authentication process with a User when the User wants to log on to the node. The secure node shall not allow access to PHI to an operator who has not successfully completed the local user authentication. Local user authentication is not an IHE specified network transaction, although it may utilize a network system for user authentication.</p>
    <p xmlns="">This is a local invocation of functions at the Secure Node. The identity of the User will be established by the Secure Node based on methods such as:</p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Username with Password</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Biometrics</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Smart card</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>Magnetic Card</span>
      </li>
    </ul>
    <p xmlns="">The User shall log in using his or her own unique individually assigned identity. Identities must be unique across the secure domain. A user may have more than one identity. The Secure Node shall be configurable to maintain a list of authorized users for the Secure Node.</p>
    <p xmlns="">The rules for assignment of unique individual identities to users is part of the Security Policy of the healthcare enterprise. Development of these rules is outside the scope of the IHE Technical Framework. The following examples list a few special cases related to user identification that may occur in practice.</p>
    <h4 xmlns="" id="3.19.7.1">3.19.7.1 Example: Team approach</h4>
    <p xmlns="">When the operator is part of a team performing a procedure, the other members of the team involved in creating and accessing the data should be manually identified and recorded in the procedure log (which may be paper or electronic), and it is assumed that all have accessed the data even though they were not (and cannot be in most cases) actually logged on to the piece of equipment.</p>
    <p xmlns="">During some procedures, it may be necessary for one operator to relieve the operator who has already been authenticated by the system. It is recommended that the first operator log off and that the system authenticate the new operator.</p>
    <p xmlns="">The audit log supports identification of the active participant. This is often defined as one key member of the team. Other means are used to track the entry and exit of various members of the team. IHE does not specify any specific team identification process.</p>
    <h4 xmlns="" id="3.19.7.2">3.19.7.2 Example: Access to locked exam room, no user logon on modality.</h4>
    <p xmlns="">There may be situations where the acquisition modality has no user logon features, and access to the equipment is controlled by controlling access to the examination room. In these situations an equipment-specific user ID will be used, and access to the room should be recorded in the procedure log (which may be paper or electronic).</p>
    <h4 xmlns="" id="3.19.7.3">3.19.7.3 Example: Enterprise User Authentication</h4>
    <p xmlns="">The healthcare enterprise may implement local user authentication using the Enterprise User Authentication Profile (EUA). This implementation may be mixed with other non-EUA access to the secure domain, based upon each node’s internal use an EUA availability.</p>
    <br xmlns="" style="page-break-before:always; clear:both" />
  </body>
</html>
