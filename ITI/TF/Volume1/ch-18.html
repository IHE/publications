<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta xmlns="" charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title xmlns="">IHE ITI TF Vol1</title>
    <link xmlns="" rel="stylesheet" href="../../../css/styles.css" />
    <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-HLBNC861DJ" async> </script> 
</head>
  <body xmlns="">
    <header>
        <div class="title-bar" data-responsive-toggle="responsive-menu" data-hide-for="medium">
          <button class="menu-icon" type="button" data-toggle="responsive-menu"></button>
          <div class="title-bar-title">IHE ITI Technical Framework</div>
        </div>
        <div class="top-bar" id="responsive-menu">
          <div class="top-bar-left">
            <img src="../../../IHE_INTERNATIONAL.png" class="IHE logo hide-for-small-only" alt="IHE logo" />
            <ul id="tf-small-menu" class="menu vertical show-for-small-only">
              <li><a class="ihe-purple" href="https://ihe.net" target="_blank">About IHE</a></li>
              <li class="menu-text">Sections
                <ul id="tf-small-menu-list" class="nested vertical menu">
                </ul>
              </li>
            </ul>
          </div>
          <div class="top-bar-right hide-for-small-only">
            <ul class="menu">
              <li class="menu-text tf-version">IHE IT Infrastructure (ITI) Technical Framework, Volume <span id="volumeNo"></span><br />Revision 19.0, June 17, 2022 – Final Text</li>
            </ul>
              <ul class="menu align-right">
                    <li><input id="ihe-search-field" type="search" placeholder="Search"></li>
                    <li><button id="ihe-search-button" type="button" class="button search">Search</button></li>
                </ul>
            </div>
        </div>
         </header>
    <div class="navigation">
      <nav aria-label="You are here:" role="navigation">
        <ul class="breadcrumbs">
        </ul>
      </nav>
    </div>
    <div class="scroll-top-wrapper">
      <span class="scroll-top-inner">
        <i class="size-icon-lg fi-arrow-up"></i>
      </span>
    </div>
    <div class="grid-container fluid">
      <div class="grid-x grid-margin-x align-center">
        <div class="cell medium-11">
          <div class="callout disclaimer warning text-center">              
          The Final Text ITI Technical Framework is published here in HTML format and is no longer published as PDF. Trial Implementation supplements are available from the <a href=https://profiles.ihe.net/ITI/TF/Volume1/index.html>Volume 1 Table of Contents</a>.
          </div>
        </div>
      </div>
      <main>
        <div class="grid-x grid-margin-x align-center">
          <div class="hide-for-small-only cell medium-2 large-2" data-sticky-container>
            <div id="section-menu" class="sticky" data-sticky data-anchor="main-top">
            </div>
          </div>
          <div id="main-top" class="cell medium-10 large-10">
      <h1 id="18">18 Cross-Community Access (XCA)</h1>
      <p>The Cross-Community Access Profile supports the means to query and retrieve patient relevant medical data held by other communities. A community is defined as a coupling of facilities/enterprises that have agreed to work together using a common set of policies for the purpose of sharing clinical information via an established mechanism. Facilities/enterprises may host any type of healthcare application such as EHR, PHR, etc. A community is identifiable by a globally unique id called the homeCommunityId. Membership of a facility/enterprise in one community does not preclude it from being a member in another community. Such communities may be XDS Affinity Domains which define document sharing using the XDS Profile or any other communities, no matter what their internal sharing structure.</p>
  	  <p class="trialImplementation">This Profile has been updated by the<a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_Suppl_XCA_Deferred_Option.pdf">XCA Deferred Response Option</a>, and <a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_AsyncAS4Option.pdf">Asynchronous AS4 Option</a> Supplement.</p>
      <h2 id="18.1">18.1 XCA Actors/Transactions</h2>
      <p>Figure 18.1-1 shows the actors directly involved in the XCA Integration Profile and the relevant transactions between them.</p>
      <p class="note">Note: The Document Consumer is shown in Figure 18.1-1 to clarify the responsibility of the XDS Affinity Domain Option discussed in Section 18.2. </p>
      <div id="f18.1-1">
        <img src="media/Figure_18.1-1.png" alt="" >
        <p class="figureTitle">Figure 18.1-1: XCA Actor Diagram</p>
      </div>
      <p>Table 18.1-1 lists the transactions for each actor directly involved in the XCA Profile. In order to claim support of this Integration Profile, an implementation must perform the required transactions (labeled “R”). Transactions labeled “O” are optional. A complete list of options defined by this Integration Profile and that implementations may choose to support is listed in Section 18.2.</p>
      <p id="t18.1-1" class="tableTitle">Table 18.1-1: XCA Integration Profile - Actors and Transactions</p>
    <table cellspacing="0" cellpadding="0">
      <thead>
        <tr>
          <td class="tableHeader">Actors</td>
          <td class="tableHeader">Transactions</td>
          <td class="tableHeader">Optionality</td>
          <td class="tableHeader">Section</td?
        </tr>
      </thead>
      <tbody>
        <tr style="height:11.65pt">
          <td rowspan="4">Initiating Gateway</td>
          <td>Cross Gateway Query [ITI-38]</td>
          <td>R</td>
          <td>
            <a href="../Volume2/ITI-38.html">ITI TF-2: 3.38</a>
          </td>
        </tr>
        <tr style="height:11.65pt">
          <td>Cross Gateway Retrieve [ITI-39]</td>
          <td>R</td>
          <td>
            <a href="../Volume2/ITI-39.html">ITI TF-2: 3.39</a>
          </td>
        </tr>
        <tr style="height:11.65pt">
          <td>Registry Stored Query [ITI-18]</td>
          <td>O</td>
          <td>
            <a href="../Volume2/ITI-18.html">ITI TF-2: 3.18</a>
          </td>
        </tr>
        <tr style="height:11.65pt">
          <td>Retrieve Document Set [ITI-43]</td>
          <td>O</td>
          <td>
            <a href="../Volume2/ITI-43.html">ITI TF-2: 3.43</a>
          </td>
        </tr>
        <tr style="height:11.65pt">
          <td rowspan="2">Responding Gateway</td>
          <td>Cross Gateway Query [ITI-38]</td>
          <td>R</td>
          <td>
            <a href="../Volume2/ITI-38.html">ITI TF-2: 3.38</a>
          </td>
        </tr>
        <tr style="height:11.65pt">
          <td>Cross Gateway Retrieve [ITI-39]</td>
          <td>R </td>
          <td>
            <a href="../Volume2/ITI-39.html">ITI TF-2: 3.39</a>
          </td>
        </tr>
      </tbody>
    </table>
            <p class="note">Note: When an Initiating or Responding Gateway is grouped with a Document Consumer, there are additional requirements. See Section 18.2.3 for a description of grouping.</p>
      <h3 id="18.1.1">18.1.1 XCA Required Groupings</h2>
            <p>An actor from this profile (Column 1) shall implement all of the required transactions and/or content modules in this profile <b><i>in addition to <u>all</u></i></b> of the requirements for the grouped actor (Column 2). </p>
      <p id="t18.1.1-1" class="tableTitle">Table 18.1.1-1: XCA - Required Actor Groupings</p>
      <table cellspacing="0" cellpadding="0">
        <thead>
        <tr>
          <td class="tableHeader">XCA Actor</td>
          <td class="tableHeader">Actor(s) to be grouped with</td>
          <td class="tableHeader">Reference</td>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td rowspan="2">Initiating Gateway</td>
          <td>CT / Time Client</td>
          <td>
            <a href="../Volume1/ch-7.html#7.1">ITI TF-1: 7.1</a>
          </td>
        </tr>
        <tr>
          <td>ATNA / Secure Node or Secure Application</td>
          <td>
            <a href="../Volume1/ch-9.html#9.1">ITI TF-1: 9.1</a>
          </td>
        </tr>
        <tr style="height:16.15pt">
          <td rowspan="2">Responding Gateway</td>
          <td>CT / Time Client</td>
          <td>
            <a href="../Volume1/ch-7.html#7.1">ITI TF-1: 7.1</a>
          </td>
        </tr>
        <tr style="height:16.15pt">
          <td>ATNA / Secure Node or Secure Application</td>
          <td>
            <a href="../Volume1/ch-9.html#9.1">ITI TF-1: 9.1</a>
          </td>
        </tr>
      </tbody>
    </table>
    <h2 id="18.2">18.2 XCA Actor Options</h2>
    <p>Options that may be selected for this Integration Profile are listed in the Table 18.2-1 along with the Actors to which they apply. Dependencies between options when applicable are specified in notes.</p>
    <p id="t18.2-1" class="tableTitle">Table 18.2-1: XCA Integration Profile - Actors and Options</p>
    <table cellspacing="0" cellpadding="0">
      <thead>
        <tr>
          <td class="tableHeader">Actor</td>
          <td class="tableHeader">Options</td>
          <td class="tableHeader">Vol. &amp; Section</td>
        </tr>
      </thead>
      <tbody>
        <tr style="height:11.65pt">
          <td rowspan="3">Initiating Gateway</td>
          <td>XDS Affinity Domain</td>
          <td>
            <a href="../Volume1/ch-18.html#18.2.1">ITI TF-1: 18.2.1</a>
          </td>
        </tr>
        <tr style="height:11.65pt">
          <td>Asynchronous Web Services Exchange</td>
          <td>
            <a href="../Volume1/ch-18.html#18.2.2">ITI TF-1: 18.2.2</a>
          </td>
        </tr>
        <tr style="height:11.65pt">
          <td>On-Demand Documents</td>
          <td>
            <a href="../Volume1/ch-18.html#18.2.4">ITI TF-1: 18.2.4</a>
          </td>
        </tr>
        <tr style="height:11.65pt">
          <td rowspan="2">Responding Gateway</td>
          <td>On-Demand Documents</td>
          <td>
            <a href="../Volume1/ch-18.html#18.2.4">ITI TF-1: 18.2.4</a>
          </td>
        </tr>
        <tr style="height:11.65pt">
          <td>Persistence of Retrieved Documents</td>
          <td>
            <a href="../Volume1/ch-18.html#18.2.5">ITI TF-1: 18.2.5</a>
          </td>
        </tr>
      </tbody>
    </table>

    <h3 id="18.2.1">18.2.1 XDS Affinity Domain Option</h3>
    <p>Initiating Gateways which support the XDS Affinity Domain Option interact with Document Consumers within the XDS Affinity Domain served by the Initiating Gateway.</p>
    <p>Initiating Gateway Actors which support this option:</p>
    <ul>
      <li class="bullet-list1">
        <span>shall</span>
        <span style="font-weight:bold">receive</span>
        <span>
          Registry Stored Query [ITI-18] transactions from a local Document Consumer and act on those requests on behalf of the Document Consumer. When receiving a Registry Stored Query from a local Document Consumer, shall require the
          homeCommunityId as an input parameter on relevant queries, and shall specify the homeCommunityId attribute within its Registry Stored Query responses. See Section 18.3.2 for description of homeCommunityId. Initiating Gateways which support
          this option shall adjust the patient identifier found in the Registry Stored Query to an appropriate patient identifier known to the Responding Gateway receiving the Cross Gateway Query. See
          <a href="../Volume2/ITI-18.html#3.18.4.1.3">ITI TF-2: 3.18.4.1.3</a>
          for details of the processing of the patient identifier.
        </span>
      </li>
      <li class="bullet-list1">
        <span>shall</span>
        <span style="font-weight:bold">receive</span>
        <span>Retrieve Document Set [ITI-43] transactions from a local Document Consumer and act on those requests on behalf of the Document Consumer. When receiving a Retrieve Document Set from a local Document Consumer, shall require the
          homeCommunityId as an input parameter.</span>
      </li>
    </ul>
    <p>When an Initiating Gateway does not support the XDS Affinity Domain Option it is expected to be using non-IHE specified interactions to communicate remote community data to systems within its local community. These proprietary interactions
      are not further described within any IHE profile.</p>
    <p>See the relevant transactions for further details regarding the homeCommunityId attribute.</p>
    <h3 id="18.2.2">18.2.2 Asynchronous Web Services Exchange Option</h3>
    <p>Initiating Gateways which support Asynchronous Web Services Exchange shall support Asynchronous Web Services Exchange on the Cross Gateway Query [ITI-38] and Cross Gateway Retrieve [ITI-39] transactions. If the Initiating Gateway
        supports both the XDS Affinity Domain Option and the Asynchronous Web Services Option it shall support Asynchronous Web Services Exchange on the Registry Stored Query [ITI-18] and Retrieve Document Set [ITI-43] transactions.</p>
    <h3 id="18.2.3">18.2.3 Grouping Rules</h3>
    <p>Grouping with a Document Consumer is used in situations where an Initiating Gateway and/or Responding Gateway are supporting an XDS Affinity Domain</p>
    <p>When an Initiating Gateway is supporting an XDS Affinity Domain, it can choose to query and retrieve from local actors in addition to remote communities. This is accomplished by grouping the Initiating Gateway with a Document Consumer Actor.
      This grouping allows Document Consumers such as EHR/PHR/etc. systems to query the Initiating Gateway to retrieve document information and content from both the local XDS Affinity Domain as well as remote communities. For details see Section
      18.2.3.1. An Initiating Gateway that is not grouped with a Document Consumer is only able to return results from remote communities, so local EHR/PHR/etc. systems (Document Consumer Actors) must direct separate query and document retrieve
      transactions internally and externally.</p>
    <p>When a Responding Gateway is supporting an XDS Affinity Domain, it may resolve Cross Gateway Query and Cross Gateway Retrieve Transactions by grouping with a Document Consumer and using the Registry Stored Query and Retrieve Document Set
      transactions. For details see Section 18.2.3.2</p>
    <h4 id="18.2.3.1">18.2.3.1 Initiating Gateway grouped with Document Consumer</h4>
    <p>Initiating Gateways that are grouped with a Document Consumer:</p>
    <ul>
      <li class="bullet-list1">shall support the XDS Affinity Domain Option</li>
      <li class="bullet-list1">
        <span>shall</span>
        <span style="font-weight:bold">initiate</span>
        <span>Registry Stored Query [ITI-18] transactions to a local Document Registry to query local information in response to a received Registry Stored Query [ITI-18] from a local Document Consumer.</span>
      </li>
      <li class="bullet-list1">
        <span>shall</span>
        <span style="font-weight:bold">initiate</span>
        <span>Retrieve Document Set [ITI-43] transactions to a local Document Repository in response to a received Retrieve Document Set from a local Document Consumer which contains a homeCommunityID indicating the local community.</span>
      </li>
    </ul>
    <div id="f18.2.3.1-1">
      <img src="media/Figure_18.2.3.1-1.png" alt="" />
      <p class="figureTitle">Figure 18.2.3.1-1: Initiating Gateway grouped with Document Consumer</p>
    </div>
    <h4 id="18.2.3.2">18.2.3.2 Responding Gateway grouped with Document Consumer</h4>
    <p>Responding Gateways that are grouped with a Document Consumer:</p>
    <ul>
      <li class="bullet-list1">
        <span>shall</span>
        <span style="font-weight:bold">initiate</span>
        <span>a Registry Stored Query [ITI-18] transaction to a local Document Registry to query local information in response to a received Cross Gateway Query [ITI-38]. The Document Registry response must be augmented with the homeCommunityId of
          the Responding Gateway’s community prior to returning in the response to the Cross Gateway Query.</span>
      </li>
      <li class="bullet-list1">
        <span>shall</span>
        <span style="font-weight:bold">initiate</span>
        <span>a Retrieve Document Set [ITI-43] transaction to a local Document Repository to retrieve local information in response to a Cross Gateway Retrieve [ITI-39].</span>
      </li>
    </ul>
    <p>When a Responding Gateway is not grouped with a Document Consumer it is expected to be using non-IHE specified interactions to collect local information in response to a Cross Gateway Query or Cross Gateway Retrieve. These proprietary
      interactions are not further described within any IHE profile.</p>
    <div id="f18.2.3.2-1">
      <img src="media/Figure_18.2.3.2-1.png" alt="" />
      <p class="figureTitle">Figure 18.2.3.2-1: Responding Gateway grouped with Document Consumer</p>
    </div>
    <h3 id="18.2.4">18.2.4 On-Demand Documents Option</h3>
    <p>Initiating and Responding Gateways may declare support for On-Demand Document Entries. Refer to <a href="./ch-10.html#10.4.11.2">Section  10.4.11.2</a> for details about On-Demand Document Entries.</p>
    <p>Requirements for an Initiating Gateway supporting this option differ depending on whether or not the Initiating Gateway also supports the XDS Affinity Domain Option:</p>
    <ul>
      <li class="bullet-list1">An Initiating Gateway that supports the XDS Affinity Domain Option relies on an XDS Document Consumer in its local community to generate query and retrieve requests which support On-Demand Document Entries. The
        Initiating Gateway does not modify content related to On-Demand Entries, but passes it in the Cross-Gateway Query and Retrieve messages to the Responding Gateway and returns full results to the Document Consumer. For this reason, this option
        imposes no additional requirements on Initiating Gateways which support the XDS Affinity Domain Option.</li>
      <li class="bullet-list1">An Initiating Gateway that supports the On-Demand Documents Option, but not the XDS Affinity Domain Option, shall:</li>
    </ul>
    <ul>
      <li class="bullet-list2">be able to specify, in a Cross Gateway Query, a request for On-Demand Document Entries</li>
      <li class="bullet-list2">be able to retrieve On-Demand Document Entries from one or more Responding Gateways</li>
    </ul>
    <p>Requirements for a Responding Gateway supporting this option differ depending on whether or not the Responding Gateway is grouped with an XDS Document Consumer:</p>
    <ul>
      <li class="bullet-list1">A Responding Gateway grouped with an XDS Document Consumer to interact with XDS Document Registry and Repository Actors is dependent on that grouped actor to support the semantics needed for On-Demand Documents. The
        Responding Gateway does not modify On-Demand Document Entries obtained from the XDS Document Consumer and passes them within the Cross-Gateway Query and Retrieve response messages returned to the Initiating Gateway. For this reason, this
        option imposes no additional requirements on Initiating Gateways that group with an XDS Document Consumer.</li>
      <li class="bullet-list1">A Responding Gateways that is not grouped with an XDS Document Consumer shall:</li>
    </ul>
    <ul>
      <li class="bullet-list2">be able to respond with On-Demand Document Entries to a Cross Gateway Query requesting On-Demand Document Entries. Without this option, a Responding Gateway shall ignore the request for On-Demand Document Entries
        (i.e., return an empty list if no other type of entry matches the query parameters).</li>
      <li class="bullet-list2">be able to respond to a Cross Gateway Retrieve requesting On-Demand Document Entries.</li>
    </ul>
    <h3 id="18.2.5">18.2.5 Persistence of Retrieved Documents Option</h3>
    <p>Responding Gateways which support the Persistence of Retrieved Documents Option shall:</p>
    <ul>
      <li class="bullet-list1">also support the On-Demand Documents Option</li>
      <li class="bullet-list1">make available, as a Stable Document Entry in response to a Cross Gateway Query, every document created as a result of receipt of a Cross Gateway Retrieve which specified the uniqueID of an On-Demand Document Entry</li>
    </ul>
    <p>See Section 18.3.3.2 for an overview of this.</p>
    <h2 id="18.3">18.3 XCA Process Flow</h2>
    <h3 id="18.3.1">18.3.1 Use Cases</h3>
    <p>Assume within a given domain, such as the State of California, we have several healthcare communities (or XDS Affinity Domains or RHIOs). One in Los Angeles is based on the XDS Profile. One in Sacramento is based on another form of healthcare
      sharing infrastructure. One in San Francisco is also based on the XDS Profile. A patient X, who travels frequently, has received healthcare in each of these communities. Patient X is admitted to a hospital in LA. The attending physician uses
      his hospital information system to query across multiple domains for healthcare information about this patient. Once found, references to patient data outside the local domain are cached locally for easy future reference.</p>
    <h3 id="18.3.2">18.3.2 homeCommunityId defined</h3>
    <p>This profile makes use of a homeCommunityId value which is a globally unique identifier for a community and is used to obtain the Web Services endpoint of services that provide access to data in that community. Specifically:</p>
    <ul>
      <li class="bullet-list1">It is returned within the response to Cross Gateway Query and Registry Stored Query transactions to indicate the association of a response element with a community. Document Consumers process the value in the response
        as an opaque unique identifier.</li>
      <li class="bullet-list1">It is an optional parameter to Registry Stored Query requests, not requiring a patient id parameter, and Retrieve Document Set requests to indicate which community to direct the request.</li>
      <li class="bullet-list1">It is used by Initiating Gateways to direct requests to the community where the initial data originated.</li>
    </ul>
    <h3 id="18.3.3">18.3.3 Detailed Interactions</h3>
    <p>The following diagram presents a high-level view of the interactions between actors when both initiating and responding communities are XDS Affinity Domains i.e., use of the XDS Affinity Domain Option and the Initiating Gateway and Responding
      Gateway are each grouped with a Document Consumer. Details on each interaction follow the diagram.</p>
    <div id="f18.3.3-1">
      <img src="media/Figure_18.3.3-1.png" alt="" />
      <p class="figureTitle">Figure 18.3.3-1: XCA Detailed Interactions</p>
    </div>
    <ul>
      <li class="bullet-list1">
        <b>Document Consumer</b>
        <i>initiates a Registry Stored Query request by patient id</i>
        – the Document Consumer initiates the initial transaction by formatting a Registry Stored Query request by patient identifier. The consumer uses PDQ, PIX or some other means to identify the XDS Affinity Domain patient id, formats that
        information plus any other query parameters into a Registry Stored Query request and sends this request to an Initiating Gateway.
      </li>
      <li class="bullet-list1">
        <b>Initiating Gateway</b>
        <i>processes Registry Stored Query by patient id request</i>
        – The Initiating Gateway receives a Registry Stored Query by patient id and must determine a) which Responding Gateways this request should be sent to b) what patient id to use in the Cross Gateway Queries. Detailed specification of these
        steps is not in the intended scope of this profile. Combination of this profile with other existing profiles (e.g., PIX/PDQ), future profiles or configuration mechanisms is possible. Please refer to ITI TF-1: E.10
        <i>XCA and Patient Identification Management</i>
        for possible use of existing profiles PIX and PDQ. For each Responding Gateway identified, the Initiating Gateway shall update the query with the correct patient identifier corresponding to the Responding Gateway’s community and initiates a
        Cross Gateway Query transaction to the Responding Gateway. If the Initiating Gateway is grouped with a Document Consumer it shall also initiate a Registry Stored Query to the local Document Registry.
      </li>
      <li class="bullet-list1">
        <b>Responding Gateway</b>
        <i>processes Cross Gateway Query by patient id</i>
        – The Responding Gateway within an XDS Affinity Domain processes the Cross Gateway Query by using grouping as a Document Consumer and initiates a Registry Stored Query to the local Document Registry. The Responding Gateway shall update the
        response from the Document Registry to ensure that the homeCommunityId is specified on every applicable element. This updated response is sent as the response to the Cross Gateway Query.
      </li>
      <li class="bullet-list1">
        <b>Initiating Gateway</b>
        <i>processes Cross Gateway Query by patient id responses</i>
        – The Initiating Gateway collects the responses from all Responding Gateways it contacted. For each response it shall verify homeCommunityId is present in each appropriate element. If the Initiating Gateway initiated a Registry Stored
          Query to the local Document Registry it shall update the response to that transaction to contain the homeCommunityId value associated with the local community. Once all responses are received the Initiating Gateway consolidates all updated
          response data into one response to the Document Consumer. The Initiating Gateway shall return to the Document Consumer the same homeCommunityId attribute values that it received from Responding Gateways.
      </li>
      <li class="bullet-list1">
        <b>Document Consumer</b>
        <i>receives Registry Stored Query by patient id response</i>
        – The Document Consumer receives the results of the query from the Initiating Gateway and must account for two unique aspects of the response; namely that a) the homeCommunityId attribute will be specified and b) the Document Consumer may
        not be able to map the repository id value directly to the Document Repository. There shall be a common coding/vocabulary scheme used across all communities. For example, all communities shall have common privacy consent vocabularies. The
        Document Consumer shall retain the values of the homeCommunityId attribute for future interaction with the Initiating Gateway.
      </li>
      <li class="bullet-list1">
        <b>Document Consumer</b>
        <i>initiates a Registry Stored Query by UUID</i>
        – Many Registry Stored Queries do not include patient id as a parameter, but instead require one of the entryUUID or uniqueID parameters, generically referred to as UUID. Both of these values are returned as part of the metadata from a query
        by patient id. The Document Consumer may do a patient id query to the Initiating Gateway prior to a query by UUID or shall have access to the correct homeCommunityId through some other means. In either case the consumer has the
        homeCommunityId attribute and shall specify it as a parameter of the query. The Document Consumer puts the homeCommunityId and UUID values plus any other query parameters into a Registry Stored Query request and sends this request to an
        Initiating Gateway.
      </li>
      <li class="bullet-list1">
        <b>Initiating Gateway</b>
        <i>processes Registry Stored Query by UUID request</i>
        – The Initiating Gateway receives a Registry Stored Query by UUID and determines which Responding Gateway to contact by using the homeCommunityId to obtain the Web Services endpoint of the Responding Gateway. The process of obtaining
          the Web Services endpoint is not further specified in this profile. If the homeCommunityId represents the local community the Initiating Gateway will initiate a Registry Stored Query to the local Document Registry. The Initiating Gateway
          shall specify the homeCommunityId in the Cross Gateway Query by UUID which is associated with the Responding Gateway.
      </li>
      <li class="bullet-list1">
        <b>Responding Gateway</b>
        <i>processes Cross Gateway Query by UUID</i>
        – The Responding Gateway within an XDS Affinity Domain processes the Cross Gateway Query by grouping as a Document Consumer and initiating a Registry Stored Query to the local Document Registry. The response to the Cross Gateway query
          shall contain the homeCommunityId of the responding community. This processing is identical to processing of the Cross Gateway Query by patient id.
      </li>
      <li class="bullet-list1">
        <b>Initiating Gateway</b>
        <i>receives Cross Gateway Query by UUID response</i>
        – The processing of a Cross Gateway Query by UUID response is identical to the processing of a Cross Gateway Query by patient id response, except there is only one response, so consolidation of responses is not needed.
      </li>
      <li class="bullet-list1">
        <b>Document Consumer</b>
        <i>receives Registry Stored Query by UUID response</i>
        – The processing of a Registry Stored Query by UUID response is identical to the processing of a Registry Stored Query by patient id response.
      </li>
      <li class="bullet-list1">
        <b>Document Consumer</b>
        <i>initiates a Retrieve Document Set</i>
        – Prior to issuing a Retrieve Document Set the Document Consumer may issue a Registry Stored Query by patient id to the Initiating Gateway. The response to the Registry Stored Query by patient id or subsequent Registry Stored Query by
          UUID includes a) the document unique ID b) the repository unique ID c) the homeCommunityId attribute. If the Document Consumer did not issue a Registry Stored Query which returned this information then it shall have acquired the
          information through some other means. The Document Consumer shall specify these three parameters in its Retrieve Document Set transaction to the Initiating Gateway.
      </li>
      <li class="bullet-list1">
        <b>Initiating Gateway</b>
        <i>processes Retrieve Document Set</i>
        – The Initiating Gateway determines which Responding Gateways to contact by using the homeCommunityId to obtain the Web Services endpoint of the Responding Gateway. If the homeCommunityId represents the local community the Initiating
          Gateway will initiate a Retrieve Document Set to a local Document Repository. The Retrieve Document Set may contain more than one unique homeCommunityId so the Initiating Gateway shall be capable of initiating requests to more than one
          Responding Gateway and consolidating the results. The Initiating Gateway shall specify the homeCommunityId in the Cross Gateway Retrieve which identifies the community associated with the Responding Gateway.
      </li>
      <li class="bullet-list1">
        <b>Responding Gateway</b>
        <i>processes Cross Gateway Retrieve</i>
        – The Responding Gateway within an XDS Affinity Domain processes the Cross Gateway Retrieve by grouping as a Document Consumer and initiating a Retrieve Document Set transaction to the Document Repository identified by the repository
          unique ID within the request. If the Cross Gateway Retrieve requests multiple documents with different repository unique IDs, the Responding Gateway shall contact multiple Document Repositories and consolidate the responses.
      </li>
    </ul>
    <h4 id="18.3.3.1">18.3.3.1 Sharing using On-Demand Documents</h4>
    <p>Figure 18.3.3-2 shows the use of an On-Demand Document Entry to allow access to the most recently available set of data from a responding community. This example does not show the Gateways interacting with XDS Actors and does not assume that
      XDS is used in any of the communities. This workflow includes persisting each document returned as a result of a retrieve and forming a stable document entry describing the new document which will be returned to future Cross Gateway Query
      requests. The semantics of the response to a retrieve of an On-Demand Document Entry are different than the semantics of the response to retrieval of stable documents. The response to a retrieve of an On-Demand Document Entry contains a new
      uniqueId, different than the uniqueId specified in the request, which is the same as the value within the ClinicalDocument id of the document returned. Use of an appropriate query against that new uniqueId will allow the requestor access to
      updated metadata about the document, including size, hash, etc. This workflow assumes that some change to the underlying data occurs between the time Community A retrieves on-demand document entry #5, and Community C retrieves on-demand
      document entry #5. That is why #6 is not re-used in response to Community C’s request.</p>
    <img src="media/Figure_18.3.3-2.png" alt="" />
    <p class="figureTitle">Figure 18.3.3-2: Dynamically created content with persistence</p>
    <p class="note">Note: Figure 18.3.3-2 is a diagram of a possible interaction, not the required interaction. In particular, the ability of the Responding Gateway to determine whether there is new data available or not is an implementation detail.
      In the case where a Responding Gateway is able to make that determination it should work as presented. If the Responding Gateway is not able to make that determination then it is free to create a new document at every retrieve request.</p>
    <h2 id="18.4">18.4 XCA Security Considerations</h2>
    <h3 id="18.4.1">18.4.1 XCA Risk Assessment</h3>
    <p>The risk analysis for XCA enumerates assets, threats, and mitigations. The complete risk data is stored and maintained in a central location. The complete risk data is stored and may be found in the IHE Google Drive at:
      <a href="https://drive.google.com/open?id=1rFbTkbwY2AfG8VwV62OzYCByHO-PRwJo">XCARiskAnalysis.xls</a>.
    </p>
    <p>
      The purpose of this risk assessment is to notify vendors of some of the risks that they are advised to consider in implementing XCA actors. For general IHE risks and threats please see
      <a href="../Volume1/ch-L.html#Appendix L">ITI TF-1: Appendix L</a>
      . The vendor is also advised that many risks cannot be mitigated by the IHE profile and instead the responsibility for mitigation is transferred to the vendor, and occasionally to the XDS Affinity Domain and enterprises. In these instances,
      IHE fulfills its responsibility to notify affected parties through the following section.
    </p>
    <h3 id="18.4.2">18.4.2 Requirements/Recommendations</h3>
    <p>The following mitigations shall be implemented by all XCA actors. These mitigations moderate all high impact risks.</p>
    <ul>
      <li class="bullet-list1">
        <b>M1</b>: All actors in XCA shall be grouped with an ATNA Secure Node or Secure Application and a CT Time Client.
      </li>
      <li class="bullet-list1">
        <b>M2</b>: Document metadata shall include a SHA1 hash of the document content. Applications shall have the ability to verify the SHA1 hash of the document with the SHA1 hash in the metadata, if corruption detection is requested.
      </li>
      <li class="bullet-list1">
        <b>M3</b>: Document Consumer implementations shall handle overloading through excessive volume of response data by discontinuing the read on the socket and closing it. The Initiating and Responding Gateways shall respond to disconnection by
          discontinuing processing of responses.
      </li>
      <li class="bullet-list1">
        <b>M4</b>: Document Consumer implementations shall not issue a Registry Stored Query that is not patient specific, i.e., it shall either supply a patient identifier or a unique document entry identifier.
      </li>
      <li class="bullet-list1">
        <b>M6</b>: Queries of unknown patient identifiers shall return either zero documents with no further information or XDSUnknownPatientId, depending on local policy. This applies to patient identifiers that are properly formatted or improperly
          formatted. By not using an error code indicating that the identifier is ill formatted, you are able to reduce the ability of applications to fish for data. This applies only to Responding Gateways, if appropriate.</span>
      </li>
    </ul>
    <p>The following mitigations address the risk of a document being maliciously changed. This mitigation is optional.</p>
    <ul>
      <li class="bullet-list1">
        <b>M5</b>
        : Documents may be digitally signed using the DSG Profile
      </li>
    </ul>
    <p>The following mitigations are transferred to the vendors, XDS Affinity Domains, and enterprises.</p>
    <ul>
      <li class="bullet-list1">
        <b>T1</b>: Backup systems for registry metadata, repository documents, and gateway configuration are recommended.
      </li>
      <li class="bullet-list1">
        <b>T2</b>
        : All implementations are recommended to ensure that all received data is propagated appropriately (i.e., without corruption and complete results) or an error is presented.
      </li>
      <li class="bullet-list1">
        <b>T3</b>
        : Network protection services are recommended to be sufficient to guard against denial of service attacks on all service interfaces.
      </li>
      <li class="bullet-list1">
        <b>T4</b>
        : A process that reviews audit records and acts on inappropriate actions is recommended.
      </li>
      <li class="bullet-list1">
        <b>T5</b>
        : It is recommended that service interfaces be implemented with a good design to guard against corruption and denial of service attacks
      </li>
    </ul>
    <h3 id="18.4.3">18.4.3 Policy Choices</h3>
    <p>Policy choices will not be addressed by this profile. Each community may have different policies. The profile has been designed with this fact in mind and an understanding of enough variety of policies so that any reasonable policy can be
      implemented without violating the profile.</p>
        </div>
        </div>
      </main>
    </div>
 <footer class="ihe-footer">
    <div class="grid-container fluid">
      <div class="grid-x grid-margin-x align-middle">
        <div class="cell medium-9 small-order-2 medium-order-1 text-center medium-text-left">
          © 2000 &mdash; <span id="current-year"></span> IHE International | TEL 1-630-481-1004 | 820&nbsp;Jorie&nbsp;Boulevard,
          Oak&nbsp;Brook, IL&nbsp;60523
        </div>
        <div class="cell medium-3 small-order-1 medium-order-2 text-center medium-text-right ihe-footer-icons">
          <a href="mailto:secretary@ihe.net"><i class="fi fi-mail"></i></a>
          <a href="https://www.linkedin.com/company/iheintl"><i class="fi fi-social-linkedin"></i></a>
          <a href="https://twitter.com/IHEIntl"><i class="fi fi-social-twitter" aria-hidden="true"></i></a>
          <a href="https://www.youtube.com/user/IHEIntl"><i class="fi fi-social-youtube" aria-hidden="true"></i></a>
        </div>
      </div>
    </div>
  </footer>
    <script src="../../../js/vendor/jquery.min.js"></script>
    <script src="../../../js/vendor/motion-ui.min.js"></script>
    <script src="../../../js/vendor/what-input.js"></script>
    <script src="../../../js/vendor/foundation.min.js"></script>
    <script src="../../../js/app.js"></script>
  	<script>
	 window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-HLBNC861DJ');
	</script>
</body>

</html>
