<html xmlns="http://www.w3.org/1999/xhtml" lang="en_US">
  <head>
    <meta charset="utf-8" />
    <title>IHE_ITI_TF_Rev16-0_Vol1_FT</title>
    <link rel="stylesheet" href="../css/styles.css" />
  </head>
  <body>
    <p>
      <img src="media/image1.jpeg" class="IHE logo" alt="IHE_LOGO_for_tf-docs" />
    </p>
    <p>IHE IT Infrastructure (ITI)</p>
    <p>Technical Framework</p>
    <p>Revision 16.0 – Final Text</p>
    <p>
      <hr />
    </p>
    <h1 xmlns="" id="26">26    Document Metadata Subscription (DSUB)</h1>
    <p xmlns="">
      <span>This profile describes the use of subscription and notification mechanism for use within an XDS Affinity Domain and across communities. The subscription allows for the matching of metadata during the publication of a new document for a given patient, and results in the delivery of a notification. This profile is based on the OASIS WS-BaseNotification standard and defines a “Push-style” method for notification. Using a “Push-style” method of notification, the</span>
      <span style="font-weight:bold" />
      <span>Document Metadata Subscriber may subscribe on behalf of the Document Metadata Notification Recipient to receive notifications about the availability of documents based on specific criteria. A Document Metadata Notification Broker keeps track of the subscriptions and sends the appropriate notifications based on the registration of objects in an XDS Document Registry. Subscriptions exist for a certain period of time and can be cancelled.</span>
    </p>
    <h2 xmlns="" id="26.1">26.1 DSUB Actors/Transactions</h2>
    <p xmlns="">Figure 26.1-1 shows the actors directly involved in the Document Metadata Subscription Integration Profile and the relevant transactions between them. Other actors that may be indirectly involved due to their participation in the XDS Integration Profile, etc. are not necessarily shown.</p>
    <img xmlns="" src="media/a7222-00r44.096.png" width="532" height="336" alt="" />
    <p xmlns="" class="figureTitle">Figure 26.1-1: Document Metadata Subscription Actor Diagram</p>
    <p xmlns="">Table 26.1-1 lists the transactions for each actor directly involved in the Document Metadata Subscription Profile. In order to claim support of this Integration Profile, an implementation must perform the required transactions (labeled “R”). Transactions labeled “O” are optional. A complete list of options defined by this Integration Profile and that implementations may choose to support is listed in Section 26.2.</p>
    <p xmlns="" class="tableTitle">Table 26.1-1: Document Metadata Subscription Integration Profile - Actors and Transactions</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <thead>
        <tr>
          <td style="width:102.3pt" class="tableHeader">Actors</td>
          <td style="width:155.7pt" class="tableHeader">Transactions</td>
          <td style="width:66.25pt" class="tableHeader">Optionality</td>
          <td style="width:65.7pt" class="tableHeader">Reference</td>
        </tr>
      </thead>
      <tbody>
        <tr style="height:22.1pt">
          <td rowspan="3" style="width:102.3pt">
            <p style="font-size:9pt">
              <span>Document Metadata Notification Broker</span>
            </p>
          </td>
          <td style="width:155.7pt">
            <p style="font-size:9pt">
              <span>Document Metadata Subscribe [ITI-52]</span>
            </p>
          </td>
          <td style="width:66.25pt">
            <p style="font-size:9pt">
              <span>R</span>
            </p>
          </td>
          <td style="width:65.7pt">
            <p style="font-size:9pt">
              <span><a href="../Volume2b/ITI-52.html#3.52">ITI TF-2b: 3.52</a></span>
            </p>
          </td>
        </tr>
        <tr>
          <td style="width:155.7pt">
            <p style="font-size:9pt">
              <span>Document Metadata Notify [ITI-53]</span>
            </p>
          </td>
          <td style="width:66.25pt">
            <p style="font-size:9pt">
              <span>R</span>
            </p>
          </td>
          <td style="width:65.7pt">
            <p style="font-size:9pt">
              <span><a href="../Volume2b/ITI-53.html#3.53">ITI TF-2b: 3.53</a></span>
            </p>
          </td>
        </tr>
        <tr>
          <td style="width:155.7pt">
            <p style="font-size:9pt">
              <span>Document Metadata Publish [ITI-54]</span>
            </p>
          </td>
          <td style="width:66.25pt">
            <p style="font-size:9pt">
              <span>O</span>
            </p>
          </td>
          <td style="width:65.7pt">
            <p style="font-size:9pt">
              <span><a href="../Volume2b/ITI-54.html#3.54">ITI TF-2b: 3.54</a></span>
            </p>
          </td>
        </tr>
        <tr style="height:30.2pt">
          <td style="width:102.3pt">
            <p style="font-size:9pt">
              <span>Document Metadata Subscriber</span>
            </p>
          </td>
          <td style="width:155.7pt">
            <p style="font-size:9pt">
              <span>Document Metadata Subscribe [ITI-52]</span>
            </p>
          </td>
          <td style="width:66.25pt">
            <p style="font-size:9pt">
              <span>R</span>
            </p>
          </td>
          <td style="width:65.7pt">
            <p style="font-size:9pt">
              <span><a href="../Volume2b/ITI-52.html#3.52">ITI TF-2b: 3.52</a></span>
            </p>
          </td>
        </tr>
        <tr style="height:24.8pt">
          <td style="width:102.3pt">
            <p style="font-size:9pt">
              <span>Document Metadata Publisher</span>
            </p>
          </td>
          <td style="width:155.7pt">
            <p style="font-size:9pt">
              <span>Document Metadata Publish [ITI-54]</span>
            </p>
          </td>
          <td style="width:66.25pt">
            <p style="font-size:9pt">
              <span>R</span>
            </p>
          </td>
          <td style="width:65.7pt">
            <p style="font-size:9pt">
              <span><a href="../Volume2b/ITI-54.html#3.54">ITI TF-2b: 3.54</a></span>
            </p>
          </td>
        </tr>
        <tr style="height:30.65pt">
          <td style="width:102.3pt">
            <p style="font-size:9pt">
              <span>Document Metadata Notification Recipient</span>
            </p>
          </td>
          <td style="width:155.7pt">
            <p style="font-size:9pt">
              <span>Document Metadata Notify [ITI-53]</span>
            </p>
          </td>
          <td style="width:66.25pt">
            <p style="font-size:9pt">
              <span>R</span>
            </p>
          </td>
          <td style="width:65.7pt">
            <p style="font-size:9pt">
              <span><a href="../Volume2b/ITI-53.html#3.53">ITI TF-2b: 3.53</a></span>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p xmlns=""> </p>
    <h3 xmlns="" id="26.1.1">26.1.1 Actor Descriptions and Actor Profile Requirements</h3>
    <p xmlns="">Most requirements are documented in Transactions (Volume 2). This section documents any additional requirements on profile’s actors</p>
    <h4 xmlns="" id="26.1.1.1">26.1.1.1 Document Metadata Notification Broker</h4>
    <p xmlns="">The Document Metadata Notification Broker is the receiver of the Document Metadata Subscribe transaction containing a subscription request, or a subscription cancellation. It keeps track of all subscriptions it receives, including the time limits of subscriptions. Based on the metadata associated with document registrations, this actor sends notifications to interested subscribers. This actor may optionally receive Document Metadata Publish transactions representing the stream of events against which the existing subscriptions are matched.</p>
    <h4 xmlns="" id="26.1.1.2">26.1.1.2 Document Metadata Subscriber</h4>
    <p xmlns="">The Document Metadata Subscriber initiates and terminates subscriptions on behalf of a Document Metadata Notification Recipient.</p>
    <h4 xmlns="" id="26.1.1.3">26.1.1.3 Document Metadata Publisher</h4>
    <p xmlns="">The Document Metadata Publisher sends a Document Metadata Publish transaction to the Document Metadata Notification Broker when an event occurs for which a subscription may exist. This profile does not specify how the Document Metadata Publisher becomes aware of those events.</p>
    <h4 xmlns="" id="26.1.1.4">26.1.1.4 Document Metadata Notification Recipient</h4>
    <p xmlns="">The Document Metadata Notification Recipient receives the notification about an event, when the subscription filters specified for this Document Metadata Notification Recipient are satisfied.</p>
    <h2 xmlns="" id="26.2">26.2 DSUB Actor Options</h2>
    <p xmlns="">Options that may be selected for this Integration Profile are listed in the Table 26.2-1 along with the actors to which they apply. Dependencies between options when applicable are specified in notes.</p>
    <p xmlns="" class="tableTitle">Table 26.2-1: Document Metadata Subscription - Actors and Options</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <tr>
        <td style="width:158.9pt" class="tableHeader">
          <p style="font-size:10pt">
            <span style="font-weight:bold">Actor</span>
          </p>
        </td>
        <td style="width:130.55pt" class="tableHeader">
          <p style="font-size:10pt">
            <span style="font-weight:bold">Option Name</span>
          </p>
        </td>
        <td style="width:75.2pt" class="tableHeader">
          <p style="font-size:10pt">
            <span style="font-weight:bold">Vol. &amp; Section</span>
          </p>
        </td>
      </tr>
      <tr style="height:16.6pt">
        <td style="width:158.9pt">
          <p style="font-size:9pt">
            <span>Document Metadata Notification Broker</span>
          </p>
        </td>
        <td style="width:130.55pt">
          <p style="font-size:9pt">
            <span>Document Metadata Publish Recipient</span>
          </p>
        </td>
        <td style="width:75.2pt">
          <p style="font-size:9pt">
            <span><a href="../Volume1/ch-26.html#26.2.1">ITI TF-1: 26.2.1</a></span>
          </p>
        </td>
      </tr>
      <tr style="height:11.65pt">
        <td style="width:158.9pt">
          <p style="font-size:9pt">
            <span>Document Metadata Subscriber</span>
          </p>
        </td>
        <td style="width:130.55pt">
          <p style="font-size:9pt">
            <span>No options defined</span>
          </p>
        </td>
        <td style="width:75.2pt">
          <h6>
            <span> </span>
            <span>- -</span>
          </h6>
        </td>
      </tr>
      <tr style="height:26.05pt">
        <td style="width:158.9pt">
          <p style="font-size:9pt">
            <span>Document Metadata Publisher</span>
          </p>
        </td>
        <td style="width:130.55pt">
          <p style="font-size:9pt">
            <span>No options defined</span>
          </p>
        </td>
        <td style="width:75.2pt">
          <p style="font-size:9pt">
            <span>- -</span>
          </p>
        </td>
      </tr>
      <tr style="height:26.05pt">
        <td style="width:158.9pt">
          <p style="font-size:9pt">
            <span>Document Metadata Notification Recipient</span>
          </p>
        </td>
        <td style="width:130.55pt">
          <p style="font-size:9pt">
            <span>No options defined</span>
          </p>
        </td>
        <td style="width:75.2pt">
          <p style="font-size:9pt">
            <span>- -</span>
          </p>
        </td>
      </tr>
    </table>
    <p xmlns=""> </p>
    <h3 xmlns="" id="26.2.1">26.2.1 Document Metadata Publish Recipient Option</h3>
    <p xmlns="">The Document Metadata Notification Broker that supports this option shall accept and process Document Metadata Publish transactions.</p>
    <h2 xmlns="" id="26.3">26.3 DSUB Required Actor Groupings</h2>
    <p xmlns="">
      <span>An actor from this profile (Column 1) shall implement all of the required transactions and/or content modules in this profile</span>
      <span style="font-weight:bold;font-style:italic">in addition to</span>
      <span>all of the transactions required for the grouped actor (Column 2).</span>
    </p>
    <p xmlns="" class="tableTitle">Table 26.3-1: DSUB - Required Actor Groupings</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <thead>
        <tr>
          <td style="width:87.15pt" class="tableHeader">DSUB Actor</td>
          <td style="width:146pt" class="tableHeader">Profile/Actor to be grouped with</td>
          <td style="width:55.65pt" class="tableHeader">Reference</td>
        </tr>
      </thead>
      <tbody>
        <tr style="height:16.6pt">
          <td rowspan="2" style="width:87.15pt">
            <p style="font-size:9pt">
              <span>Document Metadata Notification Broker</span>
            </p>
          </td>
          <td style="width:146pt">
            <p style="font-size:9pt">
              <span>ATNA / Secure Node or Secure Application</span>
            </p>
          </td>
          <td style="width:55.65pt">
            <p style="font-size:9pt">
              <span><a href="../Volume1/ch-9.html#9.4">ITI TF-1: 9.4</a></span>
            </p>
          </td>
        </tr>
        <tr style="height:16.6pt">
          <td style="width:146pt">
            <p style="font-size:9pt">
              <span>CT / Time Client</span>
            </p>
          </td>
          <td style="width:55.65pt">
            <p style="font-size:9pt">
              <span><a href="../Volume1/ch-7.html#7.1">ITI TF-1: 7.1</a></span>
            </p>
          </td>
        </tr>
        <tr style="height:16.6pt">
          <td rowspan="2" style="width:87.15pt">
            <p style="font-size:9pt">
              <span>Document Metadata Subscriber</span>
            </p>
          </td>
          <td style="width:146pt">
            <p style="font-size:9pt">
              <span>ATNA / Secure Node or Secure Application</span>
            </p>
          </td>
          <td style="width:55.65pt">
            <p style="font-size:9pt">
              <span><a href="../Volume1/ch-9.html#9.4">ITI TF-1: 9.4</a></span>
            </p>
          </td>
        </tr>
        <tr style="height:16.6pt">
          <td style="width:146pt">
            <p style="font-size:9pt">
              <span>CT / Time Client</span>
            </p>
          </td>
          <td style="width:55.65pt">
            <p style="font-size:9pt">
              <span><a href="../Volume1/ch-7.html#7.1">ITI TF-1: 7.1</a></span>
            </p>
          </td>
        </tr>
        <tr style="height:16.6pt">
          <td rowspan="2" style="width:87.15pt">
            <p style="font-size:9pt">
              <span>Document Metadata Publisher</span>
            </p>
          </td>
          <td style="width:146pt">
            <p style="font-size:9pt">
              <span>ATNA / Secure Node or Secure Application</span>
            </p>
          </td>
          <td style="width:55.65pt">
            <p style="font-size:9pt">
              <span><a href="../Volume1/ch-9.html#9.4">ITI TF-1: 9.4</a></span>
            </p>
          </td>
        </tr>
        <tr style="height:16.6pt">
          <td style="width:146pt">
            <p style="font-size:9pt">
              <span>CT / Time Client</span>
            </p>
          </td>
          <td style="width:55.65pt">
            <p style="font-size:9pt">
              <span><a href="../Volume1/ch-7.html#7.1">ITI TF-1: 7.1</a></span>
            </p>
          </td>
        </tr>
        <tr style="height:16.6pt">
          <td rowspan="2" style="width:87.15pt">
            <p style="font-size:9pt">
              <span>Document Metadata Notification Recipient</span>
            </p>
          </td>
          <td style="width:146pt">
            <p style="font-size:9pt">
              <span>ATNA / Secure Node or Secure Application</span>
            </p>
          </td>
          <td style="width:55.65pt">
            <p style="font-size:9pt">
              <span><a href="../Volume1/ch-9.html#9.4">ITI TF-1: 9.4</a></span>
            </p>
          </td>
        </tr>
        <tr style="height:16.6pt">
          <td style="width:146pt">
            <p style="font-size:9pt">
              <span>CT / Time Client</span>
            </p>
          </td>
          <td style="width:55.65pt">
            <p style="font-size:9pt">
              <span><a href="../Volume1/ch-7.html#7.1">ITI TF-1: 7.1</a></span>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <h2 xmlns="" id="26.4">26.4 DSUB Overview</h2>
    <h3 xmlns="" id="26.4.1">26.4.1 Concepts</h3>
    <p xmlns="">This profile describes the use of subscription and notification mechanisms for use within an XDS Affinity Domain and across communities. The subscription allows for the matching of metadata during the publication of a new document for a given patient, and results in the delivery of a notification.</p>
    <p xmlns="">If a system can implement the Document Metadata Notification Recipient, it can be directly notified using a push-style method.</p>
    <h3 xmlns="" id="26.4.2">26.4.2 Use Cases</h3>
    <h4 xmlns="" id="26.4.2.1">26.4.2.1 Use Case #1:  Unexpected Notification</h4>
    <h5 xmlns="" id="26.4.2.1.1">26.4.2.1.1 Unexpected Notification Use Case Description</h5>
    <p xmlns="">A patient in the emergency department has all her relevant available documents retrieved via XDS transactions. As initial triage of the patient is done, an additional document regarding diagnostic results for this patient is registered in the XDS Document Registry. Currently, there is no way for the Emergency department to learn about the existence of this new information. With a publish/subscribe infrastructure, the initial query to the XDS Document Registry would be accompanied with a subscription request, as a result of which a notification would be sent to the emergency department. The subscription will be terminated once the patient is no longer under the care of the emergency department's institution.</p>
    <h5 xmlns="" id="26.4.2.1.2">26.4.2.1.2 Unexpected Notification Process Flow</h5>
    <img xmlns="" src="media/a7222-00r44.097.png" width="454" height="456" alt="" />
    <p xmlns="" class="figureTitle">Figure 26.4.2.1.2-1: Interaction Diagram for Unexpected Notification Use Case</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <tr>
        <td style="width:464.2pt">
          <p style="font-size:10pt">
            <span>participant "Document \n Metadata \n Publisher" as publisher</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Metadata \n Subscriber" as subscriber</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Metadata \n Notification \n Broker" as notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Metadata \n Notification \n Recipient" as recipient</span>
          </p>
          <p style="font-size:10pt">
            <span>subscriber-&gt;+notificationbroker:Subscribe</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>publisher-&gt;+notificationbroker:Publish</span>
          </p>
          <p style="font-size:10pt">
            <span>notificationbroker-&gt;+recipient:Notify</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate recipient</span>
          </p>
          <p style="font-size:10pt">
            <span>publisher-&gt;+notificationbroker:Publish</span>
          </p>
          <p style="font-size:10pt">
            <span>notificationbroker-&gt;+recipient:Notify</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate recipient</span>
          </p>
          <p style="font-size:10pt">
            <span>subscriber-&gt;+notificationbroker:Unsubscribe</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>publisher-&gt;+notificationbroker:Publish</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate notificationbroker</span>
          </p>
        </td>
      </tr>
    </table>
    <p xmlns="" class="figureTitle">Figure 26.4.2.1.2-2: Websequence diagrams code related to Figure 26.4.2.1.2-1</p>
    <h4 xmlns="" id="26.4.2.2">26.4.2.2 Use Case #2: Long-term Subscription</h4>
    <h5 xmlns="" id="26.4.2.2.1">26.4.2.2.1 Long-term Subscription Use Case Description</h5>
    <p xmlns="">A patient visits his PCP after being discharged from a hospital that belongs to the same XDS Affinity Domain as the provider's organization. The provider sends a query to the XDS Document Registry, and retrieves the hospital discharge summary. The patient also has follow-up visits with a specialist at the hospital, and these visit summaries (including diagnostic test results) are registered in the XDS Document Registry. Currently, the PCP would have to periodically query the Document Registry for documents about the patient in order to retrieve the follow-up visit summaries. With a publish/subscribe infrastructure, the PCP would have a subscription for all his patients, so that notifications would have been received as the summaries were registered in the XDS Document Registry.</p>
    <h5 xmlns="" id="26.4.2.2.2">26.4.2.2.2 Long-term Subscription Process Flow</h5>
    <img xmlns="" src="media/a7222-00r44.098.png" width="454" height="404" alt="" />
    <p xmlns="" class="figureTitle">Figure 26.4.2.2.2-1: Interaction Diagram for Long-term Subscription Use Case</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <tr>
        <td style="width:464.2pt">
          <p style="font-size:10pt">
            <span>participant "Document \n Metadata \n Publisher" as publisher</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Metadata \n Subscriber" as subscriber</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Metadata \n Notification \n Broker" as notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Metadata \n Notification \n Recipient" as recipient</span>
          </p>
          <p style="font-size:10pt">
            <span>subscriber-&gt;+notificationbroker:Subscribe</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>publisher-&gt;+notificationbroker:Publish</span>
          </p>
          <p style="font-size:10pt">
            <span>notificationbroker-&gt;+recipient:Notify</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate recipient</span>
          </p>
          <p style="font-size:10pt">
            <span>publisher-&gt;+notificationbroker:Publish</span>
          </p>
          <p style="font-size:10pt">
            <span>notificationbroker-&gt;+recipient:Notify</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate recipient</span>
          </p>
        </td>
      </tr>
    </table>
    <p xmlns="" class="figureTitle">Figure 26.4.2.2.2-2: Websequence diagram code related to Figure 26.4.2.2.2-1</p>
    <h4 xmlns="" id="26.4.2.3">26.4.2.3 Use Case #3: Antepartum Record Availability</h4>
    <h5 xmlns="" id="26.4.2.3.1">26.4.2.3.1 Long-term Subscription Use Case Description</h5>
    <p xmlns="">From the set of Antepartum Record Profiles in the PCC domain:</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <tr>
        <td>
          <p>
            <span>During the 40 weeks of a typical pregnancy duration, the patient will have an initial History and Physical Examination, followed by repetitive office visits with multiple laboratory studies, imaging (usually ultrasound) studies, and serial physical examinations with recordings of vital signs, fundal height, and the fetal heart rate. As the patient is seen over a finite period in the office, aggregation of specific relevant data important to the evaluation of the obstetric patient upon presentation to Labor and Delivery is captured on paper forms. The antepartum documents contain the most critical information needed including the ongoing Medical Diagnoses, the Estimated Due Date, outcomes of any prior pregnancies, serial visit data on the appropriate growth of the uterus and assessments of fetal well-being, authorizations, laboratory and imaging studies. This data must all be presented and evaluated upon entry to the Labor and Delivery Suite to ensure optimal care for the patient and the fetus.</span>
          </p>
        </td>
      </tr>
    </table>
    <p xmlns="">The ability of the PCC Content Consumer to establish a subscription for the updates to the antepartum documents for a given expectant mother will enhance the ability to automate the delivery of the information in a timely manner.</p>
    <h5 xmlns="" id="26.4.2.3.2">26.4.2.3.2 Long-term Subscription Use Case Process Flow</h5>
    <p xmlns="">The following diagram illustrates the process flow within an XDS Affinity Domain reflecting the use case presented in Section 26.4.2.3.1:</p>
    <p xmlns="">
      <img src="media/a7222-00r44.099.png" width="624" height="648" alt="" />
      <span />
    </p>
    <p xmlns="" class="figureTitle">Figure 26.4.2.3.2-1: Interaction diagram for Long-term Subscription Use Case</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <tr>
        <td style="width:464.2pt">
          <p style="font-size:10pt">
            <span>participant "Document \n Consumer" as consumer</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Notification \n Recipient" as recipient</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Subscriber" as subscriber</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "EHR" as ehr</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Integrated \n Publisher/ \n Notification \n Broker" as notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Registry" as registry</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Repository" as repository</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Source" as source</span>
          </p>
          <p style="font-size:10pt">
            <span>note over consumer, recipient, subscriber,ehr:</span>
          </p>
          <p style="font-size:10pt">
            <span>Hospital EHR - Dept. of</span>
          </p>
          <p style="font-size:10pt">
            <span>Labor and Delivery</span>
          </p>
          <p style="font-size:10pt">
            <span>end note</span>
          </p>
          <p style="font-size:10pt">
            <span>note over notificationbroker, registry, repository:</span>
          </p>
          <p style="font-size:10pt">
            <span>HIE</span>
          </p>
          <p style="font-size:10pt">
            <span>end note</span>
          </p>
          <p style="font-size:10pt">
            <span>note over source:</span>
          </p>
          <p style="font-size:10pt">
            <span>OBGYN Office</span>
          </p>
          <p style="font-size:10pt">
            <span>EHR</span>
          </p>
          <p style="font-size:10pt">
            <span>end note</span>
          </p>
          <p style="font-size:10pt">
            <span>source-&gt;+repository:Initial ObGyn visit summary \n Provide an Register \n [ITI-41]</span>
          </p>
          <p style="font-size:10pt">
            <span>repository-&gt;+registry:Register \n [ITI-42]</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate repository</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate registry</span>
          </p>
          <p style="font-size:10pt">
            <span>ehr-&gt;+ehr:Future mother entered in \n system for upcoming \n labor and delivery</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate ehr</span>
          </p>
          <p style="font-size:10pt">
            <span>subscriber-&gt;+notificationbroker:Subscribe for this patient ID \n Document Metadata Subscribe \n [ITI-52]</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>consumer-&gt;+registry:Initial Stored Query for existing document about this patient [ITI-18]</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate registry</span>
          </p>
          <p style="font-size:10pt">
            <span>consumer-&gt;+repository:Retrieve Document Set as a result of Initial Stored Query [ITI-43]</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate repository</span>
          </p>
          <p style="font-size:10pt">
            <span>source-&gt;+repository:Subsequent ObGyn visit \n summary Provide and \n Register [ITI-41]</span>
          </p>
          <p style="font-size:10pt">
            <span>repository-&gt;+registry:Register [ITI-42]</span>
          </p>
          <p style="font-size:10pt">
            <span>registry--&gt;+notificationbroker:Internal \n interaction</span>
          </p>
          <p style="font-size:10pt">
            <span>notificationbroker-&gt;+recipient:Notification of new document(s) \n being available \n Document Metadata Notify [ITI-53]</span>
          </p>
          <p style="font-size:10pt">
            <span>recipient--&gt;+consumer:Internal \n interaction</span>
          </p>
          <p style="font-size:10pt">
            <span>consumer-&gt;repository:Retrieve Document Set as a result of the Notify [ITI-53] \n [ITI-43]</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate repository</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate registry</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate recipient</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate consumer</span>
          </p>
          <p style="font-size:10pt">
            <span>note over consumer, recipient, subscriber, EHR, notificationbroker, registry, repository, source</span>
          </p>
          <p style="font-size:10pt">
            <span>Multiple new documents may become available, repeating these steps</span>
          </p>
          <p style="font-size:10pt">
            <span>end note</span>
          </p>
          <p style="font-size:10pt">
            <span>ehr-&gt;+ehr:Successful \n delivery</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate ehr</span>
          </p>
          <p style="font-size:10pt">
            <span>subscriber-&gt;+notificationbroker:Unsubscribe [ITI-52]</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate notificationbroker</span>
          </p>
        </td>
      </tr>
    </table>
    <p xmlns="" class="figureTitle">Figure 26.4.2.3.2-2: Websequence diagram code related to Figure 26.4.2.3.2-1</p>
    <p xmlns="">The above interaction diagram is showing a grouping of a Document Consumer, a Document Metadata Notification Recipient, and a Document Metadata Subscriber on one side, and a grouping of a Document Registry, a Document Repository and an Integrated Document Metadata Publisher/Notification Broker on the other side. The emphasized transactions are described in this profile, while the interactions with the grouped XDS actors are also shown. Note that the grouping presented here is not required.</p>
    <h4 xmlns="" id="26.4.2.4">26.4.2.4 Use Case #4: Targeted Document Publication</h4>
    <p xmlns="">In this use case, a system desires to subscribe to a submissionSet with a specific intended recipient of clinical information. A source of clinical content can identify the intended target for a submissionSet using the XDSSubmissionSet.IntendedRecipient metadata attribute.</p>
    <h5 xmlns="" id="26.4.2.4.1">26.4.2.4.1 Targeted Document Publication Use Case Description</h5>
    <p xmlns="">Dr. Brown is a clinician and can request exams for many patients. His system can create a subscription for documents produced that are intended for him (the subscription created has the intendedRecipient as filter parameter).</p>
    <p xmlns="">Mr. White attends a consultation with Dr. Brown, who requests a Laboratory Report for the patient. The EMR system creates a subscription with an intendedRecipient of Dr. Brown.</p>
    <p xmlns="">The patient receives the exam in a Clinical Laboratory. The Laboratory Information System produces a report and submits the document in the Document Sharing Infrastructure identifying Dr. Brown as intendedRecipient for the submission. This publishing event matches the existing subscription and a notification is sent by the Document Metadata Notification Broker to Dr. Brown’s system (identified as Document Metadata Notification Recipient in the subscription created). Dr. Brown can quickly analyze the report published and can make other clinical decisions in an efficient way.</p>
    <h5 xmlns="" id="26.4.2.4.2">26.4.2.4.2 Targeted Document Publication Process Flow</h5>
    <img xmlns="" src="media/a7222-00r44.100.png" width="624" height="422" alt="" />
    <p xmlns="" class="figureTitle">Figure 26.4.2.4.2-1: Interaction Diagram for IntendedRecipient subscription</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <tr>
        <td style="width:464.2pt">
          <p style="font-size:10pt">
            <span>participant "Document \n Metadata \n Subscriber" as subscriber</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Metadata \n Notification \n Recipient" as recipient</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Consumer" as consumer</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Source" as source</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Integrated \n Publisher/ \n Notification \n Broker" as notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "XDS \n Document \n Registry" as registry</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "XDS \n Document \n Repository" as repository</span>
          </p>
          <p style="font-size:10pt">
            <span>note over subscriber, recipient, consumer:</span>
          </p>
          <p style="font-size:10pt">
            <span>Clinician EMR</span>
          </p>
          <p style="font-size:10pt">
            <span>end note</span>
          </p>
          <p style="font-size:10pt">
            <span>note over source:</span>
          </p>
          <p style="font-size:10pt">
            <span>Laboratory \n Information \n System</span>
          </p>
          <p style="font-size:10pt">
            <span>end note</span>
          </p>
          <p style="font-size:10pt">
            <span>note over notificationbroker, registry, repository:</span>
          </p>
          <p style="font-size:10pt">
            <span>RHIO</span>
          </p>
          <p style="font-size:10pt">
            <span>end note</span>
          </p>
          <p style="font-size:10pt">
            <span>subscriber-&gt;+notificationbroker:Document Metadata Subscribe [ITI-52] \n Parameters: PatientID=Mr.White, intendedRecipient=Dr.Brown</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>source-&gt;+repository:Provide and Register Document Set-b [ITI-41] \n metadata: submissionSet.intendedRecipient=Dr.Brown</span>
          </p>
          <p style="font-size:10pt">
            <span>repository-&gt;+registry:Register Document Set-b [ITI-42]</span>
          </p>
          <p style="font-size:10pt">
            <span>registry--&gt;+notificationbroker:Internal transaction</span>
          </p>
          <p style="font-size:10pt">
            <span>notificationbroker-&gt;+recipient:Document Metadata Notify [ITI-53]</span>
          </p>
          <p style="font-size:10pt">
            <span>recipient--&gt;+consumer:Internal transaction</span>
          </p>
          <p style="font-size:10pt">
            <span>consumer-&gt;registry:Registry Stored Query [ITI-18]</span>
          </p>
          <p style="font-size:10pt">
            <span>consumer-&gt;repository:Retrieve Document Set-b [ITI-43]</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate repository</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate registry</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate notificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate recipient</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate consumer</span>
          </p>
        </td>
      </tr>
    </table>
    <p xmlns="" class="figureTitle">Figure 26.4.2.4.2-2: Websequence diagram code related to Figure 26.4.2.4.2-1</p>
    <h4 xmlns="" id="26.4.2.5">26.4.2.5 Use Case #5: Workflow Id subscription</h4>
    <p xmlns="">In this use case a clinician creates a subscription for a specific instance of workflow (e.g., eReferral Workflow) because he wants to be notified of any updates that occurred to the workflow. The workflow Id is stored in the metadata XDSDocumentEntry.ReferenceIdList.</p>
    <h5 xmlns="" id="26.4.2.5.1">26.4.2.5.1 Workflow Id subscription Use Case Description</h5>
    <p xmlns="">Dr. Brown is a GP. He decides to refer his patient Mr. White to another healthcare provider to have a specialist’s consultation. Dr. Brown does not take part in subsequent steps of the Referral process, but he wants to be notified of any relevant progress related to the workflow. Mr. White calls the specialist, Dr. Green, to schedule the specialist consultation. Dr. Brown is notified of this event.</p>
    <p xmlns="">On the day of the visit, the patient is admitted in Dr. Green’s office. Dr. Green analyzes the referral request created by Dr. White and any useful Clinical Documents related to the request. When the visit is completed, Dr. Green publishes a report and Dr. Brown is notified of the completion of the eReferral process so that he can analyze the whole workflow and all related documents.</p>
    <h6 xmlns="" id="26.4.2.5.1.1">26.4.2.5.1.1 Technical Aspects (Workflow Id and XDSDocumentEntry ReferenceIdList subscription)</h6>
    <p xmlns="">The eReferral process is managed and tracked by the creation of a specific Workflow Document (e.g., as defined in the IHE PCC Cross-enterprise Basic eReferral Workflow Definition Profile (XBeR-WD)). The Workflow Document has a unique fixed reference, the workflow Id, which is stored in the XDSDocumentEntry.ReferenceIdList metadata.</p>
    <p xmlns="">The GP’s system creates this Workflow Document and a related subscription that identifies the specific workflow Id as filter parameter for the creation of notifications. From this time, any update of the workflow document will result in the creation and the delivery of a notification to the GP, because the Workflow Id remains the same during the whole evolution of the workflow. For example, the scheduling phase involves the creation of a new version of the Workflow Document characterized by the same workflow Id. This scheduling event triggers the creation of a notification that is sent to the GP.</p>
    <p xmlns="">The execution of the visit involves another update of the workflow document and, as consequence, a new notification is sent to the GP.</p>
    <p xmlns="">This notification framework allows the GP to be active participant in the process started by him.</p>
    <h5 xmlns="" id="26.4.2.5.2">26.4.2.5.2 Workflow Id subscription Process Flow</h5>
    <img xmlns="" src="media/a7222-00r44.101.png" width="624" height="417" alt="" />
    <p xmlns="" class="figureTitle">Figure 26.4.2.5.2-1: Interaction Diagram for Workflow Id subscription Use Case</p>
    <table xmlns="" cellspacing="0" cellpadding="0">
      <tr>
        <td style="width:464.2pt">
          <p style="font-size:10pt">
            <span>participant "Document \n Metadata \n Subscriber \n ------------------ \n Document \n Metadata \n Notification \n Recipient" as subscriberrecipient</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Consumer \n ------------------ \n XDW Content \n Consumer" as consumerXDW</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Source \n (EHR)" as sourceEHR</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "XDW Content \n Creator" as XDWcreator</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Consumer" as documentconsumer</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "XDW Content \n Updater" as XDWupdater</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document Source \n (HIS)" as sourceHIS</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Repository" as documentrepository</span>
          </p>
          <p style="font-size:10pt">
            <span>participant "Document \n Registry \n ---------------- \n Document \n Metadata \n Notification \n Broker" as registrynotificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>note over subscriberrecipient, consumerXDW, sourceEHR, XDWcreator</span>
          </p>
          <p style="font-size:10pt">
            <span>Clinician EHR</span>
          </p>
          <p style="font-size:10pt">
            <span>end note</span>
          </p>
          <p style="font-size:10pt">
            <span>note over documentconsumer, XDWupdater, sourceHIS</span>
          </p>
          <p style="font-size:10pt">
            <span>HIS</span>
          </p>
          <p style="font-size:10pt">
            <span>end note</span>
          </p>
          <p style="font-size:10pt">
            <span>note over documentrepository, registrynotificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>Regional EHR</span>
          </p>
          <p style="font-size:10pt">
            <span>end note</span>
          </p>
          <p style="font-size:10pt">
            <span>XDWcreator--&gt;+sourceEHR:Internal Transaction</span>
          </p>
          <p style="font-size:10pt">
            <span>sourceEHR-&gt;+documentrepository:[ITI-41] Provide and Register Document Set-b \n (WD, eReferral)</span>
          </p>
          <p style="font-size:10pt">
            <span>documentrepository-&gt;+registrynotificationbroker:[ITI-42] Register Document Set-b</span>
          </p>
          <p style="font-size:10pt">
            <span>subscriberrecipient-&gt;registrynotificationbroker:[ITI-52] Document Metadata Subscribe ($DocumentEntryReferenceIdList=workflow Id)</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate sourceEHR</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate documentrepository</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate registrynotificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>XDWupdater--&gt;+sourceHIS:Internal Transaction</span>
          </p>
          <p style="font-size:10pt">
            <span>sourceHIS-&gt;+documentrepository:[ITI-41] Provide and Register \n Document Set-b \n (WD, Report)</span>
          </p>
          <p style="font-size:10pt">
            <span>documentrepository-&gt;+registrynotificationbroker:[ITI-42] Register Document Set-b</span>
          </p>
          <p style="font-size:10pt">
            <span>registrynotificationbroker-&gt;+subscriberrecipient:[ITI-53] Document Metadata Notify</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate sourceHIS</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate documentrepository</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate registrynotificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate subscriberrecipient</span>
          </p>
          <p style="font-size:10pt">
            <span>consumerXDW-&gt;+registrynotificationbroker:[ITI-18] Registry Stored Query (FindDocumentsByReferenceId)</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate registrynotificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>consumerXDW-&gt;+documentrepository:[ITI-43] Retrieve Document Set-b</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate documentrepository</span>
          </p>
          <p style="font-size:10pt">
            <span>consumerXDW-&gt;+registrynotificationbroker:[ITI-18] Registry Stored Query (GetDocuments)</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate registrynotificationbroker</span>
          </p>
          <p style="font-size:10pt">
            <span>consumerXDW-&gt;+documentrepository:[ITI-43] Retrieve Document Set-b</span>
          </p>
          <p style="font-size:10pt">
            <span>deactivate documentrepository</span>
          </p>
        </td>
      </tr>
    </table>
    <p xmlns="" class="figureTitle">Figure 26.4.2.5.2-2: Websequence diagram code related to Figure 26.4.2.5.2-1</p>
    <h2 xmlns="" id="26.5">26.5 DSUB Security Considerations</h2>
    <p xmlns="">
      <span>The risk analysis for this profile enumerates assets, threats, and mitigations. The risk assessment spreadsheet is stored and available from IHE at .</span>
      <a href="http://wiki.ihe.net/images/4/46/DSUB_risk_assesment.xls" style="text-decoration:none">
        <span style="text-decoration:underline">http://wiki.ihe.net/images/4/46/DSUB_risk_assesment.xls</span>
      </a>
    </p>
    <p xmlns="">The purpose of this risk assessment is to notify implementers of some of the risks that they need to consider in implementing DSUB actors. For general IHE risks and threats please see <a href="../Volume1/ch-49.html#Appendix L">ITI TF-1: Appendix L</a>. The implementers are also advised that many risks cannot be mitigated by the IHE profile and instead the responsibility for mitigation is transferred to the implementer, and occasionally to the XDS Affinity Domain and enterprises. In these instances, IHE’s responsibility to notify affected parties is fulfilled through the following section.</p>
    <p xmlns="">A policy decision can be made during the Subscribe transaction, whether the subscription is an authorized subscription and whether a notification/type of notification is authorized. (This could be based on the XUA identity, the consumer address value, etc.)</p>
    <p xmlns="">This profile does not include the solution to changes of policy between the subscribe time and notify time (which can be substantial). The recommendation is that the policy is enforced conservatively (i.e., the length of subscription can be determined by the Document Metadata Notification Broker). An approach allows the access of content published in accordance to consent given by the patient. The consent is dynamic and can change during time. The availability of content can be discovered only asking the document-sharing infrastructure. The creation of subscription is not dependent to access policies rules. If the Document Metadata Notification Broker sends the references, then the control of access policies is in query/retrieve transactions of the Document Metadata Notification Recipient.</p>
    <p xmlns="">Specific security considerations are presented in the Security Considerations section of each transaction in Volume 2.</p>
    <h2 xmlns="" id="26.6">26.6 DSUB Cross Profile Considerations</h2>
    <p xmlns="">Within an XDS Affinity Domain:</p>
    <ul xmlns="" type="disc" style="margin:0pt; padding-left:0pt">
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>the Document Metadata Notification Broker will most likely be grouped with a Document Registry</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>the Document Metadata Subscriber will most likely be grouped with a Document Consumer</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>the Document Metadata Publisher will most likely be grouped with a Document Registry</span>
      </li>
      <li style="margin-top:6pt;margin-left:28.52pt;padding-left:7.48pt">
        <span>the Document Metadata Notification Recipient will likely be grouped with a Document Consumer</span>
      </li>
    </ul>
  </body>
</html>
