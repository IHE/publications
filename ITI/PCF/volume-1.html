<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>IHE.ITI.PCF\1:53 Privacy Consent on FHIR - FHIR v4.3.0</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>

    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  	<link href="assets/css/prism.css" rel="stylesheet" />
    <!-- Placeholder for child template CSS declarations -->
<link href="assets/css/ihe.css" rel="stylesheet"/>
<link href="assets/css/nonum.css" rel="stylesheet"/>
<script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-HLBNC861DJ" async> </script> 


    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png"/>
    <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>

    <style type="text/css">h2{--heading-prefix:"2"}
    h3,h4,h5,h6{--heading-prefix:"2"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->
        <!-- Placeholder for child template header declarations -->

<div id="project-nav">
  <a id="ihe-logo" no-external="true" href="http://profiles.ihe.net">
    <img height="71" alt="Visit the IHE website" src="assets/images/ihe-international.png"/>
  </a>
</div>
<div id="family-nav">
  <a id="family-logo" no-external="true" href="http://hl7.org/fhir"><img height="30" alt="Visit the FHIR website" src="assets/images/fhir-logo.png"/> </a>
</div>
<!--
<div id="hl7-search">
  <a id="hl7-search-lnk" no-external="true" href="searchform.html"><img alt="Search FHIR" src="assets/images/search.png"/></a>
</div>
-->
<div id="project-nav">
  
  
    <a id="project-logo" no-external="true" href="http://profiles.ihe.net/ITI/index.html"><img height="70" alt="Visit the ITI website" src="assets/images/ITI.png"/> </a>
</div>

        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">Privacy Consent on FHIR (PCF)</span>
            <br/>
            <span style="display:inline-block;">1.0.0 - Trial-Implementation



  <img alt="International flag" src="assets/images/001.svg" height="16" title="International"/>


            </span>
          </p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->

    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R5/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <!-- menu.xml  -->

<ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
  <li>
    <a href="index.html">PCF Home</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Volume 1
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="volume-1.html">Introduction</a>
      </li>
      <li>
        <a href="volume-1.html#actors-and-transactions">Actors and Transactions</a>
      </li>
      <li>
        <a href="volume-1.html#actor-options">Actor Options</a>
      </li>
      <li>
        <a href="volume-1.html#required-groupings">Required Groupings</a>
      </li>
      <li>
        <a href="volume-1.html#overview">Overview</a>
      </li>
      <li>
        <a href="volume-1.html#security-considerations">Security Considerations</a>
      </li>
      <li>
        <a href="volume-1.html#other-grouping">Cross-Profile Considerations</a>
      </li>
      <li>
        <a href="ch-P.html">Appendix P: Privacy Access Policies</a>
      </li>
    </ul>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Volume 2
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="ITI-108.html">Access Consent [ITI-108]</a>
      </li>
    </ul>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Volume 3
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="content.html">Consent Patterns</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="artifacts.html">Artifacts</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Other
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="other.html">Changes to Other IHE Specifications</a>
      </li>
      <li>
        <a href="other.html#updates-to-iti-71">Updates to ITI-71</a>
      </li>
      <li>
        <a href="download.html">Download and Analysis</a>
      </li>
      <li>
        <a href="testplan.html">Test Plan</a>
      </li>
    </ul>
  </li>
</ul>
            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->

    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><b>1:53 Privacy Consent on FHIR</b></li>

          <span style="float:right;">

            <a href="index.html">&lt;prev</a> | 

            <a href="#bottom">bottom</a>

          | <a href="ch-P.html">next&gt;</a>

          </span>

        </ul>
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->

    <a name="top"> </a>
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<style type="text/css">
h2:before{color:silver;counter-increment:section;content:var(--heading-prefix) " ";}
h3:before{color:silver;counter-increment:sub-section;content:var(--heading-prefix) "." counter(sub-section) " ";}
h4:before{color:silver;counter-increment:composite;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) " ";}
h5:before{color:silver;counter-increment:detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) " ";}
h6:before{color:silver;counter-increment:more-detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) "." counter(more-detail)" ";}
</style>
<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">This page is part of the Privacy Consent on FHIR (PCF) (v1.0.0: Publication) based on <a href="http://hl7.org/fhir/4.3.0">FHIR v4.3.0</a>. This is the current published version.  For a full list of available versions, see the <a href="https://profiles.ihe.net/ITI/PCF/history.html">Directory of published versions <img src="external.png" style="text-align: baseline"></a></p><!--EndReleaseHeader-->
  <h2>1:53 Privacy Consent on FHIR</h2>
  












    <p><!-- white space is critical inside of capture --></p>
<div class="markdown-toc">
<ul id="markdown-toc">
  <li><a href="#1531-pcf-actors-transactions-and-content-modules" id="markdown-toc-1531-pcf-actors-transactions-and-content-modules">1:53.1 PCF Actors, Transactions, and Content Modules</a>    <ul>
      <li><a href="#15311-actors" id="markdown-toc-15311-actors">1:53.1.1 Actors</a></li>
      <li><a href="#15312-transaction-descriptions" id="markdown-toc-15312-transaction-descriptions">1:53.1.2 Transaction Descriptions</a></li>
    </ul>
  </li>
  <li><a href="#1532-pcf-actor-options" id="markdown-toc-1532-pcf-actor-options">1:53.2 PCF Actor Options</a>    <ul>
      <li><a href="#15321-implicit-consent-option" id="markdown-toc-15321-implicit-consent-option">1:53.2.1 Implicit Consent Option</a></li>
      <li><a href="#15322-explicit-basic-option" id="markdown-toc-15322-explicit-basic-option">1:53.2.2 Explicit Basic Option</a></li>
      <li><a href="#15323-explicit-intermediate-options" id="markdown-toc-15323-explicit-intermediate-options">1:53.2.3 Explicit Intermediate options</a></li>
      <li><a href="#15324-explicit-advanced-option" id="markdown-toc-15324-explicit-advanced-option">1:53.2.4 Explicit Advanced Option</a></li>
    </ul>
  </li>
  <li><a href="#1533-pcf-required-actor-groupings" id="markdown-toc-1533-pcf-required-actor-groupings">1:53.3 PCF Required Actor Groupings</a>    <ul>
      <li><a href="#15331-consent-recorder" id="markdown-toc-15331-consent-recorder">1:53.3.1 Consent Recorder</a></li>
      <li><a href="#15331-consent-registry" id="markdown-toc-15331-consent-registry">1:53.3.1 Consent Registry</a></li>
      <li><a href="#15331-consent-authorization-server" id="markdown-toc-15331-consent-authorization-server">1:53.3.1 Consent Authorization Server</a></li>
      <li><a href="#15332-consent-enforcement-point" id="markdown-toc-15332-consent-enforcement-point">1:53.3.2 Consent Enforcement Point</a></li>
    </ul>
  </li>
  <li><a href="#1534-pcf-overview" id="markdown-toc-1534-pcf-overview">1:53.4 PCF Overview</a>    <ul>
      <li><a href="#15341-concepts" id="markdown-toc-15341-concepts">1:53.4.1 Concepts</a></li>
      <li><a href="#15342-use-cases" id="markdown-toc-15342-use-cases">1:53.4.2 Use Cases</a></li>
    </ul>
  </li>
  <li><a href="#1535-pcf-security-considerations" id="markdown-toc-1535-pcf-security-considerations">1:53.5 PCF Security Considerations</a></li>
  <li><a href="#1536-pcf-cross-profile-considerations" id="markdown-toc-1536-pcf-cross-profile-considerations">1:53.6 PCF Cross-Profile Considerations</a></li>
</ul>

</div>
<p>The <strong>Privacy Consent on FHIR (PCF)</strong> builds upon a basic Identity and Authorization model of <a href="https://profiles.ihe.net/ITI/IUA/index.html">Internet User Authorization (IUA)</a> to provide consent-based access control. The Privacy Consent on FHIR is thus focused only on Access Control decisions regarding the parameters of the data subject (patient) privacy consent. The Privacy Consent on FHIR leverages these basic Identity and Authorization decisions as context setting for the authorization decision and enforcement. For example, a user that would never be allowed access would be denied access at the IUA level without invoking PCF, and where PCF will further evaluate authorization based on Privacy Consents.</p>

<p>This is to say that PCF does not define:</p>

<ul>
  <li>how one identifies the patient, this is the role of other Implementation Guides like <a href="https://profiles.ihe.net/ITI/PDQm/index.html">PDQm</a>, <a href="https://profiles.ihe.net/ITI/PIXm/index.html">PIXm</a>, <a href="https://profiles.ihe.net/ITI/PMIR/index.html">PIMR</a>, <a href="https://profiles.ihe.net/ITI/HIE-Whitepaper/index.html#5-patient-identity-management">etc.</a>;</li>
  <li>how the patient experiences the ceremony of the consent act, this is systems design, user interface design, and <a href="ch-P.html">policy language</a>;</li>
  <li>how one asks for data or communicates data, this is the role of other Implementation Guides like <a href="https://profiles.ihe.net/ITI/MHD/index.html">MHD</a>, <a href="https://profiles.ihe.net/ITI/MHDS/index.html">MHDS</a>, <a href="https://profiles.ihe.net/ITI/HIE-Whitepaper/index.html#4-consuming-data-as-fhir-resources">QEDm/mXDE</a>, etc.;</li>
  <li>how one tags data with security/privacy sensitivity labels, this is the role of a systems design that might utilize a <a href="ch-P.html#SLS">Security labeling Service</a>; and</li>
  <li>how users or applications are identified and foundationally authorized, this is the role of other Implementation Guides like <a href="https://profiles.ihe.net/ITI/IUA/index.html">IUA</a>, and OpenID-Connect.</li>
</ul>

<p>But PCF enhances and relies upon these other Implementation Guides to protect sensitive resources according to Patient-specific Consents.</p>

<p><a name="actors-and-transactions"> </a></p>

<h2 id="1531-pcf-actors-transactions-and-content-modules">1:53.1 PCF Actors, Transactions, and Content Modules</h2>

<p>This section defines the actors and transactions in this implementation guide.</p>

<p>The figure below shows the actors directly involved in the PCF Profile and the relevant transactions between them.
Internet User Authorization (<a href="https://profiles.ihe.net/ITI/IUA/index.html">IUA</a>) is shown as the PCF-specific actors are reliant on IUA actors.</p>

<figure>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" preserveAspectRatio="none" version="1.1" viewBox="0 0 1067 598" zoomAndPan="magnify"><defs><filter height="300%" id="f1htakutiwc58" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0" /><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0" /><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3" /><feBlend in="SourceGraphic" in2="blurOut3" mode="normal" /></filter></defs><g><!--MD5=[d9b28bb66500c26549d017862bdb0a8b]
cluster Grouped Decider--><rect fill="#FFFFFF" filter="url(#f1htakutiwc58)" height="206" style="stroke:#000000;stroke-width:1.5;" width="238" x="328" y="279" /><path d="M459,279 L459,289.6094 L449,299.6094 L328,299.6094 " fill="none" style="stroke:#000000;stroke-width:1.5;" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="121" x="331" y="294.5332">Grouped Decider</text><!--MD5=[389e9fe725b4b700f092ac357534a7e5]
cluster Grouped Client--><rect fill="#FFFFFF" filter="url(#f1htakutiwc58)" height="206" style="stroke:#000000;stroke-width:1.5;" width="204" x="594" y="7" /><path d="M711,7 L711,17.6094 L701,27.6094 L594,27.6094 " fill="none" style="stroke:#000000;stroke-width:1.5;" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="107" x="597" y="22.5332">Grouped Client</text><!--MD5=[eb0c3f8410c12aaa7c0bd044cc374e11]
cluster Grouped Server--><rect fill="#FFFFFF" filter="url(#f1htakutiwc58)" height="307" style="stroke:#000000;stroke-width:1.5;" width="226" x="790" y="279" /><path d="M914,279 L914,289.6094 L904,299.6094 L790,299.6094 " fill="none" style="stroke:#000000;stroke-width:1.5;" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="114" x="793" y="294.5332">Grouped Server</text><!--MD5=[48b3c451e589eca1a81843d532483820]
entity decider--><rect fill="#FEFECE" filter="url(#f1htakutiwc58)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="177" x="351.5" y="315" /><a href="https://profiles.ihe.net/ITI/IUA/index.html#34112-authorization-server" target="_top" title="https://profiles.ihe.net/ITI/IUA/index.html#34112-authorization-server" xlink:actuate="onRequest" xlink:href="https://profiles.ihe.net/ITI/IUA/index.html#34112-authorization-server" xlink:show="new" xlink:title="https://profiles.ihe.net/ITI/IUA/index.html#34112-authorization-server" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="157" x="361.5" y="339.5332">IUA: Authorization Server</text></a><!--MD5=[e90ef9446c3bc27f217e420ab21ba5e4]
entity cdecider--><rect fill="#FEFECE" filter="url(#f1htakutiwc58)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="205" x="344.5" y="431" /><a href="#consentAuthorizationServer" target="_top" title="#consentAuthorizationServer" xlink:actuate="onRequest" xlink:href="#consentAuthorizationServer" xlink:show="new" xlink:title="#consentAuthorizationServer" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="185" x="354.5" y="455.5332">Consent Authorization Server</text></a><!--MD5=[aa28c8d805400c20cd048c4c84f73a99]
entity otherClient--><rect fill="#FEFECE" filter="url(#f1htakutiwc58)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="128" x="632" y="43" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="642" y="67.5332">Other FHIR client</text><!--MD5=[4a65e84059005d12693a083370a06717]
entity client--><rect fill="#FEFECE" filter="url(#f1htakutiwc58)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="171" x="610.5" y="159" /><a href="https://profiles.ihe.net/ITI/IUA/index.html#34111-authorization-client" target="_top" title="https://profiles.ihe.net/ITI/IUA/index.html#34111-authorization-client" xlink:actuate="onRequest" xlink:href="https://profiles.ihe.net/ITI/IUA/index.html#34111-authorization-client" xlink:show="new" xlink:title="https://profiles.ihe.net/ITI/IUA/index.html#34111-authorization-client" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="151" x="620.5" y="183.5332">IUA: Authorization Client</text></a><!--MD5=[7f0d886837ccf2147999c0b0de893eb6]
entity enforcer--><rect fill="#FEFECE" filter="url(#f1htakutiwc58)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="156" x="835" y="315" /><a href="https://profiles.ihe.net/ITI/IUA/index.html#34113-resource-server" target="_top" title="https://profiles.ihe.net/ITI/IUA/index.html#34113-resource-server" xlink:actuate="onRequest" xlink:href="https://profiles.ihe.net/ITI/IUA/index.html#34113-resource-server" xlink:show="new" xlink:title="https://profiles.ihe.net/ITI/IUA/index.html#34113-resource-server" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="136" x="845" y="339.5332">IUA: Resource Server</text></a><!--MD5=[df905dda0b7a6bea974471a7efa87c4d]
entity cenforcer--><rect fill="#FEFECE" filter="url(#f1htakutiwc58)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="193" x="806.5" y="431" /><a href="#consentEnforcementPoint" target="_top" title="#consentEnforcementPoint" xlink:actuate="onRequest" xlink:href="#consentEnforcementPoint" xlink:show="new" xlink:title="#consentEnforcementPoint" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="173" x="816.5" y="455.5332">Consent Enforcement Point</text></a><!--MD5=[3fe865e1d399c80bea064ab017419f6d]
entity otherServer--><rect fill="#FEFECE" filter="url(#f1htakutiwc58)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="135" x="835.5" y="532" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="845.5" y="556.5332">Other FHIR server</text><!--MD5=[f6831931d3f96b9a96dc7c9eb8f793eb]
entity capture--><rect fill="#FEFECE" filter="url(#f1htakutiwc58)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="136" x="7" y="315" /><a href="#consentRecorder" target="_top" title="#consentRecorder" xlink:actuate="onRequest" xlink:href="#consentRecorder" xlink:show="new" xlink:title="#consentRecorder" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="116" x="17" y="339.5332">Consent Recorder</text></a><!--MD5=[aff0e67a1692f4b0d96c087fa0872bfd]
entity registry--><rect fill="#FEFECE" filter="url(#f1htakutiwc58)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="129" x="10.5" y="431" /><a href="#consentRegistry" target="_top" title="#consentRegistry" xlink:actuate="onRequest" xlink:href="#consentRegistry" xlink:show="new" xlink:title="#consentRegistry" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="109" x="20.5" y="455.5332">Consent Registry</text></a><!--MD5=[0d24c3561b746c716822b6e80fd2a011]
link capture to registry--><path d="M75,353.06 C75,372.63 75,403.91 75,425.4 " fill="none" id="capture-to-registry" style="stroke:#A80036;stroke-width:1.0;" /><polygon fill="#A80036" points="75,430.64,79,421.64,75,425.64,71,421.64,75,430.64" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="76" y="397.4951">Access Consent (CRUDS)</text><a href="ITI-108.html" target="_top" title="ITI-108.html" xlink:actuate="onRequest" xlink:href="ITI-108.html" xlink:show="new" xlink:title="ITI-108.html" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="38" x="233" y="397.4951">ITI-108</text></a><!--MD5=[ecbdf930287be67062f39b7b96f0cbdd]
link decider to cdecider--><path d="M441.11,353.06 C442.17,370.31 443.79,396.65 445.06,417.38 " fill="none" id="decider-to-cdecider" style="stroke:#A80036;stroke-width:1.0;" /><polygon fill="#A80036" points="445.87,430.64,449.4935,424.4054,445.1321,418.6627,441.5086,424.8973,445.87,430.64" style="stroke:#A80036;stroke-width:1.0;" /><!--MD5=[5e2d5717b2077e41a5ceb06cfcc4e655]
reverse link registry to cdecider--><path d="M144.82,450 C201.04,450 280.89,450 344.38,450 " fill="none" id="registry-backto-cdecider" style="stroke:#A80036;stroke-width:1.0;" /><polygon fill="#A80036" points="139.8,450,148.8,454,144.8,450,148.8,446,139.8,450" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="158" y="443.4951">Access Consent (SR)</text><a href="ITI-108.html" target="_top" title="ITI-108.html" xlink:actuate="onRequest" xlink:href="ITI-108.html" xlink:show="new" xlink:title="ITI-108.html" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="38" x="288" y="443.4951">ITI-108</text></a><!--MD5=[96652eaa9a67aaaa54811eba1b5e3111]
link enforcer to cenforcer--><path d="M911.42,353.06 C909.9,370.39 907.57,396.91 905.75,417.67 " fill="none" id="enforcer-to-cenforcer" style="stroke:#A80036;stroke-width:1.0;" /><polygon fill="#A80036" points="904.61,430.64,909.1155,425.0097,905.6513,418.6853,901.1457,424.3155,904.61,430.64" style="stroke:#A80036;stroke-width:1.0;" /><!--MD5=[02d12c79b4b1c9b1232c91347286777a]
link cenforcer to otherServer--><path d="M903,469.16 C903,482.97 903,502.32 903,518.63 " fill="none" id="cenforcer-to-otherServer" style="stroke:#A80036;stroke-width:1.0;" /><polygon fill="#A80036" points="903,531.96,907,525.96,903,519.96,899,525.96,903,531.96" style="stroke:#A80036;stroke-width:1.0;" /><!--MD5=[c8c91777fd9b8353783ee3d21a99f7b8]
link otherClient to client--><path d="M696,81.06 C696,98.31 696,124.65 696,145.38 " fill="none" id="otherClient-to-client" style="stroke:#A80036;stroke-width:1.0;" /><polygon fill="#A80036" points="696,158.64,700,152.64,696,146.64,692,152.64,696,158.64" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="697" y="125.4951">other</text><!--MD5=[5606f6ac77129ce1be9aed2aabebb6be]
link client to decider--><path d="M610.22,191.88 C579.87,199.3 546.68,210.9 520,229 C489.25,249.86 465.2,286.36 451.81,310.1 " fill="none" id="client-to-decider" style="stroke:#A80036;stroke-width:1.0;" /><polygon fill="#A80036" points="449.27,314.67,457.1374,308.7452,451.6982,310.2992,450.1442,304.86,449.27,314.67" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="565" y="243.4951">IUA Get Access Token</text><a href="other.html#updates-to-iti-71" target="_top" title="other.html#updates-to-iti-71" xlink:actuate="onRequest" xlink:href="other.html#updates-to-iti-71" xlink:show="new" xlink:title="other.html#updates-to-iti-71" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="45" x="702" y="243.4951">_ITI-71_</text></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="521" y="259.8467">IUA: Get Authorization Server Metadata</text><a href="https://profiles.ihe.net/ITI/IUA/index.html#3103-get-authorization-server-metadata-iti-103" target="_top" title="https://profiles.ihe.net/ITI/IUA/index.html#3103-get-authorization-server-metadata-iti-103" xlink:actuate="onRequest" xlink:href="https://profiles.ihe.net/ITI/IUA/index.html#3103-get-authorization-server-metadata-iti-103" xlink:show="new" xlink:title="https://profiles.ihe.net/ITI/IUA/index.html#3103-get-authorization-server-metadata-iti-103" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="38" x="753" y="259.8467">ITI-103</text></a><!--MD5=[220d0c923d0dddc6e9b92fe3901843d6]
link client to enforcer--><path d="M740.84,197.05 C759.8,205.56 781.68,216.57 800,229 C835.67,253.19 871.35,288.3 892.8,310.89 " fill="none" id="client-to-enforcer" style="stroke:#A80036;stroke-width:1.0;" /><polygon fill="#A80036" points="896.38,314.68,893.1245,305.3847,892.9532,311.039,887.2989,310.8677,896.38,314.68" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="844" y="251.4951">IUA: Incorporate Access Token</text><a href="https://profiles.ihe.net/ITI/IUA/index.html#372-incorporate-access-token-iti-72" target="_top" title="https://profiles.ihe.net/ITI/IUA/index.html#372-incorporate-access-token-iti-72" xlink:actuate="onRequest" xlink:href="https://profiles.ihe.net/ITI/IUA/index.html#372-incorporate-access-token-iti-72" xlink:show="new" xlink:title="https://profiles.ihe.net/ITI/IUA/index.html#372-incorporate-access-token-iti-72" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="31" x="1028" y="251.4951">ITI-72</text></a><!--MD5=[bf210e1289fb3d0ecb47aaea33576497]
reverse link decider to enforcer--><path d="M533.91,334 C622.04,334 752.34,334 834.92,334 " fill="none" id="decider-backto-enforcer" style="stroke:#A80036;stroke-width:1.0;" /><polygon fill="#A80036" points="528.69,334,537.69,338,533.69,334,537.69,330,528.69,334" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="598.25" y="311.4951">IUA: Introspect Token</text><a href="https://profiles.ihe.net/ITI/IUA/index.html#3102-introspect-token-iti-102" target="_top" title="https://profiles.ihe.net/ITI/IUA/index.html#3102-introspect-token-iti-102" xlink:actuate="onRequest" xlink:href="https://profiles.ihe.net/ITI/IUA/index.html#3102-introspect-token-iti-102" xlink:show="new" xlink:title="https://profiles.ihe.net/ITI/IUA/index.html#3102-introspect-token-iti-102" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="38" x="727.25" y="311.4951">ITI-102</text></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="546.75" y="327.8467">IUA: Get Authorization Server Metadata</text><a href="https://profiles.ihe.net/ITI/IUA/index.html#3103-get-authorization-server-metadata-iti-103" target="_top" title="https://profiles.ihe.net/ITI/IUA/index.html#3103-get-authorization-server-metadata-iti-103" xlink:actuate="onRequest" xlink:href="https://profiles.ihe.net/ITI/IUA/index.html#3103-get-authorization-server-metadata-iti-103" xlink:show="new" xlink:title="https://profiles.ihe.net/ITI/IUA/index.html#3103-get-authorization-server-metadata-iti-103" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="38" x="778.75" y="327.8467">ITI-103</text></a><!--MD5=[720075a643cbbb2401f85b441faa5f2d]
link cenforcer to cdecider--><path d="M806.2,450 C732.59,450 631.32,450 555.07,450 " fill="none" id="cenforcer-to-cdecider" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;" /><polygon fill="#A80036" points="549.62,450,558.62,454,554.62,450,558.62,446,549.62,450" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="657.5" y="443.4951">implied</text></g></svg>
<figcaption><b>Figure 1:53.1-1: PCF Actor Diagram</b></figcaption>
</figure>
<p><br clear="all" /></p>

<p>The actors participate in the following transactions.</p>

<p><strong>Table 1:53.1-1: PCF Profile - Actors and Transactions</strong></p>

<table class="grid">
  <thead>
    <tr>
      <th>Actors</th>
      <th>Transactions</th>
      <th>Direction</th>
      <th>Optionality</th>
      <th>Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#consentRecorder">Consent Recorder</a></td>
      <td>Access Consent</td>
      <td>Initiator</td>
      <td>R</td>
      <td><a href="ITI-108.html">ITI TF-2: 3.108</a></td>
    </tr>
    <tr>
      <td><a href="#consentRegistry">Consent Registry</a></td>
      <td>Access Consent</td>
      <td>Responder</td>
      <td>R</td>
      <td><a href="ITI-108.html">ITI TF-2: 3.108</a></td>
    </tr>
    <tr>
      <td><a href="#consentAuthorizationServer">Consent Authorization Server</a></td>
      <td>Access Consent</td>
      <td>Initiator</td>
      <td>R (Note 1)</td>
      <td><a href="ITI-108.html">ITI TF-2: 3.108</a></td>
    </tr>
    <tr>
      <td><a href="#consentEnforcementPoint">Consent Enforcement Point</a></td>
      <td>none</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>Note 1: Consent Authorization Server, when operating only in an Implicit environment, does not need to demonstrate use of ITI-108.</p>

<p>The following is a repeat of the IUA actors and transactions for clarity. The PCF Implementation Guide places grouping requirements and behavior upon the IUA actors relative to the grouped PCF Actors.</p>

<p><strong>Table 1:53.1-2: IUA Profile - Actors and Transactions</strong></p>

<table class="grid">
  <thead>
    <tr>
      <th>Actors</th>
      <th>Transactions</th>
      <th>Direction</th>
      <th>Optionality</th>
      <th>Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://profiles.ihe.net/ITI/IUA/index.html#34111-authorization-client">IUA: Authorization Client</a></td>
      <td>Get Access Token</td>
      <td>Initiator</td>
      <td>R</td>
      <td><a href="other.html#updates-to-iti-71">ITI TF-2: 3.71</a></td>
    </tr>
    <tr>
      <td> </td>
      <td>Incorporate Access Token</td>
      <td>Initiator</td>
      <td>R</td>
      <td><a href="https://profiles.ihe.net/ITI/IUA/index.html#372-incorporate-access-token-iti-72">ITI TF-2: 3.72</a></td>
    </tr>
    <tr>
      <td> </td>
      <td>Get Authorization Server metadata</td>
      <td>Initiator</td>
      <td>O</td>
      <td><a href="https://profiles.ihe.net/ITI/IUA/index.html#3103-get-authorization-server-metadata-iti-103">ITI TF-2: 3.103</a></td>
    </tr>
    <tr>
      <td><a href="https://profiles.ihe.net/ITI/IUA/index.html#34112-authorization-server">IUA: Authorization Server</a></td>
      <td>Get Access Token</td>
      <td>Responder</td>
      <td>R</td>
      <td><a href="other.html#updates-to-iti-71">ITI TF-2: 3.71</a></td>
    </tr>
    <tr>
      <td> </td>
      <td>Introspect Token</td>
      <td>Responder</td>
      <td>O (Note 1)</td>
      <td><a href="https://profiles.ihe.net/ITI/IUA/index.html#3102-introspect-token-iti-102">ITI TF-2: 3.102</a></td>
    </tr>
    <tr>
      <td> </td>
      <td>Get Authorization Server metadata</td>
      <td>Responder</td>
      <td>O</td>
      <td><a href="https://profiles.ihe.net/ITI/IUA/index.html#3103-get-authorization-server-metadata-iti-103">ITI TF-2: 3.103</a></td>
    </tr>
    <tr>
      <td><a href="https://profiles.ihe.net/ITI/IUA/index.html#34113-resource-server">IUA: Resource Server</a></td>
      <td>Introspect Token</td>
      <td>Initiator</td>
      <td>O (Note 1)</td>
      <td><a href="https://profiles.ihe.net/ITI/IUA/index.html#3102-introspect-token-iti-102">ITI TF-2: 3.102</a></td>
    </tr>
    <tr>
      <td> </td>
      <td>Incorporate Access Token</td>
      <td>Responder</td>
      <td>R</td>
      <td><a href="https://profiles.ihe.net/ITI/IUA/index.html#372-incorporate-access-token-iti-72">ITI TF-2: 3.72</a></td>
    </tr>
    <tr>
      <td> </td>
      <td>Get Authorization Server metadata</td>
      <td>Initiator</td>
      <td>O</td>
      <td><a href="https://profiles.ihe.net/ITI/IUA/index.html#3103-get-authorization-server-metadata-iti-103">ITI TF-2: 3.103</a></td>
    </tr>
  </tbody>
</table>

<p>Note 1: Authorization Server or Resource Server Actors shall support at least one of the following options: JWT Token, or Token Introspection.</p>

<h3 id="15311-actors">1:53.1.1 Actors</h3>

<p>The actors in this profile are described in more detail in the sections below.</p>

<p><a name="consentRecorder"> </a></p>

<h4 id="153111-consent-recorder">1:53.1.1.1 Consent Recorder</h4>

<p>The <strong>Consent Recorder</strong> is responsible for the capturing of consent from the Patient given policies available. This actor is responsible for assuring that:</p>

<ul>
  <li>the Patient fully understood the terms of the Consent, and</li>
  <li>the Consent terms agreed to are acceptable to the organization responsible and the abilities of the <strong>Consent Authorization Server</strong> and <strong>Consent Enforcement Point</strong> Actors.</li>
</ul>

<p>The <strong>Consent Recorder</strong> may utilize other resources to interact with the Patient, and to capture the evidence of the Consent ceremony. The interaction with the Patient can be a very complex system that utilizes applications, web user interface, and forms; but may also be a paper process that results in ink signatures on paperwork. The workflow leading up to the <strong>Consent Recorder</strong> may also use FHIR Resources such as a FHIR Questionnaire or a DocumentReference / Binary. Where a DocumentReference and Binary are used to capture the Consent ceremony, the preservation should utilize the <a href="https://profiles.ihe.net/ITI/MHD">MHD</a> implementation guide.</p>

<p><a href="CapabilityStatement-IHE.PCF.consentRecorder.html">FHIR Capability Statement for Consent Recorder</a></p>

<p><a name="consentRegistry"> </a></p>

<h4 id="153112-consent-registry">1:53.1.1.2 Consent Registry</h4>

<p>The <strong>Consent Registry</strong> holds Consent resources. This includes active, inactive, and expired Consents. The <strong>Consent Registry</strong> does not have special understanding of the Consent other than as a FHIR <code class="language-plaintext highlighter-rouge">Consent</code> Resource. It, thus, is not responsible for assuring that the Consent terms are acceptable or enforceable; this is the responsibility of the <strong>Consent Recorder</strong>.</p>

<p><a href="CapabilityStatement-IHE.PCF.consentRegistry.html">FHIR Capability Statement for Consent Registry</a></p>

<p><a name="consentAuthorizationServer"> </a></p>

<h4 id="153113-consent-authorization-server">1:53.1.1.3 Consent Authorization Server</h4>

<p>The <strong>Consent Authorization Server</strong> makes authorization decisions based on a given access requested context (e.g., oAuth, query/operation parameters), organizational policies, and current active <code class="language-plaintext highlighter-rouge">Consent</code> resources. The <strong>Consent Authorization Server</strong> is often implemented utilizing other authorization services, taking input from the user identity (e.g., Open-ID-Connect), and application identity and authorization (e.g., IUA). These predicate authorizations provide the security context upon which the Privacy <code class="language-plaintext highlighter-rouge">Consent</code> constraints are applied. The result is an authorization token used to request access resources, and is used by the <strong>Consent Enforcement Point</strong>.</p>

<p><a name="consentEnforcementPoint"> </a></p>

<h4 id="153114-consent-enforcement-point">1:53.1.1.4 Consent Enforcement Point</h4>

<p>The <strong>Consent Enforcement Point</strong> enforces consent decisions made by the <strong>Consent Authorization Server</strong>. This includes deny, permit, and permit with filtering of results. The <strong>Consent Enforcement Point</strong> must be grouped with an <strong>IUA Resource Server</strong> and is invoked when the authorization token includes consent-based rules to be enforced.</p>

<h3 id="15312-transaction-descriptions">1:53.1.2 Transaction Descriptions</h3>

<p>The transactions in this profile are summarized in the sections below.</p>

<h4 id="53121-iti-108-access-consent-transaction">53.1.2.1 ITI-108 Access Consent transaction</h4>

<p>This transaction is used to Create, Read, Update, Delete, and Search on Consent resources.</p>

<p>For more details see the detailed <a href="ITI-108.html">Access Consent</a>.</p>

<h4 id="153122-implied-enforcement">1:53.1.2.2 Implied Enforcement</h4>

<p>The <strong>Consent Enforcement Point</strong> is invoked by the <strong>IUA Resource Server</strong> when there is consent rules to be enforced. There is no externally defined transaction but the <strong>Consent Enforcement Point</strong> indirectly gets the consent rules to be enforced from the <strong>IUA Resource Server</strong>, thereby implicitly learning the details of the token. How this is done, and how the enforcement is achieved is a Systems Design concern outside the scope of an Interoperability specification such as PCF.</p>

<p><a name="actor-options"> </a></p>

<h2 id="1532-pcf-actor-options">1:53.2 PCF Actor Options</h2>

<p>Options that may be selected for each actor in this implementation guide, are listed in Table 1:53.2-1 below. Dependencies
between options when applicable are specified in notes.</p>

<p><strong>Table 1:53.2-1</strong></p>

<table class="grid">
  <thead>
    <tr>
      <th>Actor</th>
      <th>Option Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Consent Recorder</td>
      <td>Explicit Basic</td>
    </tr>
    <tr>
      <td>Consent Recorder</td>
      <td>Explicit Intermediate Data Timeframe</td>
    </tr>
    <tr>
      <td>Consent Recorder</td>
      <td>Explicit Intermediate Data by id</td>
    </tr>
    <tr>
      <td>Consent Recorder</td>
      <td>Explicit Intermediate Data Author</td>
    </tr>
    <tr>
      <td>Consent Recorder</td>
      <td>Explicit Intermediate Data Relationship</td>
    </tr>
    <tr>
      <td>Consent Recorder</td>
      <td>Explicit Intermediate Additional PurposeOfUse</td>
    </tr>
    <tr>
      <td>Consent Recorder</td>
      <td>Explicit Advanced</td>
    </tr>
    <tr>
      <td>Consent Registry</td>
      <td>none</td>
    </tr>
    <tr>
      <td>Consent Authorization Server</td>
      <td>Implicit</td>
    </tr>
    <tr>
      <td>Consent Authorization Server</td>
      <td>Explicit Basic</td>
    </tr>
    <tr>
      <td>Consent Authorization Server</td>
      <td>Explicit Intermediate Data Timeframe</td>
    </tr>
    <tr>
      <td>Consent Authorization Server</td>
      <td>Explicit Intermediate Data by id</td>
    </tr>
    <tr>
      <td>Consent Authorization Server</td>
      <td>Explicit Intermediate Data Author</td>
    </tr>
    <tr>
      <td>Consent Authorization Server</td>
      <td>Explicit Intermediate Data Relationship</td>
    </tr>
    <tr>
      <td>Consent Authorization Server</td>
      <td>Explicit Intermediate Additional PurposeOfUse</td>
    </tr>
    <tr>
      <td>Consent Authorization Server</td>
      <td>Explicit Advanced</td>
    </tr>
    <tr>
      <td>Consent Enforcement Point</td>
      <td>Implicit</td>
    </tr>
    <tr>
      <td>Consent Enforcement Point</td>
      <td>Explicit Basic</td>
    </tr>
    <tr>
      <td>Consent Enforcement Point</td>
      <td>Explicit Intermediate Data Timeframe</td>
    </tr>
    <tr>
      <td>Consent Enforcement Point</td>
      <td>Explicit Intermediate Data by id</td>
    </tr>
    <tr>
      <td>Consent Enforcement Point</td>
      <td>Explicit Intermediate Data Author</td>
    </tr>
    <tr>
      <td>Consent Enforcement Point</td>
      <td>Explicit Intermediate Data Relationship</td>
    </tr>
    <tr>
      <td>Consent Enforcement Point</td>
      <td>Explicit Intermediate Additional PurposeOfUse</td>
    </tr>
    <tr>
      <td>Consent Enforcement Point</td>
      <td>Explicit Advanced</td>
    </tr>
  </tbody>
</table>

<p>Note 1: Explicit Intermediate Options and Explicit Advanced Option require that Explicit Basic Option is selected.</p>

<p>Three levels of maturity are defined which are incrementally more difficult to implement: Support for these Basic, Intermediate, and Advanced policies is support for the ability to provide these capabilities. The actual policy provided to the Patient would be some subset of this support that the data custodian is willing to enforce.</p>

<p>When the Implicit Consent Option is not declared to be implemented, then PCF expects “Deny all” or “Permit all authorized uses” for the overarching policy.</p>

<h3 id="15321-implicit-consent-option">1:53.2.1 Implicit Consent Option</h3>

<p>The Implicit Policy Option indicates that there is a default policy that is used when there is no Consent found on file for a given patient. This Implicit Policy shall support the following “overarching” policies:</p>

<table class="grid">
  <thead>
    <tr>
      <th>canonical URI</th>
      <th>Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">https://profiles.ihe.net/ITI/PCF/Policy-basic-normal</code></td>
      <td>Permit for clinicians that have authorization for Treatment use, but does not authorize other access. This presumes that basic user access control can differentiate legitimate clinical users and purposes of use.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">https://profiles.ihe.net/ITI/PCF/Policy-all-normal</code></td>
      <td>Permit for all authorized uses. This presumes that basic user access control will only allow authorized users and purposes of use.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">https://profiles.ihe.net/ITI/PCF/Policy-break-glass-only</code></td>
      <td>Deny for all use, except when the user is a clinician with authorization to declare a medical patient-safety override (a.k.a. Break-Glass).</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">https://profiles.ihe.net/ITI/PCF/Policy-deny</code></td>
      <td>Deny all.</td>
    </tr>
  </tbody>
</table>

<p>Other overarching policies may also be implemented, but their behavior is not defined in PCF.</p>

<p>The operational environment chooses which of these policies they will use, so in operational use only one of these is in effect as the “implicit policy”.</p>

<p>Neither the definition of permitted use, nor how break-glass is declared is defined here. These are  policy expectations of the environment and are expected to be configured into the IUA authorization decisions and enforcement.</p>

<p>Implicit Consent Option has no ability to have Patient-specific parameters. When Patient-specific parameters are needed, Explicit options are required.</p>

<h3 id="15322-explicit-basic-option">1:53.2.2 Explicit Basic Option</h3>

<p>The Explicit Basic Option allows for patient-specific consent to be recorded and changed. This option sets the foundation for consents that expire, and consents that change based on agreements between the organization and the patient. The lack of a consent for a given patient would be covered by the Implicit Consent Option in place.</p>

<p>Typically the Implicit Consent Option is either a Deny-All or a Permit-All-Authorized-Uses. The Deny-All sets the groundwork for an environment where Consent is required for any activity to happen (often called OPT-IN). The Permit-All-Authorized-Uses sets the groundwork for an environment where Consent can be used to refine or dissent (often called OPT-OUT). In all cases, once a Consent is recorded then the terms of the Consent override any Implicit policy.</p>

<p>The Explicit Basic Option indicates that there is support for a basic set of patient-specific parameters. The following set of patient-specific parameters may be used to permit or deny:</p>

<ol>
  <li>The overarching policy that the patient and organization have agreed upon. An environment can use the overarching policies defined above, or define policies specific to its local needs. For example, in an Implicit Deny-All, the Explicit Consents might be based on the Permit-All-Authorized-Users policy.</li>
  <li>The timeframe for which the consent applies, enabling consents that have a time limit.</li>
  <li>Who is permitted/denied: This may be a device, relatedPerson, Practitioner, or Organization. This parameter enables the naming of agents that should be allowed access or denied access. This presumes that the identified agent is appropriately identified (provisioned) and authorized to make the request; typically through some application authorization and role-based access control. The user identity is mapped to a FHIR agent type Resource using the agent type Resource <code class="language-plaintext highlighter-rouge">.identifier</code> element (e.g., <code class="language-plaintext highlighter-rouge">Practitioner.identifier</code> would hold the user id).</li>
  <li>Purpose of use permitted/denied: There are a number of PurposeOfUse that are available to be explicably identified as an authorized purposeOfUse or denied purposeOfUse. This presumes that the requesting user has the authorization to request for the requested purposeOfUse. That is to say that the Consent Authorization Server does not determine whether the user/client is authorized to make the purposeOfUse declaration and this must be previously decided by the security context (see cascaded oAuth) –  Treatment, Payment, or Operations.</li>
</ol>

<p>See <a href="content.html#basic">Basic Consent</a> Content Profile</p>

<h3 id="15323-explicit-intermediate-options">1:53.2.3 Explicit Intermediate options</h3>

<p>The following Options shall be used in conjunction with <strong>Explicit Basic Option</strong>, and may be used with <strong>Explicit Advanced Option</strong>. The Explicit Intermediate Options can be implemented and/or used individually or combined. When combined within one parameter, the logic provided by each option is combined. The data scoping Explicit Intermediate options are not expected to be found combined on one parameter, but may be combined within a Consent providing different data scoping capability. For example, a consent that indicates that a data timeframe is used to deny insurance access, with a different parameter indicting that a data relationship is allowed access to a research project.</p>

<p>See <a href="content.html#intermediate">Intermediate Consent</a> Content Profile.</p>

<h4 id="153231-explicit-intermediate-data-timeframe-option">1:53.2.3.1 Explicit Intermediate Data Timeframe Option</h4>

<p>This data scoping option provides for the Consent to have one or more permit/deny parameter that indicates a timeframe within which data has been authored or last updated.</p>

<h4 id="153232-explicit-intermediate-data-by-id-option">1:53.2.3.2 Explicit Intermediate Data by id Option</h4>

<p>This data scoping option provides for the Consent to have one or more permit/deny parameter that indicates a FHIR Resources by <code class="language-plaintext highlighter-rouge">.id</code> value.</p>

<h4 id="153233-explicit-intermediate-data-author-option">1:53.2.3.3 Explicit Intermediate Data Author Option</h4>

<p>This data scoping option provides for the Consent to have one or more permit/deny parameter that indicates data is subject to the rule by way of an indicated author. This option is useful when the consent provision is limiting access to data that was authorized by a given doctor.</p>

<h4 id="153234-explicit-intermediate-data-relationship-option">1:53.2.3.4 Explicit Intermediate Data Relationship Option</h4>

<p>This data scoping option provides for the Consent to have one or more permit/deny parameter that indicates data is subject to the rule by way of that data being related in a given way to a given identified data object. This option is useful for indicating a consent provision that is limiting/authorizing access to data that was created as part of an encounter, care plan, or episode of care.</p>

<h4 id="153235-explicit-intermediate-additional-purposeofuse-option">1:53.2.3.5 Explicit Intermediate Additional PurposeOfUse Option</h4>

<p>This option provides for the Consent to have one or more permit/deny parameter that indicates a purposeOfUse that is not listed in the <strong>Explicit Basic Option</strong> vocabulary. This would tend to be used with Clinical Research projects, where the purposeOfUse is a code assigned to a specific Clinical Research Project. This may also be used for other purposeOfUse codes. Where <strong>Explicit Basic Option</strong> has some well-known purposeOfUse codes, this option is used for other codes.</p>

<p>One specific use of this Option is to enable Break-Glass access. Where the Consent can have a permission explicitly allowing the PurposeOfUse of Break-Glass (#BTG). In this case the Consent would have restrictions, that can be overridden by an authorized Break-Glass. The logic that determines that the given user is authorized, and has declared Break-Glass is out-of-scope of this implementation guide as it is very user-interface- and policy-specific. So, only the encoding in the Consent, and the encoding in the Access Token is defined here.</p>

<h3 id="15324-explicit-advanced-option">1:53.2.4 Explicit Advanced Option</h3>

<p>The Explicit Advanced Option indicates that there is support for an advanced set of patient-specific parameters. The Advanced policies allow for Patient-specific permit/deny parameters on sensitive health topics and require the use of security-tagged data. The security-tagged data might be implemented either using a <a href="ch-P.html#SLS">Security Labeling Service</a> that is not defined here, or other systems design. This option is required to support sensitive health topic segmentation such as substance abuse, mental health, sexuality and reproductive health, etc.</p>

<p>See <a href="content.html#advanced">Advanced Consent</a> Content Profile.</p>

<p><a name="required-groupings"> </a></p>

<h2 id="1533-pcf-required-actor-groupings">1:53.3 PCF Required Actor Groupings</h2>

<p>PCF leverages other IHE Profiles for the critical functionality they provide. This includes <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">Audit Trails and Node Authentication (ATNA)</a> to provide system security and audit infrastructure, <a href="https://profiles.ihe.net/ITI/BALP/index.html">Basic Audit Log Patterns (BALP)</a> to provide audit log patterns for privacy and security sensitive access control activities, and <a href="https://profiles.ihe.net/ITI/IUA/index.html">Internet User Authorization (IUA)</a> to provide the oAuth interaction pattern between clients that want to access protected resources and the needs to protect those resources.</p>

<h3 id="15331-consent-recorder">1:53.3.1 Consent Recorder</h3>

<p>The <strong>Consent Recorder</strong> shall be grouped with an ATNA <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html#9.1.1.2">Secure Application</a>, a BALP <a href="https://profiles.ihe.net/ITI/BALP/volume-1.html#152111-audit-creator">Audit Creator</a>, and shall record the <a href="https://profiles.ihe.net/ITI/BALP/content.html#3573-restful-activities">BALP RESTful activities</a>.</p>

<h3 id="15331-consent-registry">1:53.3.1 Consent Registry</h3>

<p>The <strong>Consent Registry</strong> shall be grouped with an ATNA <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html#9.1.1.2">Secure Application</a>, a BALP <a href="https://profiles.ihe.net/ITI/BALP/volume-1.html#152111-audit-creator">Audit Creator</a>, and shall record the <a href="https://profiles.ihe.net/ITI/BALP/content.html#3573-restful-activities">BALP RESTful activities</a>.</p>

<h3 id="15331-consent-authorization-server">1:53.3.1 Consent Authorization Server</h3>

<p>The <strong>Consent Authorization Server</strong> shall be grouped with an IUA: <strong>Authorization Server</strong>. The IUA <strong>Authorization Server</strong> takes care of the IUA transactions and invokes the <strong>Consent Authorization Server</strong> when a request for a token, that would be impacted by a Patient Privacy Consent, is invoked.</p>

<p>The IUA Authorization Server shall implement the <strong>JWT Token</strong>, or <strong>Token Introspection</strong> options, and should implement the <strong>Get Authorization Server Metadata</strong> option. There is no use of the IUA Authorization Server <strong>SAML Token</strong> option.</p>

<p>Note that PCF <a href="other.html#updates-to-iti-71">adds requirements to the ITI-71</a> transaction to carry in the token extensions informed from the consents. These oAuth extensions affect JWT encoding and response from use of the Introspect Token Transaction.</p>

<p>The <strong>Consent Authorization Server</strong> shall be grouped with an ATNA <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html#9.1.1.2">Secure Application</a>, a BALP <a href="https://profiles.ihe.net/ITI/BALP/volume-1.html#152111-audit-creator">Audit Creator</a>, and shall record the <a href="https://profiles.ihe.net/ITI/BALP/content.html#3573-restful-activities">BALP RESTful activities</a>.</p>

<h3 id="15332-consent-enforcement-point">1:53.3.2 Consent Enforcement Point</h3>

<p>The <strong>Consent Enforcement Point</strong> shall be grouped with an IUA: <strong>Resource Server</strong>.  The IUA <strong>Resource Server</strong> takes care of the IUA transactions and invokes the <strong>Consent Enforcement Point</strong> when a token includes enforcement rules informed by Patient Privacy Consent.</p>

<p>The IUA Resource Server shall implement the <strong>JWT Token</strong>, or <strong>Token Introspection</strong> options, and should implement the <strong>Get Authorization Server Metadata</strong> option. There is no use of the IUA Authorization Server <strong>SAML Token</strong> option.</p>

<p>Note that PCF <a href="other.html#updates-to-iti-71">adds requirements to the ITI-71</a> transaction to carry in the token extensions informed from the consents. These oAuth extensions affect JWT encoding and response from use of the Introspect Token Transaction.</p>

<p>The <strong>Consent Enforcement Point</strong> shall be grouped with an ATNA <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html#9.1.1.2">Secure Application</a>, a BALP <a href="https://profiles.ihe.net/ITI/BALP/volume-1.html#152111-audit-creator">Audit Creator</a>, and shall record the <a href="https://profiles.ihe.net/ITI/BALP/content.html#3573-restful-activities">BALP RESTful activities</a>. Only one BALP RESTful activity AuditEvent needs to be recorded within the Grouped Server.</p>

<p><a name="overview"> </a></p>

<h2 id="1534-pcf-overview">1:53.4 PCF Overview</h2>

<p>The PCF Profile enables authorized access to data according to terms agreed by the Patient and the Organization protecting the data. These terms represent Privacy controls on the use of the data. The Privacy controls augment an overarching policy upon which these Privacy controls build. The writing of overarching policies, and the act of informing the patient and capturing their agreement is a predicate to the use cases of the PCF.</p>

<h3 id="15341-concepts">1:53.4.1 Concepts</h3>

<p>Consent is a patient-specific set of parameters that work within an overarching policy. For a discussion of policy, consent policy, and other concepts see <a href="ch-P.html">Appendix P: Privacy Access Policies</a>. The concepts outlined in <a href="ch-P.html">Appendix P: Privacy Access Policies</a> are critical to understanding this implementation guide.</p>

<h3 id="15342-use-cases">1:53.4.2 Use Cases</h3>

<p>PCF defines some transactions and some content. The content specifications define the variations on Consent that are used to enable consent parameters. The transactions utilize the content and carry out the privacy protection defined within a patient-specific consent.</p>

<h4 id="153421-use-case-1-capture-new-consent">1:53.4.2.1 Use Case #1: Capture new consent</h4>

<p>When a patient does not have a consent on file, and there is a need to capture consent, the Capture New Consent use case is used to record the details of the Consent ceremony.</p>

<h5 id="1534211-capture-new-consent-use-case-description">1:53.4.2.1.1 Capture New Consent Use Case Description</h5>

<pre><code class="language-Gherkin">Scenario Outline: Capture New Consent Use Case
  Given an Organization controlling some Patient-identifiable Data 
  And they have written and published Patient Privacy Policies
  And there is no consent on file for a given Patient
  When they present their Patient Privacy Policies to a given Patient
  And the Patient either agrees, disagrees, or adds acceptable parameters
  Then a Consent is captured by the **Consent Recorder** and stored in the **Consent Registry**
</code></pre>

<p>Note: the above use case is written in <a href="https://cucumber.io/docs/gherkin/">Gherkin</a>, a use case language optimized for automated testing.</p>

<p>The Consent details are specific to the Patient Privacy Policy, the parameters agreed to in the ceremony, and the Consent profile (Basic, Intermediate, Advance) that was used.</p>

<h5 id="1534212-capture-new-consent-process-flow">1:53.4.2.1.2 Capture New Consent Process Flow</h5>

<p>The following flow shows the activities involved in the Capture new Consent flow.</p>

<figure>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" preserveAspectRatio="none" version="1.1" viewBox="0 0 629 469" zoomAndPan="magnify"><defs><filter height="300%" id="fal1tkbmwwwh8" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0" /><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0" /><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3" /><feBlend in="SourceGraphic" in2="blurOut3" mode="normal" /></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="174" x="225.25" y="30.6855">Capture new Consent</text><rect fill="#FFFFFF" filter="url(#fal1tkbmwwwh8)" height="315.8672" style="stroke:#A80036;stroke-width:1.0;" width="10" x="213" y="88.25" /><rect fill="#FFFFFF" filter="url(#fal1tkbmwwwh8)" height="293.5156" style="stroke:#A80036;stroke-width:1.0;" width="10" x="551" y="110.6016" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="218" x2="218" y1="78.25" y2="462.4688" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="555.5" x2="555.5" y1="78.25" y2="462.4688" /><rect fill="#FEFECE" filter="url(#fal1tkbmwwwh8)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="130" x="151" y="41.6406" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="158" y="63.1738">Consent Recorder</text><rect fill="#FEFECE" filter="url(#fal1tkbmwwwh8)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="123" x="492.5" y="41.6406" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="499.5" y="63.1738">Consent Registry</text><rect fill="#FFFFFF" filter="url(#fal1tkbmwwwh8)" height="315.8672" style="stroke:#A80036;stroke-width:1.0;" width="10" x="213" y="88.25" /><rect fill="#FFFFFF" filter="url(#fal1tkbmwwwh8)" height="293.5156" style="stroke:#A80036;stroke-width:1.0;" width="10" x="551" y="110.6016" /><ellipse cx="550.5" cy="109.8516" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;" /><polygon fill="#A80036" points="533.5,106.6016,543.5,110.6016,533.5,114.6016,537.5,110.6016" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="223" x2="539.5" y1="110.6016" y2="110.6016" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="230" y="105.7451">1</text><a href="ITI-108.html" target="_top" title="ITI-108.html" xlink:actuate="onRequest" xlink:href="ITI-108.html" xlink:show="new" xlink:title="ITI-108.html" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="38" x="241" y="105.7451">ITI-108</text></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="283" y="105.7451">- Query for existing Consent</text><polygon fill="#A80036" points="234,136.9531,224,140.9531,234,144.9531,230,140.9531" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="228" x2="550" y1="140.9531" y2="140.9531" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="240" y="136.0967">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="251" y="136.0967">None found</text><line style="stroke:#A80036;stroke-width:1.0;" x1="223" x2="265" y1="171.3047" y2="171.3047" /><line style="stroke:#A80036;stroke-width:1.0;" x1="265" x2="265" y1="171.3047" y2="184.3047" /><line style="stroke:#A80036;stroke-width:1.0;" x1="224" x2="265" y1="184.3047" y2="184.3047" /><polygon fill="#A80036" points="234,180.3047,224,184.3047,234,188.3047,230,184.3047" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="230" y="166.4482">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="241" y="166.4482">Consult with Patient</text><path d="M5,197.3047 L5,239.3047 L204,239.3047 L204,207.3047 L194,197.3047 L5,197.3047 " fill="#FBFB77" filter="url(#fal1tkbmwwwh8)" style="stroke:#A80036;stroke-width:1.0;" /><path d="M194,197.3047 L194,207.3047 L204,207.3047 L194,197.3047 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="11" y="215.7998">May use FHIR Questionnaire</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="11" y="232.1514">or any kind of User Experience</text><line style="stroke:#A80036;stroke-width:1.0;" x1="223" x2="265" y1="271.3594" y2="271.3594" /><line style="stroke:#A80036;stroke-width:1.0;" x1="265" x2="265" y1="271.3594" y2="284.3594" /><line style="stroke:#A80036;stroke-width:1.0;" x1="224" x2="265" y1="284.3594" y2="284.3594" /><polygon fill="#A80036" points="234,280.3594,224,284.3594,234,288.3594,230,284.3594" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="230" y="266.5029">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="241" y="266.5029">Capture Patient conditions and acceptance</text><path d="M17,297.3594 L17,372.3594 L204,372.3594 L204,307.3594 L194,297.3594 L17,297.3594 " fill="#FBFB77" filter="url(#fal1tkbmwwwh8)" style="stroke:#A80036;stroke-width:1.0;" /><path d="M194,297.3594 L194,307.3594 L204,307.3594 L194,297.3594 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="23" y="315.8545">Preserve documentation:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="23" y="332.2061">- QuestionnaireResponse</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="23" y="348.5576">- DocumentReference (MHD)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37" x="23" y="364.9092">- other</text><ellipse cx="555.5" cy="403.3672" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;" /><polygon fill="#A80036" points="538.5,400.1172,548.5,404.1172,538.5,408.1172,542.5,404.1172" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="218" x2="544.5" y1="404.1172" y2="404.1172" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="225" y="399.2607">5</text><a href="ITI-108.html" target="_top" title="ITI-108.html" xlink:actuate="onRequest" xlink:href="ITI-108.html" xlink:show="new" xlink:title="ITI-108.html" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="38" x="236" y="399.2607">ITI-108</text></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="251" x="278" y="399.2607">- Create Consent pointing at documentation</text><path d="M155,417.1172 L155,443.1172 L618,443.1172 L618,427.1172 L608,417.1172 L155,417.1172 " fill="#FBFB77" filter="url(#fal1tkbmwwwh8)" style="stroke:#A80036;stroke-width:1.0;" /><path d="M608,417.1172 L608,427.1172 L618,427.1172 L608,417.1172 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="326.75" y="435.6123">Record AuditEvent</text></g></svg>
<figcaption><b>Figure 1:53.4.2.1-1: Capture new Consent</b></figcaption>
</figure>
<p><br clear="all" /></p>

<p>The diagrammed steps:</p>

<ol>
  <li>Query for existing Consent. This step may not be necessary but is important to establish the Capture New Consent use case from the Update Existing Consent use case.</li>
  <li>None is found. Given that no existing Consent exists, there are no preconditions, just default expectations for the workflow.</li>
  <li>Consult with the Patient. There is some interaction with the Patient. Within this interaction the patient needs to be appropriately informed of the details of the Patient Privacy Policy and the parameters the patient can control. This user Interface might use a FHIR Questionnaire resulting in a QuestionnaireResponse as documentation of the ceremony. This User Interface might use some other technical means, or might be a paper process.  This User Interface is not constrained by the PCF.</li>
  <li>The results of the ceremony are captured to the satisfaction of the controlling Organization.  This might be a QuestionnaireResponse, or a scanned image of the signed paperwork recorded using a DocumentReference (See <a href="https://profiles.ihe.net/ITI/MHD/index.html">MHD</a>)</li>
  <li>The Consent resource constrained by the Consent constraints defined in Volume 3 is then saved to the <strong>Consent Registry</strong> using Transaction [ITI-108].</li>
  <li>An <a href="https://profiles.ihe.net/ITI/BALP/index.html">AuditEvent is recorded</a> by both <strong>Consent Recorder</strong> and <strong>Consent Registry</strong> Actors to support <a href="https://profiles.ihe.net/ITI/BALP/volume-1.html#1524-basicaudit-overview">Security and Privacy audit analysis use-cases</a>.</li>
</ol>

<h4 id="153422-use-case-2-update-existing-consent">1:53.4.2.2 Use Case #2: Update Existing Consent</h4>

<p>When a patient has an existing consent on file, and there is a need to capture a new consent. The Update Existing Consent use case is used to record the details of the new Consent ceremony and assure that the previous consent is no longer used.</p>

<h5 id="1534221-update-existing-consent-use-case-description">1:53.4.2.2.1 Update Existing Consent Use Case Description</h5>

<pre><code class="language-Gherkin">Scenario Outline: Update Existing Consent use Case
  Given an Organization controlling some Patient-identifiable Data 
  And they have written and published Patient Privacy Policies
  And there is a consent on file for a given Patient
  When they present their Patient Privacy Policies to a given Patient
  And the Patient either agrees, disagrees, or adds acceptable parameters
  Then a Consent is captured by the **Consent Recorder** and stored in the **Consent Registry**
  And the new Consent overwrites or invalidates the previous Consent
</code></pre>

<p>The Consent details are specific to the Patient Privacy Policy, the parameters agreed to in the ceremony, and the Consent profile (Basic, Intermediate, Advance) that was used.</p>

<h5 id="1534222-update-existing-consent-process-flow">1:53.4.2.2.2 Update Existing Consent Process Flow</h5>

<p>The following flow shows the activities involved in the Update Existing Consent flow.</p>

<figure>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" preserveAspectRatio="none" version="1.1" viewBox="0 0 632 469" zoomAndPan="magnify"><defs><filter height="300%" id="fp5ioxsiyiwse" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0" /><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0" /><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3" /><feBlend in="SourceGraphic" in2="blurOut3" mode="normal" /></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="197" x="215.25" y="30.6855">Update Existing Consent</text><rect fill="#FFFFFF" filter="url(#fp5ioxsiyiwse)" height="315.8672" style="stroke:#A80036;stroke-width:1.0;" width="10" x="213" y="88.25" /><rect fill="#FFFFFF" filter="url(#fp5ioxsiyiwse)" height="293.5156" style="stroke:#A80036;stroke-width:1.0;" width="10" x="554" y="110.6016" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="218" x2="218" y1="78.25" y2="462.4688" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="558.5" x2="558.5" y1="78.25" y2="462.4688" /><rect fill="#FEFECE" filter="url(#fp5ioxsiyiwse)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="130" x="151" y="41.6406" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="158" y="63.1738">Consent Recorder</text><rect fill="#FEFECE" filter="url(#fp5ioxsiyiwse)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="123" x="495.5" y="41.6406" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="502.5" y="63.1738">Consent Registry</text><rect fill="#FFFFFF" filter="url(#fp5ioxsiyiwse)" height="315.8672" style="stroke:#A80036;stroke-width:1.0;" width="10" x="213" y="88.25" /><rect fill="#FFFFFF" filter="url(#fp5ioxsiyiwse)" height="293.5156" style="stroke:#A80036;stroke-width:1.0;" width="10" x="554" y="110.6016" /><ellipse cx="553.5" cy="109.8516" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;" /><polygon fill="#A80036" points="536.5,106.6016,546.5,110.6016,536.5,114.6016,540.5,110.6016" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="223" x2="542.5" y1="110.6016" y2="110.6016" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="230" y="105.7451">1</text><a href="ITI-108.html" target="_top" title="ITI-108.html" xlink:actuate="onRequest" xlink:href="ITI-108.html" xlink:show="new" xlink:title="ITI-108.html" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="38" x="241" y="105.7451">ITI-108</text></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="283" y="105.7451">- Query for existing Consent</text><polygon fill="#A80036" points="234,136.9531,224,140.9531,234,144.9531,230,140.9531" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="228" x2="553" y1="140.9531" y2="140.9531" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="240" y="136.0967">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="251" y="136.0967">Some Found</text><line style="stroke:#A80036;stroke-width:1.0;" x1="223" x2="265" y1="171.3047" y2="171.3047" /><line style="stroke:#A80036;stroke-width:1.0;" x1="265" x2="265" y1="171.3047" y2="184.3047" /><line style="stroke:#A80036;stroke-width:1.0;" x1="224" x2="265" y1="184.3047" y2="184.3047" /><polygon fill="#A80036" points="234,180.3047,224,184.3047,234,188.3047,230,184.3047" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="230" y="166.4482">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246" x="241" y="166.4482">Consult with Patient, using existing details</text><path d="M5,197.3047 L5,239.3047 L204,239.3047 L204,207.3047 L194,197.3047 L5,197.3047 " fill="#FBFB77" filter="url(#fp5ioxsiyiwse)" style="stroke:#A80036;stroke-width:1.0;" /><path d="M194,197.3047 L194,207.3047 L204,207.3047 L194,197.3047 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="11" y="215.7998">May use FHIR Questionnaire</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="11" y="232.1514">or any kind of User Experience</text><line style="stroke:#A80036;stroke-width:1.0;" x1="223" x2="265" y1="271.3594" y2="271.3594" /><line style="stroke:#A80036;stroke-width:1.0;" x1="265" x2="265" y1="271.3594" y2="284.3594" /><line style="stroke:#A80036;stroke-width:1.0;" x1="224" x2="265" y1="284.3594" y2="284.3594" /><polygon fill="#A80036" points="234,280.3594,224,284.3594,234,288.3594,230,284.3594" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="230" y="266.5029">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="241" y="266.5029">Capture Patient conditions and acceptance</text><path d="M17,297.3594 L17,372.3594 L204,372.3594 L204,307.3594 L194,297.3594 L17,297.3594 " fill="#FBFB77" filter="url(#fp5ioxsiyiwse)" style="stroke:#A80036;stroke-width:1.0;" /><path d="M194,297.3594 L194,307.3594 L204,307.3594 L194,297.3594 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="23" y="315.8545">Preserve documentation:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="23" y="332.2061">- QuestionnaireResponse</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="23" y="348.5576">- DocumentReference (MHD)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37" x="23" y="364.9092">- other</text><ellipse cx="558.5" cy="403.3672" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;" /><polygon fill="#A80036" points="541.5,400.1172,551.5,404.1172,541.5,408.1172,545.5,404.1172" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="218" x2="547.5" y1="404.1172" y2="404.1172" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="225" y="399.2607">5</text><a href="ITI-108.html" target="_top" title="ITI-108.html" xlink:actuate="onRequest" xlink:href="ITI-108.html" xlink:show="new" xlink:title="ITI-108.html" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="38" x="236" y="399.2607">ITI-108</text></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254" x="278" y="399.2607">- Update Consent pointing at documentation</text><path d="M155,417.1172 L155,443.1172 L621,443.1172 L621,427.1172 L611,417.1172 L155,417.1172 " fill="#FBFB77" filter="url(#fp5ioxsiyiwse)" style="stroke:#A80036;stroke-width:1.0;" /><path d="M611,417.1172 L611,427.1172 L621,427.1172 L611,417.1172 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="328.25" y="435.6123">Record AuditEvent</text></g></svg>
<figcaption><b>Figure 1:53.4.2.2-1: Update Existing Consent Flow</b></figcaption>
</figure>
<p><br clear="all" /></p>

<p>The diagrammed steps:</p>

<ol>
  <li>Query for existing Consent. This step may not be necessary but is important to establish the Capture New Consent use case from the Update Existing Consent use case. This step is also useful to retrieve the current Consent parameters so that the User Interface can start with appropriate settings informed by the past.</li>
  <li>A Consent is found. More than one Consent may be found, for which the PCF does not address how to address this case. The overarching policy would need to be consulted.</li>
  <li>Consult with the Patient. There is some interaction with the Patient. Within this interaction the patient needs to be appropriately informed of the details of the Patient Privacy Policy and the parameters the patient can control. This user Interface might use a FHIR Questionnaire resulting in a QuestionnaireResponse as documentation of the ceremony. This User Interface might use some other technical means, or might be a paper process.  This User Interface is not constrained by the PCF.</li>
  <li>The results of the ceremony are captured to the satisfaction of the controlling Organization.  This might be a QuestionnaireResponse, or a scanned image of the signed paperwork recorded using a DocumentReference (See <a href="https://profiles.ihe.net/ITI/MHD/index.html">MHD</a>).</li>
  <li>The Consent resource constrained by the Consent constraints defined in Volume 3 is then saved to the <strong>Consent Registry</strong> using Transaction [ITI-108]. This is typically a FHIR Update action so as to replace the previous Consent. It is also possible to delete the previous and save the Consent as a new instance.</li>
  <li>An <a href="https://profiles.ihe.net/ITI/BALP/index.html">AuditEvent is recorded</a> by both <strong>Consent Recorder</strong> and <strong>Consent Registry</strong> Actors to support <a href="https://profiles.ihe.net/ITI/BALP/volume-1.html#1524-basicaudit-overview">Security and Privacy audit analysis use-cases</a>.</li>
</ol>

<h4 id="153423-use-case-3-consent-access-control">1:53.4.2.3 Use Case #3: Consent Access Control</h4>

<p>Given that an application needs access to resources, the following use case assures that any data made available is authorized by the Consent. Note that this use case presumes that business rules and security access control are incorporated into either the foundational oAuth flow, or some other process outside of this flow.</p>

<h5 id="1534231-consent-access-control-use-case-description">1:53.4.2.3.1 Consent Access Control Use Case Description</h5>

<pre><code class="language-Gherkin">Scenario Outline: Consent Access Control Use Case
  Given an Organization controlling some Patient-identifiable Data 
  And they have written and published Patient Privacy Policies
  And there is a consent on file for a given Patient
  When a request for patient-identifiable data is made
  Then the Consents are used by the **Consent Authorization Server** as stored in the **Consent Registry** to make Access Control Decisions
  And the **Consent Enforcement Point** assures that only data authorized by the Consent Access Control Decision are allowed to be exposed.
</code></pre>

<p>The Consent details are specific to the Patient Privacy Policy, the parameters agreed to in the ceremony, and the Consent profile (Basic, Intermediate, Advance) that was used.</p>

<h5 id="1534232-consent-access-control-process-flow">1:53.4.2.3.2 Consent Access Control Process Flow</h5>

<p>The following flow shows the activities involved in the Consent Access Control flow.</p>

<figure>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" preserveAspectRatio="none" version="1.1" viewBox="0 0 1599 916" zoomAndPan="magnify"><defs><filter height="300%" id="fp60r9qubjs0r" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0" /><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0" /><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3" /><feBlend in="SourceGraphic" in2="blurOut3" mode="normal" /></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="192" x="701" y="30.6855">Consent Access Control</text><rect fill="#DDDDDD" height="861.0469" style="stroke:#A80036;stroke-width:1.0;" width="512" x="180" y="42.6406" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="108" x="382" y="56.1357">Grouped Decider</text><rect fill="#DDDDDD" height="861.0469" style="stroke:#A80036;stroke-width:1.0;" width="511.5" x="805.5" y="42.6406" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="101" x="1010.75" y="56.1357">Grouped Server</text><rect fill="#FFFFFF" filter="url(#fp60r9qubjs0r)" height="701.3828" style="stroke:#A80036;stroke-width:1.0;" width="10" x="84.5" y="109.6016" /><rect fill="#FFFFFF" filter="url(#fp60r9qubjs0r)" height="648.6797" style="stroke:#A80036;stroke-width:1.0;" width="10" x="280.5" y="162.3047" /><rect fill="#FFFFFF" filter="url(#fp60r9qubjs0r)" height="679.0313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="595.5" y="131.9531" /><rect fill="#FFFFFF" filter="url(#fp60r9qubjs0r)" height="212.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="881.5" y="598.5234" /><rect fill="#FFFFFF" filter="url(#fp60r9qubjs0r)" height="91.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1107.5" y="689.5781" /><rect fill="#FFFFFF" filter="url(#fp60r9qubjs0r)" height="60.7031" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1381.5" y="192.6563" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="89" x2="89" y1="99.6016" y2="909.6875" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="285" x2="285" y1="99.6016" y2="909.6875" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="600" x2="600" y1="99.6016" y2="909.6875" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="886.5" x2="886.5" y1="99.6016" y2="909.6875" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1112" x2="1112" y1="99.6016" y2="909.6875" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1265" x2="1265" y1="99.6016" y2="909.6875" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1386" x2="1386" y1="99.6016" y2="909.6875" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1524" x2="1524" y1="99.6016" y2="909.6875" /><rect fill="#FEFECE" filter="url(#fp60r9qubjs0r)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="165" x="5" y="62.9922" /><a href="https://profiles.ihe.net/ITI/IUA/index.html#34111-authorization-client" target="_top" title="https://profiles.ihe.net/ITI/IUA/index.html#34111-authorization-client" xlink:actuate="onRequest" xlink:href="https://profiles.ihe.net/ITI/IUA/index.html#34111-authorization-client" xlink:show="new" xlink:title="https://profiles.ihe.net/ITI/IUA/index.html#34111-authorization-client" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="151" x="12" y="84.5254">IUA: Authorization Client</text></a><rect fill="#FEFECE" filter="url(#fp60r9qubjs0r)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="199" x="184" y="62.9922" /><a href="#consentAuthorizationServer" target="_top" title="#consentAuthorizationServer" xlink:actuate="onRequest" xlink:href="#consentAuthorizationServer" xlink:show="new" xlink:title="#consentAuthorizationServer" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="185" x="191" y="84.5254">Consent Authorization Server</text></a><rect fill="#FEFECE" filter="url(#fp60r9qubjs0r)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="171" x="513" y="62.9922" /><a href="https://profiles.ihe.net/ITI/IUA/index.html#34112-authorization-server" target="_top" title="https://profiles.ihe.net/ITI/IUA/index.html#34112-authorization-server" xlink:actuate="onRequest" xlink:href="https://profiles.ihe.net/ITI/IUA/index.html#34112-authorization-server" xlink:show="new" xlink:title="https://profiles.ihe.net/ITI/IUA/index.html#34112-authorization-server" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="157" x="520" y="84.5254">IUA: Authorization Server</text></a><rect fill="#FEFECE" filter="url(#fp60r9qubjs0r)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="150" x="809.5" y="62.9922" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="136" x="816.5" y="84.5254">IUA: Resource Server</text><rect fill="#FEFECE" filter="url(#fp60r9qubjs0r)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="187" x="1017" y="62.9922" /><a href="#consentEnforcementPoint" target="_top" title="#consentEnforcementPoint" xlink:actuate="onRequest" xlink:href="#consentEnforcementPoint" xlink:show="new" xlink:title="#consentEnforcementPoint" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="173" x="1024" y="84.5254">Consent Enforcement Point</text></a><rect fill="#FEFECE" filter="url(#fp60r9qubjs0r)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="91" x="1218" y="62.9922" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="1225" y="84.5254">FHIR Server</text><rect fill="#FEFECE" filter="url(#fp60r9qubjs0r)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="123" x="1323" y="62.9922" /><a href="#consentRegistry" target="_top" title="#consentRegistry" xlink:actuate="onRequest" xlink:href="#consentRegistry" xlink:show="new" xlink:title="#consentRegistry" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="109" x="1330" y="84.5254">Consent Registry</text></a><rect fill="#FEFECE" filter="url(#fp60r9qubjs0r)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="125" x="1460" y="62.9922" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="1467" y="84.5254">Open-ID-Connect</text><rect fill="#FFFFFF" filter="url(#fp60r9qubjs0r)" height="701.3828" style="stroke:#A80036;stroke-width:1.0;" width="10" x="84.5" y="109.6016" /><rect fill="#FFFFFF" filter="url(#fp60r9qubjs0r)" height="648.6797" style="stroke:#A80036;stroke-width:1.0;" width="10" x="280.5" y="162.3047" /><rect fill="#FFFFFF" filter="url(#fp60r9qubjs0r)" height="679.0313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="595.5" y="131.9531" /><rect fill="#FFFFFF" filter="url(#fp60r9qubjs0r)" height="212.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="881.5" y="598.5234" /><rect fill="#FFFFFF" filter="url(#fp60r9qubjs0r)" height="91.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1107.5" y="689.5781" /><rect fill="#FFFFFF" filter="url(#fp60r9qubjs0r)" height="60.7031" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1381.5" y="192.6563" /><ellipse cx="595" cy="131.2031" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;" /><polygon fill="#A80036" points="578,127.9531,588,131.9531,578,135.9531,582,131.9531" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="94.5" x2="584" y1="131.9531" y2="131.9531" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="101.5" y="127.0967">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="112.5" y="127.0967">IUA Get Access Token</text><a href="other.html#updates-to-iti-71" target="_top" title="other.html#updates-to-iti-71" xlink:actuate="onRequest" xlink:href="other.html#updates-to-iti-71" xlink:show="new" xlink:title="other.html#updates-to-iti-71" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="45" x="249.5" y="127.0967">_ITI-71_</text></a><polygon fill="#A80036" points="1512.5,158.3047,1522.5,162.3047,1512.5,166.3047,1516.5,162.3047" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="605.5" x2="1518.5" y1="162.3047" y2="162.3047" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="612.5" y="157.4482">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="623.5" y="157.4482">Get authorized user using Open-ID-Connect</text><polygon fill="#A80036" points="301.5,188.6563,291.5,192.6563,301.5,196.6563,297.5,192.6563" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="295.5" x2="594.5" y1="192.6563" y2="192.6563" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="307.5" y="187.7998">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="318.5" y="187.7998">Include Consents</text><ellipse cx="1381" cy="222.2578" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;" /><polygon fill="#A80036" points="1364,219.0078,1374,223.0078,1364,227.0078,1368,223.0078" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="290.5" x2="1370" y1="223.0078" y2="223.0078" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="297.5" y="218.1514">4</text><a href="ITI-108.html" target="_top" title="ITI-108.html" xlink:actuate="onRequest" xlink:href="ITI-108.html" xlink:show="new" xlink:title="ITI-108.html" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="38" x="308.5" y="218.1514">ITI-108</text></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="350.5" y="218.1514">- Query for existing Consent</text><polygon fill="#A80036" points="301.5,249.3594,291.5,253.3594,301.5,257.3594,297.5,253.3594" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="295.5" x2="1385.5" y1="253.3594" y2="253.3594" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="307.5" y="248.5029">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="318.5" y="248.5029">Return the Consents found</text><path d="M1320,266.3594 L1320,292.3594 L1448,292.3594 L1448,276.3594 L1438,266.3594 L1320,266.3594 " fill="#FBFB77" filter="url(#fp60r9qubjs0r)" style="stroke:#A80036;stroke-width:1.0;" /><path d="M1438,266.3594 L1438,276.3594 L1448,276.3594 L1438,266.3594 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="1326" y="284.8545">Record AuditEvent</text><line style="stroke:#A80036;stroke-width:1.0;" x1="290.5" x2="332.5" y1="324.0625" y2="324.0625" /><line style="stroke:#A80036;stroke-width:1.0;" x1="332.5" x2="332.5" y1="324.0625" y2="337.0625" /><line style="stroke:#A80036;stroke-width:1.0;" x1="291.5" x2="332.5" y1="337.0625" y2="337.0625" /><polygon fill="#A80036" points="301.5,333.0625,291.5,337.0625,301.5,341.0625,297.5,337.0625" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="297.5" y="319.2061">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="308.5" y="319.2061">Match provisions to request context</text><line style="stroke:#A80036;stroke-width:1.0;" x1="290.5" x2="332.5" y1="367.4141" y2="367.4141" /><line style="stroke:#A80036;stroke-width:1.0;" x1="332.5" x2="332.5" y1="367.4141" y2="380.4141" /><line style="stroke:#A80036;stroke-width:1.0;" x1="291.5" x2="332.5" y1="380.4141" y2="380.4141" /><polygon fill="#A80036" points="301.5,376.4141,291.5,380.4141,301.5,384.4141,297.5,380.4141" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="297.5" y="362.5576">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="280" x="308.5" y="362.5576">Make Consent focused Access Control Decision</text><polygon fill="#A80036" points="583.5,406.7656,593.5,410.7656,583.5,414.7656,587.5,410.7656" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="290.5" x2="589.5" y1="410.7656" y2="410.7656" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="297.5" y="405.9092">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="308.5" y="405.9092">Include consent decisions</text><line style="stroke:#A80036;stroke-width:1.0;" x1="605.5" x2="647.5" y1="441.1172" y2="441.1172" /><line style="stroke:#A80036;stroke-width:1.0;" x1="647.5" x2="647.5" y1="441.1172" y2="454.1172" /><line style="stroke:#A80036;stroke-width:1.0;" x1="606.5" x2="647.5" y1="454.1172" y2="454.1172" /><polygon fill="#A80036" points="616.5,450.1172,606.5,454.1172,616.5,458.1172,612.5,454.1172" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="612.5" y="436.2607">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="623.5" y="436.2607">Combine Access Control decisions</text><line style="stroke:#A80036;stroke-width:1.0;" x1="605.5" x2="647.5" y1="484.4688" y2="484.4688" /><line style="stroke:#A80036;stroke-width:1.0;" x1="647.5" x2="647.5" y1="484.4688" y2="497.4688" /><line style="stroke:#A80036;stroke-width:1.0;" x1="606.5" x2="647.5" y1="497.4688" y2="497.4688" /><polygon fill="#A80036" points="616.5,493.4688,606.5,497.4688,616.5,501.4688,612.5,497.4688" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="612.5" y="479.6123">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244" x="630.5" y="479.6123">Encode combined decision in oAuth token</text><path d="M534,510.4688 L534,536.4688 L662,536.4688 L662,520.4688 L652,510.4688 L534,510.4688 " fill="#FBFB77" filter="url(#fp60r9qubjs0r)" style="stroke:#A80036;stroke-width:1.0;" /><path d="M652,510.4688 L652,520.4688 L662,520.4688 L652,510.4688 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="540" y="528.9639">Record AuditEvent</text><polygon fill="#A80036" points="105.5,564.1719,95.5,568.1719,105.5,572.1719,101.5,568.1719" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="99.5" x2="594.5" y1="568.1719" y2="568.1719" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="111.5" y="563.3154">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="129.5" y="563.3154">Decision to be Enforced</text><ellipse cx="881" cy="597.7734" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;" /><polygon fill="#A80036" points="864,594.5234,874,598.5234,864,602.5234,868,598.5234" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="94.5" x2="870" y1="598.5234" y2="598.5234" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="101.5" y="593.667">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="119.5" y="593.667">"IUA: Incorporate Access Token</text><a href="https://profiles.ihe.net/ITI/IUA/index.html#372-incorporate-access-token-iti-72" target="_top" title="https://profiles.ihe.net/ITI/IUA/index.html#372-incorporate-access-token-iti-72" xlink:actuate="onRequest" xlink:href="https://profiles.ihe.net/ITI/IUA/index.html#372-incorporate-access-token-iti-72" xlink:show="new" xlink:title="https://profiles.ihe.net/ITI/IUA/index.html#372-incorporate-access-token-iti-72" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="31" x="308.5" y="593.667">ITI-72</text></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="339.5" y="593.667">"</text><ellipse cx="605" cy="628.125" rx="4" ry="4" style="stroke:#A80036;stroke-width:1.5;fill:none;" /><polygon fill="#A80036" points="622,624.875,612,628.875,622,632.875,618,628.875" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="620" x2="880.5" y1="628.875" y2="628.875" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="622.5" y="624.0186">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="640.5" y="624.0186">"IUA: Introspect Token</text><a href="https://profiles.ihe.net/ITI/IUA/index.html#3102-introspect-token-iti-102" target="_top" title="https://profiles.ihe.net/ITI/IUA/index.html#3102-introspect-token-iti-102" xlink:actuate="onRequest" xlink:href="https://profiles.ihe.net/ITI/IUA/index.html#3102-introspect-token-iti-102" xlink:show="new" xlink:title="https://profiles.ihe.net/ITI/IUA/index.html#3102-introspect-token-iti-102" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="underline" textLength="38" x="774.5" y="624.0186">ITI-102</text></a><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="812.5" y="624.0186">"</text><polygon fill="#A80036" points="301.5,655.2266,291.5,659.2266,301.5,663.2266,297.5,659.2266" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="295.5" x2="594.5" y1="659.2266" y2="659.2266" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="307.5" y="654.3701">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="325.5" y="654.3701">Include Consent details</text><polygon fill="#A80036" points="869.5,685.5781,879.5,689.5781,869.5,693.5781,873.5,689.5781" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="605.5" x2="875.5" y1="689.5781" y2="689.5781" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="612.5" y="684.7217">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="630.5" y="684.7217">Return token details</text><polygon fill="#A80036" points="1095.5,715.9297,1105.5,719.9297,1095.5,723.9297,1099.5,719.9297" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="891.5" x2="1101.5" y1="719.9297" y2="719.9297" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="898.5" y="715.0732">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="916.5" y="715.0732">Enforce authorization decision</text><polygon fill="#A80036" points="1253.5,746.2813,1263.5,750.2813,1253.5,754.2813,1257.5,750.2813" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1117.5" x2="1259.5" y1="750.2813" y2="750.2813" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="1124.5" y="745.4248">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="1142.5" y="745.4248">execute request</text><polygon fill="#A80036" points="902.5,776.6328,892.5,780.6328,902.5,784.6328,898.5,780.6328" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="896.5" x2="1111.5" y1="780.6328" y2="780.6328" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="908.5" y="775.7764">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="926.5" y="775.7764">Enforce authorization decision</text><polygon fill="#A80036" points="100.5,806.9844,90.5,810.9844,100.5,814.9844,96.5,810.9844" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="94.5" x2="885.5" y1="810.9844" y2="810.9844" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="106.5" y="806.1279">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="124.5" y="806.1279">Returned authoried results</text><path d="M820,823.9844 L820,849.9844 L948,849.9844 L948,833.9844 L938,823.9844 L820,823.9844 " fill="#FBFB77" filter="url(#fp60r9qubjs0r)" style="stroke:#A80036;stroke-width:1.0;" /><path d="M938,823.9844 L938,833.9844 L948,833.9844 L938,823.9844 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="826" y="842.4795">Record AuditEvent</text><path d="M23,864.3359 L23,890.3359 L151,890.3359 L151,874.3359 L141,864.3359 L23,864.3359 " fill="#FBFB77" filter="url(#fp60r9qubjs0r)" style="stroke:#A80036;stroke-width:1.0;" /><path d="M141,864.3359 L141,874.3359 L151,874.3359 L141,864.3359 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="29" y="882.8311">Record AuditEvent</text></g></svg>
<figcaption><b>Figure 1:53.4.2.3-1: Consent Access Control Flow</b></figcaption>
</figure>
<p><br clear="all" /></p>

<p>The diagrammed steps:</p>

<ol>
  <li>a <strong>IUA Authorization Client</strong>, an abstraction of an app and possibly a user, requests an Access Token of the <strong>IUA Authorization Server</strong> with some defined patient, user, app, and data parameters. This is the access request context upon which the <strong>Consent Authorization Server</strong> will make Consent Access Control Decisions.</li>
  <li>The <strong>IUA Authorization Server</strong> gets user identity information, if available (e.g., by using one or more Open-ID Connect authority) adding any details to the access request context –&gt; Note that failure to identify a user may be a failure-mode.</li>
  <li>The <strong>IUA Authorization Server</strong> invokes the <strong>Consent Authorization Server</strong> passing any predicate access token, if available, adding any details to the access request context –&gt; Note that failure to get an authorization token may be a failure-mode.</li>
  <li>The <strong>Consent Authorization Server</strong> looks for Patient Consents at the <strong>Consent Registry</strong> Actor(s). The access request context may be used to limit the Consent resources returned.</li>
  <li>The <strong>Consent Authorization Server</strong> receives the available consents. –&gt; Note that no consent found means that the active default Implicit policy is enforced.</li>
  <li>The <strong>Consent Authorization Server</strong> determines the best match or matches of Consents returned to the access control request context (patient, user, app, purposeOfUse, data parameters, etc.).</li>
  <li>The <strong>Consent Authorization Server</strong> makes the Access Control Decision based on the Consents.</li>
  <li>The <strong>Consent Authorization Server</strong> provides the consent decisions to the <strong>IUA Authorization Server</strong>.</li>
  <li>The <strong>IUA Authorization Server</strong> combines the Consent Access Control Decision with the decisions returned in step 2 and 3.</li>
  <li>The <strong>IUA Authorization Server</strong> encodes the combined Access Control Decision into an oAuth token. This is typically just associating the conditions of the Access Control Decision with the opaque oAuth token returned, such that, later in step 13, the ITI-102 transaction can be used to get the details. This combined Access Control decision indicates what is permitted or denied and any obligations or refrains that must be applied.</li>
  <li>The <strong>IUA Authorization Server</strong> returns this combined token to the <strong>IUA Authorization Client</strong>. –&gt; Note that failure-modes will not return a success token but rather an access-denied response.</li>
  <li>The <strong>IUA Authorization Client</strong> encapsulates the given oAuth token, using ITI-72, to indicate the authorization given where the grouped transaction is as defined by the data access implementation guide that is grouped. Meaning the transaction is otherwise as defined elsewhere. The <strong>IUA Resource Server</strong> receives the ITI-72 and extracts the oAuth token.
<!-- the above sentences are hard to parse --></li>
  <li>The <strong>IUA Resource Server</strong> may request introspection using [ITI-102].</li>
  <li>The <strong>IUA Authorization Server</strong> includes details from the <strong>Consent Authorization Server</strong> decision.</li>
  <li>The <strong>IUA Authorization Server</strong> returns the token details. ITI-102 is augmented here to communicate the Consent Access Control decision details.</li>
  <li>The <strong>IUA Resource Server</strong> calls upon the <strong>Consent Enforcement Point</strong> to enforce the token. The <strong>Consent Enforcement Point</strong> may be able to enforce some of the Consent Access Control prior to retrieving the data requested, such as where the Consent Access Control decision would forbid a kind of FHIR Resource.</li>
  <li>The <strong>Consent Enforcement Point</strong> would use undefined means to retrieve the requested data from the FHIR Server. This may be by executing the grouped transaction with privileged access.</li>
  <li>The <strong>Consent Enforcement Point</strong> would inspect the results and further enforce the Consent Access Control decision. This might be to filter out specific resources that could not have been filtered out in other ways.</li>
  <li>The <strong>IUA Resource Server</strong> returns the authorized data to the <strong>IUA Authorization Client</strong>.</li>
</ol>

<p>Not shown, for simplicity of the diagram, is the recording <a href="https://profiles.ihe.net/ITI/BALP/index.html">AuditEvent</a> by all actors to support <a href="https://profiles.ihe.net/ITI/BALP/volume-1.html#1524-basicaudit-overview">Security and Privacy audit analysis use-cases</a>.</p>

<h4 id="153424-implicit-consent-content">1:53.4.2.4 Implicit Consent Content</h4>

<p>These use cases will outline the justification for the alternatives within the <strong>Implicit Consent Option</strong>.</p>

<p><strong>Pre-conditions</strong>:</p>

<p>Given there is no consent for a given patient. This may be because:</p>

<ul>
  <li>no consent is available, or</li>
  <li>that there is no mechanism to capture consent, or</li>
  <li>that the existence of a consent does not impact Access Control, such as when consent is used to simply flag that this patient has been presented with the privacy policy.</li>
</ul>

<p><strong>Main Flow</strong>:</p>

<ul>
  <li>The Business has chosen one of the defined <strong>Implicit Consent Option</strong> alternatives</li>
  <li>There is no Access Control use of any Consent resource in <strong>Implicit Consent Option</strong></li>
</ul>

<p><strong>Post-conditions</strong>:</p>

<ul>
  <li>The alternative protects access (see below)</li>
</ul>

<h5 id="1534241-permit-clinical-treatment">1:53.4.2.4.1 Permit Clinical Treatment</h5>

<p>Permits access by clinicians that have authorization for Treatment use, but does not authorize other access. This presumes that basic user access control can differentiate legitimate clinical users and legitimate clinical purpose.</p>

<p><strong>Pre-conditions</strong>:</p>

<p>The controlling Organization has identified Clinical roles that would have access for Treatment, and has mechanisms in place to prevent any inappropriate use.</p>

<p><strong>Main Flow</strong>:</p>

<ul>
  <li>Business Access Control prevents inappropriate users, applications, purposes, and activities. Allowing only access by Clinical users under Treatment purpose.</li>
  <li>There is no Access Control use of the Consent resource</li>
</ul>

<p><strong>Post-conditions</strong>:</p>

<p>Business Access Controls control appropriate access, thus clinical users get access for clinical treatment need.</p>

<h5 id="1534242-permit-all-authorized">1:53.4.2.4.2 Permit All Authorized</h5>

<p>Permits access by all authorized users. This presumes that basic user access control will only allow authorized users and for authorized purpose of use.</p>

<p><strong>Pre-conditions</strong>:</p>

<p>The controlling Organization has identified various roles that would have access for a given purpose, and has mechanisms in place to prevent any inappropriate use. This is distinct from the previous use case in that the roles and the purpose are not limited to Clinical and Treatment.</p>

<p><strong>Main Flow</strong>:</p>

<ul>
  <li>Business Access Control prevents inappropriate users, applications, purposes, and activities.</li>
  <li>There is no Access Control use of the Consent resource</li>
</ul>

<p><strong>Post-conditions</strong>:</p>

<p>Business Access Controls control appropriate access.</p>

<h5 id="1534243-deny-all">1:53.4.2.4.3 Deny All</h5>

<p>Deny all uses without exceptions. This is an unusual setting for a purely Implicit consent environment, but is intended to be paired with an Explicit consent. When paired with an Explicit consent, the <strong>Deny All</strong> functions as the default policy when no explicit consent is on record. This might also be used in a system that is designed simply to record data with no access to that data (e.g., an Audit log repository).</p>

<p><strong>Pre-conditions</strong>:</p>

<p>The controlling Organization has controls in place to prevent all access.</p>

<p><strong>Main Flow</strong>:</p>

<ul>
  <li>Business Access Control prevents all access by any users, applications, purposes, and activities.</li>
  <li>There is no Access Control use of the Consent resource</li>
</ul>

<p><strong>Post-conditions</strong>:</p>

<p>Business Access Controls control appropriate access.</p>

<h4 id="153425-basic-consent-content">1:53.4.2.5 Basic Consent Content</h4>

<p>The <strong>Basic Consent</strong> content provides for recording that a Consent has been given and this content is the basis of all explicit consent options. The goal of a basic consent content is to express how a Consent is recorded, Updated, Removed, and Expired. The basic consent content also shows how one finds relevant Consent instances, and determines if they are still valid.</p>

<p><strong>Pre-conditions</strong>:</p>

<ul>
  <li>
    <p>The controlling Organization has identified various roles and the kinds of purpose of use those roles are authorized to participate in.</p>
  </li>
  <li>
    <p>The Controlling Organization defines the default policy to be used when no consent is found, possibly choosing from the <strong>Implicit Consent</strong> Options policies.</p>
  </li>
  <li>
    <p>The Controlling Organization defines the policy to be used with the <strong>Explicit Basic</strong> option, the policy that will be enforced when the patient has agreed to a consent.</p>
  </li>
</ul>

<p><strong>Main Flow</strong>:</p>

<ul>
  <li>The Business Access Control prevents inappropriate users, applications, purposes, and activities</li>
  <li>when a consent is found to apply to the user / application and purpose of use (given patient, organization, and policy)
    <ul>
      <li>And that consent has not expired
        <ul>
          <li>When that consent is a Permit of the access requested
            <ul>
              <li>Then Access Control allows access</li>
            </ul>
          </li>
          <li>When that consent is a Deny
            <ul>
              <li>Then Access Control enforces the deny policy</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>When no consent is found or has expired
    <ul>
      <li>Then Access Control enforces the chosen default policy</li>
    </ul>
  </li>
</ul>

<p><strong>Post-conditions:</strong></p>

<p>Appropriate use is allowed, inappropriate use is denied</p>

<p><strong>Content:</strong></p>

<p>The following set of patient specific parameters may be used to permit or deny:</p>

<ol>
  <li>The overarching policy that the patient and organization have agreed upon. Where there is a defined set of behavior defined by overarching policies as defined in the <strong>Implicit Consent Option</strong>.</li>
  <li>The timeframe for which the consent applies. Enabling consents that have a time limit.</li>
  <li>Who is permitted/denied: This may be a device, relatedPerson, Practitioner, or Organization. This parameter enables the naming of agents that should be allowed access or denied access. This presumes that the identified agent is appropriately identified (provisioned) and authorized to make the request; typically through some application authorization and role-based access control. The user identity is mapped to a FHIR agent type Resource using the agent type Resource <code class="language-plaintext highlighter-rouge">.identifier</code> element (e.g., Practitioner.identifier would hold the user id).</li>
  <li>Purpose of use permitted/denied: There are a number of PurposeOfUse that are available to be explicably identified as an authorized purposeOfUse or denied purposeOfuse. This presumes that the requesting user has the authorization to request for the requested purposeOfUse. That is to say that the Consent Authorization Server does not determine whether the user/client is authorized to make the purposeOfUse declaration; this must be previously decided by the security context (see cascaded oAuth) –  Treatment, Payment, and Operations.</li>
</ol>

<h4 id="153426-intermediate-consent-contents">1:53.4.2.6 Intermediate Consent Contents</h4>

<p>The <strong>Intermediate Consent</strong> contents shall be used in conjunction with <strong>Basic Consent</strong> content, and may be used with <strong>Advanced Consent</strong> content. Whereas the <strong>Basic Consent</strong> is used to record the fundamental aspects of the Consent ceremony, the <strong>Intermediate Consent</strong> contents can be used independently or together.</p>

<p><strong>Pre-conditions</strong>:</p>

<ul>
  <li>
    <p>The controlling Organization has identified various roles and the purpose of use in which those roles are authorized to participate.</p>
  </li>
  <li>
    <p>The Controlling Organization defines the default policy to be used when no consent is found, possibly choosing from the <strong>Implicit Consent</strong> option policies.</p>
  </li>
  <li>
    <p>The Controlling Organization defines the policy to be used with the <strong>Explicit Basic</strong> option, the policy that will be enforced when the patient agrees to a consent.</p>
  </li>
  <li>
    <p>The controlling Organization provides for the patient to choose from the intermediate parameters that the controlling organization is willing to enforce, recognizing that some parameters may not be appropriate or allowed.</p>
  </li>
  <li>
    <p>The <strong>Consent Recorder</strong> is responsible for assuring that the recorded Consent is enforceable and appropriate.</p>
  </li>
</ul>

<p><strong>Main Flow</strong>:</p>

<ul>
  <li>Given The Business Access Control prevents inappropriate users, applications, purposes, and activities
    <ul>
      <li>And an appropriate user / application requests access for an appropriate purpose and activity</li>
      <li>And the data is tagged with appropriate sensitivity and confidentiality vocabulary</li>
    </ul>
  </li>
  <li><strong>Consent Authorization Server</strong>
    <ul>
      <li>when a consent is found to apply to the user / application and purpose of use (given patient, organization, and policy)
        <ul>
          <li>And that consent has not expired
            <ul>
              <li>The overall policy identified by Consent will be recognized to determine the overall Permit/Deny</li>
              <li>The provisions will be recognized for any applicability to the requested access</li>
            </ul>
          </li>
        </ul>
      </li>
      <li>decision of either Deny authorization, or return a Permit with appropriate scope restrictions. The scope restrictions may match the requested scope, or may have been impacted by the Consent parameters.</li>
    </ul>
  </li>
</ul>

<p><strong>Post-conditions:</strong></p>

<ul>
  <li><strong>Consent Enforcement Point</strong> assures only appropriate use is allowed, inappropriate use is denied</li>
</ul>

<h5 id="1534261-intermediate-data-timeframe-content">1:53.4.2.6.1 Intermediate Data Timeframe Content</h5>

<p>This data scoping content provides for the Consent to have one or more permit/deny parameter that indicates a timeframe within which data has been authored or last updated.</p>

<p>The use case would be where a patient knows that there was a period of time where they received care, and for which the patient indicates they want to segment out that data for permit or deny. The user interface is not defined here or constrained.</p>

<h5 id="1534262-intermediate-data-by-id-content">1:53.4.2.6.2 Intermediate Data by id Content</h5>

<p>This data scoping content provides for the Consent to have one or more permit/deny parameter that indicates a FHIR Resources by <code class="language-plaintext highlighter-rouge">.id</code> value.</p>

<p>The use case would be where a patient knows specific data artifacts that the patient indicates they want to segment out for permit or deny. The user interface is not defined here or constrained.</p>

<h5 id="1534263-intermediate-data-author-content">1:53.4.2.6.3 Intermediate Data Author Content</h5>

<p>This data scoping content provides for the Consent to have one or more permit/deny parameter that indicates that data is subject to the rule by way of a given author. This content is useful when the consent provision is limiting access to data that was authorized by a given practitioner.</p>

<p>The use case would be where a patient wants to segment out data authored by an author known to the patient (organization or practitioner) for permit or deny. Note that this capability depends on proper recording and attribution of data to the author. The user interface is not defined here or constrained.</p>

<h5 id="1534264-intermediate-data-relationship-content">1:53.4.2.6.4 Intermediate Data Relationship Content</h5>

<p>This data scoping content provides for the Consent to have one or more permit/deny parameter that indicates that data is subject to the rule by way of that data being related in a given way to a given identified data object. This content is useful for indicating a consent provision that is limiting/authorizing access to data that was created as part of an encounter, care plan, or episode of care.</p>

<p>The use case would be where a patient knows an encounter, care plan, or episode of care that can identify the data that the patient wants to segment out for permit or deny. Note that this capability depends on proper attribution of the data to the encounter, care plan, or episode of care. The user interface is not defined here or constrained.</p>

<h5 id="1534265-intermediate-additional-purposeofuse-content">1:53.4.2.6.5 Intermediate Additional PurposeOfUse Content</h5>

<p>This content provides for the Consent to have one or more permit/deny parameter that indicates a purposeOfUse not listed in the <strong>Basic Consent</strong> vocabulary. This would tend to be used with Clinical Research projects, where the purposeOfUse is a code assigned to a specific Clinical Research Project. This may also be used for other purposeOfUse codes. Whereas <strong>Basic Consent</strong> has some well-known purposeOfUse codes, this content is used for other codes.</p>

<p>The use case would be where a patient authorizes a purposeOfUse beyond those defined in the <strong>Basic Consent</strong>. An example would be a Privacy Consent allowing an identified clinical research project to have access to the patient data.</p>

<p>This would also be used to indicate that the Consent has provisions enabling Break-Glass access using the PurposeOfUse for Break-Glass (BTG). The Consent and Access Token encodings are defined, but the rules around who is authorized and how they declare Break-Glass are not defined as they are dependent on User-Interface, User-Experience, and Policy.</p>

<h4 id="153427-advanced-consent-content">1:53.4.2.7 Advanced Consent Content</h4>

<p>The <strong>Advanced Consent</strong> contents shall be used in conjunction with <strong>Basic Consent</strong> content, and may be used with <strong>Intermediate Consent</strong> content.  Whereas the <strong>Basic Consent</strong> is used to record the fundamental aspects of the Consent ceremony, the <strong>Advanced Consent</strong> Content provides for parameters in a Consent that express rules around data classified by sensitivity and confidentiality.</p>

<p>Support for the Advanced Consent relies on the data being tagged with sensitivity codes and confidentiality codes. This data tagging is not defined in PCF. There are a few established ways to get the data tagged including using a <a href="ch-P.html#SLS">Security labeling Service</a>, which has a few established architectures. The implementation of security tagging is a systems design requirement on the <strong>Consent Enforcement Point</strong>.</p>

<p><strong>Pre-conditions</strong>:</p>

<ul>
  <li>
    <p>The controlling Organization has identified various roles and purposes of use in which those roles are authorized to participate.</p>
  </li>
  <li>
    <p>The Controlling Organization defines the default policy to be used when no consent is found, possibly choosing from the <strong>Implicit Consent</strong> option policies.</p>
  </li>
  <li>
    <p>The Controlling Organization defines the policy to be used with the <strong>Explicit Basic</strong> option, the policy that will be enforced when the patient has agreed to a consent.</p>
  </li>
  <li>
    <p>The controlling Organization provides for the patient to choose from the intermediate parameters that the controlling organization is willing to enforce, recognizing that some parameters may not be appropriate or allowed.</p>
  </li>
  <li>
    <p>The <strong>Consent Recorder</strong> is responsible for assuring that the recorded Consent is enforceable and appropriate.</p>
  </li>
</ul>

<p><strong>Main Flow</strong>:</p>

<ul>
  <li>Given The Business Access Control prevents inappropriate users, applications, purposes, and activities
    <ul>
      <li>And an appropriate user / application requests access for an appropriate purpose and activity</li>
      <li>And the data are tagged with appropriate sensitivity and confidentiality vocabulary</li>
    </ul>
  </li>
  <li><strong>Consent Authorization Server</strong>
    <ul>
      <li>when a consent is found to apply to the user / application and purpose of use (given patient, organization, and policy)
        <ul>
          <li>And that consent has not expired
            <ul>
              <li>The overall policy identified by Consent will be recognized relative to the overall Permit/Deny</li>
              <li>The provisions will be recognized for any applicability to the requested access</li>
            </ul>
          </li>
        </ul>
      </li>
      <li>decision of either Deny authorization, or return a Permit with appropriate scope restrictions. The scope restrictions may match the requested scope, or may have been impacted by the Consent parameters.</li>
    </ul>
  </li>
</ul>

<p><strong>Post-conditions:</strong></p>

<ul>
  <li><strong>Consent Enforcement Point</strong> assures only appropriate use is allowed, inappropriate use is denied</li>
</ul>

<p><strong>Content:</strong></p>

<p>The <strong>Advanced Consent</strong> content utilizes sensitivity codes and confidentiality codes. The Consent would include parameters that would indicate for a given sensitivity/confidentiality code the conditions on Permit or Deny.</p>

<p>The typical use case would be where the patient will allow normal confidentiality data to be used for some purpose such as Treatment, but indicates that data tagged as restricted confidentiality not be used.</p>

<p>At a minimum the following stigmatizing <a href="https://terminology.hl7.org/ValueSet-v3-InformationSensitivityPolicy.html">Sensitivity</a> classifications shall be implemented as parameters:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ETH</code> – Substance Abuse including Alcohol
    <ul>
      <li><code class="language-plaintext highlighter-rouge">ETHUD</code> – Alcohol substance abuse</li>
      <li><code class="language-plaintext highlighter-rouge">OPIOIDUD</code> – Opioid drug abuse</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">PSY</code> – Psychiatry Disorder</li>
  <li><code class="language-plaintext highlighter-rouge">SDV</code> – Sexual Assault, Abuse, or Domestic Violence</li>
  <li><code class="language-plaintext highlighter-rouge">HIV</code> – HIV/AIDS</li>
</ul>

<p>At a minimum the following <a href="https://terminology.hl7.org/ValueSet-v3-Confidentiality.html">ConfidentialityCodes</a> shall be implemented as parameters:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">N</code> Normal and</li>
  <li><code class="language-plaintext highlighter-rouge">R</code> Restricted</li>
</ul>

<p>The ConfidentialityCode may be assigned to data by various ways. Where data have a stigmatizing sensitivity classification, the ConfidentialityCode shall be Restricted, otherwise the data are Normal. Other methods of determining the ConfidentialityCode for data are allowed.</p>

<p><a name="security-considerations"> </a></p>

<h2 id="1535-pcf-security-considerations">1:53.5 PCF Security Considerations</h2>

<p>See ITI TF-2x: <a href="https://profiles.ihe.net/ITI/TF/Volume2/ch-Z.html#z.8-mobile-security-considerations">Appendix Z.8 “Mobile Security Considerations”</a>.</p>

<p>A change to <a href="ch-P.html">any policy</a> needs to be carefully managed, especially the <a href="ch-P.html">Domain Privacy Policy / Overarching Policy</a>. A change to Overarching Policy may have no impact on the Consent, or may invalidate all Consents. The Overarching Policy identification is a foundational element of a Consent, and thus when the Overarching policy terms change, one can identify all Consents that were based on the prior <strong>Patient Privacy Policy Identifier</strong>. In some cases, such as jurisdictional rules backed by laws, the Overarching Policy may change, effectively changing the effect of the rules of a Consent based on that Overarching Policy.</p>

<p>The <a href="https://profiles.ihe.net/ITI/BALP/index.html">Basic Audit Log Patterns</a> defines the audit log patterns, these audit log patterns can be recorded using the <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">ATNA</a> <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html#9.2.7.2">ATX:TLS Syslog</a>, <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html#9.2.7.3">ATX: UDP Syslog</a>, or <a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">ATX: FHIR Feed</a>.</p>

<p>Security and Privacy office should use the <a href="https://profiles.ihe.net/ITI/BALP/index.html">BALP profiled AuditEvent</a> to track changes and uses of the Consent resources. The AuditEvent is required of <a href="ITI-108.html#2310851-security-audit-considerations">PCF when grouped with ATNA</a>. The Provenance resource recording is not required of PCF as the use case need would be satisfied by the AuditEvent record. However an implementation may choose to use Provenance on Create/Update/Delete in addition to AuditEvent. Examples of <a href="Provenance-ex-provenance-consent-basic-treat.html">a Provenance of create</a> and <a href="Provenance-ex-provenance2-consent-basic-treat.html">a Provenance of update</a> are provided. The use of Provenance is discussed in <a href="ch-P.html#p43-change-to-deny-sharing">Appendix P.4.3</a>.</p>

<p>Security office should monitor the audit log for uses of break-glass, and follow up to confirm it was a legitimate use of break-glass per policy.</p>

<p>Security office should monitor audit logs for access denied, and follow up to confirm that it was a legitimate denial of an access request. Possibly further investigating why the request was initiated.</p>

<p>Technical failures (failure-modes) where some technical or infrastructure is not performing nominally should be handled carefully. There are healthcare treatment cases where these failure-modes should result in allowing access to prefer patient and operator safety over privacy, where other less life-critical use cases should prefer preserving privacy and denying access.</p>

<p><a name="other-grouping"> </a></p>

<h2 id="1536-pcf-cross-profile-considerations">1:53.6 PCF Cross-Profile Considerations</h2>

<p>This implementation guide is expected to be used in conjunction with other implementation guides (Profiles) that provide access to Patient-specific data such as <a href="https://profiles.ihe.net/ITI/MHDS/index.html">Mobile Health Document Sharing (MHDS)</a> or the <a href="https://profiles.ihe.net/PCC/index.html">PCC</a> Query for Existing Data for Mobile (QEDm). These other implementation guides would have their <a href="volume-1.html#1531-pcf-actors-transactions-and-content-modules">appropriate actors grouped as shown in Figure 1:53.1-1</a> as “Grouped Client” and “Grouped Server”.</p>




</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->

  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/jquery-ui.min.js"> </script>

  <script type="text/javascript">
    $(document).ready(function(){
      if(window.location.hash != "") {
          $('a[href="' + window.location.hash + '"]').click()
      }
    });
  </script>
  <a name="bottom"> </a>
  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->

      <div style="background-color:var(--footer-nav-bg-color)">
        <table style="width:100%">
          <tbody>
            <tr>
              <td style="text-align:left">&#xA0;

                <a href="index.html">&lt;prev</a>

              </td>
              <td style="text-align:center">
                <a href="#top">top</a>
              </td>
              <td style="text-align:right">&#xA0;

                <a href="ch-P.html">next&gt;</a>

              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="inner-wrapper">
        <p>
          IG &#169; 2023+ <a style="color:var(--footer-hyperlink-text-color)" href="https://www.ihe.net/ihe_domains/it_infrastructure/">IHE IT Infrastructure Technical Committee</a>.  Package ihe.iti.pcf#1.0.0 based on <a style="color: var(--footer-hyperlink-text-color)" href="http://hl7.org/fhir/R5/">FHIR 4.3.0</a>. Generated <span title="Wed, Aug 2, 2023 09:51-0500">2023-08-02</span>
          <br/>
          <span style="color: var(--footer-highlight-text-color)">
                      Links: <a style="color: var(--footer-hyperlink-text-color)" href="toc.html">Table of Contents</a> |
                 <a style="color: var(--footer-hyperlink-text-color)" href="qa.html">QA Report</a>
                  | <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://github.com/IHE/ITI.PCF/issues/new/choose">New Issue</a> | <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://github.com/IHE/ITI.PCF/issues">Issues</a>
                
                 <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://profiles.ihe.net/ITI/PCF/history.html">Version History</a></a> |
                 <a style="color: var(--footer-hyperlink-text-color)" rel="license" href="https://profiles.ihe.net/GeneralIntro/ch-9.html"><img style="border-style: none;" alt="CC0" src="assets/images/cc-by.png" height="17"/></a> |
                <!-- <a style="color: var(--footer-hyperlink-text-color)" href="searchform.html">Search</a> | -->
                 <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://www.ihe.net/resources/public_comment/">Propose a change<img alt="external" style="vertical-align: baseline" src="external.png"/></a>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HLBNC861DJ');
</script>

          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->
  
  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard-btn.js"> </script>
  <script>anchors.options.visible = 'hover'
anchors.add()</script>
  
<!-- feedback form - Google forms -->
<!-- v0.1, 2021-01-09 -->


  
    
  


  
    
  



<!-- / feedback form  -->

  <!-- Analytics Below
  ================================================== -->
  </body>
</html>

