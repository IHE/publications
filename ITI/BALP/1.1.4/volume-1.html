<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>1:52 Basic Audit Log Patterns - Basic Audit Log Patterns (BALP) v1.1.4</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>

    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  	<link href="assets/css/prism.css" rel="stylesheet" />
  	<link href="assets/css/cqf.css" rel="stylesheet" />
    <!-- Placeholder for child template CSS declarations -->
<link href="assets/css/ihe.css" rel="stylesheet"/>
<link href="assets/css/nonum.css" rel="stylesheet"/>
<script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-HLBNC861DJ" async> </script> 


    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/icon-fhir-144.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/icon-fhir-114.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/icon-fhir-72.png"/>
    <link rel="apple-touch-icon-precomposed" href="assets/ico/icon-fhir-57.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>
    <script type="text/javascript" src="assets/js/mermaid.js"></script>
    <script type="text/javascript" src="assets/js/mermaid-init.js"></script>
    <style type="text/css">h2{--heading-prefix:"2"}
    h3,h4,h5,h6{--heading-prefix:"2"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->

        <!-- Placeholder for child template header declarations -->

<div id="project-nav">
  <a id="ihe-logo" data-no-external="true" href="http://profiles.ihe.net">
    <img height="71" alt="Visit the IHE website" src="assets/images/ihe-international.png"/>
  </a>
</div>
<div id="family-nav">
  <a id="family-logo" data-no-external="true" href="http://hl7.org/fhir"><img height="30" alt="Visit the FHIR website" src="assets/images/fhir-logo.png"/> </a>
</div>
<!--
<div id="hl7-search">
  <a id="hl7-search-lnk" data-no-external="true" href="searchform.html"><img alt="Search FHIR" src="assets/images/search.png"/></a>
</div>
-->
<div id="project-nav">
  
  
    <a id="project-logo" data-no-external="true" href="http://profiles.ihe.net/ITI/index.html"><img height="70" alt="Visit the ITI website" src="assets/images/ITI.png"/> </a>
</div>

        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">Basic Audit Log Patterns (BALP)</span>
            <br/>
            <span style="display:inline-block;">1.1.4 - Trial-Implementation



  <img alt="International flag" src="assets/images/001.svg" height="16" title="International"/>


            </span>
          </p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->

    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <!-- menu.xml  -->

<ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
  <li>
    <a href="index.html">BasicAudit Home</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Volume 1
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="volume-1.html">Introduction</a>
      </li>
      <li>
        <a href="volume-1.html#1521-basicaudit-actors-and-content">Actors and Content</a>
      </li>
      <li>
        <a href="volume-1.html#1522-basicaudit-actor-options">Actor Options</a>
      </li>
      <li>
        <a href="volume-1.html#1523-basicaudit-required-actor-grouping">Required Groupings</a>
      </li>
      <li>
        <a href="volume-1.html#1524-basicaudit-overview">Overview</a>
      </li>
      <li>
        <a href="volume-1.html#1525-basicaudit-security-considerations">Security Considerations</a>
      </li>
      <li>
        <a href="volume-1.html#1526-basicaudit-cross-profile-considerations">Cross-Profile Considerations</a>
      </li>
    </ul>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Volume 3
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="content.html">Basic Audit Log Patterns</a>
      </li>
      <li>
        <a href="content.html#3573-restful-activities">-RESTful activities</a>
      </li>
      <li>
        <a href="content.html#3574-saml-security-token">-SAML Security Token</a>
      </li>
      <li>
        <a href="content.html#3575-oauth-security-token">-OAuth Security Token</a>
      </li>
      <li>
        <a href="content.html#3576-consent-authorized-decision-audit-message">-Consent Authorized Decision Audit Message</a>
      </li>
      <li>
        <a href="content.html#3577-privacy-disclosure-audit-message">-Privacy Disclosure Audit Message</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="artifacts.html">Artifacts</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Other
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="appendix.html">AuditEvent Use in IHE Profiles</a>
      </li>
      <li>
        <a href="other.html">Changes to Other IHE Specifications</a>
      </li>
      <li>
        <a href="download.html">Download and Analysis</a>
      </li>
      <li>
        <a href="testplan.html">Test Plan</a>
      </li>
    </ul>
  </li>
</ul>
            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->

    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><b>1:52 Basic Audit Log Patterns</b></li>

          <span style="float:right;">

            <a href="index.html">&lt;prev</a> | 

            <a href="#bottom">bottom</a>

          | <a href="content.html">next&gt;</a>

          </span>

        </ul>
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->

    <a name="top"> </a>
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<style type="text/css">
h2:before{color:silver;counter-increment:section;content:var(--heading-prefix) " ";}
h3:before{color:silver;counter-increment:sub-section;content:var(--heading-prefix) "." counter(sub-section) " ";}
h4:before{color:silver;counter-increment:composite;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) " ";}
h5:before{color:silver;counter-increment:detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) " ";}
h6:before{color:silver;counter-increment:more-detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) "." counter(more-detail)" ";}
</style>
<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">This page is part of the IHE Basic Audit Log Patterns (BALP) (v1.1.4: Publication) based on <a data-no-external="true" href="http://hl7.org/fhir/R4">FHIR (HL7® FHIR® Standard) R4</a>. This is the current published version in its permanent home (it will always be available at this URL).  For a full list of available versions, see the <a data-no-external="true" href="https://profiles.ihe.net/ITI/BALP/history.html">Directory of published versions</a></p><!--EndReleaseHeader-->
  <h2>1:52 Basic Audit Log Patterns</h2>
  












    <p><!-- white space is critical inside of capture --></p>
<div class="markdown-toc">
<ul id="markdown-toc">
  <li><a href="#1521-basicaudit-actors-and-content" id="markdown-toc-1521-basicaudit-actors-and-content">1:52.1 BasicAudit Actors and Content</a>    <ul>
      <li><a href="#15211-actor-descriptions-and-actor-profile-requirements" id="markdown-toc-15211-actor-descriptions-and-actor-profile-requirements">1:52.1.1 Actor Descriptions and Actor Profile Requirements</a></li>
    </ul>
  </li>
  <li><a href="#1522-basicaudit-actor-options" id="markdown-toc-1522-basicaudit-actor-options">1:52.2 BasicAudit Actor Options</a></li>
  <li><a href="#1523-basicaudit-required-actor-grouping" id="markdown-toc-1523-basicaudit-required-actor-grouping">1:52.3 BasicAudit Required Actor Grouping</a></li>
  <li><a href="#1524-basicaudit-overview" id="markdown-toc-1524-basicaudit-overview">1:52.4 BasicAudit Overview</a>    <ul>
      <li><a href="#15241-concepts" id="markdown-toc-15241-concepts">1:52.4.1 Concepts</a></li>
      <li><a href="#15242-use-cases" id="markdown-toc-15242-use-cases">1:52.4.2 Use Cases</a></li>
    </ul>
  </li>
  <li><a href="#1525-basicaudit-security-considerations" id="markdown-toc-1525-basicaudit-security-considerations">1:52.5 BasicAudit Security Considerations</a></li>
  <li><a href="#1526-basicaudit-cross-profile-considerations" id="markdown-toc-1526-basicaudit-cross-profile-considerations">1:52.6 BasicAudit Cross-Profile Considerations</a></li>
</ul>

</div>

<p>The Basic Audit Log Patterns (BALP) is a Content Profile that defines some basic and reusable AuditEvent patterns.</p>

<p>The Audit Log Patterns defined here rely on the <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">ATNA</a> Profile for transport of the AuditEvent and query/retrieval of AuditEvents previously recorded. 
The patterns defined here may be used as they are, or further refined to specific use-cases. 
Where a more specific audit event is defined, it should be derived off of these basic patterns. Thus, a more specific AuditEvent would be compliant with one or more of the AuditEvent patterns defined here.</p>

<p>This Implementation Guide is intended to be fully compliant with the HL7 <a href="http://hl7.org/fhir/">FHIR</a> specification, providing only use-case driven constraints to aid with interoperability, deterministic results, and compatibility with <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">ATNA</a> and other IHE Profiles.</p>

<p>Figure 1:52-1 shows a broader setting for the actors directly involved in the Basic Audit Log Patterns Profile and the relevant transactions between them.</p>

<div>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="419px" preserveAspectRatio="none" style="width:447px;height:419px;background:#FFFFFF;" version="1.1" viewBox="0 0 447 419" width="447px" zoomAndPan="magnify"><defs /><g><!--cluster ANY Secure Client--><g class="cluster" data-entity="ANY Secure Client" data-source-line="1" data-uid="ent0002" id="cluster_ANY Secure Client"><rect fill="none" height="189" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="170" x="7" y="7" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="122.9238" x="30.5381" y="23.5332">ANY Secure Client</text></g><!--cluster ANY Secure Server--><g class="cluster" data-entity="ANY Secure Server" data-source-line="6" data-uid="ent0006" id="cluster_ANY Secure Server"><rect fill="none" height="189" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="170" x="224" y="7" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="127.627" x="245.1865" y="23.5332">ANY Secure Server</text></g><!--entity cRest--><g class="entity" data-entity="cRest" data-source-line="2" data-uid="ent0003" id="entity_cRest"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="79.1445" x="25.5" y="43" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.1445" x="35.5" y="67.5332">any client</text></g><!--entity cAud--><g class="entity" data-entity="cAud" data-source-line="3" data-uid="ent0004" id="entity_cAud"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136.7373" x="23.5" y="142" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.7373" x="33.5" y="166.5332">Secure Application</text></g><!--entity sAud--><g class="entity" data-entity="sAud" data-source-line="7" data-uid="ent0007" id="entity_sAud"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136.7373" x="240.5" y="142" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.7373" x="250.5" y="166.5332">Secure Application</text></g><!--entity sRest--><g class="entity" data-entity="sRest" data-source-line="8" data-uid="ent0008" id="entity_sRest"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85.3584" x="271.5" y="43" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65.3584" x="281.5" y="67.5332">any server</text></g><!--entity AuditRepository--><g class="entity" data-entity="AuditRepository" data-source-line="12" data-uid="ent0010" id="entity_AuditRepository"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="171.7373" x="117" y="260" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.7373" x="127" y="284.5332">Audit Record Repository</text></g><!--entity AuditClient--><g class="entity" data-entity="AuditClient" data-source-line="13" data-uid="ent0011" id="entity_AuditClient"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120.3789" x="143" y="376" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.3789" x="153" y="400.5332">Audit Consumer</text></g><!--link cRest to cAud--><g class="link" data-entity-1="cRest" data-entity-2="cAud" data-source-line="4" data-uid="lnk5" id="link_cRest_cAud"><path d="M70.08,81.24 C74.91,98.59 78.9028,112.9593 83.7228,130.2793" fill="none" id="cRest-to-cAud" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;" /><polygon fill="#181818" points="86.94,141.84,89.1849,134.9872,83.7228,130.2793,81.4778,137.1321,86.94,141.84" style="stroke:#181818;stroke-width:1;" /></g><!--link sRest to sAud--><g class="link" data-entity-1="sRest" data-entity-2="sAud" data-source-line="9" data-uid="lnk9" id="link_sRest_sAud"><path d="M313.06,81.24 C312.17,98.59 311.4458,112.5358 310.5558,129.8558" fill="none" id="sRest-to-sAud" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;" /><polygon fill="#181818" points="309.94,141.84,314.2426,136.0532,310.5558,129.8558,306.2532,135.6426,309.94,141.84" style="stroke:#181818;stroke-width:1;" /></g><!--link cRest to sRest--><g class="link" data-entity-1="cRest" data-entity-2="sRest" data-source-line="15" data-uid="lnk12" id="link_cRest_sRest"><path d="M104.73,62 C150.31,62 218.77,62 265.49,62" fill="none" id="cRest-to-sRest" style="stroke:#181818;stroke-width:1;stroke-dasharray:7.0,7.0;" /><polygon fill="#181818" points="271.49,62,262.49,58,266.49,62,262.49,66,271.49,62" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.7935" x="123" y="55.4951">ANY request/response</text></g><!--link sAud to AuditRepository--><g class="link" data-entity-1="sAud" data-entity-2="AuditRepository" data-source-line="16" data-uid="lnk13" id="link_sAud_AuditRepository"><path d="M300.92,180.08 C293.86,194.61 282.62,214.99 269,230 C258.72,241.33 250.3273,248.2846 238.3273,256.4146" fill="none" id="sAud-to-AuditRepository" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="233.36,259.78,243.0546,258.0435,237.4994,256.9755,238.5674,251.4204,233.36,259.78" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.7935" x="283" y="226.4951">Record Audit Event [ITI-20]</text></g><!--link cAud to AuditRepository--><g class="link" data-entity-1="cAud" data-entity-2="AuditRepository" data-source-line="17" data-uid="lnk14" id="link_cAud_AuditRepository"><path d="M90.57,180.23 C90.36,195.03 92.33,215.73 103,230 C112.8,243.11 121.7137,250.2077 136.4637,257.3077" fill="none" id="cAud-to-AuditRepository" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="141.87,259.91,135.4955,252.4023,137.3648,257.7414,132.0257,259.6107,141.87,259.91" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.7935" x="104" y="226.4951">Record Audit Event [ITI-20]</text></g><!--reverse link AuditRepository to AuditClient--><g class="link" data-entity-1="AuditRepository" data-entity-2="AuditClient" data-source-line="18" data-uid="lnk16" id="link_AuditRepository_AuditClient"><path d="M203,304.06 C203,325.28 203,354.3 203,375.64" fill="none" id="AuditRepository-backto-AuditClient" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="203,298.06,199,307.06,203,303.06,207,307.06,203,298.06" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.5762" x="204" y="342.4951">Retrieve ATNA Audit Event [ITI-81]</text></g></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure 1:52-1: BasicAudit Actor Setting</strong></p>

<p><em>ANY Secure Client</em> and <em>ANY Secure Server</em> represent abstractions of any client/server actor grouped with an <strong>ATNA Secure Node</strong> or an <strong>ATNA Secure Application</strong> supporting the <strong>ATX: FHIR Feed Option</strong>, defined in the <a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">RESTful ATNA Supplement</a>. Where <em>ANY Secure Client</em> and <em>ANY Secure Server</em> are involved in some communication that is an auditable event described in this Implementation Guide and for which some AuditEvent pattern is defined. The AuditEvent patterns defined here will be created and recorded [ITI-20] by the <em>Secure Node</em> or <em>Secure Application</em> that is grouped within the diagramed <em>ANY Secure Client</em> and the <em>ANY Secure Server</em>.</p>

<p>The double recording enables forensic analysis to detect failures better. Both audit events recorded will be different as the AuditEvent.source would identify the actor recording the event. Some actors will be able to populate the AuditEvent pattern given more fully, the lack of an element being populated is not a defect, but rather indicates that the actor did not have access to that data.</p>

<h2 id="1521-basicaudit-actors-and-content">1:52.1 BasicAudit Actors and Content</h2>

<p>Figure 1:52.1-1 shows the actors directly involved in the Basic Audit Log Patterns Profile and the relevant transactions between them. The <strong>Audit Creator</strong> creates AuditEvent records following this profile that is consumed by the <strong>Audit Consumer</strong>. The transport for the AuditEvent records is the <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">ATNA</a> Profile.</p>

<div>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="317px" preserveAspectRatio="none" style="width:308px;height:317px;background:#FFFFFF;" version="1.1" viewBox="0 0 308 317" width="308px" zoomAndPan="magnify"><defs /><g><!--entity cAud--><g class="entity" data-entity="cAud" data-source-line="1" data-uid="ent0002" id="entity_cAud"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102.4824" x="47.0213" y="7" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.4824" x="57.0213" y="31.5332">Audit Creator</text></g><!--entity AuditRepository--><g class="entity" data-entity="AuditRepository" data-source-line="3" data-uid="ent0003" id="entity_AuditRepository"><path d="M16.3912,131.6011 C18.7237,125.6092 23.9993,124.9477 27.6072,130.3453 C31.471,124.5011 37.1179,124.6078 40.9395,130.3936 C43.0958,125.8267 47.4697,124.7693 50.8041,129.0853 C54.5351,122.8987 60.0118,122.1195 63.7682,129.0603 C66.1839,123.0406 71.4756,122.6312 75.7775,126.8473 C78.9952,121.5055 82.981,120.1538 87.2017,125.8049 C90.265,120.986 94.0485,119.6422 97.9537,124.9072 C102.3443,119.731 107.1625,119.2769 110.2247,126.249 C113.7447,120.746 118.7837,119.4754 122.5922,125.9512 C126.7816,121.2812 131.946,121.9169 133.8254,128.299 C138.2614,122.0906 142.2198,121.252 146.6632,128.2919 C150.2493,124.3161 155.1972,124.57 157.1237,130.1151 C160.877,125.1048 167.2576,124.4897 169.8308,131.3756 C173.3805,126.198 177.9194,125.9924 181.4078,131.4424 C188.1639,134.3598 189.5431,141.111 184.1893,146.296 C191.6611,150.4032 191.6017,156.1979 185.841,161.7218 C190.9257,167.5787 190.354,171.9669 183.3977,175.7225 C189.0337,180.0159 190.0755,185.6205 182.7786,189.3253 C180.1688,195.7698 174.2808,197.0139 170.336,190.6191 C167.4746,197.3302 161.9272,198.3348 157.4744,192.2142 C153.6964,196.6262 149.3146,196.6206 146.1094,191.5291 C143.2184,196.7524 139.6905,198.1634 135.3126,193.088 C132.5714,199.0058 127.2181,200.0749 122.7535,195.0695 C119.7291,201.206 114.0473,201.0458 110.2465,195.9326 C107.4536,201.1735 102.4013,202.5206 98.9189,196.6346 C94.7286,202.4934 90.1029,201.7144 86.952,195.5961 C82.5439,201.0055 78.3658,200.4941 75.7181,193.9427 C72.5532,200.0932 66.0282,200.5782 62.6061,194.2121 C58.5989,199.1508 53.5682,197.926 52.2458,191.7169 C47.5567,197.8627 43.0884,197.9787 39.2559,190.877 C35.5046,196.784 31.3869,196.7908 27.9778,190.5591 C24.2205,196.1622 19.0578,197.1778 15.4473,190.4105 C8.1861,186.6339 6,179.91 14.1446,174.8441 C6.1583,171.7712 6.563,165.3801 12.0395,160.3517 C6.7764,155.1456 6.7294,151.0687 13.5322,147.2357 C6.6416,140.4778 8.7692,135.7053 16.3912,131.6011" fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.3379" x="22.0213" y="152.5332">ATNA</text><line style="stroke:#181818;stroke-width:1;stroke-dasharray:1.0,2.0;" x1="8.0213" x2="187.7586" y1="155.6094" y2="155.6094" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.7373" x="22.0213" y="174.1426">Audit Record Repository</text></g><!--entity AuditClient--><g class="entity" data-entity="AuditClient" data-source-line="7" data-uid="ent0004" id="entity_AuditClient"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120.3789" x="38.0213" y="274" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.3789" x="48.0213" y="298.5332">Audit Consumer</text></g><!--link cAud to AuditRepository--><g class="link" data-entity-1="cAud" data-entity-2="AuditRepository" data-source-line="9" data-uid="lnk5" id="link_cAud_AuditRepository"><path d="M98.0213,45.01 C98.0213,64.99 98.0213,91.72 98.0213,116.91" fill="none" id="cAud-to-AuditRepository" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="98.0213,122.91,102.0213,113.91,98.0213,117.91,94.0213,113.91,98.0213,122.91" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.7935" x="99.0213" y="89.4951">Record Audit Event [ITI-20]</text></g><!--reverse link AuditRepository to AuditClient--><g class="link" data-entity-1="AuditRepository" data-entity-2="AuditClient" data-source-line="10" data-uid="lnk7" id="link_AuditRepository_AuditClient"><path d="M98.0213,202.09 C98.0213,227.19 98.0213,253.78 98.0213,273.77" fill="none" id="AuditRepository-backto-AuditClient" style="stroke:#181818;stroke-width:1;" /><polygon fill="#181818" points="98.0213,196.09,94.0213,205.09,98.0213,201.09,102.0213,205.09,98.0213,196.09" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.5762" x="99.0213" y="240.4951">Retrieve ATNA Audit Event [ITI-81]</text></g></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure 1:52.1-1: BasicAudit Actor Diagram</strong></p>

<p><strong>Table 1:52.1-1: BasicAudit - Actors</strong></p>

<table class="grid">
  <thead>
    <tr>
      <th>Actors</th>
      <th style="text-align: center">Optionality</th>
      <th>Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Audit Creator</td>
      <td style="text-align: center">R</td>
      <td>1:52.1.1.1</td>
    </tr>
    <tr>
      <td>Audit Consumer</td>
      <td style="text-align: center">R</td>
      <td>1:52.1.1.2</td>
    </tr>
  </tbody>
</table>

<h3 id="15211-actor-descriptions-and-actor-profile-requirements">1:52.1.1 Actor Descriptions and Actor Profile Requirements</h3>

<h4 id="152111-audit-creator">1:52.1.1.1 Audit Creator</h4>

<p>The Audit Creator shall detect the defined auditable events and record a complaint AuditEvent as defined. The Audit Creator shall be grouped with an <strong>ATNA Secure Application</strong> or <strong>ATNA Secure Node</strong> with support for <strong>ATNA ATX:FHIR Feed Option</strong> defined in the <a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">RESTful ATNA Supplement</a> for the recording of the compliant AuditEvent to the Audit Record Repository.</p>

<p>A <code class="language-plaintext highlighter-rouge">requirements</code> CapabilityStatements defines full functional <a href="CapabilityStatement-IHE.BALP.AuditCreator.html">Audit Creator</a> with ATNA support for ITI-20.</p>

<h4 id="152112-audit-consumer">1:52.1.1.2 Audit Consumer</h4>

<p>The Audit Consumer shall be grouped with an <strong>ATNA Audit Consumer</strong> with support for the <strong>Retrieve Audit Message Option</strong> defined in the <a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">RESTful ATNA Supplement</a>. The Audit Consumer understands the AuditEvent profiles defined, but shall not reject an AuditEvent due to non-compliance.</p>

<p>A <code class="language-plaintext highlighter-rouge">requirements</code> CapabilityStatements defines full functional <a href="CapabilityStatement-IHE.BALP.AuditConsumer.html">Audit Consumer</a> with ATNA support for ITI-81.</p>

<h4 id="152113-atna-audit-record-repository">1:52.1.1.3 ATNA Audit Record Repository</h4>

<p>The <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">ATNA</a> Audit Record Repository with support for <strong>ATNA ATX:FHIR Feed Option</strong>, and <strong>Retrieve Audit Message Option</strong>. These options are defined in the <a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">RESTful ATNA Supplement</a>. The ATNA Audit Record Repository may detect and validate the AuditEvent requirements defined here, but shall not reject an AuditEvent due to non-compliance.</p>

<p>A <code class="language-plaintext highlighter-rouge">requirements</code> CapabilityStatements defines full functional <a href="CapabilityStatement-IHE.BALP.ATNA.AuditRecordRepository.html">ATNA Audit Record Repository</a> with support for the BALP content profiles.</p>

<h2 id="1522-basicaudit-actor-options">1:52.2 BasicAudit Actor Options</h2>

<p>Each AuditEvent pattern defined here can be declared by an <strong>Audit Creator</strong> or an <strong>Audit Consumer</strong>.</p>

<h2 id="1523-basicaudit-required-actor-grouping">1:52.3 BasicAudit Required Actor Grouping</h2>

<p>The required groupings for BasicAudit are those in the ATNA Profile, see <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">IHE ITI TF-1:9.3</a>.</p>

<p>The Security Considerations page describes some optional groupings that may be of interest for security considerations.</p>

<p>Cross-Profile Considerations describes some optional groupings in other related profiles.</p>

<h2 id="1524-basicaudit-overview">1:52.4 BasicAudit Overview</h2>

<h3 id="15241-concepts">1:52.4.1 Concepts</h3>
<p>This guide provides reusable AuditEvent patterns that can be used directly, or combined, or as derivation material for a more specific AuditEvent.</p>

<h5 id="152411-data-access-requests-produce-an-auditevent">1:52.4.1.1 Data access requests produce an AuditEvent</h5>

<p>The following use-case represents a generic interaction between a client and a server. The interactions 1, 2, and 4 represent the activity that is auditable. The interaction 3 is the recording of the AuditEvent following this Implementation Guide by the server. The interaction 5 is the recording of the AuditEvent following this Implementation Guide by the client.</p>

<div>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="229px" preserveAspectRatio="none" style="width:650px;height:229px;background:#FFFFFF;" version="1.1" viewBox="0 0 650 229" width="650px" zoomAndPan="magnify"><defs /><g><g><title>ANY Secure Client</title><rect fill="#FFFFFF" height="134.4063" style="stroke:#181818;stroke-width:1;" width="10" x="65.3584" y="69.9609" /></g><g><title>ANY Secure Server</title><rect fill="#FFFFFF" height="104.0547" style="stroke:#181818;stroke-width:1;" width="10" x="348.0317" y="69.9609" /></g><g><title>ANY Secure Client</title><rect fill="#000000" fill-opacity="0.00000" height="184.7578" width="8" x="66.3584" y="37.6094" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="70" x2="70" y1="37.6094" y2="222.3672" /></g><g><title>ANY Secure Server</title><rect fill="#000000" fill-opacity="0.00000" height="184.7578" width="8" x="349.0317" y="37.6094" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="352.9526" x2="352.9526" y1="37.6094" y2="222.3672" /></g><g><title>Audit Record Repository</title><rect fill="#000000" fill-opacity="0.00000" height="184.7578" width="8" x="557.1924" y="37.6094" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="560.3237" x2="560.3237" y1="37.6094" y2="222.3672" /></g><g class="participant participant-head" data-participant="Client"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130.7168" x="5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.7168" x="12" y="26.5332">ANY Secure Client</text></g><g class="participant participant-head" data-participant="Server"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136.1582" x="284.9526" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122.1582" x="291.9526" y="26.5332">ANY Secure Server</text></g><g class="participant participant-head" data-participant="AuditRepository"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165.7373" x="478.3237" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.7373" x="485.3237" y="26.5332">Audit Record Repository</text></g><g><title>ANY Secure Client</title><rect fill="#FFFFFF" height="134.4063" style="stroke:#181818;stroke-width:1;" width="10" x="65.3584" y="69.9609" /></g><g><title>ANY Secure Server</title><rect fill="#FFFFFF" height="104.0547" style="stroke:#181818;stroke-width:1;" width="10" x="348.0317" y="69.9609" /></g><g class="message" data-participant-1="Client" data-participant-2="Server"><polygon fill="#181818" points="336.0317,65.9609,346.0317,69.9609,336.0317,73.9609,340.0317,69.9609" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="75.3584" x2="342.0317" y1="69.9609" y2="69.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.6733" x="82.3584" y="65.1045">1. Client requests some data from the Server</text></g><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#181818;stroke-width:1;" x1="358.0317" x2="400.0317" y1="100.3125" y2="100.3125" /><line style="stroke:#181818;stroke-width:1;" x1="400.0317" x2="400.0317" y1="100.3125" y2="113.3125" /><line style="stroke:#181818;stroke-width:1;" x1="359.0317" x2="400.0317" y1="113.3125" y2="113.3125" /><polygon fill="#181818" points="369.0317,109.3125,359.0317,113.3125,369.0317,117.3125,365.0317,113.3125" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.1606" x="365.0317" y="95.4561">2. Server finds data requested</text></g><g class="message" data-participant-1="Server" data-participant-2="AuditRepository"><polygon fill="#181818" points="549.1924,139.6641,559.1924,143.6641,549.1924,147.6641,553.1924,143.6641" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="358.0317" x2="555.1924" y1="143.6641" y2="143.6641" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.918" x="365.0317" y="138.8076">3. Server records audit event</text></g><g class="message" data-participant-1="Server" data-participant-2="Client"><polygon fill="#181818" points="86.3584,170.0156,76.3584,174.0156,86.3584,178.0156,82.3584,174.0156" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="80.3584" x2="352.0317" y1="174.0156" y2="174.0156" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.7915" x="92.3584" y="169.1592">4. Server returns read data requested</text></g><g class="message" data-participant-1="Client" data-participant-2="AuditRepository"><polygon fill="#181818" points="549.1924,200.3672,559.1924,204.3672,549.1924,208.3672,553.1924,204.3672" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="70.3584" x2="555.1924" y1="204.3672" y2="204.3672" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8652" x="77.3584" y="199.5107">5. Client records audit event</text></g></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure: 1:52.4.1.1-1: Audit log event creation</strong></p>

<h4 id="152412-auditevents-are-available-to-authorized-clients">1:52.4.1.2 AuditEvents are available to authorized clients</h4>

<p>The following use-case represents the use-case defined in <a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">ATNA [ITI-81]</a>. The use of this transaction in this Implementation Guide is to specialize it with the use of the patient identity to retrieve AuditEvent resources where that patient identity was found in the .agent or .entity. Where the patient identity in the .agent element indicates that the patient was actively engaged in the activity recorded in that AuditEvent, and .entity element indicates that the patient was the subject of the event. Note that accessing the audit log is an auditable event and thus interactions 3 and 5.</p>

<div>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="242px" preserveAspectRatio="none" style="width:719px;height:242px;background:#FFFFFF;" version="1.1" viewBox="0 0 719 242" width="719px" zoomAndPan="magnify"><defs /><g><g><title>Audit Consumer</title><rect fill="#FFFFFF" height="147.4063" style="stroke:#181818;stroke-width:1;" width="10" x="57.1895" y="69.9609" /></g><g><title>Audit Record Repository</title><rect fill="#FFFFFF" height="117.0547" style="stroke:#181818;stroke-width:1;" width="10" x="376.5991" y="69.9609" /></g><g><title>Audit Consumer</title><rect fill="#000000" fill-opacity="0.00000" height="197.7578" width="8" x="58.1895" y="37.6094" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="62" x2="62" y1="37.6094" y2="235.3672" /></g><g><title>Audit Record Repository</title><rect fill="#000000" fill-opacity="0.00000" height="197.7578" width="8" x="377.5991" y="37.6094" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="380.7305" x2="380.7305" y1="37.6094" y2="235.3672" /></g><g class="participant participant-head" data-participant="AuditClient"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114.3789" x="5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.3789" x="12" y="26.5332">Audit Consumer</text></g><g class="participant participant-head" data-participant="AuditRepository"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165.7373" x="298.7305" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.7373" x="305.7305" y="26.5332">Audit Record Repository</text></g><g><title>Audit Consumer</title><rect fill="#FFFFFF" height="147.4063" style="stroke:#181818;stroke-width:1;" width="10" x="57.1895" y="69.9609" /></g><g><title>Audit Record Repository</title><rect fill="#FFFFFF" height="117.0547" style="stroke:#181818;stroke-width:1;" width="10" x="376.5991" y="69.9609" /></g><g class="message" data-participant-1="AuditClient" data-participant-2="AuditRepository"><polygon fill="#181818" points="364.5991,65.9609,374.5991,69.9609,364.5991,73.9609,368.5991,69.9609" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="67.1895" x2="370.5991" y1="69.9609" y2="69.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289.7578" x="74.1895" y="65.1045">1. Client requests AuditEvent records for Patient X</text></g><g class="message" data-participant-1="AuditRepository" data-participant-2="AuditRepository"><line style="stroke:#181818;stroke-width:1;" x1="386.5991" x2="428.5991" y1="100.3125" y2="100.3125" /><line style="stroke:#181818;stroke-width:1;" x1="428.5991" x2="428.5991" y1="100.3125" y2="113.3125" /><line style="stroke:#181818;stroke-width:1;" x1="387.5991" x2="428.5991" y1="113.3125" y2="113.3125" /><polygon fill="#181818" points="397.5991,109.3125,387.5991,113.3125,397.5991,117.3125,393.5991,113.3125" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="293.3823" x="393.5991" y="95.4561">2. Server finds AuditEvents requested for Patient X</text></g><g class="message" data-participant-1="AuditRepository" data-participant-2="AuditRepository"><line style="stroke:#181818;stroke-width:1;" x1="386.5991" x2="428.5991" y1="143.6641" y2="143.6641" /><line style="stroke:#181818;stroke-width:1;" x1="428.5991" x2="428.5991" y1="143.6641" y2="156.6641" /><line style="stroke:#181818;stroke-width:1;" x1="387.5991" x2="428.5991" y1="156.6641" y2="156.6641" /><polygon fill="#181818" points="397.5991,152.6641,387.5991,156.6641,397.5991,160.6641,393.5991,156.6641" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="318.6841" x="393.5991" y="138.8076">3. Server records audit event of the audit Event request</text></g><g class="message" data-participant-1="AuditRepository" data-participant-2="AuditClient"><polygon fill="#181818" points="78.1895,183.0156,68.1895,187.0156,78.1895,191.0156,74.1895,187.0156" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="72.1895" x2="380.5991" y1="187.0156" y2="187.0156" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.4097" x="84.1895" y="182.1592">4. Server returns AuditEvent records for Patient X</text></g><g class="message" data-participant-1="AuditClient" data-participant-2="AuditRepository"><polygon fill="#181818" points="369.5991,213.3672,379.5991,217.3672,369.5991,221.3672,373.5991,217.3672" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="62.1895" x2="375.5991" y1="217.3672" y2="217.3672" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.1079" x="69.1895" y="212.5107">5. Audit Client records audit event</text></g></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure: 1:52.4.1.2-1: Audit Use</strong></p>

<h4 id="152413-minimal-vs-comprehensive-auditevent">1:52.4.1.3 Minimal vs Comprehensive AuditEvent</h4>

<p>In this Implementation Guide there are sometimes two sets of patterns defined:</p>

<h5 id="1524131-minimal-auditevent">1:52.4.1.3.1 Minimal AuditEvent</h5>

<p>The minimal AuditEvent pattern should be used whenever possible. The minimal AuditEvent pattern avoids replicating information that can be looked up by any audit analysis application that has access. By placing minimal information into the AuditEvent the size of the AuditEvent is dramatically reduced, and there is less exposure of privacy and security information.</p>

<p>With minimal AuditEvent the AuditEvent contains identifiers or References, and not the details. For example, user identifier, practitioner identifier, organizational identifier, patient identifier, data object identifier, location identifiers, and security token identifier. With minimal the users names would not be recorded, details of a diagnosis would not be replicated, postal addresses would not be replicated. The identifiers that are recorded can be looked up using a user directory, practitioner directory, patient directory, data registry, and token introspection. The lookup of these values is further protection of the data behind them, preventing abuse by someone who has access to the AuditEvent log for one purpose gaining knowledge from other AuditEvent records.</p>

<p>With minimal AuditEvent, the AuditEvent contains only the search (aka, query) parameters, and never the results of the search. This too limits the size of the AuditEvent and the exposure of sensitive results data into the AuditEvent log. The results can be determined by re-executing the search or query, adjusting the results based on the time of the search.</p>

<p>The minimal AuditEvent is lower risk, but would still contain sensitive data.</p>

<h5 id="1524132-comprehensive-auditevent">1:52.4.1.3.2 Comprehensive AuditEvent</h5>

<p>There are times when the AuditEvent log are used by Audit Consumer Actors are known to not have access to some lookup services. In these cases, it is better to record the details into the AuditEvent. For example, where in a Cross-Community setting the details of the user may not be possible to lookup the security token details.</p>

<p>With Comprehensive AuditEvent, the search results might be preserved in the AuditEvent. This will create a very large AuditEvent with replicated data. So, care should be taken to select the kinds of auditable events where the results are recorded comprehensively, and these results should be purged regularly to limit the overall impact as the results data tend to be less useful as the AuditEvent ages.</p>

<p>In Cross-Community settings making full access to all of the needed directory and registry services may not be logistically possible. The counter argument is that when one party needs to perform AuditEvent log analysis and has suspicion based on that analysis, they could use out-of-band methods to request a lookup of an identifier. For example, when the AuditEvent log shows a strange behavior by a user identifier, such as an unusually large number of search activities at strange times of day or searches against a VIP patient. These out-of-band requests should be supported by the Cross-Community policy agreements.</p>

<h4 id="152414-query-parameter-handling">1:52.4.1.4 Query Parameter Handling</h4>

<p>The raw search request is base64 encoded and placed in the .entity[query].query element. The base64 encoding of the raw search request enables preserving exactly what was requested, including possibly malicious patterns. This enables detection of malicious or malformed requests.</p>

<p>The cleaned search may be recorded (not base64) in the .entity[query].description. The cleaned search request would have removed parameters that were not understood/supported. The cleaned search request in the .description element enables more efficient processing.</p>

<p>The results of the search are not included in the minimal AuditEvent, and are recommended to not be included in the comprehensive AuditEvent. Recording the results of a search in the AuditEvent will produce very large resources that are hard to process, and which replicate the database searched multiple times over. The AuditEvent record with search results contain highly sensitive data.</p>

<h4 id="152415-best-effort">1:52.4.1.5 Best Effort</h4>

<p>The AuditEvent should be populated with best-effort. This principle recognizes that there are times when an AuditEvent can't be fully populated due to the recording entity not having access to all of the information. The principle recognizes that recording some information is better than failing to record any AuditEvent due to this lack of elements to fit the pattern. These cases where lesser information is available to be recorded tend to be during failure-modes, which leads to the importance to record the elements that are known.</p>

<p>This principle also recognizes that some detail could be obtained, but through extreme effort. This extreme effort is often not justified. So best-effort does not compel the use of extreme effort to obtain the missing information. For example, during a network transaction where the AuditEvent pattern is calling for the name of the user in addition to the user identifier, the name could be looked up in a directory, but this would be extreme effort that is not called for by best-effort.</p>

<h4 id="152416-patient-as-a-subject">1:52.4.1.6 Patient as a Subject</h4>

<p>It is a best practice to include a reference to the Patient/Subject affected by any auditable event, in order to enable Privacy Accounting of Disclosures and Access Logs, and to enable privacy office and security office audit log analysis. Reasonable efforts should be taken to assure the Patient/Subject is recorded, but it is recognized that there are times when this is not reasonable, see the Best Effort section above.</p>

<p>The Patient as the subject of a transaction may be a search parameter (e.g. <code class="language-plaintext highlighter-rouge">patient</code> or <code class="language-plaintext highlighter-rouge">subject</code>), as scoped as part of a request security context such as IUA, or where the resource has a reference to a Patient (e.g. Observation.subject, DiagnosticReport.subject).</p>

<p>The Patient/Subject of an activity is indicated in an .entity element; with the .entity.who indicating the Patient reference, and the .entity.type indicating “1” Person, and the .entity.role indicating “1” patient. No other elements in this .entity need to be filled out. The indicator of the .entity.who, .entity.type, and .entity.role are enough to indicate that this AuditEvent activity has a subject as indicated.</p>

<p>Where an activity impacts more than one Patient/Subject, multiple AuditEvent resources should be recorded, one for each Patient/Subject. This best enables segmentation of the AuditEvent details so as to limit the Privacy impact. The use of multiple AuditEvent is a best-practice and should be driven by a Policy. There will be cases where the use of multiple AuditEvent resources are not necessary, such as public health reporting.</p>

<p>To record a REST interaction or $operation, it is often necessary to complete the transaction in order to determine the Patient/Subject. Inspection of the potential returned results may be necessary. Some REST Search/Query requests and $operations include parameters limiting the results to a specific Patient, in these cases this parameter informs the inclusion of the Patient reference.</p>

<p>The Patient as a Subject is distinct from when the Patient is an Agent. When the Patient is the User, they would be indicated in an .agent and the .entity element would not be necessary. Some examples would be when the Patient is using a Patient-Portal, or when the Patient is authoring Patient Generated Health Data (PGHD).  Note that in SAML and oAuth the subject of these security tokens is the user. This is contextual use of the word 'subject', as in the context is the security token subject is the user agent.</p>

<p>Finding AuditEvents by Patient:</p>
<ul>
  <li>Finding AuditEvents where the Patient is an agent, one would use the <code class="language-plaintext highlighter-rouge">agent</code> search parameter.</li>
  <li>Finding AuditEvents where the Patient is a subject, one would use the <code class="language-plaintext highlighter-rouge">entity</code> search parameter.</li>
  <li>Finding AuditEvents where the Patient is either an agent or subject, one would use the <code class="language-plaintext highlighter-rouge">patient</code> search parameter.</li>
</ul>

<p>This Implementation Guide includes profiles that include the Patient as the subject.</p>

<h3 id="15242-use-cases">1:52.4.2 Use Cases</h3>

<p>The AuditEvent patterns defined here cover the following Use Cases.</p>

<h4 id="152421-use-case-1-generic-auditevent-pattern-for-fhir-restful-operations">1:52.4.2.1 Use Case #1: Generic AuditEvent pattern for FHIR RESTful operations</h4>

<p>Given the http RESTful operations of Create, Read, Update, Delete, and Search; the patterns defined here will capture sufficient information for audit analysis by an Audit Consumer Actor. See <a href="content.html#3573-restful-activities">3:5.7.3 RESTful activities</a> for the pattern definitions and examples.</p>

<p>The Use Case #1 is represented by the figure first introduced in section <a href="#152411-data-access-requests-produce-an-auditevent">1:52.4.1.1 Data access requests produce an AuditEvent</a>.
The generic interaction between a client and a server shown with interactions 1, 2, and 4 represent the activity that is auditable. The interaction 3 is the recording of the AuditEvent following this Implementation Guide by the server. The interaction 5 is the recording of the AuditEvent following this Implementation Guide by the client.</p>

<div>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="229px" preserveAspectRatio="none" style="width:650px;height:229px;background:#FFFFFF;" version="1.1" viewBox="0 0 650 229" width="650px" zoomAndPan="magnify"><defs /><g><g><title>ANY Secure Client</title><rect fill="#FFFFFF" height="134.4063" style="stroke:#181818;stroke-width:1;" width="10" x="65.3584" y="69.9609" /></g><g><title>ANY Secure Server</title><rect fill="#FFFFFF" height="104.0547" style="stroke:#181818;stroke-width:1;" width="10" x="348.0317" y="69.9609" /></g><g><title>ANY Secure Client</title><rect fill="#000000" fill-opacity="0.00000" height="184.7578" width="8" x="66.3584" y="37.6094" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="70" x2="70" y1="37.6094" y2="222.3672" /></g><g><title>ANY Secure Server</title><rect fill="#000000" fill-opacity="0.00000" height="184.7578" width="8" x="349.0317" y="37.6094" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="352.9526" x2="352.9526" y1="37.6094" y2="222.3672" /></g><g><title>Audit Record Repository</title><rect fill="#000000" fill-opacity="0.00000" height="184.7578" width="8" x="557.1924" y="37.6094" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="560.3237" x2="560.3237" y1="37.6094" y2="222.3672" /></g><g class="participant participant-head" data-participant="Client"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130.7168" x="5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116.7168" x="12" y="26.5332">ANY Secure Client</text></g><g class="participant participant-head" data-participant="Server"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136.1582" x="284.9526" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122.1582" x="291.9526" y="26.5332">ANY Secure Server</text></g><g class="participant participant-head" data-participant="AuditRepository"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="165.7373" x="478.3237" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="151.7373" x="485.3237" y="26.5332">Audit Record Repository</text></g><g><title>ANY Secure Client</title><rect fill="#FFFFFF" height="134.4063" style="stroke:#181818;stroke-width:1;" width="10" x="65.3584" y="69.9609" /></g><g><title>ANY Secure Server</title><rect fill="#FFFFFF" height="104.0547" style="stroke:#181818;stroke-width:1;" width="10" x="348.0317" y="69.9609" /></g><g class="message" data-participant-1="Client" data-participant-2="Server"><polygon fill="#181818" points="336.0317,65.9609,346.0317,69.9609,336.0317,73.9609,340.0317,69.9609" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="75.3584" x2="342.0317" y1="69.9609" y2="69.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.6733" x="82.3584" y="65.1045">1. Client requests some data from the Server</text></g><g class="message" data-participant-1="Server" data-participant-2="Server"><line style="stroke:#181818;stroke-width:1;" x1="358.0317" x2="400.0317" y1="100.3125" y2="100.3125" /><line style="stroke:#181818;stroke-width:1;" x1="400.0317" x2="400.0317" y1="100.3125" y2="113.3125" /><line style="stroke:#181818;stroke-width:1;" x1="359.0317" x2="400.0317" y1="113.3125" y2="113.3125" /><polygon fill="#181818" points="369.0317,109.3125,359.0317,113.3125,369.0317,117.3125,365.0317,113.3125" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.1606" x="365.0317" y="95.4561">2. Server finds data requested</text></g><g class="message" data-participant-1="Server" data-participant-2="AuditRepository"><polygon fill="#181818" points="549.1924,139.6641,559.1924,143.6641,549.1924,147.6641,553.1924,143.6641" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="358.0317" x2="555.1924" y1="143.6641" y2="143.6641" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.918" x="365.0317" y="138.8076">3. Server records audit event</text></g><g class="message" data-participant-1="Server" data-participant-2="Client"><polygon fill="#181818" points="86.3584,170.0156,76.3584,174.0156,86.3584,178.0156,82.3584,174.0156" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="80.3584" x2="352.0317" y1="174.0156" y2="174.0156" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.7915" x="92.3584" y="169.1592">4. Server returns read data requested</text></g><g class="message" data-participant-1="Client" data-participant-2="AuditRepository"><polygon fill="#181818" points="549.1924,200.3672,559.1924,204.3672,549.1924,208.3672,553.1924,204.3672" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="70.3584" x2="555.1924" y1="204.3672" y2="204.3672" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.8652" x="77.3584" y="199.5107">5. Client records audit event</text></g></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure: 1:52.4.2.1-1: Audit log event creation</strong></p>

<h4 id="152422-use-case-2-security-token-enhancement-pattern">1:52.4.2.2 Use Case #2: Security token enhancement pattern</h4>

<p>Given that a security relevant event is being recorded, for example, Generic FHIR RESTful operations, and where a security token is known that describes the client and possibly the human; there is a need to record well formatted details about the security context. This use-case needs an audit event pattern defined, to be combined with the audit event pattern for the security relevant event (see Use Case #1), that would enhance the audit event log record with details from the OAuth or SAML token. See <a href="content.html#3574-saml-security-token">3:5.7.4 SAML Security Token</a> and <a href="content.html#3575-oauth-security-token">3:5.7.5 OAuth Security Token</a> for the pattern definitions and examples.</p>

<h4 id="152423-use-case-3-consent-authorized-decision-event">1:52.4.2.3 Use Case #3: Consent Authorized Decision event</h4>

<p>Given that an Authorization Service makes Authorization Decisions based on a Consent, this use-case shows how the details of the authorization decision event can be recorded. See <a href="content.html#3576-consent-authorized-decision-audit-message">3:5.7.6 Consent Authorized Decision Audit Message</a>.</p>

<div>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" preserveAspectRatio="none" version="1.1" viewBox="0 0 921 324" zoomAndPan="magnify"><defs /><g><g><title>Client</title><rect fill="#FFFFFF" height="237.4609" style="stroke:#181818;stroke-width:1;" width="10" x="177.29" y="69.9609" /></g><g><title>Authorization Service</title><rect fill="#FFFFFF" height="104.0547" style="stroke:#181818;stroke-width:1;" width="10" x="561.0986" y="151.0156" /></g><rect fill="none" height="215.4609" style="stroke:#000000;stroke-width:1.5;" width="777.6074" x="137.3936" y="84.9609" /><rect fill="none" height="183.1094" style="stroke:#000000;stroke-width:1.5;" width="757.6074" x="147.3936" y="110.3125" /><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="279.8125" width="8" x="22.7793" y="37.6094" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="26" x2="26" y1="37.6094" y2="317.4219" /></g><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="279.8125" width="8" x="178.29" y="37.6094" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="181.3936" x2="181.3936" y1="37.6094" y2="317.4219" /></g><g><title>Authorization Service</title><rect fill="#000000" fill-opacity="0.00000" height="279.8125" width="8" x="562.0986" y="37.6094" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="565.9541" x2="565.9541" y1="37.6094" y2="317.4219" /></g><g><title>Resource Server</title><rect fill="#000000" fill-opacity="0.00000" height="279.8125" width="8" x="704.7637" y="37.6094" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="708.2432" x2="708.2432" y1="37.6094" y2="317.4219" /></g><g><title>Audit Repository</title><rect fill="#000000" fill-opacity="0.00000" height="279.8125" width="8" x="832.6426" y="37.6094" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="836.2842" x2="836.2842" y1="37.6094" y2="317.4219" /></g><g class="participant participant-head" data-participant="User"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.5586" x="5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.5586" x="12" y="26.5332">User</text></g><g class="participant participant-head" data-participant="Client"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="49.793" x="157.3936" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35.793" x="164.3936" y="26.5332">Client</text></g><g class="participant participant-head" data-participant="AuthZ"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="146.2891" x="492.9541" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.2891" x="499.9541" y="26.5332">Authorization Service</text></g><g class="participant participant-head" data-participant="Resource"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119.041" x="649.2432" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.041" x="656.2432" y="26.5332">Resource Server</text></g><g class="participant participant-head" data-participant="AuditRepository"><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.7168" x="778.2842" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102.7168" x="785.2842" y="26.5332">Audit Repository</text></g><g><title>Client</title><rect fill="#FFFFFF" height="237.4609" style="stroke:#181818;stroke-width:1;" width="10" x="177.29" y="69.9609" /></g><g><title>Authorization Service</title><rect fill="#FFFFFF" height="104.0547" style="stroke:#181818;stroke-width:1;" width="10" x="561.0986" y="151.0156" /></g><g class="message" data-participant-1="User" data-participant-2="Client"><polygon fill="#181818" points="165.29,65.9609,175.29,69.9609,165.29,73.9609,169.29,69.9609" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="26.7793" x2="171.29" y1="69.9609" y2="69.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.5107" x="33.7793" y="65.1045">User uses a Client app</text></g><path d="M137.3936,84.9609 L508.8916,84.9609 L508.8916,93.3125 L498.8916,103.3125 L137.3936,103.3125 L137.3936,84.9609" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="215.4609" style="stroke:#000000;stroke-width:1.5;" width="777.6074" x="137.3936" y="84.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="326.498" x="152.3936" y="99.4561">User and Client are used within Organization context</text><path d="M147.3936,110.3125 L412.7778,110.3125 L412.7778,118.6641 L402.7778,128.6641 L147.3936,128.6641 L147.3936,110.3125" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="183.1094" style="stroke:#000000;stroke-width:1.5;" width="757.6074" x="147.3936" y="110.3125" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="220.3843" x="162.3936" y="124.8076">User has selected a specific Patient</text><g class="message" data-participant-1="Client" data-participant-2="AuthZ"><polygon fill="#181818" points="549.0986,147.0156,559.0986,151.0156,549.0986,155.0156,553.0986,151.0156" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="187.29" x2="555.0986" y1="151.0156" y2="151.0156" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354.8086" x="194.29" y="146.1592">Client App requests Authorization Decision for a given Patient</text></g><g class="message" data-participant-1="AuthZ" data-participant-2="AuthZ"><line style="stroke:#181818;stroke-width:1;" x1="571.0986" x2="613.0986" y1="181.3672" y2="181.3672" /><line style="stroke:#181818;stroke-width:1;" x1="613.0986" x2="613.0986" y1="181.3672" y2="194.3672" /><line style="stroke:#181818;stroke-width:1;" x1="572.0986" x2="613.0986" y1="194.3672" y2="194.3672" /><polygon fill="#181818" points="582.0986,190.3672,572.0986,194.3672,582.0986,198.3672,578.0986,194.3672" style="stroke:#181818;stroke-width:1;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8799" x="578.0986" y="176.5107">Check Consent</text></g><g class="message" data-participant-1="AuthZ" data-participant-2="AuditRepository"><polygon fill="#181818" points="824.6426,220.7188,834.6426,224.7188,824.6426,228.7188,828.6426,224.7188" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="571.0986" x2="830.6426" y1="224.7188" y2="224.7188" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.9561" x="578.0986" y="219.8623">Authorization Server records audit event</text></g><g class="message" data-participant-1="AuthZ" data-participant-2="Client"><polygon fill="#181818" points="198.29,251.0703,188.29,255.0703,198.29,259.0703,194.29,255.0703" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="192.29" x2="565.0986" y1="255.0703" y2="255.0703" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37.5591" x="204.29" y="250.2139">Permit</text></g><g class="message" data-participant-1="Client" data-participant-2="Resource"><polygon fill="#181818" points="696.7637,281.4219,706.7637,285.4219,696.7637,289.4219,700.7637,285.4219" style="stroke:#181818;stroke-width:1;" /><line style="stroke:#181818;stroke-width:1;" x1="187.29" x2="702.7637" y1="285.4219" y2="285.4219" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230.4771" x="194.29" y="280.5654">Uses Permit token to access Resources</text></g></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure: 1:52.4.2.3-1: Consent Authorized Decision process flow</strong></p>

<p>This diagram focuses on the Authorization Decision, so not shown in this interaction diagram are the other AuditEvent that would be recorded by the ANY Secure Client and ANY Secure Server to record the auditable event that is the client and server interaction.</p>

<h4 id="152424-use-case-4-privacy-relevant-disclosure-event">1:52.4.2.4 Use Case #4: Privacy relevant disclosure event</h4>

<p>Given that a privacy relevant disclosure event is detected, this use-case shows how the details of the event can be recorded. See <a href="content.html#3577-privacy-disclosure-audit-message">3:5.7.7 Privacy Disclosure Audit Message</a>.</p>

<h2 id="1525-basicaudit-security-considerations">1:52.5 BasicAudit Security Considerations</h2>

<p>This profile does not define any transactions. This profile defines AuditEvent patterns to be used when a more specific AuditEvent pattern is defined.</p>

<p>In some cases, this profile has defined a minimally-populated AuditEvent that is focused on recording identifiers with no descriptive or replication. The minimally-populated AuditEvent helps preserve privacy of the data, actors, and events recorded in the AuditEvent. The minimally-populated AuditEvent is expected to be used by an audit log using agent that has knowledge of the source material for these identifiers, and has access rights to use those source materials. For example, recording a Practitioner identifier, without recording the Practitioner name or other elements that can be found in the Practitioner resource; where audit log analysis would use an organization directory where that identifier can be looked up to find the full details of the Practitioner.</p>

<h2 id="1526-basicaudit-cross-profile-considerations">1:52.6 BasicAudit Cross-Profile Considerations</h2>

<p>This profile defines some AuditEvent patterns for use when there is not a more specific AuditEvent pattern defined. Thus, when grouped with an IHE Profile that has defined an AuditEvent (AuditMessage) pattern, that more specific pattern defined in the grouped IHE Profile shall be used.</p>

<p>The patterns defined here might be used as profiling parent to a more specific defined AuditEvent.</p>




</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->

  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/jquery-ui.min.js"> </script>

  <script type="text/javascript" src="assets/js/window-hash.js"> </script>
  <a name="bottom"> </a>
  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->

      <div style="background-color:var(--footer-nav-bg-color)">
        <table style="width:100%">
          <tbody>
            <tr>
              <td style="text-align:left">&#xA0;

                <a href="index.html">&lt;prev</a>

              </td>
              <td style="text-align:center">
                <a href="#top">top</a>
              </td>
              <td style="text-align:right">&#xA0;

                <a href="content.html">next&gt;</a>

              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="inner-wrapper">
        <p>
          IG &#169; 2022+ <a style="color:var(--footer-hyperlink-text-color)" href="https://www.ihe.net/ihe_domains/it_infrastructure/">IHE IT Infrastructure Technical Committee</a>.  Package ihe.iti.balp#1.1.4 based on <a style="color: var(--footer-hyperlink-text-color)" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Fri, Oct 31, 2025 12:53-0500">2025-10-31</span>
          <br/>
          <span style="color: var(--footer-highlight-text-color)">
                      Links: <a style="color: var(--footer-hyperlink-text-color)" href="toc.html">Table of Contents</a> |
                 <a style="color: var(--footer-hyperlink-text-color)" href="qa.html">QA Report</a>
                  | <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://github.com/IHE/ITI.BasicAudit/issues/new/choose">New Issue</a> | <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://github.com/IHE/ITI.BasicAudit/issues">Issues</a>
                
                 <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://profiles.ihe.net/ITI/BALP/history.html">Version History</a></a> |
                 <a style="color: var(--footer-hyperlink-text-color)" rel="license" href="https://profiles.ihe.net/GeneralIntro/ch-9.html"><img style="border-style: none;" alt="CC0" src="assets/images/cc-by.png" height="17"/></a> |
                <!-- <a style="color: var(--footer-hyperlink-text-color)" href="searchform.html">Search</a> | -->
                 <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://www.ihe.net/resources/public_comment/">Propose a change<img alt="external" style="vertical-align: baseline" src="external.png"/></a>
                 <script type="text/javascript" src=".assets/js/google-analytics.js"> </script>
          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->

  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard-btn.js"> </script>
  <script type="text/javascript" src="assets/js/anchor-hover.js"> </script>
  <!-- Analytics Below
  ================================================== -->
  </body>
</html>

