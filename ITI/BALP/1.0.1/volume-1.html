<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>IHE.ITI.BASICAUDIT\1:52 Basic Audit - FHIR v4.0.1</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>

    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  	<link href="assets/css/prism.css" rel="stylesheet" />
    <!-- Placeholder for child template CSS declarations -->
<link href="assets/css/ihe.css" rel="stylesheet"/>
<script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-HLBNC861DJ" async> </script> 

<link href="assets/css/nonum.css" rel="stylesheet"/>


    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png"/>
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png"/>
    <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>

    <style type="text/css">h2{--heading-prefix:"2"}
    h3,h4,h5,h6{--heading-prefix:"2"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->
        <!-- Placeholder for child template header declarations -->

<div id="project-nav">
  <a id="ihe-logo" no-external="true" href="http://profiles.ihe.net">
    <img height="71" alt="Visit the IHE website" src="assets/images/ihe-international.png"/>
  </a>
</div>
<div id="family-nav">
  <a id="family-logo" no-external="true" href="http://hl7.org/fhir"><img height="30" alt="Visit the FHIR website" src="assets/images/fhir-logo.png"/> </a>
</div>
<!--
<div id="hl7-search">
  <a id="hl7-search-lnk" no-external="true" href="searchform.html"><img alt="Search FHIR" src="assets/images/search.png"/></a>
</div>
-->
        <div id="project-nav">
          <a id="project-logo" no-external="true" href="http://profiles.ihe.net/ITI/index.html"><img height="70" alt="Visit the ITI website" src="assets/images/ITI_Graphic.png"/> </a>
        </div>




        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">IHE ITI Basic AuditEvent Implementation Guide</span>
            <br/>
            <span style="display:inline-block;">1.0.1 - ballot



  <img alt="International flag" src="assets/images/001.svg" height="16" title="International"/>


            </span>
          </p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->

    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <!-- menu.xml  -->

<ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
  <li>
    <a href="index.html">BasicAudit Home</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Volume 1
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="volume-1.html">Introduction</a>
      </li>
      <li>
        <a href="volume-1.html#1521-basicaudit-actors-and-content">Actors and Content</a>
      </li>
      <li>
        <a href="volume-1.html#1522-basicaudit-actor-options">Actor Options</a>
      </li>
      <li>
        <a href="volume-1.html#1523-basicaudit-required-actor-grouping">Required Groupings</a>
      </li>
      <li>
        <a href="volume-1.html#1524-basicaudit-overview">Overview</a>
      </li>
      <li>
        <a href="volume-1.html#1525-basicaudit-security-considerations">Security Considerations</a>
      </li>
      <li>
        <a href="volume-1.html#1526-basicaudit-cross-profile-considerations">Cross-Profile Considerations</a>
      </li>
    </ul>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Volume 3
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="content.html">Basic Audit Log Patterns</a>
      </li>
      <li>
        <a href="content.html#3573-restful-activities">-RESTful activities</a>
      </li>
      <li>
        <a href="content.html#3574-saml-security-token">-SAML Security Token</a>
      </li>
      <li>
        <a href="content.html#3575-oauth-security-token">-OAuth Security Token</a>
      </li>
      <li>
        <a href="content.html#3576-consent-authorized-decision-audit-message">-Consent Authorized Decision Audit Message</a>
      </li>
      <li>
        <a href="content.html#3577-privacy-disclosure-audit-message">-Privacy Disclosure Audit Message</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="testplan.html">Test Plan</a>
  </li>
  <li>
    <a href="artifacts.html">Artifacts</a>
  </li>
  <li>
    <a href="other.html">Other</a>
  </li>
</ul>
            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->

    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><b>1:52 Basic Audit</b></li>

          <span style="float:right;">

            <a href="index.html">&lt;prev</a> | 

            <a href="#bottom">bottom</a>

          | <a href="content.html">next&gt;</a>

          </span>

        </ul>
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->

    <a name="top"> </a>
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<style type="text/css">
h2:before{color:silver;counter-increment:section;content:var(--heading-prefix) " ";}
h3:before{color:silver;counter-increment:sub-section;content:var(--heading-prefix) "." counter(sub-section) " ";}
h4:before{color:silver;counter-increment:composite;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) " ";}
h5:before{color:silver;counter-increment:detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) " ";}
h6:before{color:silver;counter-increment:more-detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) "." counter(more-detail)" ";}
</style>
<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">This page is part of the IHE Basic Audit Log Patterns (BALP) (v1.0.1: Public Comment Ballot 1) based on <a href="http://hl7.org/fhir/R4">FHIR R4</a>. The current version which supercedes this version is <a href="https://profiles.ihe.net/ITI/BALP/volume-1.html">1.1.1</a>.  For a full list of available versions, see the <a href="https://profiles.ihe.net/ITI/BALP/history.html">Directory of published versions <img src="external.png" style="text-align: baseline"></a></p><!--EndReleaseHeader-->
  <h2>1:52 Basic Audit</h2>
  












    <p><!-- white space is critical inside of capture --></p>
<div class="markdown-toc">
<ul id="markdown-toc">
  <li><a href="#1521-basicaudit-actors-and-content" id="markdown-toc-1521-basicaudit-actors-and-content">1:52.1 BasicAudit Actors and Content</a>    <ul>
      <li><a href="#15211-actor-descriptions-and-actor-profile-requirements" id="markdown-toc-15211-actor-descriptions-and-actor-profile-requirements">1:52.1.1 Actor Descriptions and Actor Profile Requirements</a></li>
    </ul>
  </li>
  <li><a href="#1522-basicaudit-actor-options" id="markdown-toc-1522-basicaudit-actor-options">1:52.2 BasicAudit Actor Options</a></li>
  <li><a href="#1523-basicaudit-required-actor-grouping" id="markdown-toc-1523-basicaudit-required-actor-grouping">1:52.3 BasicAudit Required Actor Grouping</a></li>
  <li><a href="#1524-basicaudit-overview" id="markdown-toc-1524-basicaudit-overview">1:52.4 BasicAudit Overview</a>    <ul>
      <li><a href="#15241-concepts" id="markdown-toc-15241-concepts">1:52.4.1 Concepts</a></li>
      <li><a href="#15242-use-cases" id="markdown-toc-15242-use-cases">1:52.4.2 Use Cases</a></li>
    </ul>
  </li>
  <li><a href="#1525-basicaudit-security-considerations" id="markdown-toc-1525-basicaudit-security-considerations">1:52.5 BasicAudit Security Considerations</a></li>
  <li><a href="#1526-basicaudit-cross-profile-considerations" id="markdown-toc-1526-basicaudit-cross-profile-considerations">1:52.6 BasicAudit Cross-Profile Considerations</a></li>
</ul>

</div>

<p>The Basic Audit Log Pattern (BasicAudit) Content Profile defines some basic and reusable AuditEvent patterns.</p>

<p>The Audit Log Patterns defined here rely on the <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">ATNA</a> Profile for transport of the AuditEvent and query/retrival of AuditEvents previously recorded. 
The patterns defined here may be used as they are, or further refined to specific use-cases. 
Where a more specific audit event is defined, it should be derived off of these basic patterns. Thus a more specific AuditEvent would be compliant with one or more of the AuditEvent patterns defined here.</p>

<p>This implementation guide is intended to be fully compliant with the HL7 <a href="http://hl7.org/fhir/">FHIR</a> specification, providing only use-case driven constraints to aid with interoperability, deterministic results, and compatibility with <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">ATNA</a> and other IHE Profiles.</p>

<h2 id="1521-basicaudit-actors-and-content">1:52.1 BasicAudit Actors and Content</h2>

<p>Figure 1:52.1-1 shows the actors directly involved in the Basic Audit Log Pattern Profile and the relevant transactions between them.</p>

<div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="425px" preserveAspectRatio="none" style="width:446px;height:425px;background:#FFFFFF;" version="1.1" viewBox="0 0 446 425" width="446px" zoomAndPan="magnify"><defs><filter height="300%" id="fcwyuin2xsk51" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0" /><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0" /><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3" /><feBlend in="SourceGraphic" in2="blurOut3" mode="normal" /></filter></defs><g><!--MD5=[3280686db8e783ef319cc0efc7b3becd]
cluster ANY Secure Client--><rect fill="#FFFFFF" filter="url(#fcwyuin2xsk51)" height="189" style="stroke:#000000;stroke-width:1.5;" width="170" x="7" y="7" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="128" x="28" y="23.5332">ANY Secure Client</text><!--MD5=[8140580de7f269ac4f78c2930a515724]
cluster Any Secure Server--><rect fill="#FFFFFF" filter="url(#fcwyuin2xsk51)" height="189" style="stroke:#000000;stroke-width:1.5;" width="170" x="230" y="7" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="131" x="249.5" y="23.5332">Any Secure Server</text><!--MD5=[ce6083902acb2eb866727f574ec07214]
entity cRest--><rect fill="#FEFECE" filter="url(#fcwyuin2xsk51)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="80" x="37" y="43" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="47" y="67.5332">any client</text><!--MD5=[1a72b8f3137e4d7cdb500b5b88bf6aee]
entity cAud--><rect fill="#FEFECE" filter="url(#fcwyuin2xsk51)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="138" x="23" y="142" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="33" y="166.5332">Secure Application</text><!--MD5=[335af922b55c36c8a02afd4d88bb5b69]
entity sAud--><rect fill="#FEFECE" filter="url(#fcwyuin2xsk51)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="138" x="246" y="142" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="256" y="166.5332">Secure Application</text><!--MD5=[e303cc2898c79871bd5a040435b74efb]
entity sRest--><rect fill="#FEFECE" filter="url(#fcwyuin2xsk51)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="87" x="284.5" y="43" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="294.5" y="67.5332">any server</text><!--MD5=[9eacfa6325a60456a4024c02f6efe5f0]
entity AuditRepository--><rect fill="#FEFECE" filter="url(#fcwyuin2xsk51)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="174" x="110" y="260" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="120" y="284.5332">Audit Record Repository</text><!--MD5=[9d43ba15b3113dd3a510f82c9ef80b36]
entity AuditClient--><rect fill="#FEFECE" filter="url(#fcwyuin2xsk51)" height="37.6094" style="stroke:#A80036;stroke-width:1.5;" width="121" x="136.5" y="376" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="146.5" y="400.5332">Audit Consumer</text><!--MD5=[df744748f53583288c88330d46c75b70]
link cRest to cAud--><path d="M79.82,81.24 C81.9,94.66 84.76,113.21 87.2,128.94 " fill="none" id="cRest-to-cAud" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;" /><polygon fill="#A80036" points="89.19,141.84,92.2262,135.2993,87.3564,129.9809,84.3202,136.5217,89.19,141.84" style="stroke:#A80036;stroke-width:1.0;" /><!--MD5=[6d65b8d784a66852da984e6ce365228f]
link sRest to sAud--><path d="M325.55,81.24 C323.76,94.66 321.27,113.21 319.16,128.94 " fill="none" id="sRest-to-sAud" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;" /><polygon fill="#A80036" points="317.43,141.84,322.1922,136.4251,319.0255,129.9465,314.2632,135.3614,317.43,141.84" style="stroke:#A80036;stroke-width:1.0;" /><!--MD5=[021ec2edcd3bb372d04f8ba96d7cfc4f]
link cRest to sRest--><path d="M117.05,62 C161.12,62 231.96,62 279.23,62 " fill="none" id="cRest-to-sRest" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;" /><polygon fill="#A80036" points="284.3,62,275.3,58,279.3,62,275.3,66,284.3,62" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="135.25" y="55.4951">ANY request/response</text><!--MD5=[dbe01602cfc6bedd081ebe4424adf97c]
link sAud to AuditRepository--><path d="M305.34,180.16 C297,194.73 283.97,215.13 269,230 C258.75,240.18 246.03,249.49 234.16,257.14 " fill="none" id="sAud-to-AuditRepository" style="stroke:#A80036;stroke-width:1.0;" /><polygon fill="#A80036" points="229.83,259.89,239.5717,258.4413,234.0507,257.2093,235.2826,251.6882,229.83,259.89" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="284" y="226.4951">Record Audit Event [ITI-20]</text><!--MD5=[6e4251d74366320badfaa9cdaaff2459]
link cAud to AuditRepository--><path d="M92.61,180.19 C93.97,194.97 97.91,215.66 109,230 C117.82,241.4 130.14,250.45 142.78,257.48 " fill="none" id="cAud-to-AuditRepository" style="stroke:#A80036;stroke-width:1.0;" /><polygon fill="#A80036" points="147.44,259.97,141.3851,252.2022,143.0294,257.6148,137.6168,259.2592,147.44,259.97" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="110" y="226.4951">Record Audit Event [ITI-20]</text><!--MD5=[6ceb5b2c1cb01de19d85ea9feaa8562c]
reverse link AuditRepository to AuditClient--><path d="M197,303.28 C197,324.67 197,355.96 197,375.64 " fill="none" id="AuditRepository-backto-AuditClient" style="stroke:#A80036;stroke-width:1.0;" /><polygon fill="#A80036" points="197,298.06,193,307.06,197,303.06,201,307.06,197,298.06" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="198" y="342.4951">Retrieve ATNA Audit Event [ITI-81]</text></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure 1:52.1-1: BasicAudit Actor Diagram</strong></p>

<p>Table 1:52.1-1: BasicAudit; Profile - Actors and Transactions</p>

<table class="grid">
  <thead>
    <tr>
      <th>Actors</th>
      <th>Transactions</th>
      <th style="text-align: center">Initiator or Responder</th>
      <th style="text-align: center">Optionality</th>
      <th>Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><em>ANY Secure Client</em></td>
      <td><em>ANY request/response</em></td>
      <td style="text-align: center">Initiator</td>
      <td style="text-align: center">R</td>
      <td><a href="volume-1.html#152111-any-secure-client">1:52.1.1.1</a></td>
    </tr>
    <tr>
      <td><em>ANY Secure Client</em></td>
      <td>ATNA Record Audit Event</td>
      <td style="text-align: center">Initiator</td>
      <td style="text-align: center">R</td>
      <td><a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">ITI-20</a></td>
    </tr>
    <tr>
      <td><em>ANY Secure Server</em></td>
      <td><em>ANY request/response</em></td>
      <td style="text-align: center">Responder</td>
      <td style="text-align: center">R</td>
      <td><a href="volume-1.html#152112-any-secure-server">1:52.1.1.2</a></td>
    </tr>
    <tr>
      <td><em>ANY Secure Server</em></td>
      <td>ATNA Record Audit Event</td>
      <td style="text-align: center">Initiator</td>
      <td style="text-align: center">R</td>
      <td><a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">ITI-20</a></td>
    </tr>
    <tr>
      <td>ATNA Audit Record Repository</td>
      <td>ATNA Record AuditEvent</td>
      <td style="text-align: center">Responder</td>
      <td style="text-align: center">R</td>
      <td><a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">ITI-20</a></td>
    </tr>
    <tr>
      <td>ATNA Audit Record Repository</td>
      <td>ATNA Retrieve ATNA Audit Event</td>
      <td style="text-align: center">Responder</td>
      <td style="text-align: center">R</td>
      <td><a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">ITI-81</a></td>
    </tr>
    <tr>
      <td>ATNA Audit Consumer</td>
      <td>ATNA Retrieve ATNA Audit Event</td>
      <td style="text-align: center">Initiator</td>
      <td style="text-align: center">R</td>
      <td><a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">ITI-81</a></td>
    </tr>
  </tbody>
</table>

<h3 id="15211-actor-descriptions-and-actor-profile-requirements">1:52.1.1 Actor Descriptions and Actor Profile Requirements</h3>

<h4 id="152111-any-secure-client">1:52.1.1.1 ANY Secure Client</h4>

<p><em>ANY Secure Client</em> represent abstractions of any client actor grouped with an <strong>ATNA Secure Node</strong> or an <strong>ATNA Secure Application</strong> supporting the ATX: FHIR Feed Option. Where <em>ANY Secure Client</em> is involved in an auditable event that is described in this Implementation Guide and for which some AuditEvent pattern is defined. The AuditEvent patterns defined here will be created and recorded (ITI-20) by the <em>ANY Secure Client</em> and the <em>ANY Secure Server</em>. The double recording enables forensic analysis to detect failures better. Both audit events recorded will be different as the the AuditEvent.source would identify the actor recording the event. Some actors will be able to populate the AuditEvent pattern given more fully, the lack of an element being populated is not a defect but rather indicates that the actor did not have access to that data.</p>

<h4 id="152112-any-secure-server">1:52.1.1.2 ANY Secure Server</h4>

<p><em>ANY Secure Server</em> represent abstractions of any server actor grouped with an <strong>ATNA Secure Node</strong> or an <strong>ATNA Secure Application</strong> supporting the ATX: FHIR Feed Option. Where <em>ANY Secure Server</em> is involved in an auditable event that is described in this Implementation Guide and for which some AuditEvent pattern is defined. The AuditEvent patterns defined here will be created and recorded (ITI-20) by the <em>ANY Secure Client</em> and the <em>ANY Secure Server</em>. The double recording enables forensic analysis to detect failures better. Both audit events recorded will be different as the the AuditEvent.source would identify the actor recording the event. Some actors will be able to populate the AuditEvent pattern given more fully, the lack of an element being populated is not a defect but rather indicates that the actor did not have access to that data.</p>

<h4 id="152113-atna-audit-record-repository">1:52.1.1.3 ATNA Audit Record Repository</h4>

<p>The Audit Record Repository shown is the ATNA Audit Record Repository with support for ATNA ATX:FHIR Feed Option, and Retrieve Audit Message Option.</p>

<h4 id="152114-atna-audit-consumer">1:52.1.1.4 ATNA Audit Consumer</h4>

<p>The Audit Consumer shown is an ATNA Audit Consumer Actor that understands and uses the AuditEvent patterns defined here.</p>

<h2 id="1522-basicaudit-actor-options">1:52.2 BasicAudit Actor Options</h2>

<p>Each AuditEvent pattern defined here can be declared by an <em>ANY Secure Client</em>, <em>ANY Secure Server</em>, or Audit Consumer.</p>

<div class="stu-note">
  <p>TODO: likely need an option named for each AuditEvent pattern (and combinations) defined.</p>
</div>

<h2 id="1523-basicaudit-required-actor-grouping">1:52.3 BasicAudit Required Actor Grouping</h2>

<div class="stu-note">
  <p>TODO: not clear what to say here or how to say it.</p>
</div>

<p>The required groupings for BasicAudit are those in the ATNA Profile, see <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">IHE ITI TF-1:9.3</a></p>

<p>The Security Considerations page describes some optional groupings that may be of interest for security considerations.</p>

<p>Cross-Profile Considerations describes some optional groupings in other related profiles.</p>

<h2 id="1524-basicaudit-overview">1:52.4 BasicAudit Overview</h2>

<h3 id="15241-concepts">1:52.4.1 Concepts</h3>
<p>The BasicAudit implementation guide provides reusable AuditEvent patterns that can be used directly, or combined, or as derivation material for a more specific AuditEvent.</p>

<h5 id="152411-data-access-requests-produce-an-auditevent">1:52.4.1.1 Data access requests produce an AuditEvent</h5>

<p>The following use-case represents a generic interaction between a client and a server. The interactions 1, 2, and 4 represent the activity that is auditable. The interaction 3 is the recording of the AuditEvent following this Implementation Guide by the server. The interaction 5 is the recording of the AuditEvent following this Implementation Guide by the client.</p>

<div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="233px" preserveAspectRatio="none" style="width:646px;height:233px;background:#FFFFFF;" version="1.1" viewBox="0 0 646 233" width="646px" zoomAndPan="magnify"><defs><filter height="300%" id="f1rtxlhw6oqih4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0" /><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0" /><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3" /><feBlend in="SourceGraphic" in2="blurOut3" mode="normal" /></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1rtxlhw6oqih4)" height="134.4063" style="stroke:#A80036;stroke-width:1.0;" width="10" x="67" y="73.9609" /><rect fill="#FFFFFF" filter="url(#f1rtxlhw6oqih4)" height="104.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="349" y="73.9609" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="72" x2="72" y1="41.6094" y2="226.3672" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="354" x2="354" y1="41.6094" y2="226.3672" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="550" x2="550" y1="41.6094" y2="226.3672" /><rect fill="#FEFECE" filter="url(#f1rtxlhw6oqih4)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="130" x="5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="12" y="26.5332">ANY Secure Client</text><rect fill="#FEFECE" filter="url(#f1rtxlhw6oqih4)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="136" x="284" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="291" y="26.5332">ANY Secure Server</text><rect fill="#FEFECE" filter="url(#f1rtxlhw6oqih4)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="168" x="464" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="471" y="26.5332">Audit Record Repository</text><rect fill="#FFFFFF" filter="url(#f1rtxlhw6oqih4)" height="134.4063" style="stroke:#A80036;stroke-width:1.0;" width="10" x="67" y="73.9609" /><rect fill="#FFFFFF" filter="url(#f1rtxlhw6oqih4)" height="104.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="349" y="73.9609" /><polygon fill="#A80036" points="337,69.9609,347,73.9609,337,77.9609,341,73.9609" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="77" x2="343" y1="73.9609" y2="73.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258" x="84" y="69.1045">1. Client requests some data from the Server</text><line style="stroke:#A80036;stroke-width:1.0;" x1="359" x2="401" y1="104.3125" y2="104.3125" /><line style="stroke:#A80036;stroke-width:1.0;" x1="401" x2="401" y1="104.3125" y2="117.3125" /><line style="stroke:#A80036;stroke-width:1.0;" x1="360" x2="401" y1="117.3125" y2="117.3125" /><polygon fill="#A80036" points="370,113.3125,360,117.3125,370,121.3125,366,117.3125" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="366" y="99.4561">2. Server finds data requested</text><polygon fill="#A80036" points="538,143.6641,548,147.6641,538,151.6641,542,147.6641" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="359" x2="544" y1="147.6641" y2="147.6641" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="366" y="142.8076">3. Server records audit event</text><polygon fill="#A80036" points="88,174.0156,78,178.0156,88,182.0156,84,178.0156" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="82" x2="353" y1="178.0156" y2="178.0156" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="94" y="173.1592">4. Server returns read data requested</text><polygon fill="#A80036" points="538,204.3672,548,208.3672,538,212.3672,542,208.3672" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="72" x2="544" y1="208.3672" y2="208.3672" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="79" y="203.5107">5. Client records audit event</text></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure: 1:52.4.1.1-1: Audit log event creation</strong></p>

<h4 id="152412-auditevents-are-available-to-authorized-clients">1:52.4.1.2 AuditEvents are available to authorized clients</h4>

<p>The following use-case represents the use-case defined in ATNA <a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">ITI-81</a>. The use of this transaction in this Implementation Guide is to specialize it with the use of the patient identity to retrieve AuditEvent resources where that patient identity was found in the .agent or .entity. Where the patient identity in the .agent element indicates that the patient was actively engaged in the activity recorded in that AuditEvent, and .entity element indicates that the patient was the subject of the event. Note that accessing the audit log is an auditable event and thus interactions 3 and 5.</p>

<div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="246px" preserveAspectRatio="none" style="width:714px;height:246px;background:#FFFFFF;" version="1.1" viewBox="0 0 714 246" width="714px" zoomAndPan="magnify"><defs><filter height="300%" id="f6hqgex3c2rqi" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0" /><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0" /><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3" /><feBlend in="SourceGraphic" in2="blurOut3" mode="normal" /></filter></defs><g><rect fill="#FFFFFF" filter="url(#f6hqgex3c2rqi)" height="147.4063" style="stroke:#A80036;stroke-width:1.0;" width="10" x="59.5" y="73.9609" /><rect fill="#FFFFFF" filter="url(#f6hqgex3c2rqi)" height="117.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="375.5" y="73.9609" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="64" x2="64" y1="41.6094" y2="239.3672" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="380.5" x2="380.5" y1="41.6094" y2="239.3672" /><rect fill="#FEFECE" filter="url(#f6hqgex3c2rqi)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="115" x="5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="12" y="26.5332">Audit Consumer</text><rect fill="#FEFECE" filter="url(#f6hqgex3c2rqi)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="168" x="294.5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="301.5" y="26.5332">Audit Record Repository</text><rect fill="#FFFFFF" filter="url(#f6hqgex3c2rqi)" height="147.4063" style="stroke:#A80036;stroke-width:1.0;" width="10" x="59.5" y="73.9609" /><rect fill="#FFFFFF" filter="url(#f6hqgex3c2rqi)" height="117.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="375.5" y="73.9609" /><polygon fill="#A80036" points="363.5,69.9609,373.5,73.9609,363.5,77.9609,367.5,73.9609" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="69.5" x2="369.5" y1="73.9609" y2="73.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289" x="76.5" y="69.1045">1. Client requests AuditEvent records for Patient X</text><line style="stroke:#A80036;stroke-width:1.0;" x1="385.5" x2="427.5" y1="104.3125" y2="104.3125" /><line style="stroke:#A80036;stroke-width:1.0;" x1="427.5" x2="427.5" y1="104.3125" y2="117.3125" /><line style="stroke:#A80036;stroke-width:1.0;" x1="386.5" x2="427.5" y1="117.3125" y2="117.3125" /><polygon fill="#A80036" points="396.5,113.3125,386.5,117.3125,396.5,121.3125,392.5,117.3125" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290" x="392.5" y="99.4561">2. Server finds AuditEvents requested for Patient X</text><line style="stroke:#A80036;stroke-width:1.0;" x1="385.5" x2="427.5" y1="147.6641" y2="147.6641" /><line style="stroke:#A80036;stroke-width:1.0;" x1="427.5" x2="427.5" y1="147.6641" y2="160.6641" /><line style="stroke:#A80036;stroke-width:1.0;" x1="386.5" x2="427.5" y1="160.6641" y2="160.6641" /><polygon fill="#A80036" points="396.5,156.6641,386.5,160.6641,396.5,164.6641,392.5,160.6641" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315" x="392.5" y="142.8076">3. Server records audit event of the audit Event request</text><polygon fill="#A80036" points="80.5,187.0156,70.5,191.0156,80.5,195.0156,76.5,191.0156" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="74.5" x2="379.5" y1="191.0156" y2="191.0156" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="282" x="86.5" y="186.1592">4. Server returns AuditEvent records for Patient X</text><polygon fill="#A80036" points="368.5,217.3672,378.5,221.3672,368.5,225.3672,372.5,221.3672" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="64.5" x2="374.5" y1="221.3672" y2="221.3672" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="71.5" y="216.5107">5. Audit Client records audit event</text></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure: 1:52.4.1.2-1: Audit Use</strong></p>

<h4 id="152413-minimal-vs-comprehensive-auditevent">1:52.4.1.3 Minimal vs Comprehensive AuditEvent</h4>

<p>In this Implementation Guide there are sometimes two sets of patterns defined:</p>

<h5 id="1524131-minimal-auditevent">1:52.4.1.3.1 Minimal AuditEvent</h5>

<p>The minimal AuditEvent pattern should be used whenever possible. The minimal AuditEvent pattern avoids replicating information that can be looked up by any audit analysis application that has access. By placing minimal information into the AuditEvent the size of the AuditEvent is dramatically reduced, and there is less exposure of privacy and security information.</p>

<p>With minimal AuditEvent the AuditEvent contains identifiers or References, and not the details. For example user identifier, practitioner identifier, organizational identifier, patient identifier, data object identifier, location identifiers, and security token identifier. With minimal the users names would not be recorded, details of a diagnosis would not be replicated, postal addresses would not be replicated. The identifiers that are recorded can be looked up using a user directory, practitioner directory, patient directory, data registry, and token introspection. The lookup of these values is further protection of the data behind them, preventing abuse by someone who has access to the AuditEvent log for one purpose gaining knowledge from other AuditEvent records.</p>

<p>With minimal AuditEvent, the AuditEvent contains only the search (aka, query) parameters, and never the results of the search. This too limits the size of the AuditEvent, and the exposure of sensitive results data into the AuditEvent log. The results can be determined by re-executing the search or query, adjusting the results based on the time of the search.</p>

<p>The minimal AuditEvent is lower risk, but would still contain sensitive data.</p>

<h5 id="1524132-comprehensive-auditevent">1:52.4.1.3.2 Comprehensive AuditEvent</h5>

<p>There are times when the AuditEvent log are used by Audit Consumer actors are known to not have access to some lookup services. In these cases, it is better to record the details into the AuditEvent. For example, where in a Cross-Community setting the details of the user may not be possible to lookup the security token details.</p>

<p>With Comprehensive AuditEvent, the search results might be preserved in the AuditEvent. This will create a very large AuditEvent with replicated data. So, care should be taken to select the kinds of auditable events where the results are recorded comprenensively, and these results should be purged regularly to limit the overall impact as the results data tend to be less useful as the AuditEvent ages.</p>

<p>In Cross-Community settings making full access to all of the needed directory and registry services may not be logictically possible. The counter argument is that when one party needs to perform AuditEvent log analysis and has suspiction based on that analysis, they could use out-of-band methods to request a lookup of an identifier. For example, when the AuditEvent log shows a strange behaviour by a user identifier, such as an unusually large number of search activities at strange times of day or searches against a VIP patient. These out-of-band requests should be supported by the Cross-Community policy agreements.</p>

<h4 id="152414-query-parameter-handling">1:52.4.1.4 Query Parameter Handling</h4>

<p>The raw search request is base64 encoded and placed in the .entity[query].query element. The base64 encoding of the raw search request enables preserving exactly what was requested, including possibly malicious patterns. This enables detection of malicious or malformed requests.</p>

<p>The cleaned search may be recorded (not base64) in the .entity[query].description. The cleaned search request would have removed parameters that were not understood/supported. The cleaned search request in the .description element enables more efficient processing.</p>

<p>The results of the search are not included in the minimal AuditEvent, and are recommended to not be included in the comprehensive AuditEvent. Recording the results of a seach in the AuditEvent will produce very large resources that are hard to process, and which replicate the database searched multiple times over. The AuditEvent record with search results contain highly sensitive data.</p>

<h4 id="152415-best-effort">1:52.4.1.5 Best Effort</h4>

<p>The AuditEvent should be populated with best-effort. This principle recognizes that there are times when an AuditEvent can’t be fully populated due to the recording entity not having access to all of the information. The principle recognizes that recording some information is better than failing to record any AuditEvent due to this lack of elements to fit the pattern. These cases where lesser information is available to be recorded tend to be during failure-modes, which leads to the importance to record the elements that are known.</p>

<p>This principle also recognizes that some detail could be obtained, but through extreme effort. This extreme effort is often not justified. So best-effort does not compel the use of extreme effort to obtain the missing information. For example, during a network transaction where the AuditEvent pattern is calling for the name of the user in addition to the user identifier, the name could be looked up in a directory, but this would be extreme effort that is not called for by best-effort.</p>

<h4 id="152416-patient-as-a-subject">1:52.4.1.6 Patient as a Subject</h4>

<p>It is a best practice to include a reference to the Patient/Subject affected by any auditable event, in order to enable Privacy Accounting of Disclosures and Access Logs, and to enable privacy office and security office audit log analysis. Reasonable efforts should be taken to assure the Patient/Subject is recorded, but it is recognized that there are times when this is <a href="#152415-best-effort">not reasonable</a>.</p>

<p>The Patient/Subject of an activity is indicated in an .entity element; with the .entity.who indicating the Patient reference, and the .entity.type indicating “1” Person, and the .entity.role indicating “1” patient. No other elements in this .entity need to be filled out. The indicator of the .entity.who, .entity.type, and .entity.role are enough to indicate that this AuditEvent activity has a subject as indicated.</p>

<p>Where an activity impacts more than one Patient/Subject; multiple AuditEvent resources should be recorded, one for each Patient/Subject. This best enables segmentation of the AuditEvent details so as to limit the Privacy impact. The use of multiple AuditEvent is a best-practice and should be driven by a Policy. There will be cases where the use of multiple AuditEvent resources are not necessary, such as public health reporting.</p>

<p>To record a REST interaction or $operation, it is often necessary to complete the transaction in order to determine the Patient/Subject. Inspection of the potential returned results may be necessary. Some REST Search/Query requests and $operations include parameters limiting the results to a specific Patient, in these cases this parameter informs the inclusion of the Patient reference.</p>

<p>The Patient as a Subject is distinct from when the Patient is an Agent. When the Patient is the User, they would be indicated in an .agent and the .entity element would not be necessary. Some examples would be when the Patient is using a Patient-Portal, or when the Patient is authoring Patient Generated Health Data (PGHD).  Note that in SAML and oAuth the subject of these security tokens is the user. This is contextual use of the word ‘subject’, as in the context is the security token subject is the user agent.</p>

<p>Finding AuditEvents by Patient:</p>
<ul>
  <li>Finding AuditEvents where the Patient is an agent, one would use the <code class="highlighter-rouge">agent</code> search parameter.</li>
  <li>Finding AuditEvents where the Patient is a subject, one would use the <code class="highlighter-rouge">entity</code> search parameter.</li>
  <li>Finding AuditEvents where the Patient is either an agent or subject, one would use the <code class="highlighter-rouge">patient</code> search parameter.</li>
</ul>

<p>This Implementation Guide includes profiles that include the Patient as the subject.</p>

<h3 id="15242-use-cases">1:52.4.2 Use Cases</h3>

<p>The AuditEvent patterns defined here cover the following Use Cases.</p>

<h4 id="152421-use-case-1-generic-auditevent-pattern-for-fhir-restful-operations">1:52.4.2.1 Use Case #1: Generic AuditEvent pattern for FHIR RESTful operations</h4>

<p>Given the http RESTful operations of Create, Read, Update, Delete, and Search; the patterns defined here will capture sufficient information for audit analysis by an Audit Consumer Actor. See <a href="content.html#3573-restful-activities">3:5.7.3 RESTful activities</a> for the pattern definitions and examples.</p>

<p>The Use Case #1 is represented by the figure first introduced in section <a href="#152411-data-access-requests-produce-an-auditevent">1:52.4.1.1 Data access requests produce an AuditEvent</a>.
The generic interaction between a client and a server shown with interactions 1, 2, and 4 represent the activity that is auditable. The interaction 3 is the recording of the AuditEvent following this Implementation Guide by the server. The interaction 5 is the recording of the AuditEvent following this Implementation Guide by the client.</p>

<div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="233px" preserveAspectRatio="none" style="width:646px;height:233px;background:#FFFFFF;" version="1.1" viewBox="0 0 646 233" width="646px" zoomAndPan="magnify"><defs><filter height="300%" id="f1rtxlhw6oqih4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0" /><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0" /><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3" /><feBlend in="SourceGraphic" in2="blurOut3" mode="normal" /></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1rtxlhw6oqih4)" height="134.4063" style="stroke:#A80036;stroke-width:1.0;" width="10" x="67" y="73.9609" /><rect fill="#FFFFFF" filter="url(#f1rtxlhw6oqih4)" height="104.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="349" y="73.9609" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="72" x2="72" y1="41.6094" y2="226.3672" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="354" x2="354" y1="41.6094" y2="226.3672" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="550" x2="550" y1="41.6094" y2="226.3672" /><rect fill="#FEFECE" filter="url(#f1rtxlhw6oqih4)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="130" x="5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="12" y="26.5332">ANY Secure Client</text><rect fill="#FEFECE" filter="url(#f1rtxlhw6oqih4)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="136" x="284" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="291" y="26.5332">ANY Secure Server</text><rect fill="#FEFECE" filter="url(#f1rtxlhw6oqih4)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="168" x="464" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="471" y="26.5332">Audit Record Repository</text><rect fill="#FFFFFF" filter="url(#f1rtxlhw6oqih4)" height="134.4063" style="stroke:#A80036;stroke-width:1.0;" width="10" x="67" y="73.9609" /><rect fill="#FFFFFF" filter="url(#f1rtxlhw6oqih4)" height="104.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="349" y="73.9609" /><polygon fill="#A80036" points="337,69.9609,347,73.9609,337,77.9609,341,73.9609" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="77" x2="343" y1="73.9609" y2="73.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258" x="84" y="69.1045">1. Client requests some data from the Server</text><line style="stroke:#A80036;stroke-width:1.0;" x1="359" x2="401" y1="104.3125" y2="104.3125" /><line style="stroke:#A80036;stroke-width:1.0;" x1="401" x2="401" y1="104.3125" y2="117.3125" /><line style="stroke:#A80036;stroke-width:1.0;" x1="360" x2="401" y1="117.3125" y2="117.3125" /><polygon fill="#A80036" points="370,113.3125,360,117.3125,370,121.3125,366,117.3125" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="366" y="99.4561">2. Server finds data requested</text><polygon fill="#A80036" points="538,143.6641,548,147.6641,538,151.6641,542,147.6641" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="359" x2="544" y1="147.6641" y2="147.6641" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="366" y="142.8076">3. Server records audit event</text><polygon fill="#A80036" points="88,174.0156,78,178.0156,88,182.0156,84,178.0156" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="82" x2="353" y1="178.0156" y2="178.0156" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="94" y="173.1592">4. Server returns read data requested</text><polygon fill="#A80036" points="538,204.3672,548,208.3672,538,212.3672,542,208.3672" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="72" x2="544" y1="208.3672" y2="208.3672" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="79" y="203.5107">5. Client records audit event</text></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure: 1:52.4.2.1-1: Audit log event creation</strong></p>

<h4 id="152422-use-case-2-security-token-enhancement-pattern">1:52.4.2.2 Use Case #2: Security token enhancement pattern</h4>

<p>Given that a security relevant event is being recorded, for example Generic FHIR RESTful operations, and where a security token is known that descrbes the client and possibly the human; there is a need to record well formatted details about the security context. This use-case needs an audit event pattern defined, to be combined with the audit event pattern for the security relevant event (see Use Case #1), that would enhance the audit event log record with details from the OAuth or SAML token. See <a href="content.html#3574-saml-security-token">3:5.7.4 SAML Security Token</a> and <a href="content.html#3575-oauth-security-token">3:5.7.5 OAuth Security Token</a> for the pattern definitions and examples.</p>

<h4 id="152423-use-case-3-consent-authorized-decision-event">1:52.4.2.3 Use Case #3: Consent Authorized Decision event</h4>

<p>Given that an Authorization Service makes Authorization Decisions based on a Consent, this use-case shows how the details of the authorization decision event can be recorded. See <a href="content.html#3576-consent-authorized-decision-audit-message">3:5.7.6 Consent Authoried Decision Audit Message</a></p>

<div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" preserveAspectRatio="none" version="1.1" viewBox="0 0 945 328" zoomAndPan="magnify"><defs><filter height="300%" id="f1nf1lzit95uvz" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0" /><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0" /><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3" /><feBlend in="SourceGraphic" in2="blurOut3" mode="normal" /></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1nf1lzit95uvz)" height="237.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="179.5" y="73.9609" /><rect fill="#FFFFFF" filter="url(#f1nf1lzit95uvz)" height="104.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="563.5" y="155.0156" /><rect fill="#FFFFFF" filter="url(#f1nf1lzit95uvz)" height="215.4609" style="stroke:#000000;stroke-width:2.0;" width="793.5" x="137.5" y="88.9609" /><rect fill="#FFFFFF" filter="url(#f1nf1lzit95uvz)" height="183.1094" style="stroke:#000000;stroke-width:2.0;" width="773.5" x="147.5" y="114.3125" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="28" x2="28" y1="41.6094" y2="321.4219" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="184.5" x2="184.5" y1="41.6094" y2="321.4219" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="568" x2="568" y1="41.6094" y2="321.4219" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="716" x2="716" y1="41.6094" y2="321.4219" /><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="850" x2="850" y1="41.6094" y2="321.4219" /><rect fill="#FEFECE" filter="url(#f1nf1lzit95uvz)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="43" x="5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="12" y="26.5332">User</text><rect fill="#FEFECE" filter="url(#f1nf1lzit95uvz)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="50" x="157.5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="164.5" y="26.5332">Client</text><rect fill="#FEFECE" filter="url(#f1nf1lzit95uvz)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="147" x="493" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133" x="500" y="26.5332">Authorization Service</text><rect fill="#FEFECE" filter="url(#f1nf1lzit95uvz)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="121" x="654" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="661" y="26.5332">Resource Server</text><rect fill="#FEFECE" filter="url(#f1nf1lzit95uvz)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="118" x="789" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="796" y="26.5332">Audit Repository</text><rect fill="#FFFFFF" filter="url(#f1nf1lzit95uvz)" height="237.4609" style="stroke:#A80036;stroke-width:1.0;" width="10" x="179.5" y="73.9609" /><rect fill="#FFFFFF" filter="url(#f1nf1lzit95uvz)" height="104.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="563.5" y="155.0156" /><polygon fill="#A80036" points="167.5,69.9609,177.5,73.9609,167.5,77.9609,171.5,73.9609" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="28.5" x2="173.5" y1="73.9609" y2="73.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="35.5" y="69.1045">User uses a Client app</text><path d="M137.5,88.9609 L518.5,88.9609 L518.5,96.9609 L508.5,106.9609 L137.5,106.9609 L137.5,88.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;" /><rect fill="none" height="215.4609" style="stroke:#000000;stroke-width:2.0;" width="793.5" x="137.5" y="88.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="336" x="152.5" y="103.4561">User and Client are used within Organization context</text><path d="M147.5,114.3125 L416.5,114.3125 L416.5,122.3125 L406.5,132.3125 L147.5,132.3125 L147.5,114.3125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;" /><rect fill="none" height="183.1094" style="stroke:#000000;stroke-width:2.0;" width="773.5" x="147.5" y="114.3125" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="224" x="162.5" y="128.8076">User has selected a specific Patient</text><polygon fill="#A80036" points="551.5,151.0156,561.5,155.0156,551.5,159.0156,555.5,155.0156" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="189.5" x2="557.5" y1="155.0156" y2="155.0156" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355" x="196.5" y="150.1592">Client App requests Authorization Decision for a given Patient</text><line style="stroke:#A80036;stroke-width:1.0;" x1="573.5" x2="615.5" y1="185.3672" y2="185.3672" /><line style="stroke:#A80036;stroke-width:1.0;" x1="615.5" x2="615.5" y1="185.3672" y2="198.3672" /><line style="stroke:#A80036;stroke-width:1.0;" x1="574.5" x2="615.5" y1="198.3672" y2="198.3672" /><polygon fill="#A80036" points="584.5,194.3672,574.5,198.3672,584.5,202.3672,580.5,198.3672" style="stroke:#A80036;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="580.5" y="180.5107">Check Consent</text><polygon fill="#A80036" points="838,224.7188,848,228.7188,838,232.7188,842,228.7188" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="573.5" x2="844" y1="228.7188" y2="228.7188" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="580.5" y="223.8623">Authorization Server records audit event</text><polygon fill="#A80036" points="200.5,255.0703,190.5,259.0703,200.5,263.0703,196.5,259.0703" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="194.5" x2="567.5" y1="259.0703" y2="259.0703" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="206.5" y="254.2139">Permit</text><polygon fill="#A80036" points="704.5,285.4219,714.5,289.4219,704.5,293.4219,708.5,289.4219" style="stroke:#A80036;stroke-width:1.0;" /><line style="stroke:#A80036;stroke-width:1.0;" x1="189.5" x2="710.5" y1="289.4219" y2="289.4219" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="196.5" y="284.5654">Uses Permit token to access Resources</text></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure: 1:52.4.23.-1: Consent Authorized Decision process flow</strong></p>

<p>Not shown in this interaction diagram is the AuditEvent that would be recorded by the ANY Secure Client and ANY Secure Server to record the auditable event that is the client and server interaction.</p>

<h4 id="152424-use-case-4-privacy-relevant-disclosure-event">1:52.4.2.4 Use Case #4: Privacy relevant disclosure event</h4>

<p>Given that a privacy relevant disclosure event is detected, this use-case shows how the details of the event can be recorded. See <a href="content.html#3577-privacy-disclosure-audit-message">3:5.7.7 Privacy Disclosure Audit Message</a></p>

<h2 id="1525-basicaudit-security-considerations">1:52.5 BasicAudit Security Considerations</h2>

<p>This profile does not define any transactions. This profile defines AuditEvent patterns to be used when a more specific AuditEvent pattern is defined.</p>

<p>In some cases this profile has defined a minimally-populated AuditEvent that is focused on recording identifiers with no descriptive or replication. The minimally-populated AuditEvent helps preserve privacy of the data, actors, and events recorded in the AuditEvent. The minimally-populated AuditEvent is expected to be used by an audit log using agent that has knowledge of the source material for these identifiers, and has access rights to use those source materials. For example, recording a Practitioner identifier, without recording the Practitioner name or other elements that can be found in the Practitioner resource; where audit log analysis would use an organization directory where that identitifier can be looked up to find the full details of the Practitioner.</p>

<h2 id="1526-basicaudit-cross-profile-considerations">1:52.6 BasicAudit Cross-Profile Considerations</h2>

<p>This profile defines some AuditEvent patterns for use when there is not a more specific AuditEvent pattern defined. Thus when grouped with an IHE Profile that has defined an AuditEvent (AuditMessage) pattern, that more specific pattern defined in the grouped IHE Profile shall be used.</p>

<p>The patterns defined here might be used as profiling parent to a more specific defined AuditEvent.</p>




</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->

  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/jquery-ui.min.js"> </script>

  <script type="text/javascript">
    $(document).ready(function(){
      if(window.location.hash != "") {
          $('a[href="' + window.location.hash + '"]').click()
      }
    });
  </script>
  <a name="bottom"> </a>
  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->

      <div style="background-color:var(--footer-nav-bg-color)">
        <table style="width:100%">
          <tbody>
            <tr>
              <td style="text-align:left">&#xA0;

                <a href="index.html">&lt;prev</a>

              </td>
              <td style="text-align:center">
                <a href="#top">top</a>
              </td>
              <td style="text-align:right">&#xA0;

                <a href="content.html">next&gt;</a>

              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="inner-wrapper">
        <p>
          IG &#169; 2022+ <a style="color:var(--footer-hyperlink-text-color)" href="https://www.ihe.net/ihe_domains/it_infrastructure/">IHE IT Infrastructure Technical Committee</a>.  Package ihe.iti.basicaudit#1.0.1 based on <a style="color: var(--footer-hyperlink-text-color)" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Wed, Mar 2, 2022 07:55-0600">2022-03-02</span>
          <br/>
          <span style="color: var(--footer-highlight-text-color)"></span>
                      Links: <a style="color: var(--footer-hyperlink-text-color)" href="toc.html">Table of Contents</a> |
                 <a style="color: var(--footer-hyperlink-text-color)" href="qa.html">QA Report</a>
                  | <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://github.com/IHE/ITI.BasicAudit/issues/new/choose">New Issue</a> | <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://github.com/IHE/ITI.BasicAudit/issues">Issues</a>
                
                 <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://profiles.ihe.net/ITI/basicaudit/history.html">Version History</a></a> |
                 <a style="color: var(--footer-hyperlink-text-color)" rel="license" href="http://hl7.org/fhir/R4/license.html"><img style="border-style: none;" alt="CC0" src="assets/images/cc-by.png" height="17"/></a> |
                <!-- <a style="color: var(--footer-hyperlink-text-color)" href="searchform.html">Search</a> | -->
                 <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://www.ihe.net/resources/public_comment/">Propose a change<img alt="external" style="vertical-align: baseline" src="external.png"/></a>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HLBNC861DJ');
</script>

          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->
  
  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard-btn.js"> </script>
  <script>anchors.options.visible = 'hover'
anchors.add()</script>
  
<!-- feedback form - Google forms -->
<!-- v0.1, 2021-01-09 -->


  
    
  


  
    
  



<!-- / feedback form  -->

  <!-- Analytics Below
  ================================================== -->
  </body>
</html>

