<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>IHE.ITI.BALP\1:52 Basic Audit Log Patterns - FHIR v4.0.1</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>

    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  	<link href="assets/css/prism.css" rel="stylesheet" />
    <!-- Placeholder for child template CSS declarations -->
<link href="assets/css/ihe.css" rel="stylesheet"/>
<link href="assets/css/nonum.css" rel="stylesheet"/>
<script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-HLBNC861DJ" async> </script> 


    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="fhir-logo" sizes="144x144" href="assets/ico/icon-fhir-144.png"/>
    <link rel="fhir-logo" sizes="114x114" href="assets/ico/icon-fhir-114.png"/>
    <link rel="fhir-logo" sizes="72x72" href="assets/ico/icon-fhir-72.png"/>
    <link rel="fhir-logo" href="assets/ico/icon-fhir-57.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>

    <style type="text/css">h2{--heading-prefix:"2"}
    h3,h4,h5,h6{--heading-prefix:"2"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->
        <!-- Placeholder for child template header declarations -->

<div id="project-nav">
  <a id="ihe-logo" no-external="true" href="http://profiles.ihe.net">
    <img height="71" alt="Visit the IHE website" src="assets/images/ihe-international.png"/>
  </a>
</div>
<div id="family-nav">
  <a id="family-logo" no-external="true" href="http://hl7.org/fhir"><img height="30" alt="Visit the FHIR website" src="assets/images/fhir-logo.png"/> </a>
</div>
<!--
<div id="hl7-search">
  <a id="hl7-search-lnk" no-external="true" href="searchform.html"><img alt="Search FHIR" src="assets/images/search.png"/></a>
</div>
-->
<div id="project-nav">
  
  
    <a id="project-logo" no-external="true" href="http://profiles.ihe.net/ITI/index.html"><img height="70" alt="Visit the ITI website" src="assets/images/ITI.png"/> </a>
</div>

        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">Basic Audit Log Patterns (BALP)</span>
            <br/>
            <span style="display:inline-block;">1.1.2 - Trial-Implementation



  <img alt="International flag" src="assets/images/001.svg" height="16" title="International"/>


            </span>
          </p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->

    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <!-- menu.xml  -->

<ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
  <li>
    <a href="index.html">BasicAudit Home</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Volume 1
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="volume-1.html">Introduction</a>
      </li>
      <li>
        <a href="volume-1.html#1521-basicaudit-actors-and-content">Actors and Content</a>
      </li>
      <li>
        <a href="volume-1.html#1522-basicaudit-actor-options">Actor Options</a>
      </li>
      <li>
        <a href="volume-1.html#1523-basicaudit-required-actor-grouping">Required Groupings</a>
      </li>
      <li>
        <a href="volume-1.html#1524-basicaudit-overview">Overview</a>
      </li>
      <li>
        <a href="volume-1.html#1525-basicaudit-security-considerations">Security Considerations</a>
      </li>
      <li>
        <a href="volume-1.html#1526-basicaudit-cross-profile-considerations">Cross-Profile Considerations</a>
      </li>
    </ul>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Volume 3
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="content.html">Basic Audit Log Patterns</a>
      </li>
      <li>
        <a href="content.html#3573-restful-activities">-RESTful activities</a>
      </li>
      <li>
        <a href="content.html#3574-saml-security-token">-SAML Security Token</a>
      </li>
      <li>
        <a href="content.html#3575-oauth-security-token">-OAuth Security Token</a>
      </li>
      <li>
        <a href="content.html#3576-consent-authorized-decision-audit-message">-Consent Authorized Decision Audit Message</a>
      </li>
      <li>
        <a href="content.html#3577-privacy-disclosure-audit-message">-Privacy Disclosure Audit Message</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="artifacts.html">Artifacts</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Other
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="testplan.html">Test Plan</a>
      </li>
      <li>
        <a href="other.html">Changes to Other Specifications</a>
      </li>
      <li>
        <a href="download.html">Download and Analysis</a>
      </li>
      <li>
        <a href="appendix.html">AuditEvent use in Other Profiles</a>
      </li>
    </ul>
  </li>
</ul>
            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->

    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><b>1:52 Basic Audit Log Patterns</b></li>

          <span style="float:right;">

            <a href="index.html">&lt;prev</a> | 

            <a href="#bottom">bottom</a>

          | <a href="content.html">next&gt;</a>

          </span>

        </ul>
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->

    <a name="top"> </a>
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<style type="text/css">
h2:before{color:silver;counter-increment:section;content:var(--heading-prefix) " ";}
h3:before{color:silver;counter-increment:sub-section;content:var(--heading-prefix) "." counter(sub-section) " ";}
h4:before{color:silver;counter-increment:composite;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) " ";}
h5:before{color:silver;counter-increment:detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) " ";}
h6:before{color:silver;counter-increment:more-detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) "." counter(more-detail)" ";}
</style>
<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">This page is part of the IHE Basic Audit Log Patterns (BALP) (v1.1.2: Publication) based on <a data-no-external="true" href="http://hl7.org/fhir/R4">FHIR (HL7® FHIR® Standard) R4</a>. The current version which supersedes this version is <a data-no-external="true" href="https://profiles.ihe.net/ITI/BALP">1.1.4</a>.  For a full list of available versions, see the <a data-no-external="true" href="https://profiles.ihe.net/ITI/BALP/history.html">Directory of published versions</a></p><!--EndReleaseHeader-->
  <h2>1:52 Basic Audit Log Patterns</h2>
  












    <p><!-- white space is critical inside of capture --></p>
<div class="markdown-toc">
<ul id="markdown-toc">
  <li><a href="#1521-basicaudit-actors-and-content" id="markdown-toc-1521-basicaudit-actors-and-content">1:52.1 BasicAudit Actors and Content</a>    <ul>
      <li><a href="#15211-actor-descriptions-and-actor-profile-requirements" id="markdown-toc-15211-actor-descriptions-and-actor-profile-requirements">1:52.1.1 Actor Descriptions and Actor Profile Requirements</a></li>
    </ul>
  </li>
  <li><a href="#1522-basicaudit-actor-options" id="markdown-toc-1522-basicaudit-actor-options">1:52.2 BasicAudit Actor Options</a></li>
  <li><a href="#1523-basicaudit-required-actor-grouping" id="markdown-toc-1523-basicaudit-required-actor-grouping">1:52.3 BasicAudit Required Actor Grouping</a></li>
  <li><a href="#1524-basicaudit-overview" id="markdown-toc-1524-basicaudit-overview">1:52.4 BasicAudit Overview</a>    <ul>
      <li><a href="#15241-concepts" id="markdown-toc-15241-concepts">1:52.4.1 Concepts</a></li>
      <li><a href="#15242-use-cases" id="markdown-toc-15242-use-cases">1:52.4.2 Use Cases</a></li>
    </ul>
  </li>
  <li><a href="#1525-basicaudit-security-considerations" id="markdown-toc-1525-basicaudit-security-considerations">1:52.5 BasicAudit Security Considerations</a></li>
  <li><a href="#1526-basicaudit-cross-profile-considerations" id="markdown-toc-1526-basicaudit-cross-profile-considerations">1:52.6 BasicAudit Cross-Profile Considerations</a></li>
</ul>

</div>

<p>The Basic Audit Log Patterns (BALP) is a Content Profile that defines some basic and reusable AuditEvent patterns.</p>

<p>The Audit Log Patterns defined here rely on the <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">ATNA</a> Profile for transport of the AuditEvent and query/retrieval of AuditEvents previously recorded. 
The patterns defined here may be used as they are, or further refined to specific use-cases. 
Where a more specific audit event is defined, it should be derived off of these basic patterns. Thus, a more specific AuditEvent would be compliant with one or more of the AuditEvent patterns defined here.</p>

<p>This Implementation Guide is intended to be fully compliant with the HL7 <a href="http://hl7.org/fhir/">FHIR</a> specification, providing only use-case driven constraints to aid with interoperability, deterministic results, and compatibility with <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">ATNA</a> and other IHE Profiles.</p>

<p>Figure 1:52-1 shows a broader setting for the actors directly involved in the Basic Audit Log Patterns Profile and the relevant transactions between them.</p>

<div>
<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="419px" preserveAspectRatio="none" style="width:446px;height:419px;background:#FFFFFF;" version="1.1" viewBox="0 0 446 419" width="446px" zoomAndPan="magnify"><defs /><g><!--cluster ANY Secure Client--><g id="cluster_ANY Secure Client"><rect fill="none" height="189" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1.0;" width="170" x="7" y="7" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="128" x="28" y="23.5332">ANY Secure Client</text></g><!--cluster ANY Secure Server--><g id="cluster_ANY Secure Server"><rect fill="none" height="189" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1.0;" width="170" x="230" y="7" /><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="135" x="247.5" y="23.5332">ANY Secure Server</text></g><!--entity cRest--><g id="elem_cRest"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80" x="37" y="43" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="47" y="67.5332">any client</text></g><!--entity cAud--><g id="elem_cAud"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138" x="23" y="142" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="33" y="166.5332">Secure Application</text></g><!--entity sAud--><g id="elem_sAud"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138" x="246" y="142" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="118" x="256" y="166.5332">Secure Application</text></g><!--entity sRest--><g id="elem_sRest"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87" x="284.5" y="43" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="294.5" y="67.5332">any server</text></g><!--entity AuditRepository--><g id="elem_AuditRepository"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="174" x="110" y="260" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="120" y="284.5332">Audit Record Repository</text></g><!--entity AuditClient--><g id="elem_AuditClient"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="136.5" y="376" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="146.5" y="400.5332">Audit Consumer</text></g><!--link cRest to cAud--><g id="link_cRest_cAud"><path d="M79.82,81.24 C81.9,94.66 84.76,113.21 87.2,128.94 " fill="none" id="cRest-to-cAud" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;" /><polygon fill="#181818" points="89.19,141.84,92.2262,135.2993,87.3564,129.9809,84.3202,136.5217,89.19,141.84" style="stroke:#181818;stroke-width:1.0;" /></g><!--link sRest to sAud--><g id="link_sRest_sAud"><path d="M325.55,81.24 C323.76,94.66 321.27,113.21 319.16,128.94 " fill="none" id="sRest-to-sAud" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;" /><polygon fill="#181818" points="317.43,141.84,322.1922,136.4251,319.0255,129.9465,314.2632,135.3614,317.43,141.84" style="stroke:#181818;stroke-width:1.0;" /></g><!--link cRest to sRest--><g id="link_cRest_sRest"><path d="M117.05,62 C161.12,62 231.96,62 279.23,62 " fill="none" id="cRest-to-sRest" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;" /><polygon fill="#181818" points="284.3,62,275.3,58,279.3,62,275.3,66,284.3,62" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="135.25" y="55.4951">ANY request/response</text></g><!--link sAud to AuditRepository--><g id="link_sAud_AuditRepository"><path d="M305.34,180.16 C297,194.73 283.97,215.13 269,230 C258.75,240.18 246.03,249.49 234.16,257.14 " fill="none" id="sAud-to-AuditRepository" style="stroke:#181818;stroke-width:1.0;" /><polygon fill="#181818" points="229.83,259.89,239.5717,258.4413,234.0507,257.2093,235.2826,251.6882,229.83,259.89" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="284" y="226.4951">Record Audit Event [ITI-20]</text></g><!--link cAud to AuditRepository--><g id="link_cAud_AuditRepository"><path d="M92.61,180.19 C93.97,194.97 97.91,215.66 109,230 C117.82,241.4 130.14,250.45 142.78,257.48 " fill="none" id="cAud-to-AuditRepository" style="stroke:#181818;stroke-width:1.0;" /><polygon fill="#181818" points="147.44,259.97,141.3851,252.2022,143.0294,257.6148,137.6168,259.2592,147.44,259.97" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="110" y="226.4951">Record Audit Event [ITI-20]</text></g><!--reverse link AuditRepository to AuditClient--><g id="link_AuditRepository_AuditClient"><path d="M197,303.28 C197,324.67 197,355.96 197,375.64 " fill="none" id="AuditRepository-backto-AuditClient" style="stroke:#181818;stroke-width:1.0;" /><polygon fill="#181818" points="197,298.06,193,307.06,197,303.06,201,307.06,197,298.06" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="198" y="342.4951">Retrieve ATNA Audit Event [ITI-81]</text></g></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure 1:52-1: BasicAudit Actor Setting</strong></p>

<p><em>ANY Secure Client</em> and <em>ANY Secure Server</em> represent abstractions of any client/server actor grouped with an <strong>ATNA Secure Node</strong> or an <strong>ATNA Secure Application</strong> supporting the <strong>ATX: FHIR Feed Option</strong>, defined in the <a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">RESTful ATNA Supplement</a>. Where <em>ANY Secure Client</em> and <em>ANY Secure Server</em> are involved in some communication that is an auditable event described in this Implementation Guide and for which some AuditEvent pattern is defined. The AuditEvent patterns defined here will be created and recorded [ITI-20] by the <em>Secure Node</em> or <em>Secure Application</em> that is grouped within the diagramed <em>ANY Secure Client</em> and the <em>ANY Secure Server</em>.</p>

<p>The double recording enables forensic analysis to detect failures better. Both audit events recorded will be different as the AuditEvent.source would identify the actor recording the event. Some actors will be able to populate the AuditEvent pattern given more fully, the lack of an element being populated is not a defect, but rather indicates that the actor did not have access to that data.</p>

<h2 id="1521-basicaudit-actors-and-content">1:52.1 BasicAudit Actors and Content</h2>

<p>Figure 1:52.1-1 shows the actors directly involved in the Basic Audit Log Patterns Profile and the relevant transactions between them. The <strong>Audit Creator</strong> creates AuditEvent records following this profile that is consumed by the <strong>Audit Consumer</strong>. The transport for the AuditEvent records is the <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">ATNA</a> Profile.</p>

<div>
<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="317px" preserveAspectRatio="none" style="width:304px;height:317px;background:#FFFFFF;" version="1.1" viewBox="0 0 304 317" width="304px" zoomAndPan="magnify"><defs /><g><!--entity cAud--><g id="elem_cAud"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104" x="46.0638" y="7" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="56.0638" y="31.5332">Audit Creator</text></g><!--entity AuditRepository--><g id="elem_AuditRepository"><path d="M15.0607,132.5969 C18.1305,126.3075 23.5181,126.97 27.3213,131.7873 C28.8657,125.5514 34.6492,124.4046 38.7855,129.0588 C41.7437,123.8237 47.351,124.0424 50.4382,128.9101 C54.6005,121.9765 59.1636,121.7856 63.4841,128.7617 C66.0051,123.1522 70.6949,122.2828 75.1447,126.4648 C78.974,121.326 82.5693,120.6878 86.1168,126.741 C89.4412,120.4285 94.4229,120.4086 98.5744,125.8655 C102.689,119.1845 107.9269,120.252 111.6436,126.2748 C114.5871,121.3885 119.6287,120.7003 122.266,126.5769 C127.1626,121.1145 132.204,120.0657 136.058,127.6769 C139.8646,122.6128 144.8685,122.5805 147.9842,128.4317 C151.9936,122.9563 157.4341,124.2554 159.709,130.2109 C163.1813,124.4952 168.4766,124.3451 171.8017,130.3627 C176.4217,124.7647 181.1721,126.8887 183.538,132.6846 C190.4554,136.4792 190.1447,141.7652 184.2904,146.2674 C191.0585,149.3411 191.8139,155.4117 186.7312,160.5155 C193.9938,166.973 193.4088,171.9846 184.3936,175.9819 C190.0304,179.8228 188.7604,185.4408 183.2849,188.28 C180.3653,195.014 175.1627,195.3382 170.6521,189.9361 C168.3078,196.3682 162.4666,196.8841 158.7848,191.2517 C155.8275,196.6256 152.2932,198.3234 147.3989,193.3918 C143.1803,198.3046 139.3859,197.5093 136.0866,192.3585 C133.2216,199.9981 126.9379,200.0307 122.1291,194.4037 C119.3983,199.6933 114.3411,200.3864 111.3238,194.6853 C107.9781,202.1587 102.8369,202.6923 98.1189,195.9611 C94.9033,201.9482 89.5029,200.7278 86.6415,195.5956 C83.0442,200.1654 78.3851,199.792 75.7803,194.5023 C71.8294,199.5975 66.2901,199.2204 63.8593,192.9131 C58.7602,198.0853 54.3368,197.346 50.4517,191.4434 C46.7565,197.0354 41.8186,197.2076 38.2651,191.2934 C35.5336,196.1291 30.5128,196.6353 27.8615,191.2121 C22.1917,196.7282 18.4614,195.346 15.4245,188.552 C9.443,185.0653 9.0108,178.3962 14.9335,174.4937 C8.2996,170.7014 7.7562,166.0969 13.4292,160.9387 C6,157.1485 6.7435,151.0503 13.404,147.2341 C6.332,141.9543 8.5425,136.3385 15.0607,132.5969 " fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="21.0638" y="152.5332">ATNA</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:1.0,2.0;" x1="7.0638" x2="189.0638" y1="155.6094" y2="155.6094" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="21.0638" y="174.1426">Audit Record Repository</text></g><!--entity AuditClient--><g id="elem_AuditClient"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="37.5638" y="274" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="47.5638" y="298.5332">Audit Consumer</text></g><!--link cAud to AuditRepository--><g id="link_cAud_AuditRepository"><path d="M98.0638,45.01 C98.0638,63.66 98.0638,93.43 98.0638,117.8 " fill="none" id="cAud-to-AuditRepository" style="stroke:#181818;stroke-width:1.0;" /><polygon fill="#181818" points="98.0638,122.91,102.0638,113.91,98.0638,117.91,94.0638,113.91,98.0638,122.91" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="99.0638" y="89.4951">Record Audit Event [ITI-20]</text></g><!--reverse link AuditRepository to AuditClient--><g id="link_AuditRepository_AuditClient"><path d="M98.0638,201.18 C98.0638,225.46 98.0638,255.1 98.0638,273.77 " fill="none" id="AuditRepository-backto-AuditClient" style="stroke:#181818;stroke-width:1.0;" /><polygon fill="#181818" points="98.0638,196.09,94.0638,205.09,98.0638,201.09,102.0638,205.09,98.0638,196.09" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="99.0638" y="240.4951">Retrieve ATNA Audit Event [ITI-81]</text></g></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure 1:52.1-1: BasicAudit Actor Diagram</strong></p>

<p><strong>Table 1:52.1-1: BasicAudit - Actors</strong></p>

<table class="grid">
  <thead>
    <tr>
      <th>Actors</th>
      <th style="text-align: center">Optionality</th>
      <th>Reference</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Audit Creator</td>
      <td style="text-align: center">R</td>
      <td>1:52.1.1.1</td>
    </tr>
    <tr>
      <td>Audit Consumer</td>
      <td style="text-align: center">R</td>
      <td>1:52.1.1.2</td>
    </tr>
  </tbody>
</table>

<h3 id="15211-actor-descriptions-and-actor-profile-requirements">1:52.1.1 Actor Descriptions and Actor Profile Requirements</h3>

<h4 id="152111-audit-creator">1:52.1.1.1 Audit Creator</h4>

<p>The Audit Creator shall detect the defined auditable events and record a complaint AuditEvent as defined. The Audit Creator shall be grouped with an <strong>ATNA Secure Application</strong> or <strong>ATNA Secure Node</strong> with support for <strong>ATNA ATX:FHIR Feed Option</strong> defined in the <a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">RESTful ATNA Supplement</a> for the recording of the compliant AuditEvent to the Audit Record Repository.</p>

<p>A <code class="language-plaintext highlighter-rouge">requirements</code> CapabilityStatements defines full functional <a href="CapabilityStatement-IHE.BALP.AuditCreator.html">Audit Creator</a> with ATNA support for ITI-20.</p>

<h4 id="152112-audit-consumer">1:52.1.1.2 Audit Consumer</h4>

<p>The Audit Consumer shall be grouped with an <strong>ATNA Audit Consumer</strong> with support for the <strong>Retrieve Audit Message Option</strong> defined in the <a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">RESTful ATNA Supplement</a>. The Audit Consumer understands the AuditEvent profiles defined, but shall not reject an AuditEvent due to non-compliance.</p>

<p>A <code class="language-plaintext highlighter-rouge">requirements</code> CapabilityStatements defines full functional <a href="CapabilityStatement-IHE.BALP.AuditConsumer.html">Audit Consumer</a> with ATNA support for ITI-81.</p>

<h4 id="152113-atna-audit-record-repository">1:52.1.1.3 ATNA Audit Record Repository</h4>

<p>The <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">ATNA</a> Audit Record Repository with support for <strong>ATNA ATX:FHIR Feed Option</strong>, and <strong>Retrieve Audit Message Option</strong>. These options are defined in the <a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">RESTful ATNA Supplement</a>. The ATNA Audit Record Repository may detect and validate the AuditEvent requirements defined here, but shall not reject an AuditEvent due to non-compliance.</p>

<p>A <code class="language-plaintext highlighter-rouge">requirements</code> CapabilityStatements defines full functional <a href="CapabilityStatement-IHE.BALP.ATNA.AuditRecordRepository.html">ATNA Audit Record Repository</a> with support for the BALP content profiles.</p>

<h2 id="1522-basicaudit-actor-options">1:52.2 BasicAudit Actor Options</h2>

<p>Each AuditEvent pattern defined here can be declared by an <strong>Audit Creator</strong> or an <strong>Audit Consumer</strong>.</p>

<h2 id="1523-basicaudit-required-actor-grouping">1:52.3 BasicAudit Required Actor Grouping</h2>

<p>The required groupings for BasicAudit are those in the ATNA Profile, see <a href="https://profiles.ihe.net/ITI/TF/Volume1/ch-9.html">IHE ITI TF-1:9.3</a>.</p>

<p>The Security Considerations page describes some optional groupings that may be of interest for security considerations.</p>

<p>Cross-Profile Considerations describes some optional groupings in other related profiles.</p>

<h2 id="1524-basicaudit-overview">1:52.4 BasicAudit Overview</h2>

<h3 id="15241-concepts">1:52.4.1 Concepts</h3>
<p>This guide provides reusable AuditEvent patterns that can be used directly, or combined, or as derivation material for a more specific AuditEvent.</p>

<h5 id="152411-data-access-requests-produce-an-auditevent">1:52.4.1.1 Data access requests produce an AuditEvent</h5>

<p>The following use-case represents a generic interaction between a client and a server. The interactions 1, 2, and 4 represent the activity that is auditable. The interaction 3 is the recording of the AuditEvent following this Implementation Guide by the server. The interaction 5 is the recording of the AuditEvent following this Implementation Guide by the client.</p>

<div>
<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="229px" preserveAspectRatio="none" style="width:638px;height:229px;background:#FFFFFF;" version="1.1" viewBox="0 0 638 229" width="638px" zoomAndPan="magnify"><defs /><g><rect fill="#FFFFFF" height="134.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="65" y="69.9609" /><rect fill="#FFFFFF" height="104.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="347" y="69.9609" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="70" x2="70" y1="37.6094" y2="222.3672" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="352" x2="352" y1="37.6094" y2="222.3672" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="548" x2="548" y1="37.6094" y2="222.3672" /><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130" x="5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="12" y="26.5332">ANY Secure Client</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="284" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="291" y="26.5332">ANY Secure Server</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="464" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="471" y="26.5332">Audit Record Repository</text><rect fill="#FFFFFF" height="134.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="65" y="69.9609" /><rect fill="#FFFFFF" height="104.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="347" y="69.9609" /><polygon fill="#181818" points="335,65.9609,345,69.9609,335,73.9609,339,69.9609" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="75" x2="341" y1="69.9609" y2="69.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258" x="82" y="65.1045">1. Client requests some data from the Server</text><line style="stroke:#181818;stroke-width:1.0;" x1="357" x2="399" y1="100.3125" y2="100.3125" /><line style="stroke:#181818;stroke-width:1.0;" x1="399" x2="399" y1="100.3125" y2="113.3125" /><line style="stroke:#181818;stroke-width:1.0;" x1="358" x2="399" y1="113.3125" y2="113.3125" /><polygon fill="#181818" points="368,109.3125,358,113.3125,368,117.3125,364,113.3125" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="364" y="95.4561">2. Server finds data requested</text><polygon fill="#181818" points="536,139.6641,546,143.6641,536,147.6641,540,143.6641" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="357" x2="542" y1="143.6641" y2="143.6641" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="364" y="138.8076">3. Server records audit event</text><polygon fill="#181818" points="86,170.0156,76,174.0156,86,178.0156,82,174.0156" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="80" x2="351" y1="174.0156" y2="174.0156" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="92" y="169.1592">4. Server returns read data requested</text><polygon fill="#181818" points="536,200.3672,546,204.3672,536,208.3672,540,204.3672" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="70" x2="542" y1="204.3672" y2="204.3672" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="77" y="199.5107">5. Client records audit event</text></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure: 1:52.4.1.1-1: Audit log event creation</strong></p>

<h4 id="152412-auditevents-are-available-to-authorized-clients">1:52.4.1.2 AuditEvents are available to authorized clients</h4>

<p>The following use-case represents the use-case defined in <a href="https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RESTful-ATNA.pdf">ATNA [ITI-81]</a>. The use of this transaction in this Implementation Guide is to specialize it with the use of the patient identity to retrieve AuditEvent resources where that patient identity was found in the .agent or .entity. Where the patient identity in the .agent element indicates that the patient was actively engaged in the activity recorded in that AuditEvent, and .entity element indicates that the patient was the subject of the event. Note that accessing the audit log is an auditable event and thus interactions 3 and 5.</p>

<div>
<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="242px" preserveAspectRatio="none" style="width:712px;height:242px;background:#FFFFFF;" version="1.1" viewBox="0 0 712 242" width="712px" zoomAndPan="magnify"><defs /><g><rect fill="#FFFFFF" height="147.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="57.5" y="69.9609" /><rect fill="#FFFFFF" height="117.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="373.5" y="69.9609" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="62" x2="62" y1="37.6094" y2="235.3672" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="378.5" x2="378.5" y1="37.6094" y2="235.3672" /><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115" x="5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="12" y="26.5332">Audit Consumer</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="294.5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="301.5" y="26.5332">Audit Record Repository</text><rect fill="#FFFFFF" height="147.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="57.5" y="69.9609" /><rect fill="#FFFFFF" height="117.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="373.5" y="69.9609" /><polygon fill="#181818" points="361.5,65.9609,371.5,69.9609,361.5,73.9609,365.5,69.9609" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="67.5" x2="367.5" y1="69.9609" y2="69.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289" x="74.5" y="65.1045">1. Client requests AuditEvent records for Patient X</text><line style="stroke:#181818;stroke-width:1.0;" x1="383.5" x2="425.5" y1="100.3125" y2="100.3125" /><line style="stroke:#181818;stroke-width:1.0;" x1="425.5" x2="425.5" y1="100.3125" y2="113.3125" /><line style="stroke:#181818;stroke-width:1.0;" x1="384.5" x2="425.5" y1="113.3125" y2="113.3125" /><polygon fill="#181818" points="394.5,109.3125,384.5,113.3125,394.5,117.3125,390.5,113.3125" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290" x="390.5" y="95.4561">2. Server finds AuditEvents requested for Patient X</text><line style="stroke:#181818;stroke-width:1.0;" x1="383.5" x2="425.5" y1="143.6641" y2="143.6641" /><line style="stroke:#181818;stroke-width:1.0;" x1="425.5" x2="425.5" y1="143.6641" y2="156.6641" /><line style="stroke:#181818;stroke-width:1.0;" x1="384.5" x2="425.5" y1="156.6641" y2="156.6641" /><polygon fill="#181818" points="394.5,152.6641,384.5,156.6641,394.5,160.6641,390.5,156.6641" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315" x="390.5" y="138.8076">3. Server records audit event of the audit Event request</text><polygon fill="#181818" points="78.5,183.0156,68.5,187.0156,78.5,191.0156,74.5,187.0156" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="72.5" x2="377.5" y1="187.0156" y2="187.0156" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="282" x="84.5" y="182.1592">4. Server returns AuditEvent records for Patient X</text><polygon fill="#181818" points="366.5,213.3672,376.5,217.3672,366.5,221.3672,370.5,217.3672" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="62.5" x2="372.5" y1="217.3672" y2="217.3672" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="69.5" y="212.5107">5. Audit Client records audit event</text></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure: 1:52.4.1.2-1: Audit Use</strong></p>

<h4 id="152413-minimal-vs-comprehensive-auditevent">1:52.4.1.3 Minimal vs Comprehensive AuditEvent</h4>

<p>In this Implementation Guide there are sometimes two sets of patterns defined:</p>

<h5 id="1524131-minimal-auditevent">1:52.4.1.3.1 Minimal AuditEvent</h5>

<p>The minimal AuditEvent pattern should be used whenever possible. The minimal AuditEvent pattern avoids replicating information that can be looked up by any audit analysis application that has access. By placing minimal information into the AuditEvent the size of the AuditEvent is dramatically reduced, and there is less exposure of privacy and security information.</p>

<p>With minimal AuditEvent the AuditEvent contains identifiers or References, and not the details. For example, user identifier, practitioner identifier, organizational identifier, patient identifier, data object identifier, location identifiers, and security token identifier. With minimal the users names would not be recorded, details of a diagnosis would not be replicated, postal addresses would not be replicated. The identifiers that are recorded can be looked up using a user directory, practitioner directory, patient directory, data registry, and token introspection. The lookup of these values is further protection of the data behind them, preventing abuse by someone who has access to the AuditEvent log for one purpose gaining knowledge from other AuditEvent records.</p>

<p>With minimal AuditEvent, the AuditEvent contains only the search (aka, query) parameters, and never the results of the search. This too limits the size of the AuditEvent and the exposure of sensitive results data into the AuditEvent log. The results can be determined by re-executing the search or query, adjusting the results based on the time of the search.</p>

<p>The minimal AuditEvent is lower risk, but would still contain sensitive data.</p>

<h5 id="1524132-comprehensive-auditevent">1:52.4.1.3.2 Comprehensive AuditEvent</h5>

<p>There are times when the AuditEvent log are used by Audit Consumer Actors are known to not have access to some lookup services. In these cases, it is better to record the details into the AuditEvent. For example, where in a Cross-Community setting the details of the user may not be possible to lookup the security token details.</p>

<p>With Comprehensive AuditEvent, the search results might be preserved in the AuditEvent. This will create a very large AuditEvent with replicated data. So, care should be taken to select the kinds of auditable events where the results are recorded comprehensively, and these results should be purged regularly to limit the overall impact as the results data tend to be less useful as the AuditEvent ages.</p>

<p>In Cross-Community settings making full access to all of the needed directory and registry services may not be logistically possible. The counter argument is that when one party needs to perform AuditEvent log analysis and has suspicion based on that analysis, they could use out-of-band methods to request a lookup of an identifier. For example, when the AuditEvent log shows a strange behavior by a user identifier, such as an unusually large number of search activities at strange times of day or searches against a VIP patient. These out-of-band requests should be supported by the Cross-Community policy agreements.</p>

<h4 id="152414-query-parameter-handling">1:52.4.1.4 Query Parameter Handling</h4>

<p>The raw search request is base64 encoded and placed in the .entity[query].query element. The base64 encoding of the raw search request enables preserving exactly what was requested, including possibly malicious patterns. This enables detection of malicious or malformed requests.</p>

<p>The cleaned search may be recorded (not base64) in the .entity[query].description. The cleaned search request would have removed parameters that were not understood/supported. The cleaned search request in the .description element enables more efficient processing.</p>

<p>The results of the search are not included in the minimal AuditEvent, and are recommended to not be included in the comprehensive AuditEvent. Recording the results of a search in the AuditEvent will produce very large resources that are hard to process, and which replicate the database searched multiple times over. The AuditEvent record with search results contain highly sensitive data.</p>

<h4 id="152415-best-effort">1:52.4.1.5 Best Effort</h4>

<p>The AuditEvent should be populated with best-effort. This principle recognizes that there are times when an AuditEvent can’t be fully populated due to the recording entity not having access to all of the information. The principle recognizes that recording some information is better than failing to record any AuditEvent due to this lack of elements to fit the pattern. These cases where lesser information is available to be recorded tend to be during failure-modes, which leads to the importance to record the elements that are known.</p>

<p>This principle also recognizes that some detail could be obtained, but through extreme effort. This extreme effort is often not justified. So best-effort does not compel the use of extreme effort to obtain the missing information. For example, during a network transaction where the AuditEvent pattern is calling for the name of the user in addition to the user identifier, the name could be looked up in a directory, but this would be extreme effort that is not called for by best-effort.</p>

<h4 id="152416-patient-as-a-subject">1:52.4.1.6 Patient as a Subject</h4>

<p>It is a best practice to include a reference to the Patient/Subject affected by any auditable event, in order to enable Privacy Accounting of Disclosures and Access Logs, and to enable privacy office and security office audit log analysis. Reasonable efforts should be taken to assure the Patient/Subject is recorded, but it is recognized that there are times when this is not reasonable, see the Best Effort section above.</p>

<p>The Patient/Subject of an activity is indicated in an .entity element; with the .entity.who indicating the Patient reference, and the .entity.type indicating “1” Person, and the .entity.role indicating “1” patient. No other elements in this .entity need to be filled out. The indicator of the .entity.who, .entity.type, and .entity.role are enough to indicate that this AuditEvent activity has a subject as indicated.</p>

<p>Where an activity impacts more than one Patient/Subject, multiple AuditEvent resources should be recorded, one for each Patient/Subject. This best enables segmentation of the AuditEvent details so as to limit the Privacy impact. The use of multiple AuditEvent is a best-practice and should be driven by a Policy. There will be cases where the use of multiple AuditEvent resources are not necessary, such as public health reporting.</p>

<p>To record a REST interaction or $operation, it is often necessary to complete the transaction in order to determine the Patient/Subject. Inspection of the potential returned results may be necessary. Some REST Search/Query requests and $operations include parameters limiting the results to a specific Patient, in these cases this parameter informs the inclusion of the Patient reference.</p>

<p>The Patient as a Subject is distinct from when the Patient is an Agent. When the Patient is the User, they would be indicated in an .agent and the .entity element would not be necessary. Some examples would be when the Patient is using a Patient-Portal, or when the Patient is authoring Patient Generated Health Data (PGHD).  Note that in SAML and oAuth the subject of these security tokens is the user. This is contextual use of the word ‘subject’, as in the context is the security token subject is the user agent.</p>

<p>Finding AuditEvents by Patient:</p>
<ul>
  <li>Finding AuditEvents where the Patient is an agent, one would use the <code class="language-plaintext highlighter-rouge">agent</code> search parameter.</li>
  <li>Finding AuditEvents where the Patient is a subject, one would use the <code class="language-plaintext highlighter-rouge">entity</code> search parameter.</li>
  <li>Finding AuditEvents where the Patient is either an agent or subject, one would use the <code class="language-plaintext highlighter-rouge">patient</code> search parameter.</li>
</ul>

<p>This Implementation Guide includes profiles that include the Patient as the subject.</p>

<h3 id="15242-use-cases">1:52.4.2 Use Cases</h3>

<p>The AuditEvent patterns defined here cover the following Use Cases.</p>

<h4 id="152421-use-case-1-generic-auditevent-pattern-for-fhir-restful-operations">1:52.4.2.1 Use Case #1: Generic AuditEvent pattern for FHIR RESTful operations</h4>

<p>Given the http RESTful operations of Create, Read, Update, Delete, and Search; the patterns defined here will capture sufficient information for audit analysis by an Audit Consumer Actor. See <a href="content.html#3573-restful-activities">3:5.7.3 RESTful activities</a> for the pattern definitions and examples.</p>

<p>The Use Case #1 is represented by the figure first introduced in section <a href="#152411-data-access-requests-produce-an-auditevent">1:52.4.1.1 Data access requests produce an AuditEvent</a>.
The generic interaction between a client and a server shown with interactions 1, 2, and 4 represent the activity that is auditable. The interaction 3 is the recording of the AuditEvent following this Implementation Guide by the server. The interaction 5 is the recording of the AuditEvent following this Implementation Guide by the client.</p>

<div>
<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="229px" preserveAspectRatio="none" style="width:638px;height:229px;background:#FFFFFF;" version="1.1" viewBox="0 0 638 229" width="638px" zoomAndPan="magnify"><defs /><g><rect fill="#FFFFFF" height="134.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="65" y="69.9609" /><rect fill="#FFFFFF" height="104.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="347" y="69.9609" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="70" x2="70" y1="37.6094" y2="222.3672" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="352" x2="352" y1="37.6094" y2="222.3672" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="548" x2="548" y1="37.6094" y2="222.3672" /><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="130" x="5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="12" y="26.5332">ANY Secure Client</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136" x="284" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="291" y="26.5332">ANY Secure Server</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168" x="464" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="154" x="471" y="26.5332">Audit Record Repository</text><rect fill="#FFFFFF" height="134.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="65" y="69.9609" /><rect fill="#FFFFFF" height="104.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="347" y="69.9609" /><polygon fill="#181818" points="335,65.9609,345,69.9609,335,73.9609,339,69.9609" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="75" x2="341" y1="69.9609" y2="69.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258" x="82" y="65.1045">1. Client requests some data from the Server</text><line style="stroke:#181818;stroke-width:1.0;" x1="357" x2="399" y1="100.3125" y2="100.3125" /><line style="stroke:#181818;stroke-width:1.0;" x1="399" x2="399" y1="100.3125" y2="113.3125" /><line style="stroke:#181818;stroke-width:1.0;" x1="358" x2="399" y1="113.3125" y2="113.3125" /><polygon fill="#181818" points="368,109.3125,358,113.3125,368,117.3125,364,113.3125" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="364" y="95.4561">2. Server finds data requested</text><polygon fill="#181818" points="536,139.6641,546,143.6641,536,147.6641,540,143.6641" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="357" x2="542" y1="143.6641" y2="143.6641" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="364" y="138.8076">3. Server records audit event</text><polygon fill="#181818" points="86,170.0156,76,174.0156,86,178.0156,82,174.0156" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="80" x2="351" y1="174.0156" y2="174.0156" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="92" y="169.1592">4. Server returns read data requested</text><polygon fill="#181818" points="536,200.3672,546,204.3672,536,208.3672,540,204.3672" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="70" x2="542" y1="204.3672" y2="204.3672" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="77" y="199.5107">5. Client records audit event</text></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure: 1:52.4.2.1-1: Audit log event creation</strong></p>

<h4 id="152422-use-case-2-security-token-enhancement-pattern">1:52.4.2.2 Use Case #2: Security token enhancement pattern</h4>

<p>Given that a security relevant event is being recorded, for example, Generic FHIR RESTful operations, and where a security token is known that describes the client and possibly the human; there is a need to record well formatted details about the security context. This use-case needs an audit event pattern defined, to be combined with the audit event pattern for the security relevant event (see Use Case #1), that would enhance the audit event log record with details from the OAuth or SAML token. See <a href="content.html#3574-saml-security-token">3:5.7.4 SAML Security Token</a> and <a href="content.html#3575-oauth-security-token">3:5.7.5 OAuth Security Token</a> for the pattern definitions and examples.</p>

<h4 id="152423-use-case-3-consent-authorized-decision-event">1:52.4.2.3 Use Case #3: Consent Authorized Decision event</h4>

<p>Given that an Authorization Service makes Authorization Decisions based on a Consent, this use-case shows how the details of the authorization decision event can be recorded. See <a href="content.html#3576-consent-authorized-decision-audit-message">3:5.7.6 Consent Authorized Decision Audit Message</a>.</p>

<div>
<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" preserveAspectRatio="none" version="1.1" viewBox="0 0 925 324" zoomAndPan="magnify"><defs /><g><rect fill="#FFFFFF" height="237.4609" style="stroke:#181818;stroke-width:1.0;" width="10" x="177.5" y="69.9609" /><rect fill="#FFFFFF" height="104.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="561.5" y="151.0156" /><rect fill="none" height="215.4609" style="stroke:#000000;stroke-width:1.5;" width="781.5" x="137.5" y="84.9609" /><rect fill="none" height="183.1094" style="stroke:#000000;stroke-width:1.5;" width="761.5" x="147.5" y="110.3125" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="26" x2="26" y1="37.6094" y2="317.4219" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="182.5" x2="182.5" y1="37.6094" y2="317.4219" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="566" x2="566" y1="37.6094" y2="317.4219" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="710" x2="710" y1="37.6094" y2="317.4219" /><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="840" x2="840" y1="37.6094" y2="317.4219" /><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43" x="5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="12" y="26.5332">User</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="50" x="157.5" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="164.5" y="26.5332">Client</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="147" x="493" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133" x="500" y="26.5332">Authorization Service</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="650" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="657" y="26.5332">Resource Server</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="781" y="5" /><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="788" y="26.5332">Audit Repository</text><rect fill="#FFFFFF" height="237.4609" style="stroke:#181818;stroke-width:1.0;" width="10" x="177.5" y="69.9609" /><rect fill="#FFFFFF" height="104.0547" style="stroke:#181818;stroke-width:1.0;" width="10" x="561.5" y="151.0156" /><polygon fill="#181818" points="165.5,65.9609,175.5,69.9609,165.5,73.9609,169.5,69.9609" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="26.5" x2="171.5" y1="69.9609" y2="69.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="33.5" y="65.1045">User uses a Client app</text><path d="M137.5,84.9609 L518.5,84.9609 L518.5,93.3125 L508.5,103.3125 L137.5,103.3125 L137.5,84.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="215.4609" style="stroke:#000000;stroke-width:1.5;" width="781.5" x="137.5" y="84.9609" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="336" x="152.5" y="99.4561">User and Client are used within Organization context</text><path d="M147.5,110.3125 L416.5,110.3125 L416.5,118.6641 L406.5,128.6641 L147.5,128.6641 L147.5,110.3125 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;" /><rect fill="none" height="183.1094" style="stroke:#000000;stroke-width:1.5;" width="761.5" x="147.5" y="110.3125" /><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="224" x="162.5" y="124.8076">User has selected a specific Patient</text><polygon fill="#181818" points="549.5,147.0156,559.5,151.0156,549.5,155.0156,553.5,151.0156" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="187.5" x2="555.5" y1="151.0156" y2="151.0156" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="355" x="194.5" y="146.1592">Client App requests Authorization Decision for a given Patient</text><line style="stroke:#181818;stroke-width:1.0;" x1="571.5" x2="613.5" y1="181.3672" y2="181.3672" /><line style="stroke:#181818;stroke-width:1.0;" x1="613.5" x2="613.5" y1="181.3672" y2="194.3672" /><line style="stroke:#181818;stroke-width:1.0;" x1="572.5" x2="613.5" y1="194.3672" y2="194.3672" /><polygon fill="#181818" points="582.5,190.3672,572.5,194.3672,582.5,198.3672,578.5,194.3672" style="stroke:#181818;stroke-width:1.0;" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="578.5" y="176.5107">Check Consent</text><polygon fill="#181818" points="828,220.7188,838,224.7188,828,228.7188,832,224.7188" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="571.5" x2="834" y1="224.7188" y2="224.7188" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="578.5" y="219.8623">Authorization Server records audit event</text><polygon fill="#181818" points="198.5,251.0703,188.5,255.0703,198.5,259.0703,194.5,255.0703" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="192.5" x2="565.5" y1="255.0703" y2="255.0703" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="204.5" y="250.2139">Permit</text><polygon fill="#181818" points="698.5,281.4219,708.5,285.4219,698.5,289.4219,702.5,285.4219" style="stroke:#181818;stroke-width:1.0;" /><line style="stroke:#181818;stroke-width:1.0;" x1="187.5" x2="704.5" y1="285.4219" y2="285.4219" /><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="194.5" y="280.5654">Uses Permit token to access Resources</text></g></svg>
</div>
<p><br clear="all" /></p>

<p><strong>Figure: 1:52.4.2.3-1: Consent Authorized Decision process flow</strong></p>

<p>This diagram focuses on the Authorization Decision, so not shown in this interaction diagram are the other AuditEvent that would be recorded by the ANY Secure Client and ANY Secure Server to record the auditable event that is the client and server interaction.</p>

<h4 id="152424-use-case-4-privacy-relevant-disclosure-event">1:52.4.2.4 Use Case #4: Privacy relevant disclosure event</h4>

<p>Given that a privacy relevant disclosure event is detected, this use-case shows how the details of the event can be recorded. See <a href="content.html#3577-privacy-disclosure-audit-message">3:5.7.7 Privacy Disclosure Audit Message</a>.</p>

<h2 id="1525-basicaudit-security-considerations">1:52.5 BasicAudit Security Considerations</h2>

<p>This profile does not define any transactions. This profile defines AuditEvent patterns to be used when a more specific AuditEvent pattern is defined.</p>

<p>In some cases, this profile has defined a minimally-populated AuditEvent that is focused on recording identifiers with no descriptive or replication. The minimally-populated AuditEvent helps preserve privacy of the data, actors, and events recorded in the AuditEvent. The minimally-populated AuditEvent is expected to be used by an audit log using agent that has knowledge of the source material for these identifiers, and has access rights to use those source materials. For example, recording a Practitioner identifier, without recording the Practitioner name or other elements that can be found in the Practitioner resource; where audit log analysis would use an organization directory where that identifier can be looked up to find the full details of the Practitioner.</p>

<h2 id="1526-basicaudit-cross-profile-considerations">1:52.6 BasicAudit Cross-Profile Considerations</h2>

<p>This profile defines some AuditEvent patterns for use when there is not a more specific AuditEvent pattern defined. Thus, when grouped with an IHE Profile that has defined an AuditEvent (AuditMessage) pattern, that more specific pattern defined in the grouped IHE Profile shall be used.</p>

<p>The patterns defined here might be used as profiling parent to a more specific defined AuditEvent.</p>




</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->

  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/jquery-ui.min.js"> </script>

  <script type="text/javascript">
    $(document).ready(function(){
      if(window.location.hash != "") {
          $('a[href="' + window.location.hash + '"]').click()
      }
    });
  </script>
  <a name="bottom"> </a>
  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->

      <div style="background-color:var(--footer-nav-bg-color)">
        <table style="width:100%">
          <tbody>
            <tr>
              <td style="text-align:left">&#xA0;

                <a href="index.html">&lt;prev</a>

              </td>
              <td style="text-align:center">
                <a href="#top">top</a>
              </td>
              <td style="text-align:right">&#xA0;

                <a href="content.html">next&gt;</a>

              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="inner-wrapper">
        <p>
          IG &#169; 2022+ <a style="color:var(--footer-hyperlink-text-color)" href="https://www.ihe.net/ihe_domains/it_infrastructure/">IHE IT Infrastructure Technical Committee</a>.  Package ihe.iti.balp#1.1.2 based on <a style="color: var(--footer-hyperlink-text-color)" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Tue, Aug 1, 2023 08:42-0500">2023-08-01</span>
          <br/>
          <span style="color: var(--footer-highlight-text-color)">
                      Links: <a style="color: var(--footer-hyperlink-text-color)" href="toc.html">Table of Contents</a> |
                 <a style="color: var(--footer-hyperlink-text-color)" href="qa.html">QA Report</a>
                  | <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://github.com/IHE/ITI.BasicAudit/issues/new/choose">New Issue</a> | <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://github.com/IHE/ITI.BasicAudit/issues">Issues</a>
                
                 <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://profiles.ihe.net/ITI/BALP/history.html">Version History</a></a> |
                 <a style="color: var(--footer-hyperlink-text-color)" rel="license" href="https://profiles.ihe.net/GeneralIntro/ch-9.html"><img style="border-style: none;" alt="CC0" src="assets/images/cc-by.png" height="17"/></a> |
                <!-- <a style="color: var(--footer-hyperlink-text-color)" href="searchform.html">Search</a> | -->
                 <a style="color: var(--footer-hyperlink-text-color)" target="_blank" href="https://www.ihe.net/resources/public_comment/">Propose a change<img alt="external" style="vertical-align: baseline" src="external.png"/></a>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-HLBNC861DJ');
</script>

          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->
  
  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard-btn.js"> </script>
  <script>anchors.options.visible = 'hover'
anchors.add()</script>
  
<!-- feedback form - Google forms -->
<!-- v0.1, 2021-01-09 -->


  
    
  


  
    
  



<!-- / feedback form  -->

  <!-- Analytics Below
  ================================================== -->
  </body>
</html>

